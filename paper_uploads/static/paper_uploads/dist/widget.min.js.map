{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/deepmerge/dist/cjs.js","webpack:///./paper_uploads/static/paper_uploads/src/js/fine-uploader/fine-uploader.core.js","webpack:///./node_modules/mime-match/index.js","webpack:///./paper_uploads/static/paper_uploads/src/js/fine-uploader/dnd.js","webpack:///./node_modules/wildcard/index.js","webpack:///./paper_uploads/static/paper_uploads/src/img/files sync nonrecursive \\.svg$","webpack:///./paper_uploads/static/paper_uploads/src/img/files/7z.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/ai.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/archive.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/audio.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/avi.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/csv.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/doc.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/html.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/iso.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/json.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/mp3.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/mp4.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/pdf.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/ppt.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/psd.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/rar.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/rtf.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/svg.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/tar.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/txt.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/unknown.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/video.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/xls.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/xml.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/zip.svg","webpack:///./paper_uploads/static/paper_uploads/src/js/_uploader.js","webpack:///./paper_uploads/static/paper_uploads/src/js/_utils.js","webpack:///./paper_uploads/static/paper_uploads/src/js/base_widget.js","webpack:///./paper_uploads/static/paper_uploads/src/js/file_widget.js","webpack:///./paper_uploads/static/paper_uploads/src/js/image_widget.js","webpack:///./paper_uploads/static/paper_uploads/src/js/collection_widget.js","webpack:///./paper_uploads/static/paper_uploads/src/js/widget.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","isMergeableObject","isNonNullObject","stringValue","toString","$$typeof","REACT_ELEMENT_TYPE","isReactElement","isSpecial","for","cloneUnlessOtherwiseSpecified","options","clone","deepmerge","val","Array","isArray","defaultArrayMerge","target","source","concat","map","element","getKeys","keys","getOwnPropertySymbols","filter","symbol","propertyIsEnumerable","getEnumerableOwnPropertySymbols","propertyIsOnObject","_","mergeObject","destination","forEach","propertyIsUnsafe","customMerge","getMergeFunction","arrayMerge","sourceIsArray","all","array","Error","reduce","prev","next","deepmerge_1","global","qq","hide","style","display","this","attach","type","fn","addEventListener","attachEvent","detach","removeEventListener","detachEvent","contains","descendant","compareDocumentPosition","insertBefore","elementB","parentNode","remove","removeChild","css","styles","opacity","filters","Math","round","extend","hasClass","considerParent","re","RegExp","test","className","addClass","removeClass","replace","getByClass","first","candidates","result","querySelector","querySelectorAll","getElementsByTagName","each","idx","push","getFirstByClass","children","child","firstChild","nodeType","nextSibling","setText","text","innerText","textContent","clearText","hasAttribute","attrName","attrVal","exec","getAttribute","undefined","ExifRestorer","div","canvasToBlob","canvas","mime","quality","dataUriToBlob","toDataURL","dataUri","arrayBuffer","byteString","intArray","mimeString","data","BlobBuilder","blobBuilder","split","indexOf","atob","decodeURI","ArrayBuffer","length","Uint8Array","character","charCodeAt","window","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","append","getBlob","Blob","log","message","level","console","isObject","variable","isFunction","buffer","constructor","isItemList","maybeItemList","isNodeList","maybeNodeList","item","namedItem","isString","maybeString","trimStr","string","String","trim","format","str","args","slice","arguments","newStr","nextIdxToReplace","strBefore","substring","strAfter","isFile","maybeFile","File","isFileList","maybeFileList","FileList","isFileOrInput","maybeFileOrInput","isInput","maybeInput","notFile","evaluateType","normalizedType","toLowerCase","HTMLInputElement","tagName","isBlob","maybeBlob","isXhrUploadSupported","input","document","createElement","multiple","FormData","createXhrInstance","upload","XMLHttpRequest","ActiveXObject","error","isFolderDropSupported","dataTransfer","items","webkitGetAsEntry","isFileChunkingSupported","androidStock","webkitSlice","mozSlice","sliceBlob","fileOrBlob","start","end","arrayBufferToHex","bytesAsHex","bytes","byt","byteAsHexStr","readBlobToHex","blob","startOffset","initialBlob","fileReader","FileReader","promise","Promise","onload","success","onerror","failure","readAsArrayBuffer","second","extendNested","prop","override","sourceFn","super_","srcPropName","srcPropVal","arr","elt","from","len","getUniqueId","random","ie","navigator","userAgent","ie7","ie8","ie10","ie11","edge","safari","vendor","chrome","opera","firefox","windows","platform","android","ios6","ios","ios7","ios8","ios800","iosChrome","iosSafari","iosSafariWebView","preventDefault","e","returnValue","toElement","html","innerHTML","iterableItem","callback","keyOrIndex","Storage","getItem","charAt","oldFunc","context","newArgs","apply","obj2url","obj","temp","prefixDone","uristrings","prefix","add","nextObj","nextTemp","encodeURIComponent","join","obj2FormData","formData","arrayKeyName","obj2Inputs","form","setAttribute","appendChild","parseJson","json","JSON","parse","eval","getExtension","filename","extIdx","lastIndexOf","substr","getFilename","blobOrFileInput","fileName","DisposeSupport","disposers","dispose","disposer","shift","addDisposer","disposeFunction","define","version","supportedFeatures","supportsUploading","supportsUploadingBlobs","supportsFileDrop","supportsAjaxFileUploading","supportsFolderDrop","supportsChunking","supportsResume","supportsUploadViaPaste","supportsUploadCors","supportsDeleteFileXdr","supportsDeleteFileCorsXhr","supportsDeleteFileCors","supportsFolderSelection","supportsImagePreviews","supportsUploadProgress","span","isCrossOriginXhrSupported","withCredentials","isXdrSupported","XDomainRequest","tempInput","supported","disabled","ex","testSupportsFileInputElement","localStorage","setItem","isLocalStorageSupported","match","postMessage","webkitdirectory","ajaxUploading","blobUploading","canDetermineSize","chunking","deleteFileCors","deleteFileCorsXdr","deleteFileCorsXhr","dialogElement","HTMLDialogElement","fileDrop","folderDrop","folderSelection","imagePreviews","imageValidation","itemSizeValidation","pause","progressBar","resume","scaling","tiffPreviews","unlimitedScaledImageSize","uploading","uploadCors","uploadCustomHeaders","uploadNonMultipart","uploadViaPaste","isGenericPromise","maybePromise","then","successArgs","failureArgs","successCallbacks","failureCallbacks","doneCallbacks","state","onSuccess","onFailure","done","BlobProxy","referenceBlob","onCreate","UploadButton","buttonId","self","disposeSupport","acceptFiles","focusClass","folders","hoverClass","ios8BrowserCrashWorkaround","onChange","title","createInput","BUTTON_ID_ATTR_NAME","setMultiple","position","right","top","fontFamily","fontSize","margin","padding","cursor","height","overflow","direction","getInput","getButtonId","isMultiple","optInput","removeAttribute","setAcceptFiles","reset","UploadData","uploaderProxy","byUuid","byStatus","byProxyGroupId","byBatchId","getDataByIds","idOrIds","entries","id","addFile","spec","status","SUBMITTING","originalName","uuid","size","file","batchId","proxyGroupId","onBeforeStatusChange","onStatusChange","retrieve","optionalFilter","uuids","getDataByUuids","statusResults","statuses","index","statusEnum","statusResultIndexes","dataIndex","removeFileRef","record","setStatus","newStatus","oldStatus","byStatusOldStatusIndex","splice","uuidChanged","newUuid","oldUuid","updateName","newName","updateSize","newSize","setParentId","targetId","parentId","getIdsInProxyGroup","getIdsInBatch","SUBMITTED","REJECTED","QUEUED","CANCELED","PAUSED","UPLOADING","UPLOAD_FINALIZING","UPLOAD_RETRYING","UPLOAD_SUCCESSFUL","UPLOAD_FAILED","DELETE_FAILED","DELETING","DELETED","basePublicApi","addBlobs","blobDataOrArray","params","endpoint","addFiles","addInitialFiles","cannedFileList","cannedFile","_addCannedFile","_maybeHandleIos8SafariWorkaround","_storedIds","_currentBatchId","processBlob","_handleNewFile","_options","blobs","defaultName","verifiedFiles","processBlobData","blobData","processCanvas","processCanvasData","canvasData","normalizedQuality","processFileOrInput","fileOrInput","files","fileContainer","_prepareItemsForUpload","cancel","uploadData","_uploadData","getName","_handler","cancelAll","storedIdsCopy","storedFileId","clearStoredFiles","continueUpload","enabled","_uploadFile","deleteFile","_onSubmitDelete","doesExist","fileOrBlobId","isValid","drawThumbnail","fileId","imgOrCanvas","maxSize","fromServer","customResizeFunction","fileOrUrl","promiseToReturn","_imageGenerator","_thumbnailUrls","scale","getFile","container","generate","modifiedContainer","reason","getButton","_getButton","_buttonIdsForFileIds","getEndpoint","_endpointStore","uploadDataRecord","getInProgress","getParentId","uploadDataEntry","getUploads","getResumableFilesData","getSize","getNetUploads","_netUploaded","getRemainingAllowedItems","allowedItems","_currentItemLimit","_netUploadedOrQueued","getUuid","isResumable","hasResumeRecord","debug","pauseUpload","expunge","_autoRetries","_retryTimeouts","_preventRetries","_buttons","button","_paramsStore","_pasteHandler","session","refreshOnReset","_refreshSessionData","_succeededSinceLastAllComplete","_failedSinceLastAllComplete","_totalProgress","_customResumeDataStore","retry","_manualRetry","scaleImage","specs","Scaler","setCustomHeaders","headers","_customHeadersStore","set","setCustomResumeData","setDeleteFileCustomHeaders","_deleteFileCustomHeadersStore","setDeleteFileEndpoint","_deleteFileEndpointStore","setDeleteFileParams","_deleteFileParamsStore","setEndpoint","setForm","elementOrId","_updateFormSupportAndParams","setItemLimit","newItemLimit","setName","setParams","setUuid","_onDeleteComplete","errorMessage","uploadStoredFiles","_itemError","_uploadStoredFiles","basePrivateApi","sessionData","deleteFileEndpoint","deleteFileParams","thumbnailUrl","_annotateWithButtonId","associatedInput","qqButtonId","_getButtonId","_batchError","callbacks","onError","_createDeleteHandler","DeleteFileAjaxRequester","method","toUpperCase","maxConnections","uuidParamName","request","uuidName","customHeaders","paramsStore","endpointStore","cors","onDelete","_onDelete","onDeleteComplete","xhrOrXdr","isError","_createPasteHandler","PasteSupport","targetElement","paste","pasteReceived","_handleCheckedCallback","onPasteReceived","_handlePasteSuccess","identifier","_createStore","initialValue","_readOnlyValues_","store","catchall","perIdReadOnlyValues","readOnlyValues","copy","orig","includeReadOnlyValues","existing","values","addReadOnly","_createUploadDataTracker","_onUploadStatusChange","_maybeAllComplete","setTimeout","_createUploadButton","accept","validation","allowedExtensions","classes","buttonFocus","buttonHover","workarounds","ios8BrowserCrash","iosEmptyVideos","_isAllowedExtension","inputName","_onInputChange","fileInputTitle","_disposeSupport","_createUploadHandler","additionalOptions","namespace","lastOnProgress","preventRetryParam","preventRetryResponseProperty","onProgress","loaded","total","_onProgress","onComplete","xhr","retVal","_onComplete","onCancel","cancelFinalizationEffort","_onCancel","onUploadPrep","_onUploadPrep","onUpload","_onUpload","onUploadResult","onUploadChunk","chunkData","_onUploadChunk","onUploadChunkResult","partIndex","onUploadChunkSuccess","_onUploadChunkSuccess","onResume","customResumeData","onAutoRetry","responseJSON","_onAutoRetry","onUuidChanged","setSize","_setSize","getDataByUuid","isQueued","isInProgress","getCustomResumeData","_getCustomResumeData","UploadHandlerController","_fileOrBlobRejected","_formatSize","sizeSymbols","max","toFixed","_generateExtraButtonSpecs","_extraButtonSpecs","extraButtons","extraButtonOptionEntry","extraButtonSpec","_initExtraButton","extraButtonsSpec","_defaultButtonId","buttonOrFileInputOrFile","inputs","fileInput","fileBlobOrInput","_getNotFinished","_getValidationBase","_getValidationDescriptor","fileWrapper","_getValidationDescriptors","fileWrappers","fileDescriptors","_handleCameraAccess","camera","optionRoot","details","callbackRetVal","successParam","newFileWrapperList","actualFile","handler","_customNewFileHandler","_handleNewFileGeneric","addFileToHandler","_trackButton","fileList","extSuppliedName","extension","_handleDeleteSuccess","_handleDeleteFailed","_initFormSupportAndParams","_formSupport","FormSupport","attachedToForm","getFormInputsAsObject","autoUpload","newAutoUpload","newEndpoint","_isDeletePossible","expected","allowXdr","allowed","valid","allowedExt","extRegex","code","maybeNameOrNames","extensionsForMessage","placeholderMatch","messages","names","validationBase","replacement","allowedExtension","formatFileName","sizeLimit","minSizeLimit","placeholder","_onBeforeManualRetry","notFinished","_onAllComplete","ios8SafariUploads","alert","unsupportedBrowserIos8Safari","_maybeParseAndSendUploadError","response","errorReason","defaultResponseError","_maybeProcessNextItemAfterOnValidateCallback","validItem","stopOnFirstInvalidFile","validationDescriptor","onValidate","_onValidateCallbackSuccess","_onValidateCallbackFailure","successful","failed","onAllComplete","_shouldAutoRetry","retryWaitPeriod","autoAttemptDelay","_onBeforeAutoRetry","itemLimit","onManualRetry","clearTimeout","storedItemIndex","fileIndex","onIndividualProgress","_onSubmit","_onSubmitCallbackSuccess","_onSubmitted","onSubmitted","_storeForLater","onSuccessCallback","additionalMandatedParams","adjustedOnSuccessCallback","onSubmitDelete","_deleteHandler","sendDelete","_onTotalProgress","onTotalProgress","enableAuto","_onValidateBatchCallbackFailure","_onValidateBatchCallbackSuccess","validationDescriptors","proposedNetFilesUploadedOrQueued","tooManyItemsError","nextIndex","_validateFileOrBlobData","_upload","onValidateBatch","_preventLeaveInProgress","event","onLeave","Session","_session","addFileRecord","refresh","_sessionRequestComplete","onSessionRequestComplete","onNewSize","maxAutoAttempts","formElementOrId","onSubmit","idToUpload","stillSubmitting","validityChecker","allowEmpty","ImageValidation","validate","image","errorCode","_wrapCallbacks","safeCallback","errorMsg","exception","callbackName","callbackFunc","FineUploaderBasic","disableCancelForFormUploads","warnBeforeUnload","filenameParam","forceMultipart","omitDefaultParams","paramsInBody","requireSuccessJson","totalFileSizeName","maxHeight","maxWidth","minHeight","minWidth","maybeXhr","maybeXhrOrXdr","attemptNumber","fileOrBlobData","typeError","sizeError","minSizeError","emptyError","noFilesError","maxHeightImageError","maxWidthImageError","minHeightImageError","minWidthImageError","retryFailTooManyItems","concurrent","mandatory","paramNames","partByteOffset","chunkSize","totalFileSize","totalParts","partSize","jsonPayload","resetOnStatus","recordsExpireIn","resuming","customKeys","fileOrBlobName","sendCredentials","interceptSubmit","customResizer","sendOriginal","orient","defaultType","defaultQuality","failureText","includeExif","sizes","ImageGenerator","_scaler","handleNewFile","TotalProgress","entry","AjaxRequester","shouldParamsBeInQueryString","queue","requestData","acceptHeader","validMethods","contentType","mandatedParams","allowXRequestedWithAndCacheControl","successfulResponseCodes","DELETE","PATCH","POST","PUT","GET","onSend","isXdr","getXhrOrXdr","suppliedXhr","ontimeout","onprogress","getCorsAjaxTransport","dequeue","sendRequest","xdrError","responseCode","optXhr","url","onDemandParams","additionalParams","getParams","payload","additionalQueryParams","addToPath","createUrl","getXdrLoadHandler","getXdrErrorHandler","onreadystatechange","readyState","getXhrReadyStateChangeHandler","lengthComputable","registerForUploadProgress","open","onDemandHeaders","additionalHeaders","allHeaders","setRequestHeader","containsNonSimple","header","setHeaders","send","stringify","initTransport","path","cacheBuster","withPath","appendToPath","withParams","withQueryParams","_additionalQueryParams_","withHeaders","withPayload","thePayload","withCacheBuster","qqtimestamp","Date","getTime","prepareToSend","canceled","UploadHandler","proxy","fileState","fileItem","getThirdPartyFileId","_getFileState","_setThirdPartyFileId","thirdPartyFileId","_wasCanceled","preventRetryResponse","controller","chunkingPossible","concurrentChunkingPossible","chunked","chunkIdx","_getChunkData","attemptingResume","chunkProgress","_getChunkDataForCallback","finalize","finalizeChunks","normaizedResponse","normalizeResponse","_maybeDeletePersistedChunkData","cleanup","normalizedResponse","handleFailure","clearCachedChunk","inProgressIdx","responseToReport","inProgressChunksArray","inProgress","remaining","unshift","ignoreFailure","_getXhrs","ckid","ckXhr","abort","_cancelled","moveInProgressToRemaining","connectionManager","free","hasMoreParts","nextPart","nextIdx","_getTotalChunks","reevaluateChunking","sendNext","inProgressChunks","available","requestOverrides","uploadChunkData","overrides","uploadChunk","inProgressChunkIdx","_maybePersistChunkedState","clearXhr","_open","_openChunks","_waiting","openChunkEntriesCount","openChunksCount","openChunkIndexes","dontAllowNext","nextId","allowNext","waitingIndex","connectionsIndex","getProxyOrBlob","getWaitingOrConnected","waitingOrConnected","chunks","parseInt","isUsingConnection","pop","openChunksEntry","simple","uploadFile","maybeNewUuid","_clearXhrs","getProxy","initHandler","handlerType","traditional","handlerModuleSubtype","onFinalizing","_removeExpiredChunkingRecords","isDeferredEligibleForUpload","maybeDefer","generatedBlob","updateBlob","maybeSendDeferredFiles","errorResponse","idsInGroup","uploadedThisId","idInGroup","now","originalResponse","_shouldChunkThisFile","blobToUpload","cancelRetVal","isProxied","_getLocalStorageId","isAttemptingResume","WindowReceiveMessage","callbackWrapperDetachers","receiveMessage","stopReceivingMessages","detacher","FormUploadHandler","formHandlerInstanceId","onloadCallbacks","detachLoadEvents","postMessageCallbackTimers","isCors","corsMessageReceiver","getFileIdForIframeName","iframeName","iframe","getElementById","_getIframeName","expungeFile","_attachLoadEvent","responseDescriptor","onloadCallback","_parseJsonResponse","_detachLoadEvent","registerPostMessageCallback","contentDocument","body","_createIframe","initIframeForUpload","_initFormForUpload","targetName","innerHtmlOrMessage","XhrUploadHandler","getChunkSize","chunkFiles","resumeEnabled","xhrId","ajaxRequester","_getAjaxRequester","blobOrProxy","_initTempState","_maybePrepareForResume","cachedChunks","tempState","xhrs","ajaxRequesters","responseParser","lastChunkIdx","_getXhr","resumableFilesData","_iterateResumeRecords","notResumable","optInProgress","optRemaining","chunkingState","reverse","paused","totalChunks","parts","newBlob","chunkId","_createXhr","optChunkIdx","_registerXhr","chunkIndex","fileSize","startBytes","endBytes","part","count","startByte","endByte","localStorageId","_getMimeType","_getPersistableData","ceil","_markNotResumable","removeItem","persistedData","lastUpdated","_registerProgressHandler","progressCalculator","totalSuccessfullyLoadedForFile","loadedForRequest","totalForRequest","estActualChunkLoaded","totalLoadedForFile","chunkLoaded","optAjaxRequester","xhrsId","expirationDays","expirationDate","setDate","getDate","requester","_method","renderImageToCanvas","img","doSquash","modifiedDimensions","iw","naturalWidth","ih","naturalHeight","width","ctx","getContext","save","resize","resizeInfo","imageHeight","imageWidth","orientation","sourceCanvas","sourceCanvasContext","targetCanvas","targetHeight","targetWidth","transformCoordinate","drawImage","qqImageRendered","renderImageToCanvasWithCustomResizer","origHeight","origWidth","newHeight","sqrt","newWidth","maybeCalculateDownsampledDimensions","getImageData","detectSubsampling","tmpCtx","sx","dx","tmpCanvas","vertSquashRatio","ratio","sy","ey","py","detectVerticalSquash","dw","dh","dy","clearRect","restore","translate","rotate","PI","MegaPixImage","srcImage","errorCallback","Image","URL","createObjectURL","webkitURL","src","listeners","imageLoadListeners","render","opt","oldTargetSrc","imgWidth","imgHeight","optionsKey","optionsValue","renderImageToDataURL","onrender","isImg","el","isCanvas","determineMimeOfFileName","nameWithPath","pathSegments","isCrossOrigin","targetProtocol","targetHostname","targetPort","targetAnchor","href","protocol","port","hostname","location","registerThumbnailRenderedListener","registered","registerImgLoadListeners","registerCanvasDrawImageListener","drawOnCanvasOrImgFromUrl","canvasOrImg","draw","tempImg","tempImgRender","crossOrigin","drawOnImgFromUrlWithCssScaling","drawFromUrl","fileBlobOrUrl","drawPreview","Identify","megapixErrorHandler","isPreviewable","dummyExif","exif","Exif","mpImg","Orientation","failureMsg","_testing","TAG_IDS","TAG_INFO","274","parseLittleEndian","hex","pow","getApp1Offset","seekToApp1","offset","theOffset","thePromise","segmentLength","parser","onParseFailure","app1Offset","app1Start","littleEndian","getDirEntryCount","dirEntryCount","dirEntries","getIfd","ifdHex","getDirEntries","tagValues","tagsToFind","vals","tagValHex","tagValLength","idHex","tagsToFindIdx","getTagValues","previewable","isPreviewableSync","PREVIEWABLE_MIME_TYPES","questionableBytes","identifiable","magicBytesEntries","magicBytesArrayEntry","fileMime","isRecognizedImage","limits","sizeDetermination","validationEffort","atLeastOne","limit","hasNonZeroLimits","dimensions","failingLimit","limitName","limitValue","limitMatcher","dimensionPropName","actualValue","getFailingLimit","handleFileItems","fileItems","someItemsIgnored","isJsonResponseValid","err","refreshEffort","requesterOptions","SessionAjaxRequester","queryServer","responseText","includeOriginal","failedToScaleText","_getSortedSizes","getFileRecords","originalFileUuid","originalFileName","originalBlobOrBlobData","records","originalBlob","sizeRecord","outputType","_determineOutputType","requestedType","refType","_getName","_generateScaledImage","failedText","api","param","scaledIds","originalId","blobSize","scaledId","qqparentuuid","qqparentsize","scalingEffort","scalingOptions","scaler","referenceType","scaledVersionProperties","startOfExt","versionType","scaledName","scaledExt","nameAppendage","sort","a","b","sourceFile","imageGenerator","scaledImageDataUri","signalSuccess","_insertExifHeader","scaledImageDataUriWithExif","originalImage","reader","insertionEffort","originalImageDataUri","readAsDataURL","_dataUriToBlob","_createBlob","chr1","chr2","enc1","enc2","enc3","output","chr3","enc4","isNaN","KEY_STR","origFileBase64","resizedFileBase64","rawImage","decode64","segments","slice2Segments","exifManipulation","encode64","exifArray","getExifArray","newImageArray","insertExif","seg","x","imageData","buf","separatePoint","mae","ato","rawImageArray","head","endPoint","perFileProgress","totalLoaded","totalSize","lastLoadedSent","lastTotalSent","callbackProxy","onNew","updateTotalProgress","newLoaded","newTotal","oldLoaded","oldTotal","retryable","none","failedId","noRetryableFiles","detachPasteHandler","clipboardData","isImage","getAsFile","startUpload","formEl","validateForm","nativeSubmit","checkValidity","_form2Obj","determineNewEndpoint","submit","maybeUploadOnSubmit","determineFormEl","ignoreValue","checked","elements","select","selected","selectValue","createForm","responseFromMessage","doc","innerHtml","contentWindow","nodeValue","getIframeContentJson","multipart","allChunksDoneRequester","AllChunksDoneAjaxRequester","createReadyStateChangedHandler","onUploadOrChunkComplete","isErrorUploadResponse","parseResponse","sendChunksCompleteRequest","complete","getChunksCompleteParams","setParamsAndGetEntityToSend","entityToSendParams","xhrOverrides","customParams","defaultParams","xhrOverrideParams","setUploadHeaders","headersOptions","headerOverrides","headerName","headerValue","extraHeaders","uploadChunkParams","toSend","addChunkingSpecificParams","promises","endpointHandler","wildcard","reMimePartSplit","pattern","DragAndDrop","dropZones","maybeHideDropZones","HIDE_ZONES_EVENT_NAME","HIDE_BEFORE_ENTER_ATTR","uploadDropZones","droppedFiles","traverseFileTree","parseEntryPromise","qqPath","extractDirectoryPath","fileError","dropLog","fullPath","isDirectory","getFilesInDirectory","accumEntries","existingPromise","dirReader","createReader","readEntries","newEntries","entriesLeft","indexOfNameInFullPath","setupDropzone","dropArea","dropZone","UploadDropZone","onEnter","dropActive","dragEnter","stopPropagation","onLeaveNotDescendants","dragLeave","onDrop","uploadDropZone","pendingFolderPromises","handleDataTransferPromise","processingDroppedFiles","dropDisabled","allowMultipleItems","processingDroppedFilesComplete","dropError","filesAsArray","getElement","uploadDroppedFiles","isFileDrag","dragEvent","fileDrag","types","dropZoneElements","HTMLElement","y","leavingDocumentOut","setupExtraDropzone","removeDropzone","dzs","targetEl","errorSpecifics","preventDrop","dropOutsideDisabled","dragoverShouldBeCanceled","isValidFileDrag","effectTest","dt","isSafari","effectAllowed","includes","isOrSetDropDisabled","isDisabled","dropEffect","effect","relatedTarget","elementFromPoint","clientX","clientY","hideZonesEvent","triggerUsingOldApi","createEvent","initEvent","CustomEvent","dispatchEvent","triggerHidezonesEvent","WildcardMatcher","separator","hasWild","ii","testParts","matches","partsCount","matcher","webpackContext","req","webpackContextResolve","resolve","EventEmitter","paperAdmin","ValidationError","captureStackTrace","stack","Uploader","_opts","assign","dropzones","extraData","uploader","_makeUploader","getPaperParams","dataset","_this","is_loading","trigger","validationOptions","allowedMimeTypes","some","template","reject","minImageWidth","minImageHeight","maxImageWidth","maxImageHeight","uploadedBytes","totalBytes","percentage","succeeded","errors","bootbox","_errors","formatErrors","showError","preloader","formUtils","BaseWidget","uploadButton","cancelButton","changeButton","deleteButton","link","urls","change","delete","loading","empty","instanceId","initUploader","addListeners","Boolean","_empty","newValue","classList","_loading","on","instance_id","fileInfo","file_info","previewLink","_change","$dialog","$form","find","show","fetch","credentials","ok","statusText","cleanFormErrors","form_errors","addFormErrorsFromJSON","modal","catch","_delete","dialog","gettext","onEscape","buttons","label","confirm","queryString","URLSearchParams","whenDomReady","emitters","initWidget","closest","uploadUrl","changeUrl","deleteUrl","initWidgets","root","dom","Sortable","Collection","itemContainer","createButton","preloaderItem","preloaderTemplate","itemPreview","itemLink","itemCheckbox","itemName","changeItemButton","cancelItemButton","deleteItemButton","itemSelectorTemplate","collectionEmptyState","itemCheckedState","itemRemovingState","createCollection","deleteCollection","uploadItem","changeItem","deleteItem","sortItems","init","createCollectionUrl","deleteCollectionUrl","uploadItemUrl","changeItemUrl","deleteItemUrl","sortItemsUrl","uploadInput","sortable","initSortable","collectionId","importNode","content","queueId","itemType","item_type","templateSelector","preview","before","animation","draggable","handle","ghostClass","onEnd","order","pk","cleanItems","_createCollection","collection_id","_deleteItem","_changeItem","_deleteCollection","lastItem","_checkItem","toggle","lastChecked","target_state","checkbox","ctrlKey","shiftKey","lastIndex","targetIndex","startIndex","min","endIndex","checkedItems","MouseEvent","bubbles","cancelable","require"],"mappings":"aACE,IAAIA,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUC,QAGnC,IAAIC,EAASJ,EAAiBE,GAAY,CACzCG,EAAGH,EACHI,GAAG,EACHH,QAAS,IAUV,OANAI,EAAQL,GAAUM,KAAKJ,EAAOD,QAASC,EAAQA,EAAOD,QAASF,GAG/DG,EAAOE,GAAI,EAGJF,EAAOD,QAKfF,EAAoBQ,EAAIF,EAGxBN,EAAoBS,EAAIV,EAGxBC,EAAoBU,EAAI,SAASR,EAASS,EAAMC,GAC3CZ,EAAoBa,EAAEX,EAASS,IAClCG,OAAOC,eAAeb,EAASS,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEZ,EAAoBkB,EAAI,SAAShB,GACX,oBAAXiB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAeb,EAASiB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAeb,EAAS,aAAc,CAAEmB,OAAO,KAQvDrB,EAAoBsB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQrB,EAAoBqB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFA1B,EAAoBkB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOrB,EAAoBU,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRzB,EAAoB6B,EAAI,SAAS1B,GAChC,IAAIS,EAAST,GAAUA,EAAOqB,WAC7B,WAAwB,OAAOrB,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAH,EAAoBU,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRZ,EAAoBa,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG/B,EAAoBkC,EAAI,8BAIjBlC,EAAoBA,EAAoBmC,EAAI,I,+BChFrD,IAAIC,EAAoB,SAA2Bf,GAClD,OAID,SAAyBA,GACxB,QAASA,GAA0B,iBAAVA,EALlBgB,CAAgBhB,KAQxB,SAAmBA,GAClB,IAAIiB,EAAcxB,OAAOkB,UAAUO,SAAShC,KAAKc,GAEjD,MAAuB,oBAAhBiB,GACa,kBAAhBA,GAQL,SAAwBjB,GACvB,OAAOA,EAAMmB,WAAaC,EARtBC,CAAerB,GAZdsB,CAAUtB,IAgBhB,IACIoB,EADiC,mBAAXtB,QAAyBA,OAAOyB,IAClBzB,OAAOyB,IAAI,iBAAmB,MAUtE,SAASC,EAA8BxB,EAAOyB,GAC7C,OAA0B,IAAlBA,EAAQC,OAAmBD,EAAQV,kBAAkBf,GAC1D2B,GANiBC,EAMK5B,EALlB6B,MAAMC,QAAQF,GAAO,GAAK,IAKA5B,EAAOyB,GACrCzB,EAPJ,IAAqB4B,EAUrB,SAASG,EAAkBC,EAAQC,EAAQR,GAC1C,OAAOO,EAAOE,OAAOD,GAAQE,KAAI,SAASC,GACzC,OAAOZ,EAA8BY,EAASX,MAoBhD,SAASY,EAAQL,GAChB,OAAOvC,OAAO6C,KAAKN,GAAQE,OAT5B,SAAyCF,GACxC,OAAOvC,OAAO8C,sBACX9C,OAAO8C,sBAAsBP,GAAQQ,QAAO,SAASC,GACtD,OAAOT,EAAOU,qBAAqBD,MAElC,GAI+BE,CAAgCX,IAGnE,SAASY,EAAmBnC,EAAQC,GACnC,IACC,OAAOA,KAAYD,EAClB,MAAMoC,GACP,OAAO,GAWT,SAASC,EAAYd,EAAQC,EAAQR,GACpC,IAAIsB,EAAc,GAiBlB,OAhBItB,EAAQV,kBAAkBiB,IAC7BK,EAAQL,GAAQgB,SAAQ,SAAS1C,GAChCyC,EAAYzC,GAAOkB,EAA8BQ,EAAO1B,GAAMmB,MAGhEY,EAAQJ,GAAQe,SAAQ,SAAS1C,IAblC,SAA0B0B,EAAQ1B,GACjC,OAAOsC,EAAmBZ,EAAQ1B,MAC5Bb,OAAOmB,eAAe1B,KAAK8C,EAAQ1B,IACpCb,OAAOiD,qBAAqBxD,KAAK8C,EAAQ1B,KAWzC2C,CAAiBjB,EAAQ1B,KAIxBmB,EAAQV,kBAAkBkB,EAAO3B,KAAUsC,EAAmBZ,EAAQ1B,GAG1EyC,EAAYzC,GAlDf,SAA0BA,EAAKmB,GAC9B,IAAKA,EAAQyB,YACZ,OAAOvB,EAER,IAAIuB,EAAczB,EAAQyB,YAAY5C,GACtC,MAA8B,mBAAhB4C,EAA6BA,EAAcvB,EA6CpCwB,CAAiB7C,EAAKmB,EAAtB0B,CAA+BnB,EAAO1B,GAAM2B,EAAO3B,GAAMmB,GAF5EsB,EAAYzC,GAAOkB,EAA8BS,EAAO3B,GAAMmB,OAKzDsB,EAGR,SAASpB,EAAUK,EAAQC,EAAQR,IAClCA,EAAUA,GAAW,IACb2B,WAAa3B,EAAQ2B,YAAcrB,EAC3CN,EAAQV,kBAAoBU,EAAQV,mBAAqBA,EAGzDU,EAAQD,8BAAgCA,EAExC,IAAI6B,EAAgBxB,MAAMC,QAAQG,GAIlC,OAFgCoB,IADZxB,MAAMC,QAAQE,GAKvBqB,EACH5B,EAAQ2B,WAAWpB,EAAQC,EAAQR,GAEnCqB,EAAYd,EAAQC,EAAQR,GAJ5BD,EAA8BS,EAAQR,GAQ/CE,EAAU2B,IAAM,SAAsBC,EAAO9B,GAC5C,IAAKI,MAAMC,QAAQyB,GAClB,MAAM,IAAIC,MAAM,qCAGjB,OAAOD,EAAME,QAAO,SAASC,EAAMC,GAClC,OAAOhC,EAAU+B,EAAMC,EAAMlC,KAC3B,KAGJ,IAAImC,EAAcjC,EAElB7C,EAAOD,QAAU+E,G,6CCpIjB,mCACA,SAAUC,QACN,IAAIC,GAAK,SAALA,EAAc1B,GACd,aACA,MAAO,CACH2B,KAAM,WAEF,OADA3B,EAAQ4B,MAAMC,QAAU,OACjBC,MAEXC,OAAQ,SAASC,EAAMC,GAMnB,OALIjC,EAAQkC,iBACRlC,EAAQkC,iBAAiBF,EAAMC,GAAI,GAC5BjC,EAAQmC,aACfnC,EAAQmC,YAAY,KAAOH,EAAMC,GAE9B,WACHP,EAAG1B,GAASoC,OAAOJ,EAAMC,KAGjCG,OAAQ,SAASJ,EAAMC,GAMnB,OALIjC,EAAQqC,oBACRrC,EAAQqC,oBAAoBL,EAAMC,GAAI,GAC/BjC,EAAQmC,aACfnC,EAAQsC,YAAY,KAAON,EAAMC,GAE9BH,MAEXS,SAAU,SAASC,GACf,QAAKA,IAGDxC,IAAYwC,IAGZxC,EAAQuC,SACDvC,EAAQuC,SAASC,MAEgC,EAA9CA,EAAWC,wBAAwBzC,OAGrD0C,aAAc,SAASC,GAEnB,OADAA,EAASC,WAAWF,aAAa1C,EAAS2C,GACnCb,MAEXe,OAAQ,WAEJ,OADA7C,EAAQ4C,WAAWE,YAAY9C,GACxB8B,MAEXiB,IAAK,SAASC,GACV,GAAqB,MAAjBhD,EAAQ4B,MACR,MAAM,IAAIF,EAAGN,MAAM,8EAQvB,OANsB,MAAlB4B,EAAOC,SAC8B,iBAA1BjD,EAAQ4B,MAAMqB,cAAmD,IAApBjD,EAAQkD,UAC5DF,EAAO5C,OAAS,iBAAmB+C,KAAKC,MAAM,IAAMJ,EAAOC,SAAW,KAG9EvB,EAAG2B,OAAOrD,EAAQ4B,MAAOoB,GAClBlB,MAEXwB,SAAU,SAASpG,EAAMqG,GACrB,IAAIC,EAAK,IAAIC,OAAO,QAAUvG,EAAO,SACrC,OAAOsG,EAAGE,KAAK1D,EAAQ2D,eAAiBJ,IAAkBC,EAAGE,KAAK1D,EAAQ4C,WAAWe,aAEzFC,SAAU,SAAS1G,GAIf,OAHKwE,EAAG1B,GAASsD,SAASpG,KACtB8C,EAAQ2D,WAAa,IAAMzG,GAExB4E,MAEX+B,YAAa,SAAS3G,GAClB,IAAIsG,EAAK,IAAIC,OAAO,QAAUvG,EAAO,SAErC,OADA8C,EAAQ2D,UAAY3D,EAAQ2D,UAAUG,QAAQN,EAAI,KAAKM,QAAQ,aAAc,IACtEhC,MAEXiC,WAAY,SAASJ,EAAWK,GAC5B,IAAIC,EAAYC,EAAS,GACzB,OAAIF,GAAShE,EAAQmE,cACVnE,EAAQmE,cAAc,IAAMR,GAC5B3D,EAAQoE,iBACRpE,EAAQoE,iBAAiB,IAAMT,IAE1CM,EAAajE,EAAQqE,qBAAqB,KAC1C3C,EAAG4C,KAAKL,GAAY,SAASM,EAAK/E,GAC1BkC,EAAGlC,GAAK8D,SAASK,IACjBO,EAAOM,KAAKhF,MAGbwE,EAAQE,EAAO,GAAKA,IAE/BO,gBAAiB,SAASd,GACtB,OAAOjC,EAAG1B,GAAS+D,WAAWJ,GAAW,IAE7Ce,SAAU,WAEN,IADA,IAAIA,EAAW,GAAIC,EAAQ3E,EAAQ4E,WAC5BD,GACoB,IAAnBA,EAAME,UACNH,EAASF,KAAKG,GAElBA,EAAQA,EAAMG,YAElB,OAAOJ,GAEXK,QAAS,SAASC,GAGd,OAFAhF,EAAQiF,UAAYD,EACpBhF,EAAQkF,YAAcF,EACflD,MAEXqD,UAAW,WACP,OAAOzD,EAAG1B,GAAS+E,QAAQ,KAE/BK,aAAc,SAASC,GACnB,IAAIC,EACJ,OAAItF,EAAQoF,eACHpF,EAAQoF,aAAaC,IAGgC,MAAnD,WAAWE,KAAKvF,EAAQwF,aAAaH,SAG5BI,KADhBH,EAAUtF,EAAQqF,KAIiB,MAA5B,WAAWE,KAAKD,MA45J/BI,cAv5JR,WACI,aAqRe,IACPC,IArRRjE,GAAGkE,aAAe,SAASC,EAAQC,EAAMC,GACrC,OAAOrE,GAAGsE,cAAcH,EAAOI,UAAUH,EAAMC,KAEnDrE,GAAGsE,cAAgB,SAASE,GACxB,IAAIC,EAAaC,EAUdC,EAAUC,EAVsCC,EAAMT,EACjDU,EAA+GC,EAqBvH,OAVIL,EADAF,EAAQQ,MAAM,KAAK,GAAGC,QAAQ,WAAa,EAC9BC,KAAKV,EAAQQ,MAAM,KAAK,IAExBG,UAAUX,EAAQQ,MAAM,KAAK,IAE9CJ,EAAaJ,EAAQQ,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGA,MAAM,KAAK,GAC5DP,EAAc,IAAIW,YAAYV,EAAWW,QACzCV,EAAW,IAAIW,WAAWb,GAC1BzE,GAAG4C,KAAK8B,GAAY,SAAS7B,EAAK0C,GAC9BZ,EAAS9B,GAAO0C,EAAUC,WAAW,MApBUX,EAsBjCJ,EAtBuCL,EAsB1BQ,EArBvBE,EAAcW,OAAOX,aAAeW,OAAOC,mBAAqBD,OAAOE,gBAAkBF,OAAOG,eAAeb,EAAcD,GAAe,IAAIA,IAEhJC,EAAYc,OAAOhB,GACZE,EAAYe,QAAQ1B,IAEpB,IAAI2B,KAAK,CAAElB,GAAQ,CACtBvE,KAAM8D,KAiBtBpE,GAAGgG,IAAM,SAASC,EAASC,GACnBT,OAAOU,UACFD,GAAmB,SAAVA,EAGNT,OAAOU,QAAQD,GACfT,OAAOU,QAAQD,GAAOD,GAEtBR,OAAOU,QAAQH,IAAI,IAAME,EAAQ,KAAOD,GAL5CR,OAAOU,QAAQH,IAAIC,KAU/BjG,GAAGoG,SAAW,SAASC,GACnB,OAAOA,IAAaA,EAASlD,UAAyD,oBAA7CxH,OAAOkB,UAAUO,SAAShC,KAAKiL,IAE5ErG,GAAGsG,WAAa,SAASD,GACrB,MAA2B,mBAAbA,GAElBrG,GAAGhC,QAAU,SAAS9B,GAClB,MAAiD,mBAA1CP,OAAOkB,UAAUO,SAAShC,KAAKc,IAA+BA,GAASuJ,OAAOL,aAAelJ,EAAMqK,QAAUrK,EAAMqK,OAAOC,cAAgBpB,aAErJpF,GAAGyG,WAAa,SAASC,GACrB,MAAyD,kCAAlD/K,OAAOkB,UAAUO,SAAShC,KAAKsL,IAE1C1G,GAAG2G,WAAa,SAASC,GACrB,MAAyD,sBAAlDjL,OAAOkB,UAAUO,SAAShC,KAAKwL,IAA0CA,EAAcC,MAAQD,EAAcE,WAExH9G,GAAG+G,SAAW,SAASC,GACnB,MAAuD,oBAAhDrL,OAAOkB,UAAUO,SAAShC,KAAK4L,IAE1ChH,GAAGiH,QAAU,SAASC,GAClB,OAAIC,OAAOtK,UAAUuK,KACVF,EAAOE,OAEXF,EAAO9E,QAAQ,aAAc,KAExCpC,GAAGqH,OAAS,SAASC,GACjB,IAAIC,EAAOxJ,MAAMlB,UAAU2K,MAAMpM,KAAKqM,UAAW,GAAIC,EAASJ,EAAKK,EAAmBD,EAAOzC,QAAQ,MASrG,OARAjF,GAAG4C,KAAK2E,GAAM,SAAS1E,EAAK/E,GACxB,IAAI8J,EAAYF,EAAOG,UAAU,EAAGF,GAAmBG,EAAWJ,EAAOG,UAAUF,EAAmB,GAGtG,IADAA,GADAD,EAASE,EAAY9J,EAAMgK,GACD7C,QAAQ,KAAM0C,EAAmB7J,EAAIuH,SACxC,EACnB,OAAO,KAGRqC,GAEX1H,GAAG+H,OAAS,SAASC,GACjB,OAAOvC,OAAOwC,MAAsD,kBAA9CtM,OAAOkB,UAAUO,SAAShC,KAAK4M,IAEzDhI,GAAGkI,WAAa,SAASC,GACrB,OAAO1C,OAAO2C,UAA8D,sBAAlDzM,OAAOkB,UAAUO,SAAShC,KAAK+M,IAE7DnI,GAAGqI,cAAgB,SAASC,GACxB,OAAOtI,GAAG+H,OAAOO,IAAqBtI,GAAGuI,QAAQD,IAErDtI,GAAGuI,QAAU,SAASC,EAAYC,GAC9B,IAAIC,EAAe,SAASpI,GACxB,IAAIqI,EAAiBrI,EAAKsI,cAC1B,OAAIH,EAC0B,SAAnBE,EAEe,SAAnBA,GAEX,SAAIlD,OAAOoD,kBAC4C,8BAA/ClN,OAAOkB,UAAUO,SAAShC,KAAKoN,IAC3BA,EAAWlI,MAAQoI,EAAaF,EAAWlI,WAKnDkI,EAAWM,SAC8B,UAArCN,EAAWM,QAAQF,eACfJ,EAAWlI,MAAQoI,EAAaF,EAAWlI,QAO3DN,GAAG+I,OAAS,SAASC,GACjB,GAAIvD,OAAOM,MAAsD,kBAA9CpK,OAAOkB,UAAUO,SAAShC,KAAK4N,GAC9C,OAAO,GAGfhJ,GAAGiJ,qBAAuB,WACtB,IAAIC,EAAQC,SAASC,cAAc,SAEnC,OADAF,EAAM5I,KAAO,YACayD,IAAnBmF,EAAMG,UAA0C,oBAATpB,MAA4C,oBAAbqB,eAAqE,IAAlCtJ,GAAGuJ,oBAAoBC,QAE3IxJ,GAAGuJ,kBAAoB,WACnB,GAAI9D,OAAOgE,eACP,OAAO,IAAIA,eAEf,IACI,OAAO,IAAIC,cAAc,sBAC3B,MAAOC,GAEL,OADA3J,GAAGgG,IAAI,wCAAyC,SACzC,OAGfhG,GAAG4J,sBAAwB,SAASC,GAChC,OAAOA,EAAaC,OAASD,EAAaC,MAAMzE,OAAS,GAAKwE,EAAaC,MAAM,GAAGC,kBAExF/J,GAAGgK,wBAA0B,WACzB,OAAQhK,GAAGiK,gBAAkBjK,GAAGiJ,8BAAoDlF,IAAzBkE,KAAKpL,UAAU2K,YAAsDzD,IAA/BkE,KAAKpL,UAAUqN,kBAAyDnG,IAA5BkE,KAAKpL,UAAUsN,WAEhKnK,GAAGoK,UAAY,SAASC,EAAYC,EAAOC,GAEvC,OADaF,EAAW7C,OAAS6C,EAAWF,UAAYE,EAAWH,aACrD9O,KAAKiP,EAAYC,EAAOC,IAE1CvK,GAAGwK,iBAAmB,SAASjE,GAC3B,IAAIkE,EAAa,GAAIC,EAAQ,IAAIpF,WAAWiB,GAQ5C,OAPAvG,GAAG4C,KAAK8H,GAAO,SAAS7H,EAAK8H,GACzB,IAAIC,EAAeD,EAAIvN,SAAS,IAC5BwN,EAAavF,OAAS,IACtBuF,EAAe,IAAMA,GAEzBH,GAAcG,KAEXH,GAEXzK,GAAG6K,cAAgB,SAASC,EAAMC,EAAa1F,GAC3C,IAAI2F,EAAchL,GAAGoK,UAAUU,EAAMC,EAAaA,EAAc1F,GAAS4F,EAAa,IAAIC,WAAcC,EAAU,IAAInL,GAAGoL,QAMzH,OALAH,EAAWI,OAAS,WAChBF,EAAQG,QAAQtL,GAAGwK,iBAAiBS,EAAWzI,UAEnDyI,EAAWM,QAAUJ,EAAQK,QAC7BP,EAAWQ,kBAAkBT,GACtBG,GAEXnL,GAAG2B,OAAS,SAASW,EAAOoJ,EAAQC,GAWhC,OAVA3L,GAAG4C,KAAK8I,GAAQ,SAASE,EAAM9N,GACvB6N,GAAgB3L,GAAGoG,SAAStI,SACRiG,IAAhBzB,EAAMsJ,KACNtJ,EAAMsJ,GAAQ,IAElB5L,GAAG2B,OAAOW,EAAMsJ,GAAO9N,GAAK,IAE5BwE,EAAMsJ,GAAQ9N,KAGfwE,GAEXtC,GAAG6L,SAAW,SAAS3N,EAAQ4N,GAC3B,IAAIC,EAAS,GAAI5N,EAAS2N,EAASC,GAOnC,OANA/L,GAAG4C,KAAKzE,GAAQ,SAAS6N,EAAaC,QACNlI,IAAxB7F,EAAO8N,KACPD,EAAOC,GAAe9N,EAAO8N,IAEjC9N,EAAO8N,GAAeC,KAEnB/N,GAEX8B,GAAGiF,QAAU,SAASiH,EAAKC,EAAKC,GAC5B,GAAIF,EAAIjH,QACJ,OAAOiH,EAAIjH,QAAQkH,EAAKC,GAE5BA,EAAOA,GAAQ,EACf,IAAIC,EAAMH,EAAI7G,OAId,IAHI+G,EAAO,IACPA,GAAQC,GAEND,EAAOC,EAAKD,GAAQ,EACtB,GAAIF,EAAIpP,eAAesP,IAASF,EAAIE,KAAUD,EAC1C,OAAOC,EAGf,OAAQ,GAEZpM,GAAGsM,YAAc,WACb,MAAO,uCAAuClK,QAAQ,SAAS,SAAS9G,GACpE,IAAIS,EAAoB,GAAhB0F,KAAK8K,SAAgB,EAC7B,OADyC,KAALjR,EAAWS,EAAQ,EAAJA,EAAQ,GAClDqB,SAAS,QAG1B4C,GAAGwM,GAAK,WACJ,OAAgD,IAAzCC,UAAUC,UAAUzH,QAAQ,UAA8D,IAA5CwH,UAAUC,UAAUzH,QAAQ,YAErFjF,GAAG2M,IAAM,WACL,OAAkD,IAA3CF,UAAUC,UAAUzH,QAAQ,WAEvCjF,GAAG4M,IAAM,WACL,OAAkD,IAA3CH,UAAUC,UAAUzH,QAAQ,WAEvCjF,GAAG6M,KAAO,WACN,OAAmD,IAA5CJ,UAAUC,UAAUzH,QAAQ,YAEvCjF,GAAG8M,KAAO,WACN,OAAO9M,GAAGwM,OAAkD,IAA1CC,UAAUC,UAAUzH,QAAQ,UAElDjF,GAAG+M,KAAO,WACN,OAAON,UAAUC,UAAUzH,QAAQ,SAAW,GAElDjF,GAAGgN,OAAS,WACR,YAA4BjJ,IAArB0I,UAAUQ,SAA+D,IAAvCR,UAAUQ,OAAOhI,QAAQ,UAEtEjF,GAAGkN,OAAS,WACR,YAA4BnJ,IAArB0I,UAAUQ,SAAgE,IAAxCR,UAAUQ,OAAOhI,QAAQ,WAEtEjF,GAAGmN,MAAQ,WACP,YAA4BpJ,IAArB0I,UAAUQ,SAA+D,IAAvCR,UAAUQ,OAAOhI,QAAQ,UAEtEjF,GAAGoN,QAAU,WACT,OAAQpN,GAAG+M,SAAW/M,GAAG8M,SAAsD,IAA5CL,UAAUC,UAAUzH,QAAQ,iBAA0ClB,IAArB0I,UAAUQ,QAA6C,KAArBR,UAAUQ,QAEpIjN,GAAGqN,QAAU,WACT,MAA8B,UAAvBZ,UAAUa,UAErBtN,GAAGuN,QAAU,WACT,OAAiE,IAA1Dd,UAAUC,UAAU9D,cAAc3D,QAAQ,YAErDjF,GAAGiK,aAAe,WACd,OAAOjK,GAAGuN,WAAad,UAAUC,UAAU9D,cAAc3D,QAAQ,UAAY,GAAKwH,UAAUC,UAAU9D,cAAc3D,QAAQ,WAAa,GAE7IjF,GAAGwN,KAAO,WACN,OAAOxN,GAAGyN,QAAoD,IAA3ChB,UAAUC,UAAUzH,QAAQ,WAEnDjF,GAAG0N,KAAO,WACN,OAAO1N,GAAGyN,QAAoD,IAA3ChB,UAAUC,UAAUzH,QAAQ,WAEnDjF,GAAG2N,KAAO,WACN,OAAO3N,GAAGyN,QAAoD,IAA3ChB,UAAUC,UAAUzH,QAAQ,WAEnDjF,GAAG4N,OAAS,WACR,OAAO5N,GAAGyN,QAAsD,IAA7ChB,UAAUC,UAAUzH,QAAQ,aAEnDjF,GAAGyN,IAAM,WACL,OAAgD,IAAzChB,UAAUC,UAAUzH,QAAQ,UAA2D,IAAzCwH,UAAUC,UAAUzH,QAAQ,UAA6D,IAA3CwH,UAAUC,UAAUzH,QAAQ,WAEnIjF,GAAG6N,UAAY,WACX,OAAO7N,GAAGyN,QAAmD,IAA1ChB,UAAUC,UAAUzH,QAAQ,UAEnDjF,GAAG8N,UAAY,WACX,OAAO9N,GAAGyN,QAAUzN,GAAG6N,cAA0D,IAA3CpB,UAAUC,UAAUzH,QAAQ,WAEtEjF,GAAG+N,iBAAmB,WAClB,OAAO/N,GAAGyN,QAAUzN,GAAG6N,cAAgB7N,GAAG8N,aAE9C9N,GAAGgO,eAAiB,SAASC,GACrBA,EAAED,eACFC,EAAED,iBAEFC,EAAEC,aAAc,GAGxBlO,GAAGmO,WACKlK,IAAMkF,SAASC,cAAc,OAC1B,SAASgF,GACZnK,IAAIoK,UAAYD,EAChB,IAAI9P,EAAU2F,IAAIf,WAElB,OADAe,IAAI7C,YAAY9C,GACTA,IAGf0B,GAAG4C,KAAO,SAAS0L,EAAcC,GAC7B,IAAIC,EACJ,GAAIF,EACA,GAAI7I,OAAOgJ,SAAWH,EAAa9H,cAAgBf,OAAOgJ,QACtD,IAAKD,EAAa,EAAGA,EAAaF,EAAajJ,SAE5B,IADNkJ,EAASD,EAAa9R,IAAIgS,GAAaF,EAAaI,QAAQJ,EAAa9R,IAAIgS,KADnCA,UAMpD,GAAIxO,GAAGhC,QAAQsQ,IAAiBtO,GAAGyG,WAAW6H,IAAiBtO,GAAG2G,WAAW2H,GAChF,IAAKE,EAAa,EAAGA,EAAaF,EAAajJ,SAE5B,IADNkJ,EAASC,EAAYF,EAAaE,IADQA,UAMpD,GAAIxO,GAAG+G,SAASuH,GACnB,IAAKE,EAAa,EAAGA,EAAaF,EAAajJ,SAE5B,IADNkJ,EAASC,EAAYF,EAAaK,OAAOH,IADCA,UAOvD,IAAKA,KAAcF,EACf,GAAI3S,OAAOkB,UAAUC,eAAe1B,KAAKkT,EAAcE,KAEpC,IADND,EAASC,EAAYF,EAAaE,IAEvC,OAOxBxO,GAAGvD,KAAO,SAASmS,EAASC,GACxB,GAAI7O,GAAGsG,WAAWsI,GAAU,CACxB,IAAIrH,EAAOxJ,MAAMlB,UAAU2K,MAAMpM,KAAKqM,UAAW,GACjD,OAAO,WACH,IAAIqH,EAAU9O,GAAG2B,OAAO,GAAI4F,GAI5B,OAHIE,UAAUpC,SACVyJ,EAAUA,EAAQ1Q,OAAOL,MAAMlB,UAAU2K,MAAMpM,KAAKqM,aAEjDmH,EAAQG,MAAMF,EAASC,IAGtC,MAAM,IAAIpP,MAAM,wCAEpBM,GAAGgP,QAAU,SAASC,EAAKC,EAAMC,GAC7B,IAAIC,EAAa,GAAIC,EAAS,IAAKC,EAAM,SAASC,EAAStU,GACvD,IAAIuU,EAAWN,EAAO,QAAQlN,KAAKkN,GAAQA,EAAOA,EAAO,IAAMjU,EAAI,IAAMA,EACxD,cAAbuU,GAAkC,cAANvU,GAC5BmU,EAAWtM,KAAwB,iBAAZyM,EAAuBvP,GAAGgP,QAAQO,EAASC,GAAU,GAAoD,sBAA5C7T,OAAOkB,UAAUO,SAAShC,KAAKmU,GAAmCE,mBAAmBD,GAAY,IAAMC,mBAAmBF,KAAaE,mBAAmBD,GAAY,IAAMC,mBAAmBF,KAkB3R,OAfKJ,GAAcD,GACfG,EAAS,KAAKrN,KAAKkN,GAAQ,MAAMlN,KAAKkN,GAAQ,GAAK,IAAM,IACzDE,EAAWtM,KAAKoM,GAChBE,EAAWtM,KAAK9C,GAAGgP,QAAQC,KACoB,mBAAxCtT,OAAOkB,UAAUO,SAAShC,KAAK6T,SAA4C,IAARA,EAC1EjP,GAAG4C,KAAKqM,GAAK,SAASpM,EAAK/E,GACvBwR,EAAIxR,EAAK+E,MAEN,MAAOoM,GAAsD,iBAARA,EAC5DjP,GAAG4C,KAAKqM,GAAK,SAASrD,EAAM9N,GACxBwR,EAAIxR,EAAK8N,MAGbwD,EAAWtM,KAAK2M,mBAAmBP,GAAQ,IAAMO,mBAAmBR,IAEpEC,EACOE,EAAWM,KAAKL,GAEhBD,EAAWM,KAAKL,GAAQjN,QAAQ,KAAM,IAAIA,QAAQ,OAAQ,MAGzEpC,GAAG2P,aAAe,SAASV,EAAKW,EAAUC,GActC,OAbKD,IACDA,EAAW,IAAItG,UAEnBtJ,GAAG4C,KAAKqM,GAAK,SAASzS,EAAKsB,GACvBtB,EAAMqT,EAAeA,EAAe,IAAMrT,EAAM,IAAMA,EAClDwD,GAAGoG,SAAStI,GACZkC,GAAG2P,aAAa7R,EAAK8R,EAAUpT,GACxBwD,GAAGsG,WAAWxI,GACrB8R,EAAS/J,OAAOrJ,EAAKsB,KAErB8R,EAAS/J,OAAOrJ,EAAKsB,MAGtB8R,GAEX5P,GAAG8P,WAAa,SAASb,EAAKc,GAC1B,IAAI7G,EAYJ,OAXK6G,IACDA,EAAO5G,SAASC,cAAc,SAElCpJ,GAAG2P,aAAaV,EAAK,CACjBpJ,OAAQ,SAASrJ,EAAKsB,IAClBoL,EAAQC,SAASC,cAAc,UACzB4G,aAAa,OAAQxT,GAC3B0M,EAAM8G,aAAa,QAASlS,GAC5BiS,EAAKE,YAAY/G,MAGlB6G,GAEX/P,GAAGkQ,UAAY,SAASC,MACpB,OAAI1K,OAAO2K,MAAQpQ,GAAGsG,WAAW8J,KAAKC,OAC3BD,KAAKC,MAAMF,MAEXG,KAAK,IAAMH,KAAO,MAGjCnQ,GAAGuQ,aAAe,SAASC,GACvB,IAAIC,EAASD,EAASE,YAAY,KAAO,EACzC,GAAID,EAAS,EACT,OAAOD,EAASG,OAAOF,EAAQD,EAASnL,OAASoL,IAGzDzQ,GAAG4Q,YAAc,SAASC,GACtB,OAAI7Q,GAAGuI,QAAQsI,GACJA,EAAgB3U,MAAMkG,QAAQ,YAAa,IAC3CpC,GAAG+H,OAAO8I,IACgB,OAA7BA,EAAgBC,eAAkD/M,IAA7B8M,EAAgBC,SAC9CD,EAAgBC,SAGxBD,EAAgBrV,MAE3BwE,GAAG+Q,eAAiB,WAChB,IAAIC,EAAY,GAChB,MAAO,CACHC,QAAS,WACL,IAAIC,EACJ,IACIA,EAAWF,EAAUG,UAEjBD,UAECA,IAEb7Q,OAAQ,WACJ,IAAIkH,EAAOE,UACXrH,KAAKgR,YAAYpR,GAAGuH,EAAK,IAAIlH,OAAO0O,MAAM3O,KAAMrC,MAAMlB,UAAU2K,MAAMpM,KAAKqM,UAAW,MAE1F2J,YAAa,SAASC,GAClBL,EAAUlO,KAAKuO,MAnb/B,GAwbA,WACI,kBAEU,KAANC,yCACI,OAAOtR,IADL,kGAHd,GAYA,WACI,aACAA,GAAGN,MAAQ,SAASuG,GAChB7F,KAAK6F,QAAU,kBAAoBjG,GAAGuR,QAAU,KAAOtL,GAE3DjG,GAAGN,MAAM7C,UAAY,IAAI6C,MAL7B,GAOAM,GAAGuR,QAAU,QACbvR,GAAGwR,kBAAoB,WACnB,aACA,IAAIC,EAAmBC,EAAwBC,EAAkBC,EAA2BC,EAAoBC,EAAkBC,EAAgBC,EAAwBC,EAAoBC,EAAuBC,EAA2BC,EAAwBC,EAAyBC,EAAuBC,EA6ChTC,EAQAtJ,EAnCR,SAASuJ,IACL,QAAIhN,OAAOgE,qBAEwB1F,IADrB/D,GAAGuJ,oBACFmJ,gBAInB,SAASC,IACL,YAAiC5O,IAA1B0B,OAAOmN,eA8ClB,OAxBAnB,EA/CA,WACI,IAAsBoB,EAAlBC,GAAY,EAChB,KACID,EAAY1J,SAASC,cAAc,UACzB9I,KAAO,OACjBN,GAAG6S,GAAW5S,OACV4S,EAAUE,WACVD,GAAY,GAElB,MAAOE,GACLF,GAAY,EAEhB,OAAOA,EAmCSG,GAEpBvB,GADAE,EAA4BH,GAAqBzR,GAAGiJ,0BACGjJ,GAAGiK,eAE1D4H,GADAF,EAAmBC,KALP,cADJY,EAAOrJ,SAASC,cAAc,UACH,gBAAiBoJ,GAAQ,WAAYA,KAAUxS,GAAGuN,YAAcvN,GAAGyN,WAO9FvE,EAAQC,SAASC,cAAc,UAC7B9I,KAAO,UACH,oBAAsB4I,GAASC,SAASzG,iBAAiB,oBAAoB,MAE3FoP,EAAmBF,GAA6B5R,GAAGgK,0BACnD+H,EAAiBH,GAA6BE,GArB9C,WACI,IACI,QAASrM,OAAOyN,cAAgBlT,GAAGsG,WAAWb,OAAOyN,aAAaC,SACpE,MAAOxJ,GACL,OAAO,GAiBmDyJ,GAClEpB,EAAyBJ,IA3Cb5R,GAAGkN,UAAYlN,GAAGmN,eAAiFpJ,IAArE0I,UAAUC,UAAU2G,MAAM,uCA4CpEpB,EAAqBR,SAA6C1N,IAAvB0B,OAAO6N,aAA6B1B,GAC/EO,EAA4BM,IAC5BP,EAAwBS,IACxBP,IAlCQK,KAGGE,IAgCXN,OA7B+DtO,IAApDoF,SAASC,cAAc,SAASmK,gBA8B3CjB,EAAwBV,QAAmD7N,IAAtB0B,OAAOyF,WAC5DqH,IACQX,IACQ5R,GAAGiK,iBAAmBjK,GAAG6N,YAIlC,CACH2F,cAAe5B,EACf6B,cAAe/B,EACfgC,iBAAkB9B,EAClB+B,SAAU7B,EACV8B,eAAgBxB,EAChByB,kBAAmB3B,EACnB4B,kBAAmB3B,EACnB4B,gBAAiBtO,OAAOuO,kBACxBC,SAAUtC,EACVuC,WAAYrC,EACZsC,gBAAiB9B,EACjB+B,cAAe9B,EACf+B,gBAAiB/B,EACjBgC,mBAAoB1C,EACpB2C,MAAOzC,EACP0C,YAAajC,EACbkC,OAAQ1C,EACR2C,QAASpC,GAAyBZ,EAClCiD,aAAc3U,GAAGgN,SACjB4H,0BAA2B5U,GAAGyN,MAC9BoH,UAAWpD,EACXqD,WAAY7C,EACZ8C,oBAAqBnD,EACrBoD,mBAAoBpD,EACpBqD,eAAgBjD,GAnGD,GAsGvBhS,GAAGkV,iBAAmB,SAASC,GAC3B,aACA,SAAUA,GAAgBA,EAAaC,MAAQpV,GAAGsG,WAAW6O,EAAaC,QAE9EpV,GAAGoL,QAAU,WACT,aACA,IAAIiK,EAAaC,EAAaC,EAAmB,GAAIC,EAAmB,GAAIC,EAAgB,GAAIC,EAAQ,EACxG1V,GAAG2B,OAAOvB,KAAM,CACZgV,KAAM,SAASO,EAAWC,GAatB,OAZc,IAAVF,GACIC,GACAJ,EAAiBzS,KAAK6S,GAEtBC,GACAJ,EAAiB1S,KAAK8S,KAER,IAAXF,EACPE,GAAaA,EAAU7G,MAAM,KAAMuG,GAC5BK,GACPA,EAAU5G,MAAM,KAAMsG,GAEnBjV,MAEXyV,KAAM,SAAStH,GAMX,OALc,IAAVmH,EACAD,EAAc3S,KAAKyL,GAEnBA,EAASQ,MAAM,UAAsBhL,IAAhBuR,EAA4BD,EAAcC,GAE5DlV,MAEXkL,QAAS,WAaL,OAZAoK,EAAQ,EACRL,EAAc5N,UACV8N,EAAiBlQ,QACjBrF,GAAG4C,KAAK2S,GAAkB,SAAS1S,EAAK0L,GACpCA,EAASQ,MAAM,KAAMsG,MAGzBI,EAAcpQ,QACdrF,GAAG4C,KAAK6S,GAAe,SAAS5S,EAAK0L,GACjCA,EAASQ,MAAM,KAAMsG,MAGtBjV,MAEXoL,QAAS,WAaL,OAZAkK,GAAS,EACTJ,EAAc7N,UACV+N,EAAiBnQ,QACjBrF,GAAG4C,KAAK4S,GAAkB,SAAS3S,EAAK0L,GACpCA,EAASQ,MAAM,KAAMuG,MAGzBG,EAAcpQ,QACdrF,GAAG4C,KAAK6S,GAAe,SAAS5S,EAAK0L,GACjCA,EAASQ,MAAM,KAAMuG,MAGtBlV,SAInBJ,GAAG8V,UAAY,SAASC,EAAeC,GACnC,aACAhW,GAAG2B,OAAOvB,KAAM,CACZ2V,cAAeA,EACfxZ,OAAQ,WACJ,OAAOyZ,EAASD,OAI5B/V,GAAGiW,aAAe,SAASva,GACvB,aACA,IAWGwN,EAAOgN,EAXNC,EAAO/V,KAAMgW,EAAiB,IAAIpW,GAAG+Q,eAAkBpT,EAAU,CACjE0Y,YAAa,KACb/X,QAAS,KACTgY,WAAY,yBACZC,SAAS,EACTC,WAAY,yBACZC,4BAA4B,EAC5BpN,UAAU,EACV7N,KAAM,SACNkb,SAAU,SAASxN,KACnByN,MAAO,MAIX,SAASC,IACL,IAAI1N,EAAQC,SAASC,cAAc,SA0CnC,OAzCAF,EAAM8G,aAAahQ,GAAGiW,aAAaY,oBAAqBX,GACxDhN,EAAM8G,aAAa,QAASrS,EAAQgZ,OACpCR,EAAKW,YAAYnZ,EAAQ0L,SAAUH,GAC/BvL,EAAQ4Y,SAAWvW,GAAGwR,kBAAkB2C,iBACxCjL,EAAM8G,aAAa,kBAAmB,IAEtCrS,EAAQ0Y,aACRnN,EAAM8G,aAAa,SAAUrS,EAAQ0Y,aAEzCnN,EAAM8G,aAAa,OAAQ,QAC3B9G,EAAM8G,aAAa,OAAQrS,EAAQnC,MACnCwE,GAAGkJ,GAAO7H,IAAI,CACV0V,SAAU,WACVC,MAAO,EACPC,IAAK,EACLC,WAAY,QACZC,SAAUnX,GAAGwM,OAASxM,GAAG4M,MAAQ,SAAW,QAC5CwK,OAAQ,EACRC,QAAS,EACTC,OAAQ,UACR/V,QAAS,KAEZvB,GAAG2M,OAAS3M,GAAGkJ,GAAO7H,IAAI,CACvBkW,OAAQ,SAEZ5Z,EAAQW,QAAQ2R,YAAY/G,GAC5BkN,EAAe/V,OAAO6I,EAAO,UAAU,WACnCvL,EAAQ+Y,SAASxN,MAErBkN,EAAe/V,OAAO6I,EAAO,aAAa,WACtClJ,GAAGrC,EAAQW,SAAS4D,SAASvE,EAAQ6Y,eAEzCJ,EAAe/V,OAAO6I,EAAO,YAAY,WACrClJ,GAAGrC,EAAQW,SAAS6D,YAAYxE,EAAQ6Y,eAE5CJ,EAAe/V,OAAO6I,EAAO,SAAS,WAClClJ,GAAGrC,EAAQW,SAAS4D,SAASvE,EAAQ2Y,eAEzCF,EAAe/V,OAAO6I,EAAO,QAAQ,WACjClJ,GAAGrC,EAAQW,SAAS6D,YAAYxE,EAAQ2Y,eAErCpN,EA7CXlJ,GAAG2B,OAAOhE,EAASjC,GACnBwa,EAAWlW,GAAGsM,cA8CdtM,GAAGrC,EAAQW,SAAS+C,IAAI,CACpB0V,SAAU,WACVS,SAAU,SACVC,UAAW,QAEfzX,GAAG2B,OAAOvB,KAAM,CACZsX,SAAU,WACN,OAAOxO,GAEXyO,YAAa,WACT,OAAOzB,GAEXY,YAAa,SAASc,EAAYC,GAC9B,IAAI3O,EAAQ2O,GAAYzX,KAAKsX,WACzB/Z,EAAQ8Y,4BAA8BzW,GAAG2N,SAAW3N,GAAG6N,aAAe7N,GAAG+N,oBACzE7E,EAAM8G,aAAa,WAAY,IAE3B4H,EACA1O,EAAM8G,aAAa,WAAY,IAE/B9G,EAAM4O,gBAAgB,aAIlCC,eAAgB,SAAS1B,GACjBA,IAAgB1Y,EAAQ0Y,aACxBnN,EAAM8G,aAAa,SAAUqG,IAGrC2B,MAAO,WACC9O,EAAMhI,YACNlB,GAAGkJ,GAAO/H,SAEdnB,GAAGrC,EAAQW,SAAS6D,YAAYxE,EAAQ2Y,YACxCpN,EAAQ,KACRA,EAAQ0N,OAGhB1N,EAAQ0N,KAEZ5W,GAAGiW,aAAaY,oBAAsB,eACtC7W,GAAGiY,WAAa,SAASC,GACrB,aACA,IAAIrT,EAAO,GAAIsT,EAAS,GAAIC,EAAW,GAAIC,EAAiB,GAAIC,EAAY,GAC5E,SAASC,EAAaC,GAClB,GAAIxY,GAAGhC,QAAQwa,GAAU,CACrB,IAAIC,EAAU,GAId,OAHAzY,GAAG4C,KAAK4V,GAAS,SAAS3V,EAAK6V,GAC3BD,EAAQ3V,KAAK+B,EAAK6T,OAEfD,EAEX,OAAO5T,EAAK2T,GAwBhBxY,GAAG2B,OAAOvB,KAAM,CACZuY,QAAS,SAASC,GACd,IAAIC,EAASD,EAAKC,QAAU7Y,GAAG6Y,OAAOC,WAAYJ,EAAK7T,EAAK/B,KAAK,CAC7DtH,KAAMod,EAAKpd,KACXud,aAAcH,EAAKpd,KACnBwd,KAAMJ,EAAKI,KACXC,KAAmB,MAAbL,EAAKK,MAAgB,EAAIL,EAAKK,KACpCJ,OAAQA,EACRK,KAAMN,EAAKM,OACV,EAuBL,OAtBIN,EAAKO,UACLtU,EAAK6T,GAAIS,QAAUP,EAAKO,aACQpV,IAA5BuU,EAAUM,EAAKO,WACfb,EAAUM,EAAKO,SAAW,IAE9Bb,EAAUM,EAAKO,SAASrW,KAAK4V,IAE7BE,EAAKQ,eACLvU,EAAK6T,GAAIU,aAAeR,EAAKQ,kBACarV,IAAtCsU,EAAeO,EAAKQ,gBACpBf,EAAeO,EAAKQ,cAAgB,IAExCf,EAAeO,EAAKQ,cAActW,KAAK4V,IAE3C7T,EAAK6T,GAAIA,GAAKA,EACdP,EAAOS,EAAKI,MAAQN,OACK3U,IAArBqU,EAASS,KACTT,EAASS,GAAU,IAEvBT,EAASS,GAAQ/V,KAAK4V,GACtBE,EAAKS,sBAAwBT,EAAKS,qBAAqBX,GACvDR,EAAcoB,eAAeZ,EAAI,KAAMG,GAChCH,GAEXa,SAAU,SAASC,GACf,OAAIxZ,GAAGoG,SAASoT,IAAmB3U,EAAKQ,YACVtB,IAAtByV,EAAed,GACRH,EAAaiB,EAAed,SACJ3U,IAAxByV,EAAeR,KA5DtC,SAAwBS,GACpB,GAAIzZ,GAAGhC,QAAQyb,GAAQ,CACnB,IAAIhB,EAAU,GAId,OAHAzY,GAAG4C,KAAK6W,GAAO,SAAS5W,EAAKmW,GACzBP,EAAQ3V,KAAK+B,EAAKsT,EAAOa,QAEtBP,EAEX,OAAO5T,EAAKsT,EAAOsB,IAqDAC,CAAeF,EAAeR,MAC9BQ,EAAeX,QApDbA,EAqDcW,EAAeX,OApD9Cc,EAAgB,GAAIC,EAAW,GAAGxb,OAAOya,GAC7C7Y,GAAG4C,KAAKgX,GAAU,SAASC,EAAOC,GAC9B,IAAIC,EAAsB3B,EAAS0B,QACP/V,IAAxBgW,GACA/Z,GAAG4C,KAAKmX,GAAqB,SAAS9e,EAAG+e,GACrCL,EAAc7W,KAAK+B,EAAKmV,UAI7BL,QA0CQ,EAIA3Z,GAAG2B,OAAO,GAAIkD,GAAM,GAxDvC,IAAyBgU,EACjBc,EAAoBC,GA0DxBK,cAAe,SAASvB,GACpB,IAAIwB,EAAS3B,EAAaG,GACtBwB,UACOA,EAAOhB,MAGtBlB,MAAO,WACHnT,EAAO,GACPsT,EAAS,GACTC,EAAW,GACXE,EAAY,IAEhB6B,UAAW,SAASzB,EAAI0B,GACpB,IAAIC,EAAYxV,EAAK6T,GAAIG,OAAQyB,EAAyBta,GAAGiF,QAAQmT,EAASiC,GAAY3B,GAC1FN,EAASiC,GAAWE,OAAOD,EAAwB,GACnDzV,EAAK6T,GAAIG,OAASuB,OACUrW,IAAxBqU,EAASgC,KACThC,EAASgC,GAAa,IAE1BhC,EAASgC,GAAWtX,KAAK4V,GACzBR,EAAcoB,eAAeZ,EAAI2B,EAAWD,IAEhDI,YAAa,SAAS9B,EAAI+B,GACtB,IAAIC,EAAU7V,EAAK6T,GAAIM,KACvBnU,EAAK6T,GAAIM,KAAOyB,EAChBtC,EAAOsC,GAAW/B,SACXP,EAAOuC,IAElBC,WAAY,SAASjC,EAAIkC,GACrB/V,EAAK6T,GAAIld,KAAOof,GAEpBC,WAAY,SAASnC,EAAIoC,GACrBjW,EAAK6T,GAAIO,KAAO6B,GAEpBC,YAAa,SAASC,EAAUC,GAC5BpW,EAAKmW,GAAUC,SAAWA,GAE9BC,mBAAoB,SAASxC,GACzB,IAAIU,EAAevU,EAAK6T,GAAIU,aAC5B,OAAIA,EACOf,EAAee,GAEnB,IAEX+B,cAAe,SAASzC,GACpB,IAAIS,EAAUtU,EAAK6T,GAAIS,QACvB,OAAOb,EAAUa,OAI7BnZ,GAAG6Y,OAAS,CACRC,WAAY,aACZsC,UAAW,YACXC,SAAU,WACVC,OAAQ,SACRC,SAAU,WACVC,OAAQ,SACRC,UAAW,YACXC,kBAAmB,oBACnBC,gBAAiB,kBACjBC,kBAAmB,oBACnBC,cAAe,gBACfC,cAAe,gBACfC,SAAU,WACVC,QAAS,WAEb,WACI,aACAhc,GAAGic,cAAgB,CACfC,SAAU,SAASC,EAAiBC,EAAQC,GACxCjc,KAAKkc,SAASH,EAAiBC,EAAQC,IAE3CE,gBAAiB,SAASC,GACtB,IAAIrG,EAAO/V,KACXJ,GAAG4C,KAAK4Z,GAAgB,SAAS3C,EAAO4C,GACpCtG,EAAKuG,eAAeD,OAG5BH,SAAU,SAASzX,EAAMuX,EAAQC,GAC7Bjc,KAAKuc,mCACL,IAAIxD,EAAqC,IAA3B/Y,KAAKwc,WAAWvX,OAAerF,GAAGsM,cAAgBlM,KAAKyc,gBAAiBC,EAAc9c,GAAGvD,MAAK,SAASqO,GACjH1K,KAAK2c,eAAe,CAChBjS,KAAMA,EACNtP,KAAM4E,KAAK4c,SAASC,MAAMC,aAC3B/D,EAASgE,KACb/c,MAAOgd,EAAkBpd,GAAGvD,MAAK,SAAS4gB,GACzCjd,KAAK2c,eAAeM,EAAUlE,EAASgE,KACxC/c,MAAOkd,EAAgBtd,GAAGvD,MAAK,SAAS0H,GACvC,IAAI2G,EAAO9K,GAAGkE,aAAaC,GAC3B/D,KAAK2c,eAAe,CAChBjS,KAAMA,EACNtP,KAAM4E,KAAK4c,SAASC,MAAMC,YAAc,QACzC/D,EAASgE,KACb/c,MAAOmd,EAAoBvd,GAAGvD,MAAK,SAAS+gB,GAC3C,IAAIC,EAAoBD,EAAWnZ,SAAWmZ,EAAWnZ,QAAU,IAAKyG,EAAO9K,GAAGkE,aAAasZ,EAAWrZ,OAAQqZ,EAAWld,KAAMmd,GACnIrd,KAAK2c,eAAe,CAChBjS,KAAMA,EACNtP,KAAMgiB,EAAWhiB,MAClB2d,EAASgE,KACb/c,MAAOsd,EAAqB1d,GAAGvD,MAAK,SAASkhB,GAC5C,GAAI3d,GAAGuI,QAAQoV,IAAgB3d,GAAGwR,kBAAkBgC,cAAe,CAC/D,IAAIoK,EAAQ7f,MAAMlB,UAAU2K,MAAMpM,KAAKuiB,EAAYC,OAAQzH,EAAO/V,KAClEJ,GAAG4C,KAAKgb,GAAO,SAAS/a,EAAKqW,GACzB/C,EAAK4G,eAAe7D,EAAMC,EAASgE,WAGvC/c,KAAK2c,eAAeY,EAAaxE,EAASgE,KAE/C/c,MAKA+V,EAAO/V,KAAM+c,EAAgB,GAChC/c,KAAKyc,gBAAkB1D,EACnBtU,IANI7E,GAAGkI,WAAWrD,KACdA,EAAO9G,MAAMlB,UAAU2K,MAAMpM,KAAKyJ,IAEtCA,EAAO,GAAGzG,OAAOyG,GAKjB7E,GAAG4C,KAAKiC,GAAM,SAAShC,EAAKgb,GACpB7d,GAAGqI,cAAcwV,GACjBH,EAAmBG,GACZ7d,GAAG+I,OAAO8U,GACjBf,EAAYe,GACL7d,GAAGoG,SAASyX,GACfA,EAAc/S,MAAQ+S,EAAcriB,KACpC4hB,EAAgBS,GACTA,EAAc1Z,QAAU0Z,EAAcriB,MAC7C+hB,EAAkBM,GAEfA,EAAc/U,SAAmD,WAAxC+U,EAAc/U,QAAQF,cACtD0U,EAAcO,GAEd1H,EAAKnQ,IAAI6X,EAAgB,6CAA8C,WAG/Ezd,KAAK4F,IAAI,YAAcmX,EAAc9X,OAAS,WAC9CjF,KAAK0d,uBAAuBX,EAAef,EAAQC,KAG3D0B,OAAQ,SAASrF,GACb,IAAIsF,EAAa5d,KAAK6d,YAAY1E,SAAS,CACvCb,GAAIA,IAEJsF,GAAcA,EAAWnF,SAAW7Y,GAAG6Y,OAAO6C,kBAC9Ctb,KAAK4F,IAAIhG,GAAGqH,OAAO,2DAA4DqR,EAAItY,KAAK8d,QAAQxF,IAAM,SAEtGtY,KAAK+d,SAASJ,OAAOrF,IAG7B0F,UAAW,WACP,IAAIC,EAAgB,GAAIlI,EAAO/V,KAC/BJ,GAAG2B,OAAO0c,EAAeje,KAAKwc,YAC9B5c,GAAG4C,KAAKyb,GAAe,SAASxb,EAAKyb,GACjCnI,EAAK4H,OAAOO,MAEhBle,KAAK+d,SAASC,aAElBG,iBAAkB,WACdne,KAAKwc,WAAa,IAEtB4B,eAAgB,SAAS9F,GACrB,IAAIsF,EAAa5d,KAAK6d,YAAY1E,SAAS,CACvCb,GAAIA,IAER,SAAK1Y,GAAGwR,kBAAkB+C,QAAUnU,KAAK4c,SAASrJ,SAAS8K,WAGvDT,EAAWnF,SAAW7Y,GAAG6Y,OAAO2C,QAChCpb,KAAK4F,IAAIhG,GAAGqH,OAAO,yDAA0DqR,EAAItY,KAAK8d,QAAQxF,KAC9FtY,KAAKse,YAAYhG,IACV,IAEPtY,KAAK4F,IAAIhG,GAAGqH,OAAO,sDAAuDqR,EAAItY,KAAK8d,QAAQxF,IAAM,UAE9F,KAEXiG,WAAY,SAASjG,GACjB,OAAOtY,KAAKwe,gBAAgBlG,IAEhCmG,UAAW,SAASC,GAChB,OAAO1e,KAAK+d,SAASY,QAAQD,IAEjCE,cAAe,SAASC,EAAQC,EAAaC,EAASC,EAAYC,GAC9D,IAAwCC,EAAW3hB,EAA/C4hB,EAAkB,IAAIvf,GAAGoL,QAgC7B,OA/BIhL,KAAKof,iBACLF,EAAYlf,KAAKqf,eAAeR,GAChCthB,EAAU,CACN0hB,qBAAsBA,EACtBF,QAASA,EAAU,EAAIA,EAAU,KACjCO,MAAOP,EAAU,IAEhBC,GAAcpf,GAAGwR,kBAAkB4C,gBACpCkL,EAAYlf,KAAKuf,QAAQV,IAEZ,MAAbK,EACAC,EAAgB/T,QAAQ,CACpBoU,UAAWV,EACXvV,MAAO,2BAGXvJ,KAAKof,gBAAgBK,SAASP,EAAWJ,EAAavhB,GAASyX,MAAK,SAAiB0K,GACjFP,EAAgBjU,QAAQwU,MACzB,SAAiBF,EAAWG,GAC3BR,EAAgB/T,QAAQ,CACpBoU,UAAWA,EACXjW,MAAOoW,GAAU,qCAK7BR,EAAgB/T,QAAQ,CACpBoU,UAAWV,EACXvV,MAAO,mCAGR4V,GAEXS,UAAW,SAASf,GAChB,OAAO7e,KAAK6f,WAAW7f,KAAK8f,qBAAqBjB,KAErDkB,YAAa,SAASlB,GAClB,OAAO7e,KAAKggB,eAAetkB,IAAImjB,IAEnCU,QAAS,SAASb,GACd,IACIuB,EADAnH,EAAO9Y,KAAK+d,SAASwB,QAAQb,GAUjC,OARK5F,IACDmH,EAAmBjgB,KAAK6d,YAAY1E,SAAS,CACzCb,GAAIoG,OAGJ5F,EAAOmH,EAAiBnH,MAGzBA,GAAQ,MAEnBoH,cAAe,WACX,OAAOlgB,KAAK6d,YAAY1E,SAAS,CAC7BV,OAAQ,CAAE7Y,GAAG6Y,OAAO4C,UAAWzb,GAAG6Y,OAAO8C,gBAAiB3b,GAAG6Y,OAAOyC,UACrEjW,QAEP6Y,QAAS,SAASxF,GACd,OAAOtY,KAAK6d,YAAY1E,SAAS,CAC7Bb,GAAIA,IACLld,MAEP+kB,YAAa,SAAS7H,GAClB,IAAI8H,EAAkBpgB,KAAKqgB,WAAW,CAClC/H,GAAIA,IACJuC,EAAW,KAMf,OALIuF,QACiCzc,IAA7Byc,EAAgBvF,WAChBA,EAAWuF,EAAgBvF,UAG5BA,GAEXyF,sBAAuB,WACnB,OAAOtgB,KAAK+d,SAASuC,yBAEzBC,QAAS,SAASjI,GACd,OAAOtY,KAAK6d,YAAY1E,SAAS,CAC7Bb,GAAIA,IACLO,MAEP2H,cAAe,WACX,OAAOxgB,KAAKygB,cAEhBC,yBAA0B,WACtB,IAAIC,EAAe3gB,KAAK4gB,kBACxB,OAAID,EAAe,EACRA,EAAe3gB,KAAK6gB,qBAExB,MAEXR,WAAY,SAASjH,GACjB,OAAOpZ,KAAK6d,YAAY1E,SAASC,IAErC0H,QAAS,SAASxI,GACd,OAAOtY,KAAK6d,YAAY1E,SAAS,CAC7Bb,GAAIA,IACLM,MAEPmI,YAAa,SAASzI,GAClB,OAAOtY,KAAK+d,SAASiD,gBAAgB1I,IAEzC1S,IAAK,SAASsB,EAAKpB,IACX9F,KAAK4c,SAASqE,OAAWnb,GAAmB,SAAVA,EAE3BA,GAAmB,SAAVA,GAChBlG,GAAGgG,IAAI,kBAAoBhG,GAAGuR,QAAU,KAAOjK,EAAKpB,GAFpDlG,GAAGgG,IAAI,kBAAoBhG,GAAGuR,QAAU,KAAOjK,IAKvDga,YAAa,SAAS5I,GAClB,IAAIsF,EAAa5d,KAAK6d,YAAY1E,SAAS,CACvCb,GAAIA,IAER,IAAK1Y,GAAGwR,kBAAkB+C,QAAUnU,KAAK4c,SAASrJ,SAAS8K,QACvD,OAAO,EAEX,GAAIze,GAAGiF,QAAQ,CAAEjF,GAAG6Y,OAAO4C,UAAWzb,GAAG6Y,OAAO8C,iBAAmBqC,EAAWnF,SAAW,EAAG,CACxF,GAAIzY,KAAK+d,SAAS5J,MAAMmE,GAEpB,OADAtY,KAAK6d,YAAY9D,UAAUzB,EAAI1Y,GAAG6Y,OAAO2C,SAClC,EAEPpb,KAAK4F,IAAIhG,GAAGqH,OAAO,mCAAoCqR,EAAItY,KAAK8d,QAAQxF,IAAM,cAGlFtY,KAAK4F,IAAIhG,GAAGqH,OAAO,wDAAyDqR,EAAItY,KAAK8d,QAAQxF,IAAM,SAEvG,OAAO,GAEXuB,cAAe,SAASvB,GACpBtY,KAAK+d,SAASoD,QAAQ7I,GACtBtY,KAAK6d,YAAYhE,cAAcvB,IAEnCV,MAAO,WACH5X,KAAK4F,IAAI,yBACT5F,KAAK+d,SAASnG,QACd5X,KAAKwc,WAAa,GAClBxc,KAAKohB,aAAe,GACpBphB,KAAKqhB,eAAiB,GACtBrhB,KAAKshB,gBAAkB,GACvBthB,KAAKqf,eAAiB,GACtBzf,GAAG4C,KAAKxC,KAAKuhB,UAAU,SAAS9e,EAAK+e,GACjCA,EAAO5J,WAEX5X,KAAKyhB,aAAa7J,QAClB5X,KAAKggB,eAAepI,QACpB5X,KAAK6gB,qBAAuB,EAC5B7gB,KAAKygB,aAAe,EACpBzgB,KAAK6d,YAAYjG,QACjB5X,KAAK8f,qBAAuB,GAC5B9f,KAAK0hB,eAAiB1hB,KAAK0hB,cAAc9J,QACzC5X,KAAK4c,SAAS+E,QAAQC,gBAAkB5hB,KAAK6hB,sBAC7C7hB,KAAK8hB,+BAAiC,GACtC9hB,KAAK+hB,4BAA8B,GACnC/hB,KAAKgiB,gBAAkBhiB,KAAKgiB,eAAepK,QAC3C5X,KAAKiiB,uBAAuBrK,SAEhCsK,MAAO,SAAS5J,GACZ,OAAOtY,KAAKmiB,aAAa7J,IAE7B8J,WAAY,SAAS9J,EAAI+J,GAErB,OAAOziB,GAAG0iB,OAAO7lB,UAAU2lB,WAAW9J,EAAI+J,EAAO,CAC7Czc,IAAKhG,GAAGvD,KAFD2D,KAEW4F,IAFX5F,MAGPuf,QAAS3f,GAAGvD,KAHL2D,KAGeuf,QAHfvf,MAIP4d,WAJO5d,KAIU6d,eAGzB0E,iBAAkB,SAASC,EAASlK,GAChCtY,KAAKyiB,oBAAoBC,IAAIF,EAASlK,IAE1CqK,oBAAqB,SAASrK,EAAI7T,GAC9BzE,KAAKiiB,uBAAuBS,IAAIje,EAAM6T,IAE1CsK,2BAA4B,SAASJ,EAASlK,GAC1CtY,KAAK6iB,8BAA8BH,IAAIF,EAASlK,IAEpDwK,sBAAuB,SAAS7G,EAAU3D,GACtCtY,KAAK+iB,yBAAyBL,IAAIzG,EAAU3D,IAEhD0K,oBAAqB,SAAShH,EAAQ1D,GAClCtY,KAAKijB,uBAAuBP,IAAI1G,EAAQ1D,IAE5C4K,YAAa,SAASjH,EAAU3D,GAC5BtY,KAAKggB,eAAe0C,IAAIzG,EAAU3D,IAEtC6K,QAAS,SAASC,GACdpjB,KAAKqjB,4BAA4BD,IAErCE,aAAc,SAASC,GACnBvjB,KAAK4gB,kBAAoB2C,GAE7BC,QAAS,SAASlL,EAAIkC,GAClBxa,KAAK6d,YAAYtD,WAAWjC,EAAIkC,IAEpCiJ,UAAW,SAASzH,EAAQ1D,GACxBtY,KAAKyhB,aAAaiB,IAAI1G,EAAQ1D,IAElCoL,QAAS,SAASpL,EAAI+B,GAClB,OAAOra,KAAK6d,YAAYzD,YAAY9B,EAAI+B,IAE5CN,UAAW,SAASzB,EAAI0B,GAIpB,IAHiBha,KAAKqgB,WAAW,CAC7B/H,GAAIA,IAGJ,MAAM,IAAI1Y,GAAGN,MAAMgZ,EAAK,4BAE5B,OAAQ0B,GACN,KAAKpa,GAAG6Y,OAAOmD,QACb5b,KAAK2jB,kBAAkBrL,EAAI,MAAM,GACjC,MAEF,KAAK1Y,GAAG6Y,OAAOiD,cACb1b,KAAK2jB,kBAAkBrL,EAAI,MAAM,GACjC,MAEF,QACE,IAAIsL,EAAe,+BAAiCxoB,KAAO,6BAA+B4e,EAE1F,MADAha,KAAK4F,IAAIge,GACH,IAAIhkB,GAAGN,MAAMskB,KAG3BC,kBAAmB,WACgB,IAA3B7jB,KAAKwc,WAAWvX,OAChBjF,KAAK8jB,WAAW,gBAEhB9jB,KAAK+jB,uBAIjBnkB,GAAGokB,eAAiB,CAChB1H,eAAgB,SAAS2H,GACrB,IAAIlO,EAAO/V,KACX,OAAOA,KAAK6d,YAAYtF,QAAQ,CAC5BK,KAAMqL,EAAYrL,KAClBxd,KAAM6oB,EAAY7oB,KAClByd,KAAMoL,EAAYpL,KAClBJ,OAAQ7Y,GAAG6Y,OAAO+C,kBAClBvC,qBAAsB,SAASX,GAC3B2L,EAAYC,oBAAsBnO,EAAK+M,sBAAsBmB,EAAYC,mBAAoB5L,GAC7F2L,EAAYE,kBAAoBpO,EAAKiN,oBAAoBiB,EAAYE,iBAAkB7L,GACnF2L,EAAYG,eACZrO,EAAKsJ,eAAe/G,GAAM2L,EAAYG,cAE1CrO,EAAK0K,eACL1K,EAAK8K,2BAIjBwD,sBAAuB,SAASvL,EAAMwL,GAC9B1kB,GAAG+H,OAAOmR,KACVA,EAAKyL,WAAavkB,KAAKwkB,aAAaF,KAG5CG,YAAa,SAAS5e,GAClB7F,KAAK4c,SAAS8H,UAAUC,QAAQ,KAAM,KAAM9e,OAASlC,IAEzDihB,qBAAsB,WAClB,IAAI7O,EAAO/V,KACX,OAAO,IAAIJ,GAAGilB,wBAAwB,CAClCC,OAAQ9kB,KAAK4c,SAAS2B,WAAWuG,OAAOC,cACxCC,eAAgBhlB,KAAK4c,SAASoI,eAC9BC,cAAejlB,KAAK4c,SAASsI,QAAQC,SACrCC,cAAeplB,KAAK6iB,8BACpBwC,YAAarlB,KAAKijB,uBAClBqC,cAAetlB,KAAK+iB,yBACpBwC,KAAMvlB,KAAK4c,SAAS2I,KACpB3f,IAAKhG,GAAGvD,KAAK0Z,EAAKnQ,IAAKmQ,GACvByP,SAAU,SAASlN,GACfvC,EAAK0P,UAAUnN,GACfvC,EAAK6G,SAAS8H,UAAUc,SAASlN,IAErCoN,iBAAkB,SAASpN,EAAIqN,EAAUC,GACrC7P,EAAK4N,kBAAkBrL,EAAIqN,EAAUC,GACrC7P,EAAK6G,SAAS8H,UAAUgB,iBAAiBpN,EAAIqN,EAAUC,OAInEC,oBAAqB,WACjB,IAAI9P,EAAO/V,KACX,OAAO,IAAIJ,GAAGkmB,aAAa,CACvBC,cAAe/lB,KAAK4c,SAASoJ,MAAMD,cACnCrB,UAAW,CACP9e,IAAKhG,GAAGvD,KAAK0Z,EAAKnQ,IAAKmQ,GACvBkQ,cAAe,SAASvb,GACpBqL,EAAKmQ,uBAAuB,CACxB9qB,KAAM,kBACN+S,SAAUvO,GAAGvD,KAAK0Z,EAAK6G,SAAS8H,UAAUyB,gBAAiBpQ,EAAMrL,GACjE6K,UAAW3V,GAAGvD,KAAK0Z,EAAKqQ,oBAAqBrQ,EAAMrL,GACnD2b,WAAY,sBAMhCC,aAAc,SAASC,EAAcC,GACjC,IAAIC,EAAQ,GAAIC,EAAWH,EAAcI,EAAsB,GAAIC,EAAiBJ,EAAkBK,EAAO,SAASC,GAClH,OAAIlnB,GAAGoG,SAAS8gB,GACLlnB,GAAG2B,OAAO,GAAIulB,GAElBA,GAMRC,EAAwB,SAASzO,EAAI0O,GAChCJ,GAAkBhnB,GAAGoG,SAASghB,IAC9BpnB,GAAG2B,OAAOylB,EANVpnB,GAAGsG,WAAW0gB,GACPA,IAEJA,GAKHD,EAAoBrO,IACpB1Y,GAAG2B,OAAOylB,EAAUL,EAAoBrO,KAGhD,MAAO,CACHoK,IAAK,SAAShlB,EAAK4a,GACL,MAANA,GACAmO,EAAQ,GACRC,EAAWG,EAAKnpB,IAEhB+oB,EAAMnO,GAAMuO,EAAKnpB,IAGzBhC,IAAK,SAAS4c,GACV,IAAI2O,EAOJ,OALIA,EADM,MAAN3O,GAAcmO,EAAMnO,GACXmO,EAAMnO,GAENuO,EAAKH,GAElBK,EAAsBzO,EAAI2O,GACnBJ,EAAKI,IAEhBC,YAAa,SAAS5O,EAAI2O,GAClBrnB,GAAGoG,SAASygB,KACD,OAAPnO,EACI1Y,GAAGsG,WAAW+gB,GACdL,EAAiBK,GAEjBL,EAAiBA,GAAkB,GACnChnB,GAAG2B,OAAOqlB,EAAgBK,KAG9BN,EAAoBrO,GAAMqO,EAAoBrO,IAAO,GACrD1Y,GAAG2B,OAAOolB,EAAoBrO,GAAK2O,MAI/ClmB,OAAQ,SAAS8d,GACb,cAAc4H,EAAM5H,IAExBjH,MAAO,WACH6O,EAAQ,GACRE,EAAsB,GACtBD,EAAWH,KAIvBY,yBAA0B,WACtB,IAAIpR,EAAO/V,KACX,OAAO,IAAIJ,GAAGiY,WAAW,CACrBiG,QAAS,SAASxF,GACd,OAAOvC,EAAK+H,QAAQxF,IAExBwI,QAAS,SAASxI,GACd,OAAOvC,EAAK+K,QAAQxI,IAExBiI,QAAS,SAASjI,GACd,OAAOvC,EAAKwK,QAAQjI,IAExBY,eAAgB,SAASZ,EAAI2B,EAAWD,GACpCjE,EAAKqR,sBAAsB9O,EAAI2B,EAAWD,GAC1CjE,EAAK6G,SAAS8H,UAAUxL,eAAeZ,EAAI2B,EAAWD,GACtDjE,EAAKsR,kBAAkB/O,EAAI0B,GACvBjE,EAAKiM,gBACLsF,YAAW,WACPvR,EAAKiM,eAAe9I,eAAeZ,EAAI2B,EAAWD,KACnD,OAKnBuN,oBAAqB,SAAS/O,GAC1B,IAA8KgJ,EAA1KzL,EAAO/V,KAAMiW,EAAcuC,EAAKgP,QAAUxnB,KAAK4c,SAAS6K,WAAWxR,YAAayR,EAAoBlP,EAAKkP,mBAAqB1nB,KAAK4c,SAAS6K,WAAWC,kBA+B3J,OAlBAlG,EAAS,IAAI5hB,GAAGiW,aAAa,CACzBI,YAAaA,EACb/X,QAASsa,EAAKta,QACdgY,WAAYlW,KAAK4c,SAAS+K,QAAQC,YAClCzR,QAASqC,EAAKrC,QACdC,WAAYpW,KAAK4c,SAAS+K,QAAQE,YAClCxR,2BAA4BrW,KAAK4c,SAASkL,YAAYC,iBACtD9e,WAlBIrJ,GAAGwR,kBAAkBgC,iBACjB2C,EAAK6G,SAASkL,YAAYE,gBAAkBpoB,GAAGyN,QAAUzN,GAAGwN,QAAU2I,EAAKkS,oBAAoBP,EAAmB,gBAGhG/jB,IAAlB6U,EAAKvP,SACE8M,EAAK6G,SAAS3T,SAElBuP,EAAKvP,UAYhB7N,KAAM4E,KAAK4c,SAASsI,QAAQgD,UAC5B5R,SAAU,SAASxN,GACfiN,EAAKoS,eAAerf,IAExByN,MAAqB,MAAdiC,EAAKjC,MAAgBvW,KAAK4c,SAAS1Z,KAAKklB,eAAiB5P,EAAKjC,QAEzEvW,KAAKqoB,gBAAgBrX,aAAY,WAC7BwQ,EAAO3Q,aAEXkF,EAAKwL,SAAS7e,KAAK8e,GACZA,GAEX8G,qBAAsB,SAASC,EAAmBC,GAC9C,IAAIzS,EAAO/V,KAAMyoB,EAAiB,GAAIlrB,EAAU,CAC5C0jB,MAAOjhB,KAAK4c,SAASqE,MACrB+D,eAAgBhlB,KAAK4c,SAASoI,eAC9BO,KAAMvlB,KAAK4c,SAAS2I,KACpBF,YAAarlB,KAAKyhB,aAClB6D,cAAetlB,KAAKggB,eACpBzM,SAAUvT,KAAK4c,SAASrJ,SACxBc,OAAQrU,KAAK4c,SAASvI,OACtBwI,MAAO7c,KAAK4c,SAASC,MACrBjX,IAAKhG,GAAGvD,KAAK0Z,EAAKnQ,IAAKmQ,GACvB2S,kBAAmB1oB,KAAK4c,SAASsF,MAAMyG,6BACvCC,WAAY,SAAStQ,EAAIld,EAAMytB,EAAQC,GAC/BD,EAAS,GAAKC,EAAQ,IAGtBL,EAAenQ,IACXmQ,EAAenQ,GAAIuQ,SAAWA,GAAUJ,EAAenQ,GAAIwQ,QAAUA,IAKzE/S,EAAKgT,YAAYzQ,EAAIld,EAAMytB,EAAQC,GACnC/S,EAAK6G,SAAS8H,UAAUkE,WAAWtQ,EAAIld,EAAMytB,EAAQC,IAEzDL,EAAenQ,GAAM,CACjBuQ,OAAQA,EACRC,MAAOA,KAGfE,WAAY,SAAS1Q,EAAIld,EAAMgH,EAAQ6mB,UAC5BR,EAAenQ,GACtB,IAEW4Q,EAFPzQ,EAAS1C,EAAKsK,WAAW,CACzB/H,GAAIA,IACLG,OACCA,IAAW7Y,GAAG6Y,OAAO+C,mBAAqB/C,IAAW7Y,GAAG6Y,OAAOgD,iBAGnEyN,EAASnT,EAAKoT,YAAY7Q,EAAIld,EAAMgH,EAAQ6mB,cACtBrpB,GAAGoL,QACrBke,EAAOzT,MAAK,WACRM,EAAK6G,SAAS8H,UAAUsE,WAAW1Q,EAAIld,EAAMgH,EAAQ6mB,MAGzDlT,EAAK6G,SAAS8H,UAAUsE,WAAW1Q,EAAIld,EAAMgH,EAAQ6mB,KAG7DG,SAAU,SAAS9Q,EAAIld,EAAMiuB,GACzB,IAAIte,EAAU,IAAInL,GAAGoL,QAarB,OAZA+K,EAAKmQ,uBAAuB,CACxB9qB,KAAM,WACN+S,SAAUvO,GAAGvD,KAAK0Z,EAAK6G,SAAS8H,UAAU0E,SAAUrT,EAAMuC,EAAIld,GAC9Doa,UAAWzK,EAAQK,QACnBmK,UAAW,WACP8T,EAAyBrU,MAAK,WAC1Be,EAAKuT,UAAUhR,EAAIld,MAEvB2P,EAAQG,WAEZmb,WAAY/N,IAETvN,GAEXwe,aAAc3pB,GAAGvD,KAAK2D,KAAKwpB,cAAexpB,MAC1CypB,SAAU,SAASnR,EAAIld,GACnB2a,EAAK2T,UAAUpR,EAAIld,GACnB,IAAIuuB,EAAiB5T,EAAK6G,SAAS8H,UAAU+E,SAASnR,EAAIld,GAC1D,OAAIwE,GAAGkV,iBAAiB6U,IACpB5T,EAAKnQ,IAAIhG,GAAGqH,OAAO,+DAAgEqR,IAC5EqR,IAEJ,IAAI/pB,GAAGoL,SAAUE,WAE5B0e,cAAe,SAAStR,EAAIld,EAAMyuB,GAC9B9T,EAAK+T,eAAexR,EAAIuR,GACxB,IAAIE,EAAsBhU,EAAK6G,SAAS8H,UAAUkF,cAActR,EAAIld,EAAMyuB,GAC1E,OAAIjqB,GAAGkV,iBAAiBiV,IACpBhU,EAAKnQ,IAAIhG,GAAGqH,OAAO,uEAAwEqR,EAAIuR,EAAUG,YAClGD,IAEJ,IAAInqB,GAAGoL,SAAUE,WAE5B+e,qBAAsB,SAAS3R,EAAIuR,EAAWznB,EAAQ6mB,GAClDlT,EAAKmU,sBAAsB5R,EAAIuR,GAC/B9T,EAAK6G,SAAS8H,UAAUuF,qBAAqBtb,MAAMoH,EAAM1O,YAE7D8iB,SAAU,SAAS7R,EAAIld,EAAMyuB,EAAWO,GACpC,OAAOrU,EAAK6G,SAAS8H,UAAUyF,SAAS7R,EAAIld,EAAMyuB,EAAWO,IAEjEC,YAAa,SAAS/R,EAAIld,EAAMkvB,EAAcrB,GAC1C,OAAOlT,EAAKwU,aAAa5b,MAAMoH,EAAM1O,YAEzCmjB,cAAe,SAASlS,EAAI+B,GACxBtE,EAAKnQ,IAAI,sCAAwCmQ,EAAK+K,QAAQxI,GAAM,SAAW+B,EAAU,KACzFtE,EAAK2N,QAAQpL,EAAI+B,IAErByD,QAASle,GAAGvD,KAAK0Z,EAAK+H,QAAS/H,GAC/B+K,QAASlhB,GAAGvD,KAAK0Z,EAAK+K,QAAS/K,GAC/BwK,QAAS3gB,GAAGvD,KAAK0Z,EAAKwK,QAASxK,GAC/B0U,QAAS7qB,GAAGvD,KAAK0Z,EAAK2U,SAAU3U,GAChC4U,cAAe,SAAS/R,GACpB,OAAO7C,EAAKsK,WAAW,CACnBzH,KAAMA,KAGdgS,SAAU,SAAStS,GACf,IAAIG,EAAS1C,EAAKsK,WAAW,CACzB/H,GAAIA,IACLG,OACH,OAAOA,IAAW7Y,GAAG6Y,OAAOyC,QAAUzC,IAAW7Y,GAAG6Y,OAAOuC,WAAavC,IAAW7Y,GAAG6Y,OAAO8C,iBAAmB9C,IAAW7Y,GAAG6Y,OAAO2C,QAEzIN,mBAAoB/E,EAAK8H,YAAY/C,mBACrCC,cAAehF,EAAK8H,YAAY9C,cAChC8P,aAAc,SAASvS,GACnB,OAAOvC,EAAKsK,WAAW,CACnB/H,GAAIA,IACLG,SAAW7Y,GAAG6Y,OAAO4C,WAE5ByP,oBAAqBlrB,GAAGvD,KAAK0Z,EAAKgV,qBAAsBhV,GACxDgE,UAAW,SAASzB,EAAIG,GACpB1C,EAAK8H,YAAY9D,UAAUzB,EAAIG,KAYvC,OATA7Y,GAAG4C,KAAKxC,KAAK4c,SAASsI,SAAS,SAAS1Z,EAAM9N,GAC1CH,EAAQiO,GAAQ9N,KAEpBH,EAAQ6nB,cAAgBplB,KAAKyiB,oBACzB8F,GACA3oB,GAAG4C,KAAK+lB,GAAmB,SAASnsB,EAAKsB,GACrCH,EAAQnB,GAAOsB,KAGhB,IAAIkC,GAAGorB,wBAAwBztB,EAASirB,IAEnDyC,oBAAqB,SAAS3S,GAC1BtY,KAAK6gB,uBACL7gB,KAAK6d,YAAY9D,UAAUzB,EAAI1Y,GAAG6Y,OAAOwC,WAE7CiQ,YAAa,SAAS5gB,GAClB,GAAc,IAAVA,EACA,OAAOA,EAAQtK,KAAK4c,SAAS1Z,KAAKioB,YAAY,GAElD,IAAItwB,GAAK,EACT,GACIyP,GAAgB,KAChBzP,UACKyP,EAAQ,MACjB,OAAOjJ,KAAK+pB,IAAI9gB,EAAO,IAAI+gB,QAAQ,GAAKrrB,KAAK4c,SAAS1Z,KAAKioB,YAAYtwB,IAE3EywB,0BAA2B,WACvB,IAAIvV,EAAO/V,KACXA,KAAKurB,kBAAoB,GACzB3rB,GAAG4C,KAAKxC,KAAK4c,SAAS4O,cAAc,SAAS/oB,EAAKgpB,GAC9C,IAAIxiB,EAAWwiB,EAAuBxiB,SAAUwe,EAAa7nB,GAAG2B,OAAO,GAAIwU,EAAK6G,SAAS6K,YAAY,GAAOiE,EAAkB9rB,GAAG2B,OAAO,GAAIkqB,QAC3H9nB,IAAbsF,IACAA,EAAW8M,EAAK6G,SAAS3T,UAEzByiB,EAAgBjE,YAChB7nB,GAAG2B,OAAOkmB,EAAYgE,EAAuBhE,YAAY,GAE7D7nB,GAAG2B,OAAOmqB,EAAiB,CACvBziB,SAAUA,EACVwe,WAAYA,IACb,GACH1R,EAAK4V,iBAAiBD,OAG9B7L,WAAY,SAAS/J,GACjB,IAAI8V,EAAmB5rB,KAAKurB,kBAAkBzV,GAC9C,OAAI8V,EACOA,EAAiB1tB,QACjB4X,IAAa9V,KAAK6rB,iBAClB7rB,KAAK4c,SAAS4E,YADlB,GAIXgD,aAAc,SAASsH,GACnB,IAAIC,EAAQC,EAAWC,EAAkBH,EAIzC,GAHIG,aAA2BrsB,GAAG8V,YAC9BuW,EAAkBA,EAAgBtW,eAElCsW,IAAoBrsB,GAAG+I,OAAOsjB,GAAkB,CAChD,GAAIrsB,GAAG+H,OAAOskB,GACV,OAAOA,EAAgB1H,WACpB,GAA8C,UAA1C0H,EAAgBvjB,QAAQF,eAAoE,SAAvCyjB,EAAgB/rB,KAAKsI,cACjF,OAAOyjB,EAAgBvoB,aAAa9D,GAAGiW,aAAaY,qBASxD,GAPAsV,EAASE,EAAgB1pB,qBAAqB,SAC9C3C,GAAG4C,KAAKupB,GAAQ,SAAStpB,EAAKqG,GAC1B,GAAmC,SAA/BA,EAAMpF,aAAa,QAEnB,OADAsoB,EAAYljB,GACL,KAGXkjB,EACA,OAAOA,EAAUtoB,aAAa9D,GAAGiW,aAAaY,uBAI1DsU,qBAAsB,SAASlM,GAC3B,OAAO7e,KAAKiiB,uBAAuBvmB,IAAImjB,IAE3CqN,gBAAiB,WACb,OAAOlsB,KAAK6d,YAAY1E,SAAS,CAC7BV,OAAQ,CAAE7Y,GAAG6Y,OAAO4C,UAAWzb,GAAG6Y,OAAO8C,gBAAiB3b,GAAG6Y,OAAOyC,OAAQtb,GAAG6Y,OAAOC,WAAY9Y,GAAG6Y,OAAOuC,UAAWpb,GAAG6Y,OAAO2C,UAClInW,QAEPknB,mBAAoB,SAASrW,GACzB,IAAI4V,EAAkB1rB,KAAKurB,kBAAkBzV,GAC7C,OAAO4V,EAAkBA,EAAgBjE,WAAaznB,KAAK4c,SAAS6K,YAExE2E,yBAA0B,SAASC,GAC/B,OAAIA,EAAYvT,gBAAgBlZ,GAAG8V,UACxB,CACHta,KAAMwE,GAAG4Q,YAAY6b,EAAYvT,KAAKnD,eACtCkD,KAAMwT,EAAYvT,KAAKnD,cAAckD,MAGtC,CACHzd,KAAM4E,KAAKqgB,WAAW,CAClB/H,GAAI+T,EAAY/T,KACjBld,KACHyd,KAAM7Y,KAAKqgB,WAAW,CAClB/H,GAAI+T,EAAY/T,KACjBO,OAGXyT,0BAA2B,SAASC,GAChC,IAAIxW,EAAO/V,KAAMwsB,EAAkB,GAInC,OAHA5sB,GAAG4C,KAAK+pB,GAAc,SAAS9pB,EAAK4pB,GAChCG,EAAgB9pB,KAAKqT,EAAKqW,yBAAyBC,OAEhDG,GAEXC,oBAAqB,WACjB,GAAIzsB,KAAK4c,SAAS8P,OAAOrf,KAAOzN,GAAGyN,MAAO,CACtC,IAAgDmU,EAASxhB,KAAK4c,SAAS8P,OAAOlL,OAAQ1L,EAAW0L,EAASxhB,KAAKwkB,aAAahD,GAAUxhB,KAAK6rB,iBAAkBc,EAAa3sB,KAAK4c,SAC3K9G,GAAYA,IAAa9V,KAAK6rB,mBAC9Bc,EAAa3sB,KAAKurB,kBAAkBzV,IAExC6W,EAAW1jB,UAAW,EACoB,OAAtC0jB,EAAWlF,WAAWxR,YACtB0W,EAAWlF,WAAWxR,YANJ,yBAQlB0W,EAAWlF,WAAWxR,aAAe,0BAEzCrW,GAAG4C,KAAKxC,KAAKuhB,UAAU,SAAS9e,EAAK+e,GACjC,GAAIA,EAAOjK,gBAAkBzB,EAGzB,OAFA0L,EAAO9K,YAAYiW,EAAW1jB,UAC9BuY,EAAO7J,eAAegV,EAAW1W,cAC1B,OAKvBiQ,uBAAwB,SAAS0G,GAC7B,IAAI7W,EAAO/V,KAAM6sB,EAAiBD,EAAQze,WAC1C,OAAIvO,GAAGkV,iBAAiB+X,IACpB7sB,KAAK4F,IAAIgnB,EAAQxxB,KAAO,kBAAoBwxB,EAAQxxB,KAAO,gCAAkCwxB,EAAQvG,YAC9FwG,EAAe7X,MAAK,SAAS8X,GAChC/W,EAAKnQ,IAAIgnB,EAAQxxB,KAAO,wBAA0BwxB,EAAQvG,YAC1DuG,EAAQrX,UAAUuX,MACnB,WACKF,EAAQpX,WACRO,EAAKnQ,IAAIgnB,EAAQxxB,KAAO,wBAA0BwxB,EAAQvG,YAC1DuG,EAAQpX,aAERO,EAAKnQ,IAAIgnB,EAAQxxB,KAAO,wBAA0BwxB,EAAQvG,kBAI/C,IAAnBwG,EACAD,EAAQrX,UAAUsX,GAEdD,EAAQpX,WACRxV,KAAK4F,IAAIgnB,EAAQxxB,KAAO,mCAAqCwxB,EAAQvG,WAAa,iCAClFuG,EAAQpX,aAERxV,KAAK4F,IAAIgnB,EAAQxxB,KAAO,mCAAqCwxB,EAAQvG,WAAa,wBAGnFwG,IAEXlQ,eAAgB,SAAS7D,EAAMC,EAASgU,GACpC,IAAIhX,EAAO/V,KAAM4Y,EAAOhZ,GAAGsM,cAAe2M,GAAQ,EAAGzd,EAAOwE,GAAG4Q,YAAYsI,GAAOkU,EAAalU,EAAKpO,MAAQoO,EAAMmU,EAAUjtB,KAAKktB,sBAAwBltB,KAAKktB,sBAAwBttB,GAAGvD,KAAK0Z,EAAKoX,sBAAuBpX,IACrNnW,GAAGuI,QAAQ6kB,IAAeA,EAAWnU,MAAQ,IAC9CA,EAAOmU,EAAWnU,MAEtBoU,EAAQD,EAAY5xB,EAAMwd,EAAMC,EAAMkU,EAAoBhU,EAAS/Y,KAAK4c,SAASsI,QAAQC,SAAU,CAC/FvH,WAAY7H,EAAK8H,YACjBwH,YAAatP,EAAK0L,aAClB2L,iBAAkB,SAAS9U,EAAIQ,GAC3B/C,EAAKgI,SAAS7O,IAAIoJ,EAAIQ,GACtB/C,EAAK8K,uBACL9K,EAAKsX,aAAa/U,OAI9B6U,sBAAuB,SAASrU,EAAM1d,EAAMwd,EAAMC,EAAMyU,EAAUvU,GAC9D,IAAIT,EAAKtY,KAAK6d,YAAYtF,QAAQ,CAC9BK,KAAMA,EACNxd,KAAMA,EACNyd,KAAMA,EACNE,QAASA,EACTD,KAAMA,IAEV9Y,KAAK+d,SAAS7O,IAAIoJ,EAAIQ,GACtB9Y,KAAKqtB,aAAa/U,GAClBtY,KAAK6gB,uBACLyM,EAAS5qB,KAAK,CACV4V,GAAIA,EACJQ,KAAMA,KAGdsN,oBAAqB,SAAS1b,EAAM6iB,GAChC,IAAIC,EAAY9iB,EAAKxK,KAAK0E,MAAM,KAAK,GAAIxJ,EAAOmyB,EACpC,MAARnyB,IACAA,EAAO4E,KAAK4c,SAASoJ,MAAMlJ,aAE/B1hB,GAAQ,IAAMoyB,EACdxtB,KAAKkc,SAAS,CACV9gB,KAAMA,EACNsP,KAAMA,KAGd+iB,qBAAsB,SAASnV,GAC3B,GAAItY,KAAKqgB,WAAW,CAChB/H,GAAIA,IACLG,SAAW7Y,GAAG6Y,OAAOmD,QAAS,CAC7B,IAAIxgB,EAAO4E,KAAK8d,QAAQxF,GACxBtY,KAAK6gB,uBACL7gB,KAAKygB,eACLzgB,KAAK+d,SAASoD,QAAQ7I,GACtBtY,KAAK6d,YAAY9D,UAAUzB,EAAI1Y,GAAG6Y,OAAOmD,SACzC5b,KAAK4F,IAAI,uBAAyBxK,EAAO,sBAGjDsyB,oBAAqB,SAASpV,EAAIqN,GAC9B,IAAIvqB,EAAO4E,KAAK8d,QAAQxF,GACxBtY,KAAK6d,YAAY9D,UAAUzB,EAAI1Y,GAAG6Y,OAAOiD,eACzC1b,KAAK4F,IAAI,uBAAyBxK,EAAO,gBAAiB,SACrDuqB,QAAyChiB,IAA7BgiB,EAASrT,gBAGtBtS,KAAK4c,SAAS8H,UAAUC,QAAQrM,EAAIld,EAAM,4CAA8CuqB,EAASlN,OAAQkN,GAFzG3lB,KAAK4c,SAAS8H,UAAUC,QAAQrM,EAAIld,EAAM,wBAAyBuqB,IAK3EgG,iBAAkB,SAASnT,GACvB,IAAIgJ,EAASxhB,KAAKunB,oBAAoB,CAClCC,OAAQhP,EAAKiP,WAAWxR,YACxByR,kBAAmBlP,EAAKiP,WAAWC,kBACnCxpB,QAASsa,EAAKta,QACdiY,QAASqC,EAAKrC,QACdlN,SAAUuP,EAAKvP,SACfsN,MAAOiC,EAAK4P,iBAEhBpoB,KAAKurB,kBAAkB/J,EAAOjK,eAAiBiB,GAEnDmV,0BAA2B,WACvB3tB,KAAK4tB,aAAehuB,GAAGiuB,aAAe,IAAIjuB,GAAGiuB,YAAY7tB,KAAK4c,SAASjN,KAAM/P,GAAGvD,KAAK2D,KAAK6jB,kBAAmB7jB,MAAOJ,GAAGvD,KAAK2D,KAAK4F,IAAK5F,OAClIA,KAAK4tB,cAAgB5tB,KAAK4tB,aAAaE,gBACvC9tB,KAAKyhB,aAAezhB,KAAKsmB,aAAatmB,KAAK4c,SAASsI,QAAQlJ,OAAQhc,KAAK4tB,aAAaG,uBACtF/tB,KAAK4c,SAASoR,WAAahuB,KAAK4tB,aAAaK,cACzCjuB,KAAK4tB,aAAaM,cAClBluB,KAAK4c,SAASsI,QAAQjJ,SAAWjc,KAAK4tB,aAAaM,cAGvDluB,KAAKyhB,aAAezhB,KAAKsmB,aAAatmB,KAAK4c,SAASsI,QAAQlJ,SAGpEmS,kBAAmB,WACf,SAAKvuB,GAAGilB,0BAA4B7kB,KAAK4c,SAAS2B,WAAWF,YAGzDre,KAAK4c,SAAS2I,KAAK6I,aACfxuB,GAAGwR,kBAAkBsC,sBAGrB9T,GAAGwR,kBAAkBqC,oBAAqBzT,KAAK4c,SAAS2I,KAAK8I,aAOzEpG,oBAAqB,SAASqG,EAAS5d,GACnC,IAAI6d,GAAQ,EACZ,OAAKD,EAAQrpB,SAGbrF,GAAG4C,KAAK8rB,GAAS,SAAS7rB,EAAK+rB,GAC3B,GAAI5uB,GAAG+G,SAAS6nB,GAAa,CACzB,IAAIC,EAAW,IAAI9sB,OAAO,MAAQ6sB,EAAa,IAAK,KACpD,GAAgC,MAA5B9d,EAASuC,MAAMwb,GAEf,OADAF,GAAQ,GACD,MAIZA,IAEXzK,WAAY,SAAS4K,EAAMC,EAAkBloB,GACzC,IAAkNmoB,EAAsBC,EAApOhpB,EAAU7F,KAAK4c,SAASkS,SAASJ,GAAOhH,EAAoB,GAAIqH,EAAQ,GAAG/wB,OAAO2wB,GAAmBvzB,EAAO2zB,EAAM,GAAIjZ,EAAW9V,KAAKwkB,aAAa/d,GAAOuoB,EAAiBhvB,KAAKmsB,mBAAmBrW,GACvM,SAASna,EAAEP,EAAM6zB,GACbppB,EAAUA,EAAQ7D,QAAQ5G,EAAM6zB,GAmBpC,OAjBArvB,GAAG4C,KAAKwsB,EAAetH,mBAAmB,SAASjlB,EAAKysB,GAChDtvB,GAAG+G,SAASuoB,IACZxH,EAAkBhlB,KAAKwsB,MAG/BN,EAAuBlH,EAAkBpY,KAAK,MAAM9G,cACpD7M,EAAE,SAAUqE,KAAK4c,SAASuS,eAAe/zB,IACzCO,EAAE,eAAgBizB,GAClBjzB,EAAE,cAAeqE,KAAKkrB,YAAY8D,EAAeI,YACjDzzB,EAAE,iBAAkBqE,KAAKkrB,YAAY8D,EAAeK,eAE3B,QADzBR,EAAmBhpB,EAAQoN,MAAM,gBAE7BrT,GAAG4C,KAAKqsB,GAAkB,SAASpsB,EAAK6sB,GACpC3zB,EAAE2zB,EAAaP,EAAMtsB,OAG7BzC,KAAK4c,SAAS8H,UAAUC,QAAQ,KAAMvpB,EAAMyK,OAASlC,GAC9CkC,GAEXsc,aAAc,SAAS7J,EAAInK,GACvB,GAAInO,KAAKuvB,qBAAqBjX,GAQ1B,OAPAtY,KAAK6gB,uBACL7gB,KAAK6d,YAAY9D,UAAUzB,EAAI1Y,GAAG6Y,OAAO8C,iBACrCpN,EACAA,EAASmK,GAETtY,KAAK+d,SAASmE,MAAM5J,IAEjB,GAGf+O,kBAAmB,SAAS/O,EAAIG,GAC5B,IAAI1C,EAAO/V,KAAMwvB,EAAcxvB,KAAKksB,kBAChCzT,IAAW7Y,GAAG6Y,OAAO+C,kBACrBxb,KAAK8hB,+BAA+Bpf,KAAK4V,GAClCG,IAAW7Y,GAAG6Y,OAAOgD,eAAiBhD,IAAW7Y,GAAG6Y,OAAOwC,UAAYxC,IAAW7Y,GAAG6Y,OAAO0C,UACnGnb,KAAK+hB,4BAA4Brf,KAAK4V,GAEtB,IAAhBkX,IAAsBxvB,KAAK8hB,+BAA+B7c,QAAUjF,KAAK+hB,4BAA4B9c,SACrGqiB,YAAW,YACHvR,EAAK+L,+BAA+B7c,QAAU8Q,EAAKgM,4BAA4B9c,SAC/E8Q,EAAK0Z,eAAe1Z,EAAK+L,+BAAgC/L,EAAKgM,+BAEnE,IAGXxF,iCAAkC,WAC9B,IAAIxG,EAAO/V,KACX,GAAIA,KAAK4c,SAASkL,YAAY4H,mBAAqB9vB,GAAG4N,UAAY5N,GAAG8N,YAIjE,MAHA4Z,YAAW,WACPjiB,OAAOsqB,MAAM5Z,EAAK6G,SAASkS,SAASc,gCACrC,GACG,IAAIhwB,GAAGN,MAAMU,KAAK4c,SAASkS,SAASc,+BAGlDC,8BAA+B,SAASvX,EAAIld,EAAM00B,EAAU7G,GACxD,IAAK6G,EAAS5kB,QACV,GAAI+d,GAAsB,MAAfA,EAAIxQ,SAAmBqX,EAASvmB,MACvCvJ,KAAK4c,SAAS8H,UAAUC,QAAQrM,EAAIld,EAAM,8BAAgC6tB,EAAIxQ,OAAQwQ,OACnF,CACH,IAAI8G,EAAcD,EAASvmB,MAAQumB,EAASvmB,MAAQvJ,KAAK4c,SAAS1Z,KAAK8sB,qBACvEhwB,KAAK4c,SAAS8H,UAAUC,QAAQrM,EAAIld,EAAM20B,EAAa9G,KAInEgH,6CAA8C,SAASC,EAAWxmB,EAAO+P,EAAOuC,EAAQC,GACpF,IAAIlG,EAAO/V,KACX,GAAI0J,EAAMzE,OAASwU,EACf,GAAIyW,IAAclwB,KAAK4c,SAAS6K,WAAW0I,uBACvC7I,YAAW,WACP,IAAI8I,EAAuBra,EAAKqW,yBAAyB1iB,EAAM+P,IAAS3D,EAAWC,EAAKyO,aAAa9a,EAAM+P,GAAOX,MAAO0I,EAASzL,EAAK8J,WAAW/J,GAClJC,EAAKmQ,uBAAuB,CACxB9qB,KAAM,aACN+S,SAAUvO,GAAGvD,KAAK0Z,EAAK6G,SAAS8H,UAAU2L,WAAYta,EAAMqa,EAAsB5O,GAClFjM,UAAW3V,GAAGvD,KAAK0Z,EAAKua,2BAA4Bva,EAAMrM,EAAO+P,EAAOuC,EAAQC,GAChFzG,UAAW5V,GAAGvD,KAAK0Z,EAAKwa,2BAA4Bxa,EAAMrM,EAAO+P,EAAOuC,EAAQC,GAChFoK,WAAY,SAAW+J,EAAqBh1B,KAAO,YAAcg1B,EAAqBvX,SAE3F,QACA,IAAKqX,EACR,KAAMzW,EAAQ/P,EAAMzE,OAAQwU,IACxB1D,EAAKkV,oBAAoBvhB,EAAM+P,GAAOnB,KAKtDmX,eAAgB,SAASe,EAAYC,GACjCzwB,KAAKgiB,gBAAkBhiB,KAAKgiB,eAAe0O,cAAcF,EAAYC,EAAQzwB,KAAKshB,iBAClFthB,KAAK4c,SAAS8H,UAAUgM,cAAc9wB,GAAG2B,OAAO,GAAIivB,GAAa5wB,GAAG2B,OAAO,GAAIkvB,IAC/EzwB,KAAK8hB,+BAAiC,GACtC9hB,KAAK+hB,4BAA8B,IAEvCwI,aAAc,SAASjS,EAAIld,EAAMkvB,EAAcrB,EAAK9a,GAChD,IAAI4H,EAAO/V,KAEX,GADA+V,EAAKuL,gBAAgBhJ,GAAMgS,EAAavU,EAAK6G,SAASsF,MAAMyG,8BACxD5S,EAAK4a,iBAAiBrY,GAAK,CAC3B,IAAIsY,EAAyD,IAAvC7a,EAAK6G,SAASsF,MAAM2O,iBAa1C,OAZA9a,EAAK8Z,8BAA8BlhB,MAAMoH,EAAM1O,WAC/C0O,EAAK6G,SAAS8H,UAAU2F,YAAY/R,EAAIld,EAAM2a,EAAKqL,aAAa9I,IAChEvC,EAAK+a,mBAAmBxY,EAAIld,GAC5B2a,EAAK8H,YAAY9D,UAAUzB,EAAI1Y,GAAG6Y,OAAO8C,iBACzCxF,EAAKsL,eAAe/I,GAAMgP,YAAW,WACjCvR,EAAKnQ,IAAI,sBAAwBxK,EAAO,OACpC+S,EACAA,EAASmK,GAETvC,EAAKgI,SAASmE,MAAM5J,KAEzBsY,IACI,IAGfE,mBAAoB,SAASxY,EAAIld,GAC7B4E,KAAK4F,IAAI,WAAa5F,KAAK4c,SAASsF,MAAM2O,iBAAmB,4BAA8Bz1B,EAAO,QAEtGm0B,qBAAsB,SAASjX,GAC3B,IAAwC5H,EAApCqgB,EAAY/wB,KAAK4gB,kBACrB,OAAI5gB,KAAKshB,gBAAgBhJ,IACrBtY,KAAK4F,IAAI,gCAAkC0S,EAAI,SACxC,GACAtY,KAAK+d,SAASY,QAAQrG,IAC7B5H,EAAW1Q,KAAK8d,QAAQxF,IACoC,IAAxDtY,KAAK4c,SAAS8H,UAAUsM,cAAc1Y,EAAI5H,KAG1CqgB,EAAY,GAAK/wB,KAAK6gB,qBAAuB,EAAIkQ,GACjD/wB,KAAK8jB,WAAW,0BACT,IAEX9jB,KAAK4F,IAAI,wBAA0B8K,EAAW,UAAY4H,EAAK,SACxD,MAEPtY,KAAK4F,IAAI,IAAM0S,EAAK,2BAA4B,UACzC,IAGfgR,UAAW,SAAShR,EAAIld,GACpB4E,KAAK6gB,uBACLoQ,aAAajxB,KAAKqhB,eAAe/I,IACjC,IAAI4Y,EAAkBtxB,GAAGiF,QAAQ7E,KAAKwc,WAAYlE,IAC7CtY,KAAK4c,SAASoR,YAAckD,GAAmB,GAChDlxB,KAAKwc,WAAWrC,OAAO+W,EAAiB,GAE5ClxB,KAAK6d,YAAY9D,UAAUzB,EAAI1Y,GAAG6Y,OAAO0C,WAE7CgO,YAAa,SAAS7Q,EAAIld,EAAMgH,EAAQ6mB,GAepC,OAdK7mB,EAAO8I,SAOJ9I,EAAOgiB,eACPpkB,KAAKqf,eAAe/G,GAAMlW,EAAOgiB,cAErCpkB,KAAKygB,eACLzgB,KAAK6d,YAAY9D,UAAUzB,EAAI1Y,GAAG6Y,OAAO+C,qBAVzCxb,KAAK6gB,uBACL7gB,KAAK6d,YAAY9D,UAAUzB,EAAI1Y,GAAG6Y,OAAOgD,gBACwB,IAA7DrZ,EAAOpC,KAAK4c,SAASsF,MAAMyG,gCAC3B3oB,KAAKshB,gBAAgBhJ,IAAM,IASnCtY,KAAK6vB,8BAA8BvX,EAAIld,EAAMgH,EAAQ6mB,KAC9C7mB,EAAO8I,SAElBua,UAAW,SAASnN,GAChBtY,KAAK6d,YAAY9D,UAAUzB,EAAI1Y,GAAG6Y,OAAOkD,WAE7CgI,kBAAmB,SAASrL,EAAIqN,EAAUC,GAC3B5lB,KAAK8d,QAAQxF,GACpBsN,EACA5lB,KAAK0tB,oBAAoBpV,EAAIqN,GAE7B3lB,KAAKytB,qBAAqBnV,IAGlC6P,eAAgB,SAASrf,GACrB,IAAIqoB,EACJ,GAAIvxB,GAAGwR,kBAAkBgC,cAAe,CACpC,IAAK+d,EAAY,EAAGA,EAAYroB,EAAM0U,MAAMvY,OAAQksB,IAChDnxB,KAAKqkB,sBAAsBvb,EAAM0U,MAAM2T,GAAYroB,GAEvD9I,KAAKkc,SAASpT,EAAM0U,YACb1U,EAAMhN,MAAMmJ,OAAS,GAC5BjF,KAAKkc,SAASpT,GAElBlJ,GAAG4C,KAAKxC,KAAKuhB,UAAU,SAAS9e,EAAK+e,GACjCA,EAAO5J,YAGfmR,YAAa,SAASzQ,EAAIld,EAAMytB,EAAQC,GACpC9oB,KAAKgiB,gBAAkBhiB,KAAKgiB,eAAeoP,qBAAqB9Y,EAAIuQ,EAAQC,IAEhFuI,UAAW,SAAS/Y,EAAIld,KACxBk2B,yBAA0B,SAAShZ,EAAIld,GACnC4E,KAAKqxB,UAAU1iB,MAAM3O,KAAMqH,WAC3BrH,KAAK6d,YAAY9D,UAAUzB,EAAI1Y,GAAG6Y,OAAOuC,WACzChb,KAAKuxB,aAAa5iB,MAAM3O,KAAMqH,WAC1BrH,KAAK4c,SAASoR,YACdhuB,KAAK4c,SAAS8H,UAAU8M,YAAY7iB,MAAM3O,KAAMqH,WAChDrH,KAAKse,YAAYhG,KAEjBtY,KAAKyxB,eAAenZ,GACpBtY,KAAK4c,SAAS8H,UAAU8M,YAAY7iB,MAAM3O,KAAMqH,aAGxDmX,gBAAiB,SAASlG,EAAIoZ,EAAmBC,GAC7C,IAA6BC,EAAzBhZ,EAAO5Y,KAAK8gB,QAAQxI,GAIxB,OAHIoZ,IACAE,EAA4BhyB,GAAGvD,KAAKq1B,EAAmB1xB,KAAMsY,EAAIM,EAAM+Y,IAEvE3xB,KAAKmuB,qBACLnuB,KAAKkmB,uBAAuB,CACxB9qB,KAAM,iBACN+S,SAAUvO,GAAGvD,KAAK2D,KAAK4c,SAAS8H,UAAUmN,eAAgB7xB,KAAMsY,GAChE/C,UAAWqc,GAA6BhyB,GAAGvD,KAAK2D,KAAK8xB,eAAeC,WAAY/xB,KAAMsY,EAAIM,EAAM+Y,GAChGtL,WAAY/N,KAET,IAEPtY,KAAK4F,IAAI,iCAAmC0S,EAAK,wHAA8H,SACxK,IAGfiZ,aAAc,SAASjZ,KACvB0Z,iBAAkB,SAASnJ,EAAQC,GAC/B9oB,KAAK4c,SAAS8H,UAAUuN,gBAAgBpJ,EAAQC,IAEpDU,cAAe,SAASlR,KACxBoR,UAAW,SAASpR,EAAIld,GACpB4E,KAAK6d,YAAY9D,UAAUzB,EAAI1Y,GAAG6Y,OAAO4C,YAE7CyO,eAAgB,SAASxR,EAAIuR,KAC7BK,sBAAuB,SAAS5R,EAAIuR,IAC3B7pB,KAAKshB,gBAAgBhJ,IAAOtY,KAAK4c,SAASsF,MAAMgQ,aACjDlyB,KAAKohB,aAAa9I,GAAM,IAGhC8O,sBAAuB,SAAS9O,EAAI2B,EAAWD,GACvCA,IAAcpa,GAAG6Y,OAAO2C,QACxB6V,aAAajxB,KAAKqhB,eAAe/I,KAGzC6Z,gCAAiC,SAAS5F,GACtC,IAAIxW,EAAO/V,KACXJ,GAAG4C,KAAK+pB,GAAc,SAAS9pB,EAAK4pB,GAChCtW,EAAKkV,oBAAoBoB,EAAY/T,QAG7C8Z,gCAAiC,SAASC,EAAuB3oB,EAAOsS,EAAQC,EAAUuF,GACtF,IAAIoC,EAAcmN,EAAY/wB,KAAK4gB,kBAAmB0R,EAAmCtyB,KAAK6gB,qBAC5E,IAAdkQ,GAAmBuB,GAAoCvB,EACnDrnB,EAAMzE,OAAS,EACfjF,KAAKkmB,uBAAuB,CACxB9qB,KAAM,aACN+S,SAAUvO,GAAGvD,KAAK2D,KAAK4c,SAAS8H,UAAU2L,WAAYrwB,KAAMqyB,EAAsB,GAAI7Q,GACtFjM,UAAW3V,GAAGvD,KAAK2D,KAAKswB,2BAA4BtwB,KAAM0J,EAAO,EAAGsS,EAAQC,GAC5EzG,UAAW5V,GAAGvD,KAAK2D,KAAKuwB,2BAA4BvwB,KAAM0J,EAAO,EAAGsS,EAAQC,GAC5EoK,WAAY,SAAW3c,EAAM,GAAGoP,KAAK1d,KAAO,YAAcsO,EAAM,GAAGoP,KAAKD,OAG5E7Y,KAAK8jB,WAAW,iBAGpB9jB,KAAKmyB,gCAAgCzoB,GACrCka,EAAe5jB,KAAK4c,SAASkS,SAASyD,kBAAkBvwB,QAAQ,gBAAiBswB,GAAkCtwB,QAAQ,iBAAkB+uB,GAC7I/wB,KAAKykB,YAAYb,KAGzB2M,2BAA4B,SAAS7mB,EAAO+P,EAAOuC,EAAQC,GACvD,IAAIuW,EAAY/Y,EAAQ,EACxBzZ,KAAKirB,oBAAoBvhB,EAAM+P,GAAOnB,GAAI5O,EAAM+P,GAAOX,KAAK1d,MAC5D4E,KAAKiwB,8CAA6C,EAAOvmB,EAAO8oB,EAAWxW,EAAQC,IAEvFqU,2BAA4B,SAAS5mB,EAAO+P,EAAOuC,EAAQC,GACvD,IAAIlG,EAAO/V,KAAMwyB,EAAY/Y,EAAQ,EAAG2W,EAAuBpwB,KAAKosB,yBAAyB1iB,EAAM+P,IACnGzZ,KAAKyyB,wBAAwB/oB,EAAM+P,GAAQ2W,GAAsBpb,MAAK,WAClEe,EAAK2c,QAAQhpB,EAAM+P,GAAOnB,GAAI0D,EAAQC,GACtClG,EAAKka,8CAA6C,EAAMvmB,EAAO8oB,EAAWxW,EAAQC,MACnF,WACClG,EAAKka,8CAA6C,EAAOvmB,EAAO8oB,EAAWxW,EAAQC,OAG3FyB,uBAAwB,SAAShU,EAAOsS,EAAQC,GAC5C,GAAqB,IAAjBvS,EAAMzE,OAAV,CAIA,IAAIotB,EAAwBryB,KAAKssB,0BAA0B5iB,GAAQoM,EAAW9V,KAAKwkB,aAAa9a,EAAM,GAAGoP,MAAO0I,EAASxhB,KAAK6f,WAAW/J,GACzI9V,KAAKkmB,uBAAuB,CACxB9qB,KAAM,kBACN+S,SAAUvO,GAAGvD,KAAK2D,KAAK4c,SAAS8H,UAAUiO,gBAAiB3yB,KAAMqyB,EAAuB7Q,GACxFjM,UAAW3V,GAAGvD,KAAK2D,KAAKoyB,gCAAiCpyB,KAAMqyB,EAAuB3oB,EAAOsS,EAAQC,EAAUuF,GAC/GhM,UAAW5V,GAAGvD,KAAK2D,KAAKmyB,gCAAiCnyB,KAAM0J,GAC/D2c,WAAY,0BATZrmB,KAAK8jB,WAAW,iBAYxB8O,wBAAyB,WACrB,IAAI7c,EAAO/V,KACXA,KAAKqoB,gBAAgBpoB,OAAOoF,OAAQ,gBAAgB,SAASwI,GACzD,GAAIkI,EAAKmK,gBAGL,OAFArS,EAAIA,GAAKxI,OAAOwtB,OACd/kB,YAAciI,EAAK6G,SAASkS,SAASgE,QAChC/c,EAAK6G,SAASkS,SAASgE,YAI1CjR,oBAAqB,WACjB,IAAI9L,EAAO/V,KAAMzC,EAAUyC,KAAK4c,SAAS+E,QACrC/hB,GAAGmzB,SAA6C,MAAlC/yB,KAAK4c,SAAS+E,QAAQ1F,WAC/Bjc,KAAKgzB,WACNpzB,GAAG2B,OAAOhE,EAAS,CACfgoB,KAAMvlB,KAAK4c,SAAS2I,OAExBhoB,EAAQqI,IAAMhG,GAAGvD,KAAK2D,KAAK4F,IAAK5F,MAChCzC,EAAQ01B,cAAgBrzB,GAAGvD,KAAK2D,KAAKsc,eAAgBtc,MACrDA,KAAKgzB,SAAW,IAAIpzB,GAAGmzB,QAAQx1B,IAEnC+pB,YAAW,WACPvR,EAAKid,SAASE,UAAUle,MAAK,SAAS8a,EAAUnK,GAC5C5P,EAAKod,0BACLpd,EAAK6G,SAAS8H,UAAU0O,yBAAyBtD,GAAU,EAAMnK,MAClE,SAASmK,EAAUnK,GAClB5P,EAAK6G,SAAS8H,UAAU0O,yBAAyBtD,GAAU,EAAOnK,QAEvE,KAGXwN,wBAAyB,aACzBzI,SAAU,SAASpS,EAAIoC,GACnB1a,KAAK6d,YAAYpD,WAAWnC,EAAIoC,GAChC1a,KAAKgiB,gBAAkBhiB,KAAKgiB,eAAeqR,UAAU/a,IAEzDqY,iBAAkB,SAASrY,GACvB,IAAIsF,EAAa5d,KAAK6d,YAAY1E,SAAS,CACvCb,GAAIA,IAER,UAAKtY,KAAKshB,gBAAgBhJ,IAAOtY,KAAK4c,SAASsF,MAAMgQ,YAActU,EAAWnF,SAAW7Y,GAAG6Y,OAAO2C,cACjEzX,IAA1B3D,KAAKohB,aAAa9I,KAClBtY,KAAKohB,aAAa9I,GAAM,GAExBtY,KAAKohB,aAAa9I,GAAMtY,KAAK4c,SAASsF,MAAMoR,oBAC5CtzB,KAAKohB,aAAa9I,IAAO,GAClB,IAKnBmZ,eAAgB,SAASnZ,GACrBtY,KAAKwc,WAAW9Z,KAAK4V,IAEzB+U,aAAc,SAAS/U,GACnB,IAAIxC,GAEAA,EADAlW,GAAGwR,kBAAkBgC,cACVpT,KAAK+d,SAASwB,QAAQjH,GAAIiM,WAE1BvkB,KAAKwkB,aAAaxkB,KAAK+d,SAASzG,SAASgB,OAGpDtY,KAAK8f,qBAAqBxH,GAAMxC,IAGxCuN,4BAA6B,SAASkQ,GAClCvzB,KAAK4c,SAASjN,KAAKzR,QAAUq1B,EAC7BvzB,KAAK4tB,aAAehuB,GAAGiuB,aAAe,IAAIjuB,GAAGiuB,YAAY7tB,KAAK4c,SAASjN,KAAM/P,GAAGvD,KAAK2D,KAAK6jB,kBAAmB7jB,MAAOJ,GAAGvD,KAAK2D,KAAK4F,IAAK5F,OAClIA,KAAK4tB,cAAgB5tB,KAAK4tB,aAAaE,iBACvC9tB,KAAKyhB,aAAayF,YAAY,KAAMlnB,KAAK4tB,aAAaG,uBACtD/tB,KAAK4c,SAASoR,WAAahuB,KAAK4tB,aAAaK,cACzCjuB,KAAK4tB,aAAaM,aAClBluB,KAAKkjB,YAAYljB,KAAK4tB,aAAaM,eAI/CwE,QAAS,SAASpa,EAAI0D,EAAQC,GAC1B,IAAI7gB,EAAO4E,KAAK8d,QAAQxF,GACpB0D,GACAhc,KAAKyjB,UAAUzH,EAAQ1D,GAEvB2D,GACAjc,KAAKkjB,YAAYjH,EAAU3D,GAE/BtY,KAAKkmB,uBAAuB,CACxB9qB,KAAM,WACN+S,SAAUvO,GAAGvD,KAAK2D,KAAK4c,SAAS8H,UAAU8O,SAAUxzB,KAAMsY,EAAIld,GAC9Dma,UAAW3V,GAAGvD,KAAK2D,KAAKsxB,yBAA0BtxB,KAAMsY,EAAIld,GAC5Doa,UAAW5V,GAAGvD,KAAK2D,KAAKirB,oBAAqBjrB,KAAMsY,EAAIld,GACvDirB,WAAY/N,KAGpBgG,YAAa,SAAShG,GACbtY,KAAK+d,SAAS3U,OAAOkP,IACtBtY,KAAK6d,YAAY9D,UAAUzB,EAAI1Y,GAAG6Y,OAAOyC,SAGjD6I,mBAAoB,WAEhB,IADA,IAAI0P,EAAYC,EAAiB3d,EAAO/V,KACjCA,KAAKwc,WAAWvX,QACnBwuB,EAAazzB,KAAKwc,WAAWzL,QAC7B/Q,KAAKse,YAAYmV,IAErBC,EAAkB1zB,KAAKqgB,WAAW,CAC9B5H,OAAQ7Y,GAAG6Y,OAAOC,aACnBzT,UAECrF,GAAGgG,IAAI,qBAAuB8tB,EAAkB,yEAChDpM,YAAW,WACPvR,EAAKgO,uBACN,OAGX0O,wBAAyB,SAASpG,EAAa+D,GAC3C,IAAIra,EAAO/V,KAAM8Y,EACTuT,EAAYvT,gBAAgBlZ,GAAG8V,UACxB2W,EAAYvT,KAAKnD,cAErB0W,EAAYvT,KAClB1d,EAAOg1B,EAAqBh1B,KAAMyd,EAAOuX,EAAqBvX,KAAM/C,EAAW9V,KAAKwkB,aAAa6H,EAAYvT,MAAOkW,EAAiBhvB,KAAKmsB,mBAAmBrW,GAAW6d,EAAkB,IAAI/zB,GAAGoL,QAItM,OAHA2oB,EAAgB3e,MAAK,eAAe,WAChCe,EAAKkV,oBAAoBoB,EAAY/T,GAAIld,MAEzCwE,GAAGqI,cAAc6Q,KAAU9Y,KAAKioB,oBAAoB+G,EAAetH,kBAAmBtsB,IACtF4E,KAAK8jB,WAAW,YAAa1oB,EAAM0d,GAC5B6a,EAAgBvoB,WAEtBpL,KAAK4c,SAAS6K,WAAWmM,YAAuB,IAAT/a,EAIxCA,EAAO,GAAKmW,EAAeI,WAAavW,EAAOmW,EAAeI,WAC9DpvB,KAAK8jB,WAAW,YAAa1oB,EAAM0d,GAC5B6a,EAAgBvoB,WAEvByN,EAAO,GAAKA,EAAOmW,EAAeK,cAClCrvB,KAAK8jB,WAAW,eAAgB1oB,EAAM0d,GAC/B6a,EAAgBvoB,YAEvBxL,GAAGi0B,iBAAmBj0B,GAAGwR,kBAAkB4C,eAAiBpU,GAAG+H,OAAOmR,GACtE,IAAIlZ,GAAGi0B,gBAAgB/a,EAAMlZ,GAAGvD,KAAK0Z,EAAKnQ,IAAKmQ,IAAO+d,SAAS9E,EAAe+E,OAAO/e,KAAK2e,EAAgBzoB,SAAS,SAAS8oB,GACxHje,EAAK+N,WAAWkQ,EAAY,aAAc54B,EAAM0d,GAChD6a,EAAgBvoB,aAGpBuoB,EAAgBzoB,UAEbyoB,IAnBH3zB,KAAK8jB,WAAW,aAAc1oB,EAAM0d,GAC7B6a,EAAgBvoB,YAoB/B6oB,eAAgB,WACZ,IAAIle,EAAMme,EAAc1oB,EAWxB,IAAKA,KAVLuK,EAAO/V,KACPk0B,EAAe,SAAS94B,EAAM+S,EAAUhH,GACpC,IAAIgtB,EACJ,IACI,OAAOhmB,EAASQ,MAAMoH,EAAM5O,GAC9B,MAAOitB,GACLD,EAAWC,EAAUvuB,SAAWuuB,EAAUp3B,WAC1C+Y,EAAKnQ,IAAI,wBAA0BxK,EAAO,gBAAkB+4B,EAAU,WAGjEn0B,KAAK4c,SAAS8H,WACvB,WACI,IAAI2P,EAAcC,EAClBD,EAAe7oB,EACf8oB,EAAeve,EAAK6G,SAAS8H,UAAU2P,GACvCte,EAAK6G,SAAS8H,UAAU2P,GAAgB,WACpC,OAAOH,EAAaG,EAAcC,EAAcjtB,YALxD,KAl3ChB,GA83CA,WACI,aACAzH,GAAG20B,kBAAoB,SAASj5B,GAC5B,IAAIya,EAAO/V,KACXA,KAAK4c,SAAW,CACZqE,OAAO,EACPO,OAAQ,KACRvY,UAAU,EACV+b,eAAgB,EAChBwP,6BAA6B,EAC7BxG,YAAY,EACZyG,kBAAkB,EAClBvP,QAAS,CACLE,cAAe,GACfnJ,SAAU,iBACVyY,cAAe,aACfC,gBAAgB,EAChBzM,UAAW,SACXpD,OAAQ,OACR8P,mBAAmB,EACnB5Y,OAAQ,GACR6Y,cAAc,EACdC,oBAAoB,EACpBC,kBAAmB,kBACnB5P,SAAU,UAEdsC,WAAY,CACRC,kBAAmB,GACnB0H,UAAW,EACXC,aAAc,EACd0B,UAAW,EACXZ,wBAAwB,EACxBla,YAAa,KACb8d,MAAO,CACHiB,UAAW,EACXC,SAAU,EACVC,UAAW,EACXC,SAAU,GAEdvB,YAAY,GAEhBlP,UAAW,CACP8O,SAAU,SAASlb,EAAIld,KACvBo2B,YAAa,SAASlZ,EAAIld,KAC1B4tB,WAAY,SAAS1Q,EAAIld,EAAMkvB,EAAc8K,KAC7C1E,cAAe,SAASF,EAAYC,KACpCrH,SAAU,SAAS9Q,EAAIld,KACvBquB,SAAU,SAASnR,EAAIld,KACvBwuB,cAAe,SAAStR,EAAIld,EAAMyuB,KAClCI,qBAAsB,SAAS3R,EAAIuR,EAAWS,EAAcrB,KAC5DkB,SAAU,SAAS7R,EAAI5H,EAAUmZ,EAAWO,KAC5CxB,WAAY,SAAStQ,EAAIld,EAAMytB,EAAQC,KACvCmJ,gBAAiB,SAASpJ,EAAQC,KAClCnE,QAAS,SAASrM,EAAIld,EAAMukB,EAAQ0V,KACpChL,YAAa,SAAS/R,EAAIld,EAAMk6B,KAChCtE,cAAe,SAAS1Y,EAAIld,KAC5Bu3B,gBAAiB,SAAS4C,KAC1BlF,WAAY,SAASkF,KACrB1D,eAAgB,SAASvZ,KACzBkN,SAAU,SAASlN,KACnBoN,iBAAkB,SAASpN,EAAIqN,EAAUC,KACzCO,gBAAiB,SAASzb,KAC1BwO,eAAgB,SAASZ,EAAI2B,EAAWD,KACxCoZ,yBAA0B,SAAStD,EAAU5kB,EAASya,MAE1DmJ,SAAU,CACN0G,UAAW,qEACXC,UAAW,yDACXC,aAAc,4DACdC,WAAY,yDACZC,aAAc,sBACdrD,kBAAmB,6EACnBsD,oBAAqB,qBACrBC,mBAAoB,qBACpBC,oBAAqB,4BACrBC,mBAAoB,4BACpBC,sBAAuB,mDACvBnD,QAAS,8EACTlD,6BAA8B,6KAElC1N,MAAO,CACHgQ,YAAY,EACZoB,gBAAiB,EACjBzC,iBAAkB,EAClBlI,6BAA8B,gBAElChB,QAAS,CACLE,YAAa,yBACbD,YAAa,0BAEjBrU,SAAU,CACN8K,SAAS,EACT6X,WAAY,CACR7X,SAAS,GAEb8X,WAAW,EACXC,WAAY,CACRpM,UAAW,cACXqM,eAAgB,mBAChBC,UAAW,cACXC,cAAe,kBACfC,WAAY,gBAEhBC,SAAU,SAASne,GACf,OAAO,KAEXpN,QAAS,CACL+Q,SAAU,KACVuG,QAAS,SAASlK,GACd,OAAO,MAEXoe,aAAa,EACb5R,OAAQ,OACR9I,OAAQ,SAAS1D,GACb,OAAO,MAEXqe,cAAe,KAGvBtiB,OAAQ,CACJgK,SAAS,EACTuY,gBAAiB,EACjBR,WAAY,CACRS,SAAU,YAEdC,WAAY,SAASjY,GACjB,MAAO,KAGfsQ,eAAgB,SAAS4H,GACrB,OAAOA,GAEX7zB,KAAM,CACF8sB,qBAAsB,gCACtB5H,eAAgB,aAChB+C,YAAa,CAAE,KAAM,KAAM,KAAM,KAAM,KAAM,OAEjD5M,WAAY,CACRF,SAAS,EACTyG,OAAQ,SACR7I,SAAU,iBACVmJ,cAAe,GACfpJ,OAAQ,IAEZuJ,KAAM,CACF6I,UAAU,EACV4I,iBAAiB,EACjB3I,UAAU,GAEdxR,MAAO,CACHC,YAAa,aAEjBkJ,MAAO,CACHD,cAAe,KACfjJ,YAAa,gBAEjB4P,OAAQ,CACJrf,KAAK,EACLmU,OAAQ,MAEZgK,aAAc,GACd7J,QAAS,CACL1F,SAAU,KACVD,OAAQ,GACRoJ,cAAe,GACfxD,gBAAgB,GAEpBjS,KAAM,CACFzR,QAAS,UACT8vB,YAAY,EACZiJ,iBAAiB,GAErB3iB,QAAS,CACL4iB,cAAe,KACfC,cAAc,EACdC,QAAQ,EACRC,YAAa,KACbC,eAAgB,GAChBC,YAAa,kBACbC,aAAa,EACbC,MAAO,IAEX3P,YAAa,CACTE,gBAAgB,EAChB0H,mBAAmB,EACnB3H,kBAAkB,IAG1BnoB,GAAG2B,OAAOvB,KAAK4c,SAAUthB,GAAG,GAC5B0E,KAAKuhB,SAAW,GAChBvhB,KAAKurB,kBAAoB,GACzBvrB,KAAK8f,qBAAuB,GAC5B9f,KAAKi0B,iBACLj0B,KAAKqoB,gBAAkB,IAAIzoB,GAAG+Q,eAC9B3Q,KAAKwc,WAAa,GAClBxc,KAAKohB,aAAe,GACpBphB,KAAKqhB,eAAiB,GACtBrhB,KAAKshB,gBAAkB,GACvBthB,KAAKqf,eAAiB,GACtBrf,KAAK6gB,qBAAuB,EAC5B7gB,KAAKygB,aAAe,EACpBzgB,KAAK6d,YAAc7d,KAAKmnB,2BACxBnnB,KAAK2tB,4BACL3tB,KAAKyiB,oBAAsBziB,KAAKsmB,aAAatmB,KAAK4c,SAASsI,QAAQE,eACnEplB,KAAK6iB,8BAAgC7iB,KAAKsmB,aAAatmB,KAAK4c,SAAS2B,WAAW6G,eAChFplB,KAAKijB,uBAAyBjjB,KAAKsmB,aAAatmB,KAAK4c,SAAS2B,WAAWvC,QACzEhc,KAAKggB,eAAiBhgB,KAAKsmB,aAAatmB,KAAK4c,SAASsI,QAAQjJ,UAC9Djc,KAAK+iB,yBAA2B/iB,KAAKsmB,aAAatmB,KAAK4c,SAAS2B,WAAWtC,UAC3Ejc,KAAK+d,SAAW/d,KAAKsoB,uBACrBtoB,KAAK8xB,eAAiBlyB,GAAGilB,yBAA2B7kB,KAAK4kB,uBACrD5kB,KAAK4c,SAAS4E,SACdxhB,KAAK6rB,iBAAmB7rB,KAAKunB,oBAAoB,CAC7CrpB,QAAS8B,KAAK4c,SAAS4E,OACvBjL,MAAOvW,KAAK4c,SAAS1Z,KAAKklB,iBAC3B7Q,eAEPvX,KAAKsrB,4BACLtrB,KAAKysB,sBACDzsB,KAAK4c,SAASoJ,MAAMD,gBAChBnmB,GAAGkmB,aACH9lB,KAAK0hB,cAAgB1hB,KAAK6lB,sBAE1B7lB,KAAK4F,IAAI,iCAAkC,UAGnD5F,KAAK4c,SAAS6X,kBAAoBz0B,KAAK4yB,0BACvC5yB,KAAKof,gBAAkBxf,GAAG83B,gBAAkB,IAAI93B,GAAG83B,eAAe93B,GAAGvD,KAAK2D,KAAK4F,IAAK5F,OACpFA,KAAK6hB,sBACL7hB,KAAK8hB,+BAAiC,GACtC9hB,KAAK+hB,4BAA8B,GACnC/hB,KAAK23B,QAAU/3B,GAAG0iB,QAAU,IAAI1iB,GAAG0iB,OAAOtiB,KAAK4c,SAAStI,QAAS1U,GAAGvD,KAAK2D,KAAK4F,IAAK5F,QAAU,GACzFA,KAAK23B,QAAQtZ,UACbre,KAAKktB,sBAAwBttB,GAAGvD,KAAK2D,KAAK23B,QAAQC,cAAe53B,KAAK23B,UAEtE/3B,GAAGi4B,eAAiBj4B,GAAGwR,kBAAkBgD,cACzCpU,KAAKgiB,eAAiB,IAAIpiB,GAAGi4B,cAAcj4B,GAAGvD,KAAK2D,KAAKgyB,iBAAkBhyB,OAAO,SAASsY,GACtF,IAAIwf,EAAQ/hB,EAAK8H,YAAY1E,SAAS,CAClCb,GAAIA,IAER,OAAOwf,GAASA,EAAMjf,MAAQ,MAGtC7Y,KAAK4gB,kBAAoB5gB,KAAK4c,SAAS6K,WAAWsJ,UAClD/wB,KAAKiiB,uBAAyBjiB,KAAKsmB,gBAEvC1mB,GAAG20B,kBAAkB93B,UAAYmD,GAAGic,cACpCjc,GAAG2B,OAAO3B,GAAG20B,kBAAkB93B,UAAWmD,GAAGokB,gBAtPjD,GAwPApkB,GAAGm4B,cAAgB,SAASz8B,GACxB,aACA,IAAIsK,EAAKoyB,EAA6BC,EAAQ,GAAIC,EAAc,GAAI36B,EAAU,CAC1E46B,aAAc,KACdC,aAAc,CAAE,QAAS,OAAQ,OACjCtT,OAAQ,OACRuT,YAAa,oCACbrT,eAAgB,EAChBI,cAAe,GACfE,cAAe,GACfD,YAAa,GACbiT,eAAgB,GAChBC,oCAAoC,EACpCC,wBAAyB,CACrBC,OAAQ,CAAE,IAAK,IAAK,KACpBC,MAAO,CAAE,IAAK,IAAK,IAAK,IAAK,KAC7BC,KAAM,CAAE,IAAK,IAAK,IAAK,IAAK,KAC5BC,IAAK,CAAE,IAAK,IAAK,IAAK,IAAK,KAC3BC,IAAK,CAAE,MAEXtT,KAAM,CACF6I,UAAU,EACV4I,iBAAiB,GAErBpxB,IAAK,SAASsB,EAAKpB,KACnBgzB,OAAQ,SAASxgB,KACjB0Q,WAAY,SAAS1Q,EAAIqN,EAAUC,KACnCgD,WAAY,MAIhB,GAFAhpB,GAAG2B,OAAOhE,EAASjC,GACnBsK,EAAMrI,EAAQqI,IACVhG,GAAGiF,QAAQtH,EAAQ66B,aAAc76B,EAAQunB,QAAU,EACnD,MAAM,IAAIxlB,MAAM,IAAM/B,EAAQunB,OAAS,yDAe3C,SAASiU,EAAM9P,GACX,OAAO1rB,EAAQgoB,KAAK6I,eAAoCzqB,IAAxBslB,EAAI3W,gBAgBxC,SAAS0mB,EAAY1gB,EAAI2gB,GACrB,IAAItT,EAAWuS,EAAY5f,IAAO4f,EAAY5f,GAAI2Q,IAalD,OAZKtD,IAEGA,EADAsT,IAGI17B,EAAQgoB,KAAK6I,SApB7B,WACI,IAAIzI,EAWJ,OAVItgB,OAAOgE,gBAAkBhE,OAAOiE,qBAEC3F,KADjCgiB,EAAW/lB,GAAGuJ,qBACDmJ,mBACTqT,EAAW,IAAInT,gBACNvH,OAAS,aAClB0a,EAASxa,QAAU,aACnBwa,EAASuT,UAAY,aACrBvT,EAASwT,WAAa,cAGvBxT,EASgByT,GAEAx5B,GAAGuJ,qBAGtB+uB,EAAY5f,GAAI2Q,IAAMtD,GAEnBA,EAEX,SAAS0T,EAAQ/gB,GACb,IAAIzd,EAAI+E,GAAGiF,QAAQozB,EAAO3f,GAAK8S,EAAM7tB,EAAQynB,sBACtCkT,EAAY5f,GACnB2f,EAAM9d,OAAOtf,EAAG,GACZo9B,EAAMhzB,QAAUmmB,GAAOvwB,EAAIuwB,GAE3BkO,EADSrB,EAAM7M,EAAM,IAI7B,SAASpC,EAAW1Q,EAAIihB,GACpB,IAuH0BC,EAvHtBvQ,EAAM+P,EAAY1gB,GAAKwM,EAASvnB,EAAQunB,OAAQc,GAAuB,IAAb2T,EAC9DF,EAAQ/gB,GACJsN,EACAhgB,EAAIkf,EAAS,gBAAkBxM,EAAK,cAAe,SAC3CygB,EAAM9P,KAmHQuQ,EAnHsBvQ,EAAIxQ,OAoH7C7Y,GAAGiF,QAAQtH,EAAQi7B,wBAAwBj7B,EAAQunB,QAAS0U,IAAiB,KAnHhF5T,GAAU,EACVhgB,EAAIkf,EAAS,gBAAkBxM,EAAK,+BAAiC2Q,EAAIxQ,OAAQ,UAErFlb,EAAQyrB,WAAW1Q,EAAI2Q,EAAKrD,GAqBhC,SAAS0T,EAAYhhB,EAAImhB,GACrB,IAAuHC,EAAnHzQ,EAAM+P,EAAY1gB,EAAImhB,GAAS3U,EAASvnB,EAAQunB,OAAQ9I,EApBhE,SAAmB1D,GACf,IAAgG0D,EAA5F2d,EAAiBzB,EAAY5f,GAAIshB,iBAAkBtB,EAAiB/6B,EAAQ+6B,eAgBhF,OAfI/6B,EAAQ8nB,YAAY3pB,MACpBsgB,EAASze,EAAQ8nB,YAAY3pB,IAAI4c,IAEjCqhB,GACA/5B,GAAG4C,KAAKm3B,GAAgB,SAASv+B,EAAMsC,IACnCse,EAASA,GAAU,IACZ5gB,GAAQsC,KAGnB46B,GACA14B,GAAG4C,KAAK81B,GAAgB,SAASl9B,EAAMsC,IACnCse,EAASA,GAAU,IACZ5gB,GAAQsC,KAGhBse,EAG8D6d,CAAUvhB,GAAKwhB,EAAU5B,EAAY5f,GAAIwhB,QA2B9G,OA1BAv8B,EAAQu7B,OAAOxgB,GACfohB,EA2BJ,SAAmBphB,EAAI0D,EAAQ+d,GAC3B,IAAI9d,EAAW1e,EAAQ+nB,cAAc5pB,IAAI4c,GAAK0hB,EAAY9B,EAAY5f,GAAI0hB,UACzDr2B,MAAbq2B,IACA/d,GAAY,IAAM+d,GAElBhC,GAA+Bhc,IAC/BC,EAAWrc,GAAGgP,QAAQoN,EAAQC,IAE9B8d,IACA9d,EAAWrc,GAAGgP,QAAQmrB,EAAuB9d,IAEjD,OAAOA,EAtCDge,CAAU3hB,EAAI0D,EAAQkc,EAAY5f,GAAIyhB,uBACxChB,EAAM9P,IACNA,EAAIhe,OAuDZ,SAA2BqN,GACvB,OAAO,WACH0Q,EAAW1Q,IAzDE4hB,CAAkB5hB,GAC/B2Q,EAAI9d,QA2DZ,SAA4BmN,GACxB,OAAO,WACH0Q,EAAW1Q,GAAI,IA7DD6hB,CAAmB7hB,IAEjC2Q,EAAImR,mBAmCZ,SAAuC9hB,GACnC,OAAO,WACgC,IAA/B0gB,EAAY1gB,GAAI+hB,YAChBrR,EAAW1Q,IAtCUgiB,CAA8BhiB,GA0C/D,SAAmCA,GAC/B,IAAIsQ,EAAarrB,EAAQqrB,WACrBA,IACAoQ,EAAY1gB,GAAIlP,OAAO+vB,WAAa,SAAStrB,GACrCA,EAAE0sB,kBACF3R,EAAWtQ,EAAIzK,EAAEgb,OAAQhb,EAAEib,SA7CvC0R,CAA0BliB,GAC1B2Q,EAAIwR,KAAK3V,EAAQ4U,GAAK,GAClBn8B,EAAQgoB,KAAK6I,UAAY7wB,EAAQgoB,KAAKyR,kBAAoB+B,EAAM9P,KAChEA,EAAI3W,iBAAkB,GAyD9B,SAAoBgG,GAChB,IAAI2Q,EAAM+P,EAAY1gB,GAAK8M,EAAgB7nB,EAAQ6nB,cAAesV,EAAkBxC,EAAY5f,GAAIqiB,mBAAqB,GAAI7V,EAASvnB,EAAQunB,OAAQ8V,EAAa,GAC9J7B,EAAM9P,KACP1rB,EAAQ46B,cAAgBlP,EAAI4R,iBAAiB,SAAUt9B,EAAQ46B,cAC3D56B,EAAQg7B,qCACHh7B,EAAQgoB,KAAK6I,UA/JnBxuB,GAAGiF,QAAQ,CAAE,MAAO,OAAQ,QAAUtH,EAAQunB,SAAW,IAG5DgW,GAAoB,EACxBl7B,GAAG4C,KAAKs4B,GAAmB,SAASr4B,EAAKs4B,GACrC,GAAIn7B,GAAGiF,QAAQ,CAAE,SAAU,kBAAmB,mBAAoB,gBAAkBk2B,GAAU,EAE1F,OADAD,GAAoB,GACb,MAGRA,KAsJK7R,EAAI4R,iBAAiB,mBAAoB,kBACzC5R,EAAI4R,iBAAiB,gBAAiB,eAG1Ct9B,EAAQ86B,aAA2B,SAAXvT,GAAgC,QAAXA,GAC7CmE,EAAI4R,iBAAiB,eAAgBt9B,EAAQ86B,aAEjDz4B,GAAG2B,OAAOq5B,EAAYh7B,GAAGsG,WAAWkf,GAAiBA,EAAc9M,GAAM8M,GACzExlB,GAAG2B,OAAOq5B,EAAYF,GACtB96B,GAAG4C,KAAKo4B,GAAY,SAASx/B,EAAMsC,GAC/BurB,EAAI4R,iBAAiBz/B,EAAMsC,OAxKvC,IACQo9B,EAgGJE,CAAW1iB,GACX1S,EAAI,WAAakf,EAAS,gBAAkBxM,GACxCwhB,EACA7Q,EAAIgS,KAAKnB,GACF9B,IAAgChc,EACvCiN,EAAIgS,OACGjf,GAAUze,EAAQ86B,aAAe96B,EAAQ86B,YAAY7vB,cAAc3D,QAAQ,sCAAwC,EAC1HokB,EAAIgS,KAAKr7B,GAAGgP,QAAQoN,EAAQ,KACrBA,GAAUze,EAAQ86B,aAAe96B,EAAQ86B,YAAY7vB,cAAc3D,QAAQ,qBAAuB,EACzGokB,EAAIgS,KAAKjrB,KAAKkrB,UAAUlf,IAExBiN,EAAIgS,KAAKjf,GAENiN,EA8EX+O,EAAiD,QAAnBz6B,EAAQunB,QAAuC,WAAnBvnB,EAAQunB,OAClEllB,GAAG2B,OAAOvB,KAAM,CACZm7B,cAAe,SAAS7iB,GACpB,IAAI8iB,EAAMpf,EAAQwG,EAASsX,EAASuB,EAAatB,EACjD,MAAO,CACHuB,SAAU,SAASC,GAEf,OADAH,EAAOG,EACAv7B,MAEXw7B,WAAY,SAAS5B,GAEjB,OADA5d,EAAS4d,EACF55B,MAEXy7B,gBAAiB,SAASC,GAEtB,OADA3B,EAAwB2B,EACjB17B,MAEX27B,YAAa,SAAShB,GAElB,OADAnY,EAAUmY,EACH36B,MAEX47B,YAAa,SAASC,GAElB,OADA/B,EAAU+B,EACH77B,MAEX87B,gBAAiB,WAEb,OADAT,GAAc,EACPr7B,MAEXi7B,KAAM,SAASxB,GAIX,OAHI4B,GAAez7B,GAAGiF,QAAQ,CAAE,MAAO,UAAYtH,EAAQunB,SAAW,IAClE9I,EAAO+f,aAAc,IAAIC,MAAOC,WA5CpD,SAAuB3jB,EAAImhB,EAAQO,EAAWJ,EAAkBG,EAAuBY,EAAmBb,GAStG,GARA5B,EAAY5f,GAAM,CACd0hB,UAAWA,EACXJ,iBAAkBA,EAClBG,sBAAuBA,EACvBY,kBAAmBA,EACnBb,QAASA,GAEH7B,EAAMv1B,KAAK4V,IACV/a,EAAQynB,eACf,OAAOsU,EAAYhhB,EAAImhB,GAoCRyC,CAAc5jB,EAAImhB,EAAQ2B,EAAMpf,EAAQ+d,EAAuBvX,EAASsX,MAI3FqC,SAAU,SAAS7jB,GACf+gB,EAAQ/gB,OAIpB1Y,GAAGw8B,cAAgB,SAAS5jB,GACxB,aACA,IAAI6jB,EAAQ7jB,EAAK6jB,MAAOC,EAAY,GAAIlT,EAAWiT,EAAMjT,SAAUtL,EAAUue,EAAMve,QACnFle,GAAG2B,OAAOvB,KAAM,CACZkP,IAAK,SAASoJ,EAAIikB,GACdD,EAAUhkB,GAAMikB,EAChBD,EAAUhkB,GAAIxJ,KAAO,IAEzB6O,OAAQ,SAASrF,GACb,IAAIvC,EAAO/V,KAAMqpB,EAA2B,IAAIzpB,GAAGoL,QAA4Boe,EAAS9Q,EAAIwF,EAAQxF,GAAK+Q,GAC1FrU,MAAK,WACZe,EAAK4I,QAAQrG,KACbgkB,EAAUhkB,GAAI6jB,UAAW,EACzBpmB,EAAKoL,QAAQ7I,IAEjB+Q,EAAyBne,cAGjCiW,QAAS,SAAS7I,UACPgkB,EAAUhkB,IAErBkkB,oBAAqB,SAASlkB,GAC1B,OAAOgkB,EAAUhkB,GAAIlc,KAEzBuiB,QAAS,SAASrG,GACd,YAAyB3U,IAAlB24B,EAAUhkB,IAErBV,MAAO,WACH0kB,EAAY,IAEhBG,cAAe,SAASnkB,GACpB,OAAOgkB,EAAUhkB,IAErBokB,qBAAsB,SAASpkB,EAAIqkB,GAC/BL,EAAUhkB,GAAIlc,IAAMugC,GAExBC,aAAc,SAAStkB,GACnB,QAASgkB,EAAUhkB,GAAI6jB,aAInCv8B,GAAGorB,wBAA0B,SAAS1vB,EAAGktB,GACrC,aACA,IAA+FqU,EAAsBj3B,EAAKqnB,EAuflH6C,EAvfJgN,EAAa98B,KAAM+8B,GAAmB,EAAOC,GAA6B,EAAqDz/B,EAAU,CACzI8nB,YAAa,GACbL,eAAgB,EAChBzR,SAAU,CACN8K,SAAS,EACTpV,SAAU,CACNoV,SAAS,IAGjBzY,IAAK,SAASsB,EAAKpB,KACnB8iB,WAAY,SAAStQ,EAAI5H,EAAUmY,EAAQC,KAC3CE,WAAY,SAAS1Q,EAAI5H,EAAUof,EAAU7G,KAC7CG,SAAU,SAAS9Q,EAAI5H,KACvB6Y,aAAc,SAASjR,KACvBmR,SAAU,SAASnR,EAAI5H,KACvBkZ,cAAe,SAAStR,EAAI5H,EAAUmZ,KACtCI,qBAAsB,SAAS3R,EAAIuR,EAAWiG,EAAU7G,KACxDoB,YAAa,SAAS/R,EAAI5H,EAAUof,EAAU7G,KAC9CkB,SAAU,SAAS7R,EAAI5H,EAAUmZ,EAAWO,KAC5CI,cAAe,SAASlS,EAAI+B,KAC5ByD,QAAS,SAASxF,KAClBmS,QAAS,SAASnS,EAAIoC,KACtBkQ,SAAU,SAAStS,KACnBwC,mBAAoB,SAASxC,KAC7ByC,cAAe,SAASzC,KACxBuS,aAAc,SAASvS,MACxB2kB,EAAU,CACTxnB,KAAM,SAAS6C,EAAI4kB,EAAUpN,EAAU7G,GACnC,IAAIY,EAAYoD,EAAQkQ,cAAc7kB,EAAI4kB,GAC1CjQ,EAAQwP,cAAcnkB,GAAI8kB,kBAAmB,SACtCnQ,EAAQwP,cAAcnkB,GAAIxJ,KAAKuuB,cAAcH,GACpDjQ,EAAQwP,cAAcnkB,GAAIuQ,QAAUgB,EAAUhR,KAC9Ctb,EAAQ0sB,qBAAqB3R,EAAI2U,EAAQqQ,yBAAyBzT,GAAYiG,EAAU7G,IAE5FsU,SAAU,SAASjlB,GACf,IAAIO,EAAOtb,EAAQgjB,QAAQjI,GAAKld,EAAOmC,EAAQugB,QAAQxF,GACvD1S,EAAI,qCAAuC0S,EAAK,qBAChD2U,EAAQuQ,eAAellB,GAAItD,MAAK,SAAS8a,EAAU7G,GAC/CrjB,EAAI,2BAA6B0S,GACjC,IAAImlB,EAAoBr0B,EAAOs0B,kBAAkB5N,GAAU,GAC3DvyB,EAAQqrB,WAAWtQ,EAAIld,EAAMyd,EAAMA,GACnCoU,EAAQ0Q,+BAA+BrlB,GACvClP,EAAOw0B,QAAQtlB,EAAImlB,EAAmBxU,MACvC,SAAS6G,EAAU7G,GAClB,IAAI4U,EAAqBz0B,EAAOs0B,kBAAkB5N,GAAU,GAC5DlqB,EAAI,yCAA2C0S,EAAK,MAAQulB,EAAmBt0B,MAAO,UAClFs0B,EAAmBjmB,OAASqR,GAAO1rB,EAAQgW,SAASrI,QAAQyrB,cAAc9xB,QAAQokB,EAAIxQ,SAAW,IACjGwkB,EAAQrlB,MAAMU,GAEb/a,EAAQ8sB,YAAY/R,EAAIld,EAAMyiC,EAAoB5U,IACnD7f,EAAOw0B,QAAQtlB,EAAIulB,EAAoB5U,OAInD6U,cAAe,SAASZ,EAAU5kB,EAAIwX,EAAU7G,GAC5C,IAAI7tB,EAAOmC,EAAQugB,QAAQxF,GAC3B1S,EAAI,qCAAuC0S,EAAK,WAAa4kB,GAC7DjQ,EAAQ8Q,iBAAiBzlB,EAAI4kB,GAC7B,IAAkEc,EAA9DC,EAAmB70B,EAAOs0B,kBAAkB5N,GAAU,GAC1D,GAAImO,EAAiBrmB,MACjBqlB,EAAQrlB,MAAMU,OACX,CACH,IAAI4lB,EAAwBjR,EAAQwP,cAAcnkB,GAAI/E,SAAS4qB,YAC/DH,EAAgBE,EAAwBt+B,GAAGiF,QAAQq5B,EAAuBhB,IAAa,IAClE,IACjBjQ,EAAQwP,cAAcnkB,GAAI/E,SAAS4qB,WAAWhkB,OAAO6jB,EAAe,GACpE/Q,EAAQwP,cAAcnkB,GAAI/E,SAAS6qB,UAAUC,QAAQnB,IAGxDjQ,EAAQwP,cAAcnkB,GAAIxJ,KAAKwvB,gBAC5BtB,IACA/P,EAAQwP,cAAcnkB,GAAIxJ,KAAKwvB,eAAgB,EAC/C14B,EAAIhG,GAAGqH,OAAO,mFAAoF+I,KAAKkrB,UAAU3/B,OAAO6C,KAAK6uB,EAAQsR,SAASjmB,KAAOtI,KAAKkrB,UAAUjO,EAAQwP,cAAcnkB,GAAI/E,SAAS4qB,cACvMv+B,GAAG4C,KAAKyqB,EAAQsR,SAASjmB,IAAK,SAASkmB,EAAMC,GACzC74B,EAAIhG,GAAGqH,OAAO,sDAAuDqR,EAAIkmB,EAAMC,EAAMpE,aACrFoE,EAAMC,QACND,EAAME,YAAa,KAEvB1R,EAAQ2R,0BAA0BtmB,GAClCumB,EAAkBC,KAAKxmB,GAAI,IAE1B/a,EAAQ8sB,YAAY/R,EAAIld,EAAM6iC,EAAkBhV,IACjD7f,EAAOw0B,QAAQtlB,EAAI2lB,EAAkBhV,KAIjD8V,aAAc,SAASzmB,GACnB,QAAS2U,EAAQwP,cAAcnkB,GAAI/E,SAAS6qB,UAAUn5B,QAE1D+5B,SAAU,SAAS1mB,GACf,IAAI2mB,EAAUhS,EAAQwP,cAAcnkB,GAAI/E,SAAS6qB,UAAUrtB,QAI3D,OAHIkuB,GAAWhS,EAAQiS,gBAAgB5mB,KACnC2mB,EAAU,MAEPA,GAEXrnB,MAAO,SAASU,GACZ1S,EAAI,8FAAgG0S,EAAI,SACxG2U,EAAQ0Q,+BAA+BrlB,GACvC2U,EAAQkS,mBAAmB7mB,GAC3B2U,EAAQwP,cAAcnkB,GAAIuQ,OAAS,EACnCoE,EAAQwP,cAAcnkB,GAAI8kB,kBAAmB,GAEjDgC,SAAU,SAAS9mB,GACf,IAAIO,EAAOtb,EAAQgjB,QAAQjI,GAAKld,EAAOmC,EAAQugB,QAAQxF,GAAK4kB,EAAWD,EAAQ+B,SAAS1mB,GAAKuR,EAAYoD,EAAQkQ,cAAc7kB,EAAI4kB,GAAWZ,EAAYrP,EAAQwP,cAAcnkB,GAAKue,EAAWyF,EAAUc,iBAAkBiC,EAAmB/C,EAAU/oB,SAAS4qB,YAAc,IACxP,MAApB7B,EAAUzT,SACVyT,EAAUzT,OAAS,GAEnBgO,IAAkF,IAAtEt5B,EAAQ4sB,SAAS7R,EAAIld,EAAMyuB,EAAWyS,EAAUlS,oBAC5D6S,EAAQrlB,MAAMU,GACd4kB,EAAWD,EAAQ+B,SAAS1mB,GAC5BuR,EAAYoD,EAAQkQ,cAAc7kB,EAAI4kB,GACtCrG,GAAW,GAEC,MAAZqG,GAAgD,IAA5BmC,EAAiBp6B,QACrCg4B,EAAQM,SAASjlB,IAEjB+mB,EAAiB38B,KAAKw6B,GACtBjQ,EAAQwP,cAAcnkB,GAAI/E,SAAS4qB,WAAakB,EAC5CrC,GACA6B,EAAkBpE,KAAKniB,EAAI4kB,GAE3BF,GAA8B6B,EAAkBS,aAAerS,EAAQwP,cAAcnkB,GAAI/E,SAAS6qB,UAAUn5B,QAC5Gg4B,EAAQmC,SAAS9mB,GAEO,IAAxBuR,EAAUnf,KAAKmO,OACfjT,EAAIhG,GAAGqH,OAAO,+DAAgEi2B,EAAU5kB,GAAK,SAC7F2kB,EAAQa,cAAcZ,EAAU5kB,EAAI,8BAA+B,OAE5C/a,EAAQqsB,cAActR,EAAIld,EAAM6xB,EAAQqQ,yBAAyBzT,IACvE7U,MAAK,SAASuqB,GAC/B,GAAKhiC,EAAQstB,aAAavS,GAEnB,CACH1S,EAAIhG,GAAGqH,OAAO,oEAAqEqR,EAAI4kB,EAAUrT,EAAU3f,MAAQ,EAAG2f,EAAU1f,IAAK0O,IACrI,IAAI2mB,EAAkB,CAClBtC,SAAUA,EACV5kB,GAAIA,EACJmnB,UAAWF,EACX1I,SAAUA,GAEd5J,EAAQyS,YAAYF,GAAiBxqB,MAAK,SAAiB8a,EAAU7G,GACjErjB,EAAI,wCAA0C0S,EAAK,WAAa4kB,GAChEjQ,EAAQ8Q,iBAAiBzlB,EAAI4kB,GAC7B,IAAImC,EAAmBpS,EAAQwP,cAAcnkB,GAAI/E,SAAS4qB,YAAc,GAAIF,EAAmB70B,EAAOs0B,kBAAkB5N,GAAU,GAAO6P,EAAqB//B,GAAGiF,QAAQw6B,EAAkBnC,GAC3Lt3B,EAAIhG,GAAGqH,OAAO,8CAA+Ci2B,EAAU5kB,IACvE2kB,EAAQxnB,KAAK6C,EAAI4kB,EAAUe,EAAkBhV,GACzC0W,GAAsB,GACtBN,EAAiBllB,OAAOwlB,EAAoB,GAEhD1S,EAAQ2S,0BAA0BtnB,GAC7B2kB,EAAQ8B,aAAazmB,IAAmC,IAA5B+mB,EAAiBp6B,OAEvCg4B,EAAQ8B,aAAazmB,GAC5B2kB,EAAQmC,SAAS9mB,GAEjB1S,EAAIhG,GAAGqH,OAAO,oGAAqGqR,EAAItI,KAAKkrB,UAAUmE,KAJtIpC,EAAQM,SAASjlB,MAMtB,SAAiBwX,EAAU7G,GAC1BgU,EAAQa,cAAcZ,EAAU5kB,EAAIwX,EAAU7G,MAC/CxT,MAAK,WACJwX,EAAQ4S,SAASvnB,EAAI4kB,WA7BzBt3B,EAAIhG,GAAGqH,OAAO,6EAA8EqR,EAAI4kB,OAgCrG,SAAS3zB,GACR0zB,EAAQa,cAAcZ,EAAU5kB,EAAI/O,EAAO,YAIxDs1B,EAAoB,CACnBiB,MAAO,GACPC,YAAa,GACbC,SAAU,GACVV,UAAW,WACP,IAAIlU,EAAM7tB,EAAQynB,eAAgBib,EAAwB,EAAGC,EAAkB,EAK/E,OAJAtgC,GAAG4C,KAAKq8B,EAAkBkB,aAAa,SAASlhB,EAAQshB,GACpDF,IACAC,GAAmBC,EAAiBl7B,UAEjCmmB,GAAOyT,EAAkBiB,MAAM76B,OAASg7B,EAAwBC,IAE3EpB,KAAM,SAASxmB,EAAI8nB,GACf,IAAuJC,EAAnJC,GAAaF,EAAeG,EAAe3gC,GAAGiF,QAAQg6B,EAAkBmB,SAAU1nB,GAAKkoB,EAAmB5gC,GAAGiF,QAAQg6B,EAAkBiB,MAAOxnB,UAC3IumB,EAAkBkB,YAAYznB,GACjClP,EAAOq3B,eAAenoB,aAAe1Y,GAAG8V,YACxC9P,EAAI,uCAAyC0S,EAAK,sCAC3C2U,EAAQwP,cAAcnkB,GAAIQ,MAEjCynB,GAAgB,EAChB1B,EAAkBmB,SAAS7lB,OAAOomB,EAAc,GACzCD,GAAaE,GAAoB,IACxC3B,EAAkBiB,MAAM3lB,OAAOqmB,EAAkB,IACjDH,EAASxB,EAAkBmB,SAASjvB,UACtB,IACV8tB,EAAkBiB,MAAMp9B,KAAK29B,GAC7Bj3B,EAAOc,MAAMm2B,MAIzBK,sBAAuB,WACnB,IAAIC,EAAqB,GAYzB,OAXA/gC,GAAG4C,KAAKq8B,EAAkBkB,aAAa,SAASlhB,EAAQ+hB,GAChDA,GAAUA,EAAO37B,QACjB07B,EAAmBj+B,KAAKm+B,SAAShiB,OAGzCjf,GAAG4C,KAAKq8B,EAAkBiB,OAAO,SAASr9B,EAAKoc,GACtCggB,EAAkBkB,YAAYlhB,IAC/B8hB,EAAmBj+B,KAAKm+B,SAAShiB,OAGzC8hB,EAAqBA,EAAmB3iC,OAAO6gC,EAAkBmB,WAGrEc,kBAAmB,SAASxoB,GACxB,OAAO1Y,GAAGiF,QAAQg6B,EAAkBiB,MAAOxnB,IAAO,GAEtDmiB,KAAM,SAASniB,EAAI4kB,GAIf,OAHgB,MAAZA,GACA2B,EAAkBmB,SAASt9B,KAAK4V,KAEhCumB,EAAkBS,cACF,MAAZpC,GACA2B,EAAkBmB,SAASe,MAC3BlC,EAAkBiB,MAAMp9B,KAAK4V,MAGrB0oB,EAAkBnC,EAAkBkB,YAAYznB,IAAO,IAC3C5V,KAAKw6B,GACrB2B,EAAkBkB,YAAYznB,GAAM0oB,IAGrC,GANH,IACQA,GASpBppB,MAAO,WACHinB,EAAkBmB,SAAW,GAC7BnB,EAAkBiB,MAAQ,KAE/BmB,EACO,SAAS3oB,EAAIld,GACf,IAAIkhC,EAAYrP,EAAQwP,cAAcnkB,GACjCgkB,GAILA,EAAUzT,OAAS,EACnBjjB,EAAI,qCAAuC0S,GAC3C2U,EAAQiU,WAAW5oB,GAAItD,MAAK,SAAS8a,EAAU2J,GAC3C7zB,EAAI,uCAAyC0S,GAC7C,IAAI2lB,EAAmB70B,EAAOs0B,kBAAkB5N,GAAU,GAAOjX,EAAOtb,EAAQgjB,QAAQjI,GACxF/a,EAAQqrB,WAAWtQ,EAAIld,EAAMyd,EAAMA,GACnCzP,EAAO+3B,aAAa7oB,EAAI2lB,GACxB70B,EAAOw0B,QAAQtlB,EAAI2lB,EAAkBxE,MACtC,SAAS3J,EAAU2J,GAClB7zB,EAAI,oCAAsC0S,GAC1C,IAAI2lB,EAAmB70B,EAAOs0B,kBAAkB5N,GAAU,GACrDvyB,EAAQ8sB,YAAY/R,EAAIld,EAAM6iC,EAAkBxE,IACjDrwB,EAAOw0B,QAAQtlB,EAAI2lB,EAAkBxE,OAfzC7zB,EAAI,yEAA2E0S,EAAI,SAmB5FlP,EAAS,CACRuU,OAAQ,SAASrF,GACb1S,EAAI,cAAgB0S,GACpB/a,EAAQ8nB,YAAYtkB,OAAOuX,GAC3BumB,EAAkBC,KAAKxmB,IAE3BslB,QAAS,SAAStlB,EAAIwX,EAAU2J,GAC5B,IAAIr+B,EAAOmC,EAAQugB,QAAQxF,GAC3B/a,EAAQyrB,WAAW1Q,EAAIld,EAAM00B,EAAU2J,GACnCxM,EAAQwP,cAAcnkB,IACtB2U,EAAQmU,YAAcnU,EAAQmU,WAAW9oB,GAE7CumB,EAAkBC,KAAKxmB,IAE3BmoB,eAAgB,SAASnoB,GACrB,OAAO2U,EAAQoU,UAAYpU,EAAQoU,SAAS/oB,IAAO2U,EAAQ1N,SAAW0N,EAAQ1N,QAAQjH,IAE1FgpB,YAAa,WACT,IAAIC,EAAc/Y,EAAY5oB,GAAG4oB,GAAa5oB,GAAG4hC,YAAaC,EAAuB7hC,GAAGwR,kBAAkBgC,cAAgB,MAAQ,QAClI6Z,EAAU,IAAIsU,EAAYE,EAAuB,iBAAiBlkC,EAAS,CACvEutB,oBAAqBvtB,EAAQutB,oBAC7BH,cAAeptB,EAAQotB,cACvB7M,QAASvgB,EAAQugB,QACjByC,QAAShjB,EAAQgjB,QACjBO,QAASvjB,EAAQujB,QACjBlb,IAAKA,EACLwjB,SAAU7rB,EAAQ6rB,SAClBR,WAAYrrB,EAAQqrB,WACpB4B,cAAejtB,EAAQitB,cACvBkX,aAAc,SAASppB,GACnB/a,EAAQwc,UAAUzB,EAAI1Y,GAAG6Y,OAAO6C,uBAG5BqmB,+BACR1U,EAAQ0U,iCAGhBC,4BAA6B,SAAStpB,GAClC,OAAO/a,EAAQqtB,SAAStS,IAE5BupB,WAAY,SAASvpB,EAAI5N,GACrB,OAAIA,IAASuiB,EAAQ1N,QAAQjH,IAAO5N,aAAgB9K,GAAG8V,WACnDnY,EAAQgsB,aAAajR,GACrB1S,EAAI,+CAAiD0S,GACrD5N,EAAKvO,SAAS6Y,MAAK,SAAS8sB,GACxBl8B,EAAI,mCAAqC0S,GACzC2U,EAAQ8U,WAAWzpB,EAAIwpB,GACvBvkC,EAAQktB,QAAQnS,EAAIwpB,EAAcjpB,MAClCoU,EAAQkS,mBAAmB7mB,GAC3BlP,EAAO44B,uBAAuB1pB,MAC/B,SAASsL,GACR,IAAIqe,EAAgB,GAChBre,IACAqe,EAAc14B,MAAQqa,GAE1Bhe,EAAIhG,GAAGqH,OAAO,yDAA0DqR,EAAIsL,GAAe,SAC3FrmB,EAAQyrB,WAAW1Q,EAAI/a,EAAQugB,QAAQxF,GAAK1Y,GAAG2B,OAAO0gC,EAAepF,GAAuB,MAC5FzzB,EAAO44B,uBAAuB1pB,GAC9BumB,EAAkBC,KAAKxmB,OAKxB,GAFIlP,EAAO44B,uBAAuB1pB,IAI7C0pB,uBAAwB,SAAS1pB,GAC7B,IAAI4pB,EAAa3kC,EAAQud,mBAAmBxC,GAAK6pB,GAAiB,EAelE,OAdID,GAAcA,EAAWj9B,QACzBW,EAAI,0CAA4C0S,GAChD1Y,GAAG4C,KAAK0/B,GAAY,SAASz/B,EAAK2/B,GAC9B,GAAIh5B,EAAOw4B,4BAA4BQ,IAAgBnV,EAAQ1N,QAAQ6iB,GACnED,EAAiBC,IAAc9pB,EAC/BlP,EAAOi5B,IAAID,QACR,GAAIh5B,EAAOw4B,4BAA4BQ,GAC1C,OAAO,OAIfD,GAAiB,EACjB/4B,EAAOi5B,IAAI/pB,IAER6pB,GAEXhB,aAAc,SAAS7oB,EAAIwX,QACEnsB,IAArBmsB,EAASzV,SACT9c,EAAQitB,cAAclS,EAAIwX,EAASzV,UAG3CqjB,kBAAmB,SAAS4E,EAAkB9R,GAC1C,IAAIV,EAAWwS,EAQf,OAPK1iC,GAAGoG,SAASs8B,KACbxS,EAAW,GACPlwB,GAAG+G,SAAS27B,KAAsB9R,IAClCV,EAASvmB,MAAQ+4B,IAGzBxS,EAAS5kB,QAAUslB,EACZV,GAEXuS,IAAK,SAAS/pB,GACV,IAAIld,EAAOmC,EAAQugB,QAAQxF,GAC3B,IAAKwkB,EAAWne,QAAQrG,GACpB,MAAM,IAAI1Y,GAAGN,MAAMgZ,EAAK,sCAE5B/a,EAAQksB,SAASnR,EAAIld,GAAM4Z,MAAK,SAAS8a,GACjCA,GAAYA,EAAS3b,OACrB5W,EAAQwc,UAAUzB,EAAI1Y,GAAG6Y,OAAO2C,QAChC6R,EAAQ9Y,MAAMmE,GACdumB,EAAkBC,KAAKxmB,IAEnBykB,GAAoB9P,EAAQsV,qBAAqBjqB,GACjD2kB,EAAQmC,SAAS9mB,GAEjB2oB,EAAY3oB,EAAIld,MAGzB,SAASmO,GAGR,GADA3D,EAAI0S,EAAK,sEADT/O,EAAQA,GAAS,IACsE,UAClFhM,EAAQ8sB,YAAY/R,EAAIld,EAAMmO,EAAM+gB,cAAgB,IAAK,CAC1D,IAAIwF,EAAW1mB,EAAOs0B,kBAAkBn0B,EAAM+gB,cAAc,GAC5DlhB,EAAOw0B,QAAQtlB,EAAIwX,QAI/B5lB,MAAO,SAASoO,GACZ,IAAIkqB,EAAep5B,EAAOq3B,eAAenoB,GACzC,OAAIkqB,EACOp5B,EAAOy4B,WAAWvpB,EAAIkqB,IAE7Bp5B,EAAOi5B,IAAI/pB,IACJ,KAInB1Y,GAAG2B,OAAOvB,KAAM,CACZkP,IAAK,SAASoJ,EAAIQ,GACdmU,EAAQ/d,IAAIP,MAAM3O,KAAMqH,YAE5B+B,OAAQ,SAASkP,GACb,QAAIumB,EAAkBpE,KAAKniB,IAChBlP,EAAOc,MAAMoO,IAI5B4J,MAAO,SAAS5J,GAIZ,OAHI0kB,IACA/P,EAAQwP,cAAcnkB,GAAIxJ,KAAKwvB,eAAgB,GAE/CO,EAAkBiC,kBAAkBxoB,GAC7BlP,EAAOc,MAAMoO,GAEbwkB,EAAW1zB,OAAOkP,IAGjCqF,OAAQ,SAASrF,GACb,IAAImqB,EAAexV,EAAQtP,OAAOrF,GAC9B1Y,GAAGkV,iBAAiB2tB,GACpBA,EAAaztB,MAAK,WACd5L,EAAOuU,OAAOrF,OAEM,IAAjBmqB,GACPr5B,EAAOuU,OAAOrF,IAGtB0F,UAAW,WACP,IAAoEnjB,EAAhE8lC,EAAqB9B,EAAkB6B,wBAC3C,GAAIC,EAAmB17B,OACnB,IAAKpK,EAAI8lC,EAAmB17B,OAAS,EAAGpK,GAAK,EAAGA,IAC5CiiC,EAAWnf,OAAOgjB,EAAmB9lC,IAG7CgkC,EAAkBjnB,SAEtB2H,QAAS,SAASjH,GACd,OAAI2U,EAAQoU,UAAYpU,EAAQoU,SAAS/oB,GAC9B2U,EAAQoU,SAAS/oB,GAAI3C,cAEzBsX,EAAQ1N,SAAW0N,EAAQ1N,QAAQjH,IAE9CoqB,UAAW,SAASpqB,GAChB,SAAU2U,EAAQoU,WAAYpU,EAAQoU,SAAS/oB,KAEnDhB,SAAU,SAASgB,GACf,GAAI2U,EAAQ3V,SACR,OAAO2V,EAAQ3V,SAASgB,IAGhCV,MAAO,WACHhS,EAAI,4BACJk3B,EAAW9e,YACX6gB,EAAkBjnB,QAClBqV,EAAQrV,SAEZuJ,QAAS,SAAS7I,GACd,GAAIwkB,EAAWne,QAAQrG,GACnB,OAAO2U,EAAQ9L,QAAQ7I,IAG/BqG,QAAS,SAASrG,GACd,OAAO2U,EAAQtO,QAAQrG,IAE3B0I,gBAAiB,SAAS1I,GACtB,IAAIlc,EAAM6wB,EAAQtO,QAAQrG,IAAO2U,EAAQ0V,oBAAsB1V,EAAQ0V,mBAAmBrqB,GAC1F,QAAIlc,KACS0W,aAAaxE,QAAQlS,IAItCkkB,sBAAuB,WACnB,OAAI2M,EAAQ3M,sBACD2M,EAAQ3M,wBAEZ,IAEXkc,oBAAqB,SAASlkB,GAC1B,GAAIwkB,EAAWne,QAAQrG,GACnB,OAAO2U,EAAQuP,oBAAoBlkB,IAG3CnE,MAAO,SAASmE,GACZ,SAAIwkB,EAAW/b,YAAYzI,IAAO2U,EAAQ9Y,OAAS2oB,EAAWne,QAAQrG,IAAO2U,EAAQ9Y,MAAMmE,MACvFumB,EAAkBC,KAAKxmB,GACvB2U,EAAQ2R,0BAA0BtmB,IAC3B,IAIfsqB,mBAAoB,SAAStqB,GACzB,QAAS2U,EAAQ2V,oBAAsB3V,EAAQ2V,mBAAmBtqB,IAEtEyI,YAAa,SAASzI,GAClB,QAAS2U,EAAQlM,aAAekM,EAAQlM,YAAYzI,MAG5D1Y,GAAG2B,OAAOhE,EAASjC,GACnBsK,EAAMrI,EAAQqI,IACdm3B,EAAmBx/B,EAAQgW,SAAS8K,SAAWze,GAAGwR,kBAAkBmC,SACpEypB,EAA6BD,GAAoBx/B,EAAQgW,SAAS2iB,WAAW7X,SAErEyR,EAAW,IACNvyB,EAAQmrB,oBAAqB,EAF1CmU,EAGW/M,EAEX1mB,EAAOk4B,eAEX1hC,GAAGijC,qBAAuB,SAASvnC,GAC/B,aACA,IAEGwnC,EAA2B,GAC9BljC,GAAG2B,OAHW,CACVqE,IAAK,SAASC,EAASC,MAERxK,GACnBsE,GAAG2B,OAAOvB,KAAM,CACZ+iC,eAAgB,SAASzqB,EAAInK,GAIrB9I,OAAO6N,YACP4vB,EAAyBxqB,GAAM1Y,GAAGyF,QAAQpF,OAAO,WAJtB,SAAS4yB,GACpC1kB,EAAS0kB,EAAMpuB,SAKfmB,IAAI,wDAAyD,UAGrEo9B,sBAAuB,SAAS1qB,GAC5B,GAAIjT,OAAO6N,YAAa,CACpB,IAAI+vB,EAAWH,EAAyBxqB,GACpC2qB,GACAA,SAMpBrjC,GAAGsjC,kBAAoB,SAAS1qB,GAC5B,aACA,IAAIjb,EAAUib,EAAKjb,QAAS0vB,EAAUjtB,KAAMq8B,EAAQ7jB,EAAK6jB,MAAO8G,EAAwBvjC,GAAGsM,cAAek3B,EAAkB,GAAIC,EAAmB,GAAIC,EAA4B,GAAIC,EAAShmC,EAAQgmC,OAAQrb,EAAY3qB,EAAQ2qB,UAAWpH,EAAUub,EAAMvb,QAASlb,EAAMy2B,EAAMz2B,IAAK49B,EAAsB,IAAI5jC,GAAGijC,qBAAqB,CACvUj9B,IAAKA,IAeT,SAAS69B,EAAuBC,GAC5B,OAAOA,EAAW9+B,MAAM,KAAK,GAyCjChF,GAAG2B,OAAOvB,KAAM,IAAIJ,GAAGw8B,cAAc5jB,IACrC5Y,GAAG6L,SAASzL,MAAM,SAAS2L,GACvB,MAAO,CACHuD,IAAK,SAASoJ,EAAI0T,GACdrgB,EAAOuD,IAAIoJ,EAAI,CACXxP,MAAOkjB,IAEXA,EAAUpc,aAAa,OAAQsY,GAC3B8D,EAAUlrB,YACVlB,GAAGosB,GAAWjrB,UAGtBogB,QAAS,SAAS7I,IAnE1B,SAAqBA,UACV+qB,EAAiB/qB,GACpBirB,IACAtS,aAAaqS,EAA0BhrB,WAChCgrB,EAA0BhrB,GACjCkrB,EAAoBR,sBAAsB1qB,IAE9C,IAAIqrB,EAAS56B,SAAS66B,eAAe3W,EAAQ4W,eAAevrB,IACxDqrB,IACAA,EAAO/zB,aAAa,MAAO,qBAC3BhQ,GAAG+jC,GAAQ5iC,UA0DP+iC,CAAYxrB,GACZ3M,EAAOwV,QAAQ7I,IAEnBqG,QAAS,SAASrG,GACd,OAAO3M,EAAOgT,QAAQrG,SAA2C3U,IAApCspB,EAAQwP,cAAcnkB,GAAIxP,WAInElJ,GAAG2B,OAAOvB,KAAM,CACZsX,SAAU,SAASgB,GACf,OAAO2U,EAAQwP,cAAcnkB,GAAIxP,OAErCi7B,iBAAkB,SAASJ,EAAQx1B,GAC/B,IAAI61B,EACAT,EA3DZ,SAAqCI,EAAQx1B,GACzC,IAAIu1B,EAAaC,EAAOrrB,GAAIuG,EAAS4kB,EAAuBC,GAAa9qB,EAAOkI,EAAQjC,GACxFukB,EAAgBxqB,GAAQzK,EACxBk1B,EAAiBxkB,GAAUjf,GAAG+jC,GAAQ1jC,OAAO,QAAQ,WAC7CgtB,EAAQ3V,SAASuH,KACjBjZ,EAAI,mEAAqE89B,EAAa,KACtFJ,EAA0BI,GAAcpc,YAAW,WAC/C,IAAI1D,EAAe,gEAAkE8f,EACrF99B,EAAIge,EAAc,SAClBzV,EAAS,CACL5E,MAAOqa,MAEZ,SAGX4f,EAAoBT,eAAeW,GAAY,SAAS79B,GACpDD,EAAI,2CAA6CC,EAAU,KAC9C49B,EAAuBC,GAApC,IAAuHO,EAAtEnU,EAAW7C,EAAQiX,mBAAmBr+B,GAAU+S,EAAOkX,EAASlX,KAC7GA,GAAQwqB,EAAgBxqB,IACxBhT,EAAI,qCAAuC89B,GAC3CzS,aAAaqS,EAA0BI,WAChCJ,EAA0BI,GACjCzW,EAAQkX,iBAAiBT,GACzBO,EAAiBb,EAAgBxqB,UAC1BwqB,EAAgBxqB,GACvB4qB,EAAoBR,sBAAsBU,GAC1CO,EAAenU,IACPlX,GACRhT,EAAI,IAAMC,EAAU,4CAgCpBu+B,CAA4BT,EAAQx1B,GAEpCk1B,EAAiBM,EAAOrrB,IAAM1Y,GAAG+jC,GAAQ1jC,OAAO,QAAQ,WAEpD,GADA2F,EAAI,yBAA2B+9B,EAAOrrB,IACjCqrB,EAAO7iC,WAAZ,CAGA,IACI,GAAI6iC,EAAOU,iBAAmBV,EAAOU,gBAAgBC,MAAiD,SAAzCX,EAAOU,gBAAgBC,KAAKr2B,UACrF,OAEN,MAAO1E,GACL3D,EAAI,8EAAgF2D,EAAM1D,QAAU,IAAK,SACzGm+B,EAAqB,CACjB94B,SAAS,GAGjBiD,EAAS61B,QAIrBO,cAAe,SAASjsB,GAEpB,OA1FR,SAA6Bld,GACzB,IAAIuoC,EAAS/jC,GAAGmO,UAAU,yCAA2C3S,EAAO,QAI5E,OAHAuoC,EAAO/zB,aAAa,KAAMxU,GAC1BuoC,EAAO7jC,MAAMC,QAAU,OACvBgJ,SAASu7B,KAAKz0B,YAAY8zB,GACnBA,EAqFIa,CADUvX,EAAQ4W,eAAevrB,KAG5C6rB,iBAAkB,SAAS7rB,QACM3U,IAAzB0/B,EAAiB/qB,KACjB+qB,EAAiB/qB,YACV+qB,EAAiB/qB,KAGhCurB,eAAgB,SAAShlB,GACrB,OAAOA,EAAS,IAAMskB,GAE1BsB,mBAAoB,SAASjsB,GACzB,IAAIsM,EAAStM,EAAKsM,OAAQ7I,EAAWzD,EAAKyD,SAAUD,EAASxD,EAAKwD,OAAQ6Y,EAAerc,EAAKqc,aAAc6P,EAAalsB,EAAKksB,WAAY/0B,EAAO/P,GAAGmO,UAAU,iBAAmB+W,EAAS,2CAA4C4U,EAAMzd,EAU5O,OATI4Y,EACAj1B,GAAG8P,WAAWsM,EAAQrM,GAEtB+pB,EAAM95B,GAAGgP,QAAQoN,EAAQC,GAE7BtM,EAAKC,aAAa,SAAU8pB,GAC5B/pB,EAAKC,aAAa,SAAU80B,GAC5B/0B,EAAK7P,MAAMC,QAAU,OACrBgJ,SAASu7B,KAAKz0B,YAAYF,GACnBA,GAEXu0B,mBAAoB,SAASS,GACzB,IAAI7U,EAAW,GACf,IACIA,EAAWlwB,GAAGkQ,UAAU60B,GAC1B,MAAOp7B,GACL3D,EAAI,0DAA4D2D,EAAM1D,QAAU,IAAK,SAEzF,OAAOiqB,MAInBlwB,GAAGglC,iBAAmB,SAASpsB,GAC3B,aACA,IAAIyU,EAAUjtB,KAAMwoB,EAAYhQ,EAAKjb,QAAQirB,UAAW6T,EAAQ7jB,EAAK6jB,MAAO9oB,EAAWiF,EAAKjb,QAAQgW,SAAUsxB,EAAe,SAASvsB,GAClI,IAAIgkB,EAAYrP,EAAQwP,cAAcnkB,GACtC,GAAIgkB,EAAUhG,UACV,OAAOgG,EAAUhG,UAEjB,IAAIA,EAAY/iB,EAASkjB,SAKzB,OAJI72B,GAAGsG,WAAWowB,KACdA,EAAYA,EAAUhe,EAAIiI,EAAQjI,KAEtCgkB,EAAUhG,UAAYA,EACfA,GAEZjiB,EAASmE,EAAKjb,QAAQ8W,OAAQywB,EAAavxB,GAAYiF,EAAKjb,QAAQgW,SAAS8K,SAAWze,GAAGwR,kBAAkBmC,SAAUwxB,EAAgB1wB,GAAUmE,EAAKjb,QAAQ8W,OAAOgK,SAAWymB,GAAcllC,GAAGwR,kBAAkBiD,OAAQyJ,EAAUue,EAAMve,QAASyC,EAAU8b,EAAM9b,QAASO,EAAUub,EAAMvb,QAASf,EAAcsc,EAAMtc,YAAa4K,EAAgB0R,EAAM1R,cAAeH,EAAgB6R,EAAM7R,cAAe5B,EAAayT,EAAMzT,WAAYhjB,EAAMy2B,EAAMz2B,IAAKklB,EAAsBuR,EAAMvR,oBAChe,SAAS4T,EAAMpmB,GACX1Y,GAAG4C,KAAKyqB,EAAQsR,SAASjmB,IAAK,SAAS0sB,EAAO/b,GAC1C,IAAIgc,EAAgBhY,EAAQiY,kBAAkB5sB,EAAI0sB,GAClD/b,EAAImR,mBAAqB,KACzBnR,EAAI7f,OAAO+vB,WAAa,KACxBlQ,EAAIyV,QACJuG,GAAiBA,EAAc9I,UAAY8I,EAAc9I,SAAS7jB,MAG1E1Y,GAAG2B,OAAOvB,KAAM,IAAIJ,GAAGw8B,cAAc5jB,IACrC5Y,GAAG6L,SAASzL,MAAM,SAAS2L,GACvB,MAAO,CACHuD,IAAK,SAASoJ,EAAI6sB,GACd,GAAIvlC,GAAG+H,OAAOw9B,IAAgBvlC,GAAG+I,OAAOw8B,GACpCx5B,EAAOuD,IAAIoJ,EAAI,CACXQ,KAAMqsB,QAEP,MAAIA,aAAuBvlC,GAAG8V,WAKjC,MAAM,IAAIpW,MAAM,4CAJhBqM,EAAOuD,IAAIoJ,EAAI,CACX+jB,MAAO8I,IAKflY,EAAQmY,eAAe9sB,GACvBysB,GAAiB9X,EAAQoY,uBAAuB/sB,IAEpD6I,QAAS,SAAS7I,GACdomB,EAAMpmB,GACN2U,EAAQ0Q,+BAA+BrlB,GACvC2U,EAAQmU,WAAW9oB,GACnB3M,EAAOwV,QAAQ7I,QAI3B1Y,GAAG2B,OAAOvB,KAAM,CACZ+9B,iBAAkB,SAASzlB,EAAI4kB,GAC3B,IAAIZ,EAAYrP,EAAQwP,cAAcnkB,GAClCgkB,UACOA,EAAUxtB,KAAKw2B,aAAapI,IAG3C2C,SAAU,SAASvnB,EAAI4kB,GACnB,IAAIqI,EAAYtY,EAAQwP,cAAcnkB,GAAIxJ,KACtCy2B,EAAUC,aACHD,EAAUC,KAAKtI,GAEtBqI,EAAUE,uBACHF,EAAUE,eAAevI,IAGxCM,eAAgB,SAASllB,EAAIotB,GACzB,IAAIC,EAAe1Y,EAAQiS,gBAAgB5mB,GAAM,EAAG2Q,EAAMgE,EAAQ2Y,QAAQttB,EAAIqtB,GAC9E,OAAID,GACO,IAAI9lC,GAAGoL,SAAUE,QAAQw6B,EAAezc,GAAMA,IAElD,IAAIrpB,GAAGoL,SAAUE,QAAQ,GAAI+d,IAExC1J,QAAS,SAASjH,GACd,OAAO2U,EAAQtO,QAAQrG,IAAO2U,EAAQwP,cAAcnkB,GAAIQ,MAE5DuoB,SAAU,SAAS/oB,GACf,OAAO2U,EAAQtO,QAAQrG,IAAO2U,EAAQwP,cAAcnkB,GAAI+jB,OAE5D/b,sBAAuB,WACnB,IAAIulB,EAAqB,GAiBzB,OAhBA5Y,EAAQ6Y,uBAAsB,SAAS1pC,EAAKwhB,GACxCqP,EAAQ2R,0BAA0B,KAAMhhB,EAAWrK,SAAS4qB,WAAYvgB,EAAWrK,SAAS6qB,WAC5F,IAAI35B,EAAO,CACPrJ,KAAMwiB,EAAWxiB,KACjBgjC,UAAWxgB,EAAWrK,SAAS6qB,UAC/BvlB,KAAM+E,EAAW/E,KACjBD,KAAMgF,EAAWhF,MAEjBgF,EAAWxhB,MACXqI,EAAKrI,IAAMwhB,EAAWxhB,KAEtBwhB,EAAWwM,mBACX3lB,EAAK2lB,iBAAmBxM,EAAWwM,kBAEvCyb,EAAmBnjC,KAAK+B,MAErBohC,GAEXjD,mBAAoB,SAAStqB,GACzB,OAAO2U,EAAQwP,cAAcnkB,GAAI8kB,kBAErCrc,YAAa,SAASzI,GAClB,QAAS/E,GAAY0Z,EAAQtO,QAAQrG,KAAQ2U,EAAQwP,cAAcnkB,GAAIytB,cAE3EnH,0BAA2B,SAAStmB,EAAI0tB,EAAeC,GACnD,IAAiDC,GAAjCjZ,EAAQwP,cAAcnkB,IAAO,IAA8B/E,UAAY,GAAI4qB,EAAa6H,GAAiBE,EAAc/H,WAAYC,EAAY6H,GAAgBC,EAAc9H,UACzLD,IACAv4B,EAAIhG,GAAGqH,OAAO,yDAA0D+I,KAAKkrB,UAAUiD,KACvFA,EAAWgI,UACXvmC,GAAG4C,KAAK27B,GAAY,SAAS17B,EAAKy6B,GAC9BkB,EAAUC,QAAQnB,MAEtBiB,EAAWl5B,OAAS,IAG5BkP,MAAO,SAASmE,GACZ,GAAI2U,EAAQtO,QAAQrG,GAIhB,OAHA1S,EAAIhG,GAAGqH,OAAO,4DAA6DqR,EAAIwF,EAAQxF,KACvF2U,EAAQwP,cAAcnkB,GAAI8tB,QAAS,EACnC1H,EAAMpmB,IACC,GAGf6mB,mBAAoB,SAAS7mB,GACzB,GAAI/E,GAAY0Z,EAAQtO,QAAQrG,GAAK,CACjC,IAAuC+tB,EAAaxrC,EAAhDya,EAAQ2X,EAAQwP,cAAcnkB,GAIlC,UAHOhD,EAAM/B,SACb+B,EAAM/B,SAAW,IACjB8yB,EAAcpZ,EAAQiS,gBAAgB5mB,IACpB,GAAK/E,EAAS4iB,UAAW,CAIvC,IAHA7gB,EAAM/B,SAAS8K,SAAU,EACzB/I,EAAM/B,SAAS+yB,MAAQD,EACvB/wB,EAAM/B,SAAS6qB,UAAY,GACtBvjC,EAAI,EAAGA,EAAIwrC,EAAaxrC,IACzBya,EAAM/B,SAAS6qB,UAAU17B,KAAK7H,GAElCoyB,EAAQmY,eAAe9sB,QAEvBhD,EAAM/B,SAAS8K,SAAU,IAIrC0jB,WAAY,SAASzpB,EAAIiuB,GACjBtZ,EAAQtO,QAAQrG,KAChB2U,EAAQwP,cAAcnkB,GAAIQ,KAAOytB,IAGzCnF,WAAY,SAAS9oB,GACjB,IAAIitB,EAAYtY,EAAQwP,cAAcnkB,GAAIxJ,KAC1ClP,GAAG4C,KAAK+iC,EAAUE,gBAAgB,SAASe,UAChCjB,EAAUE,eAAee,MAEpC5mC,GAAG4C,KAAK+iC,EAAUC,MAAM,SAASgB,UACtBjB,EAAUC,KAAKgB,OAG9BC,WAAY,SAASnuB,EAAIouB,GACrB,OAAOzZ,EAAQ0Z,aAAaruB,EAAIouB,EAAa9mC,GAAGuJ,sBAEpD+7B,kBAAmB,SAAS5sB,EAAIouB,GAC5B,IAAIxJ,EAA0B,MAAfwJ,GAAuB,EAAIA,EAC1C,OAAOzZ,EAAQwP,cAAcnkB,GAAIxJ,KAAK22B,eAAevI,IAEzDC,cAAe,SAAS7kB,EAAIsuB,GACxB,IAAItQ,EAAYuO,EAAavsB,GAAKuuB,EAAWtmB,EAAQjI,GAAKrO,EAAagjB,EAAQ1N,QAAQjH,GAAKwuB,EAAaxQ,EAAYsQ,EAAYG,EAAWD,EAAaxQ,GAAauQ,EAAWA,EAAWC,EAAaxQ,EAAW+P,EAAcpZ,EAAQiS,gBAAgB5mB,GAAKgtB,EAAetlC,KAAKy8B,cAAcnkB,GAAIxJ,KAAKw2B,aAAc56B,EAAO46B,EAAasB,IAAehnC,GAAGoK,UAAUC,EAAY68B,EAAYC,GAEhY,OADAzB,EAAasB,GAAcl8B,EACpB,CACHs8B,KAAMJ,EACN18B,MAAO48B,EACP38B,IAAK48B,EACLE,MAAOZ,EACP37B,KAAMA,EACNmO,KAAMkuB,EAAWD,IAGzBxJ,yBAA0B,SAASzT,GAC/B,MAAO,CACHG,UAAWH,EAAUmd,KACrBE,UAAWrd,EAAU3f,MAAQ,EAC7Bi9B,QAAStd,EAAU1f,IACnBqsB,WAAY3M,EAAUod,QAG9BtE,mBAAoB,SAASrqB,GACzB,IAA2Bld,EAAO0iB,EAAQxF,GAAKO,EAAO0H,EAAQjI,GAAKge,EAAYuO,EAAavsB,GAAK2D,EAAW8D,EAAYzH,GAAKwe,EAAaziB,EAAOyiB,WAAWxe,GAAK8uB,EAAiBxnC,GAAGqH,OAAO,2BAA4BuhB,EAApM,MAA8NptB,EAAMyd,EAAMyd,EAAWra,GAIzQ,OAHA6a,EAAWh4B,SAAQ,SAAS1C,GACxBgrC,GAAkB,IAAMhrC,KAErBgrC,GAEXC,aAAc,SAAS/uB,GACnB,OAAO2U,EAAQ1N,QAAQjH,GAAIpY,MAE/BonC,oBAAqB,SAAShvB,GAC1B,OAAO2U,EAAQwP,cAAcnkB,GAAI/E,UAErC2rB,gBAAiB,SAAS5mB,GACtB,GAAI/E,EAAU,CACV,IAAIszB,EAAWtmB,EAAQjI,GAAKge,EAAYuO,EAAavsB,GACrD,OAAOjX,KAAKkmC,KAAKV,EAAWvQ,KAGpCsP,QAAS,SAASttB,EAAIouB,GAClB,IAAIxJ,EAA0B,MAAfwJ,GAAuB,EAAIA,EAC1C,OAAOzZ,EAAQwP,cAAcnkB,GAAIxJ,KAAK02B,KAAKtI,IAE/CqB,SAAU,SAASjmB,GACf,OAAO2U,EAAQwP,cAAcnkB,GAAIxJ,KAAK02B,MAE1CM,sBAAuB,SAAS33B,GACxB42B,GACAnlC,GAAG4C,KAAKsQ,cAAc,SAAS1W,EAAKqK,GAChC,GAAwD,IAApDrK,EAAIyI,QAAQjF,GAAGqH,OAAO,aAAcuhB,IAAmB,CACvD,IAAI5K,EAAa5N,KAAKC,MAAMxJ,GAC5B0H,EAAS/R,EAAKwhB,QAK9BwnB,eAAgB,SAAS9sB,GACrB2U,EAAQwP,cAAcnkB,GAAIxJ,KAAO,CAC7B22B,eAAgB,GAChBpI,cAAe,GACfmI,KAAM,GACNF,aAAc,KAGtBkC,kBAAmB,SAASlvB,GACxB2U,EAAQwP,cAAcnkB,GAAIytB,cAAe,GAE7CpI,+BAAgC,SAASrlB,GACrC,IAAI8uB,EACJ,SAAIrC,GAAiB9X,EAAQlM,YAAYzI,KACrC8uB,EAAiBna,EAAQ0V,mBAAmBrqB,KACtBxF,aAAaxE,QAAQ84B,MACvCt0B,aAAa20B,WAAWL,IACjB,IAKnB/B,uBAAwB,SAAS/sB,GAC7B,IAAuC8uB,EAAgBM,EAAnDpyB,EAAQ2X,EAAQwP,cAAcnkB,GAC9BysB,QAA+BphC,IAAd2R,EAAMlZ,MACvBgrC,EAAiBna,EAAQ0V,mBAAmBrqB,IAC5CovB,EAAgB50B,aAAaxE,QAAQ84B,MAEjCM,EAAgB13B,KAAKC,MAAMy3B,GACvB/c,EAAc+c,EAAc9uB,MAC5BqU,EAAQua,kBAAkBlvB,IAE1B1S,EAAIhG,GAAGqH,OAAO,0DAA2DqR,EAAIwF,EAAQxF,KACrFkS,EAAclS,EAAIovB,EAAc9uB,MAChCtD,EAAMlZ,IAAMsrC,EAActrC,IAC1BkZ,EAAM/B,SAAWm0B,EAAcn0B,SAC/B+B,EAAMuT,OAAS6e,EAAc7e,OAC7BvT,EAAM8U,iBAAmBsd,EAActd,iBACvC9U,EAAM8nB,kBAAmB,EACzBnQ,EAAQ2R,0BAA0BtmB,OAKlDsnB,0BAA2B,SAAStnB,GAChC,IAAuC8uB,EAAgBM,EAAnDpyB,EAAQ2X,EAAQwP,cAAcnkB,GAClC,GAAIysB,GAAiB9X,EAAQlM,YAAYzI,GAAK,CAC1C,IAAI8R,EAAmBU,EAAoBxS,GAC3C8uB,EAAiBna,EAAQ0V,mBAAmBrqB,GAC5CovB,EAAgB,CACZtsC,KAAM0iB,EAAQxF,GACdO,KAAM0H,EAAQjI,GACdM,KAAMkI,EAAQxI,GACdlc,IAAKkZ,EAAMlZ,IACXmX,SAAU+B,EAAM/B,SAChBsV,OAAQvT,EAAMuT,OACd8e,YAAa3L,KAAKqG,OAElBjY,IACAsd,EAActd,iBAAmBA,GAErC,IACItX,aAAaC,QAAQq0B,EAAgBp3B,KAAKkrB,UAAUwM,IACtD,MAAOn+B,GACL3D,EAAIhG,GAAGqH,OAAO,0DAA2DqR,EAAI/O,EAAMvM,YAAa,WAI5G4qC,yBAA0B,SAAStvB,EAAI4kB,EAAU5G,GAC7C,IAAIrN,EAAMgE,EAAQ2Y,QAAQttB,EAAI4kB,GAAW9hC,EAAO0iB,EAAQxF,GAAKuvB,EAAqB,CAC9E5G,OAAQ,SAASpY,EAAQC,GACrB,IAAI+d,EAAWtmB,EAAQjI,GAEnBsQ,EAAWtQ,EAAIld,EADfytB,IAAWC,EACU+d,EAEAhe,GAAUge,EAAWA,EAAW,EAAIhe,EAF1Bge,IAKvC5J,QAAS,SAASpU,EAAQC,GACtB,IAAIuU,EAAgBpQ,EAAQwP,cAAcnkB,GAAIxJ,KAAKuuB,cAAeyK,EAAiC7a,EAAQwP,cAAcnkB,GAAIuQ,OAAQkf,EAAmBlf,EAAQmf,EAAkBlf,EAAOyN,EAAgBhW,EAAQjI,GAAK2vB,EAAuBF,GAAoBC,EAAkB1R,GAAY4R,EAAqBJ,EACpTzK,EAAcH,GAAY+K,EAC1BroC,GAAG4C,KAAK66B,GAAe,SAASH,EAAUiL,GACtCD,GAAsBC,KAE1Bvf,EAAWtQ,EAAIld,EAAM8sC,EAAoB3R,KAGjDtN,EAAI7f,OAAO+vB,WAAa,SAAStrB,GACzBA,EAAE0sB,kBAEFsN,EADwB,MAAbvR,EAAoB,SAAW,WACjBzoB,EAAEgb,OAAQhb,EAAEib,SAIjD6d,aAAc,SAASruB,EAAIouB,EAAazd,EAAKmf,GACzC,IAAIC,EAAwB,MAAf3B,GAAuB,EAAIA,EAAanB,EAAYtY,EAAQwP,cAAcnkB,GAAIxJ,KAO3F,OANAy2B,EAAUC,KAAOD,EAAUC,MAAQ,GACnCD,EAAUE,eAAiBF,EAAUE,gBAAkB,GACvDF,EAAUC,KAAK6C,GAAUpf,EACrBmf,IACA7C,EAAUE,eAAe4C,GAAUD,GAEhCnf,GAEX0Y,8BAA+B,WAC3B,IAAI2G,EAAiBj0B,EAAOuiB,gBAC5B3J,EAAQ6Y,uBAAsB,SAAS1pC,EAAKwhB,GACxC,IAAI2qB,EAAiB,IAAIvM,KAAKpe,EAAW+pB,aACzCY,EAAeC,QAAQD,EAAeE,UAAYH,GAC9CC,EAAetM,WAAaD,KAAKqG,QACjCz8B,EAAI,2CAA6CxJ,GACjD0W,aAAa20B,WAAWrrC,QAIpCmmC,qBAAsB,SAASjqB,GAC3B,IAAIhD,EAAQ2X,EAAQwP,cAAcnkB,GAClC,GAAIhD,EAIA,OAHKA,EAAM/B,UACP0Z,EAAQkS,mBAAmB7mB,GAExBhD,EAAM/B,SAAS8K,YAKtCze,GAAGilB,wBAA0B,SAASvpB,GAClC,aACA,IAAIotC,EAAWnrC,EAAU,CACrBunB,OAAQ,SACRG,cAAe,SACfK,cAAe,GACfN,eAAgB,EAChBI,cAAe,SAAS9M,GACpB,MAAO,IAEX+M,YAAa,GACbE,KAAM,CACF6I,UAAU,EACV4I,iBAAiB,GAErBpxB,IAAK,SAASsB,EAAKpB,KACnB0f,SAAU,SAASlN,KACnBoN,iBAAkB,SAASpN,EAAIqN,EAAUC,MAE7ChmB,GAAG2B,OAAOhE,EAASjC,GASnBotC,EAAY9oC,GAAG2B,OAAOvB,KAAM,IAAIJ,GAAGm4B,cAAc,CAC7CI,aAAc,mBACdC,aAAc,CAAE,OAAQ,UACxBtT,OAAQvnB,EAAQunB,OAChBQ,cAAe/nB,EAAQ+nB,cACvBD,YAAa9nB,EAAQ8nB,YACrBiT,eAbqC,SAAjC/6B,EAAQunB,OAAOC,cACR,CACH4jB,QAAS,UAGV,GASP3jB,eAAgBznB,EAAQynB,eACxBI,cAAe,SAAS9M,GACpB,OAAO/a,EAAQ6nB,cAAc1pB,IAAI4c,IAErC1S,IAAKrI,EAAQqI,IACbkzB,OAAQv7B,EAAQioB,SAChBwD,WAAYzrB,EAAQmoB,iBACpBH,KAAMhoB,EAAQgoB,QAElB3lB,GAAG2B,OAAOvB,KAAM,CACZ+xB,WAAY,SAASzZ,EAAIM,EAAM+Y,GAC3B,IAAIpJ,EAAoBoJ,GAA4B,GACpDp0B,EAAQqI,IAAI,sCAAwC0S,GAC7B,WAAnB/a,EAAQunB,OACR4jB,EAAUvN,cAAc7iB,GAAIgjB,SAAS1iB,GAAM4iB,WAAWjT,GAAmB0S,QAEzE1S,EAAkBhrB,EAAQ0nB,eAAiBrM,EAC3C8vB,EAAUvN,cAAc7iB,GAAIkjB,WAAWjT,GAAmB0S,YAK1E,WAkDI,SAAS2N,EAAoBC,EAAKn+B,EAAM3G,EAAQxG,EAASurC,GACrD,IAA8JC,EAA1JC,EAAKH,EAAII,aAAcC,EAAKL,EAAIM,cAAeC,EAAQ7rC,EAAQ6rC,MAAOjyB,EAAS5Z,EAAQ4Z,OAAQkyB,EAAMtlC,EAAOulC,WAAW,MAAOv+B,EAAU,IAAInL,GAAGoL,QAEnJ,OADAq+B,EAAIE,OACAhsC,EAAQisC,OAyDhB,SAA8CC,GAC1C,IAAI/+B,EAAO++B,EAAW/+B,KAAMqpB,EAAQ0V,EAAW1V,MAAO2V,EAAcD,EAAWC,YAAaC,EAAaF,EAAWE,WAAYC,EAAcH,EAAWG,YAAa7+B,EAAU,IAAInL,GAAGoL,QAAWw+B,EAASC,EAAWD,OAAQK,EAAe9gC,SAASC,cAAc,UAAW8gC,EAAsBD,EAAaP,WAAW,MAAOS,EAAeN,EAAW1lC,OAAQimC,EAAeP,EAAWO,aAAcC,EAAcR,EAAWQ,YAgBva,OAfAC,EAAoBL,EAAcF,EAAYD,EAAaE,GAC3DG,EAAa5yB,OAAS6yB,EACtBD,EAAaX,MAAQa,EACrBH,EAAoBK,UAAUpW,EAAO,EAAG,GACxCyV,EAAO,CACH9+B,KAAMA,EACNyM,OAAQ6yB,EACRjW,MAAOA,EACP8V,aAAcA,EACdE,aAAcA,EACdX,MAAOa,IACRj1B,MAAK,WACJ+0B,EAAaK,iBAAmBL,EAAaK,kBAC7Cr/B,EAAQG,YACTH,EAAQK,SACJL,EAzEIs/B,CAAqC,CACxC3/B,KAAMA,EACN3G,OAAQA,EACRgwB,MAAO8U,EACPa,YAAaR,EACbS,WAAYX,EACZY,YAAarsC,EAAQqsC,YACrBJ,OAAQjsC,EAAQisC,OAChBQ,aAAc7yB,EACd8yB,YAAab,KAGhBxpC,GAAGwR,kBAAkBoD,2BACtBu0B,EA7BR,SAA6CvwB,GAEzC,IAAK5Y,GAAGyN,MACJ,MAAM,IAAIzN,GAAGN,MAAM,mEAEvB,GAAIkZ,EAAK8xB,WAAa9xB,EAAK+xB,UAJX,OAKZ,MAAO,CACHC,UAAWnpC,KAAKC,MAAMD,KAAKopC,KAAkBjyB,EAAK8xB,WAAa9xB,EAAK+xB,UAN5D,SAORG,SAAUrpC,KAAKC,MAAMD,KAAKopC,KAAkBjyB,EAAK+xB,UAAY/xB,EAAK8xB,WAP1D,UA4BSK,CAAoC,CACrDJ,UAAWnB,EACXkB,WAAYnzB,OAGZvX,GAAGgG,IAAIhG,GAAGqH,OAAO,iFAAkFmiC,EAAOjyB,EAAQ4xB,EAAmB2B,SAAU3B,EAAmByB,WAAY,QAC9KpB,EAAQL,EAAmB2B,SAC3BvzB,EAAS4xB,EAAmByB,WAGpCN,EAAoBnmC,EAAQqlC,EAAOjyB,EAAQ5Z,EAAQqsC,aAC/ChqC,GAAGyN,MACH,YA9ER,SAA2Bw7B,GACvB,IAA8FQ,EAA1FL,EAAKH,EAAII,aAAcC,EAAKL,EAAIM,cAAeplC,EAASgF,SAASC,cAAc,UACnF,OAAIggC,EAAKE,EAAK,UACVnlC,EAAOqlC,MAAQrlC,EAAOoT,OAAS,GAC/BkyB,EAAMtlC,EAAOulC,WAAW,OACpBa,UAAUtB,EAAW,EAALG,EAAQ,GACoB,IAAzCK,EAAIuB,aAAa,EAAG,EAAG,EAAG,GAAGnmC,KAAK,KAyEjComC,CAAkBhC,KAClBG,GAAM,EACNE,GAAM,GAEV,IAAmO4B,EAAQC,EAAIC,EAA3O7vC,EAAI,KAAM8vC,EAAYliC,SAASC,cAAc,UAAWkiC,EAAkBpC,EAxE1F,SAA8BD,EAAKG,EAAIE,GACnC,IAAyEG,EAAK5kC,EAAa0mC,EAAvFpnC,EAASgF,SAASC,cAAc,UAAWoiC,EAAK,EAAGC,EAAKnC,EAAIoC,EAAKpC,EAMrE,IALAnlC,EAAOqlC,MAAQ,EACfrlC,EAAOoT,OAAS+xB,GAChBG,EAAMtlC,EAAOulC,WAAW,OACpBa,UAAUtB,EAAK,EAAG,GACtBpkC,EAAO4kC,EAAIuB,aAAa,EAAG,EAAG,EAAG1B,GAAIzkC,KAC9B6mC,EAAKF,GAEM,IADN3mC,EAAgB,GAAV6mC,EAAK,GAAS,GAExBD,EAAKC,EAELF,EAAKE,EAETA,EAAKD,EAAKD,GAAM,EAGpB,OAAiB,KADjBD,EAAQG,EAAKpC,GACQ,EAAIiC,EAuDwEI,CAAqB1C,EAAKG,EAAIE,GAAM,EAAGsC,EAAKnqC,KAAKkmC,KAAKpsC,EAAIiuC,EAAQJ,GAAKyC,EAAKpqC,KAAKkmC,KAAKpsC,EAAIgc,EAAS+xB,EAAKgC,GAAkBE,EAAK,EAAGM,EAAK,EAGhO,IAFAT,EAAU7B,MAAQ6B,EAAU9zB,OAAShc,EACrC2vC,EAASG,EAAU3B,WAAW,MACvB8B,EAAKlC,GAAI,CAGZ,IAFA6B,EAAK,EACLC,EAAK,EACED,EAAK/B,GACR8B,EAAOa,UAAU,EAAG,EAAGxwC,EAAGA,GAC1B2vC,EAAOX,UAAUtB,GAAMkC,GAAKK,GAC5B/B,EAAIc,UAAUc,EAAW,EAAG,EAAG9vC,EAAGA,EAAG6vC,EAAIU,EAAIF,EAAIC,GACjDV,GAAM5vC,EACN6vC,GAAMQ,EAEVJ,GAAMjwC,EACNuwC,GAAMD,EAEVpC,EAAIuC,UACJX,EAAYH,EAAS,KAtBzB,GAyBAzB,EAAIc,UAAUtB,EAAK,EAAG,EAAGO,EAAOjyB,GAEpCpT,EAAOqmC,iBAAmBrmC,EAAOqmC,kBACjCr/B,EAAQG,UACDH,GAqBX,SAASm/B,EAAoBnmC,EAAQqlC,EAAOjyB,EAAQyyB,GAChD,OAAQA,GACN,KAAK,EACL,KAAK,EACL,KAAK,EACL,KAAK,EACH7lC,EAAOqlC,MAAQjyB,EACfpT,EAAOoT,OAASiyB,EAChB,MAEF,QACErlC,EAAOqlC,MAAQA,EACfrlC,EAAOoT,OAASA,EAEpB,IAAIkyB,EAAMtlC,EAAOulC,WAAW,MAC5B,OAAQM,GACN,KAAK,EACHP,EAAIwC,UAAUzC,EAAO,GACrBC,EAAI/pB,OAAO,EAAG,GACd,MAEF,KAAK,EACH+pB,EAAIwC,UAAUzC,EAAOjyB,GACrBkyB,EAAIyC,OAAOzqC,KAAK0qC,IAChB,MAEF,KAAK,EACH1C,EAAIwC,UAAU,EAAG10B,GACjBkyB,EAAI/pB,MAAM,GAAI,GACd,MAEF,KAAK,EACH+pB,EAAIyC,OAAO,GAAKzqC,KAAK0qC,IACrB1C,EAAI/pB,MAAM,GAAI,GACd,MAEF,KAAK,EACH+pB,EAAIyC,OAAO,GAAKzqC,KAAK0qC,IACrB1C,EAAIwC,UAAU,GAAI10B,GAClB,MAEF,KAAK,EACHkyB,EAAIyC,OAAO,GAAKzqC,KAAK0qC,IACrB1C,EAAIwC,UAAUzC,GAAQjyB,GACtBkyB,EAAI/pB,OAAO,EAAG,GACd,MAEF,KAAK,EACH+pB,EAAIyC,QAAQ,GAAKzqC,KAAK0qC,IACtB1C,EAAIwC,WAAWzC,EAAO,IAO9B,SAAS4C,EAAaC,EAAUC,GAC5B,IAAIn2B,EAAO/V,KACPqF,OAAOM,MAAQsmC,aAAoBtmC,MACnC,WACI,IAAIkjC,EAAM,IAAIsD,MAASC,EAAM/mC,OAAO+mC,KAAO/mC,OAAO+mC,IAAIC,gBAAkBhnC,OAAO+mC,IAAM/mC,OAAOinC,WAAajnC,OAAOinC,UAAUD,gBAAkBhnC,OAAOinC,UAAY,KAC/J,IAAKF,EACD,MAAM9sC,MAAM,wDAEhBupC,EAAI0D,IAAMH,EAAIC,gBAAgBJ,GAC9Bl2B,EAAKrL,KAAOuhC,EACZA,EAAWpD,EAPf,GAUCoD,EAAShD,cAAiBgD,EAAS9C,gBACpC8C,EAAShhC,OAAS,WACd,IAAIuhC,EAAYz2B,EAAK02B,mBACjBD,IACAz2B,EAAK02B,mBAAqB,KAC1BnlB,YAAW,WACP,IAAK,IAAIzsB,EAAI,EAAGoR,EAAMugC,EAAUvnC,OAAQpK,EAAIoR,EAAKpR,IAC7C2xC,EAAU3xC,OAEf,KAGXoxC,EAAS9gC,QAAU+gC,EACnBlsC,KAAKysC,mBAAqB,IAE9BzsC,KAAKisC,SAAWA,EAEpBD,EAAavvC,UAAUiwC,OAAS,SAAS5uC,EAAQP,GAC7CA,EAAUA,GAAW,GACrB,IAA+SovC,EA+BnSC,EA/BR72B,EAAO/V,KAAM6sC,EAAW7sC,KAAKisC,SAAShD,aAAc6D,EAAY9sC,KAAKisC,SAAS9C,cAAeC,EAAQ7rC,EAAQ6rC,MAAOjyB,EAAS5Z,EAAQ4Z,OAAQ8d,EAAW13B,EAAQ03B,SAAUD,EAAYz3B,EAAQy3B,UAAW8T,GAAY9oC,KAAK0K,MAA2B,eAAnB1K,KAAK0K,KAAKxK,KAAuBwI,EAAU5K,EAAO4K,QAAQF,cAC5RxI,KAAKysC,mBACLzsC,KAAKysC,mBAAmB/pC,MAAK,WACzBqT,EAAK22B,OAAO5uC,EAAQP,OAIxB6rC,IAAUjyB,EACVA,EAAS21B,EAAY1D,EAAQyD,GAAY,EAClC11B,IAAWiyB,EAClBA,EAAQyD,EAAW11B,EAAS21B,GAAa,GAEzC1D,EAAQyD,EACR11B,EAAS21B,GAET7X,GAAYmU,EAAQnU,IAEpB9d,EAAS21B,GADT1D,EAAQnU,GACqB4X,GAAY,GAEzC7X,GAAa7d,EAAS6d,IAEtBoU,EAAQyD,GADR11B,EAAS6d,GACmB8X,GAAa,GAE7CH,EAAM,CACFvD,MAAOA,EACPjyB,OAAQA,GACTvX,GAAG4C,KAAKjF,GAAS,SAASwvC,EAAYC,GACrCL,EAAII,GAAcC,KAEN,QAAZtkC,GAEQkkC,EAAe9uC,EAAOyuC,IAzNtC,SAA8B1D,EAAKn+B,EAAMnN,EAASurC,GAC9C,IAAI/kC,EAASgF,SAASC,cAAc,UAAWhF,EAAOzG,EAAQyG,MAAQ,aAAc+G,EAAU,IAAInL,GAAGoL,QAIrG,OAHA49B,EAAoBC,EAAKn+B,EAAM3G,EAAQxG,EAASurC,GAAU9zB,MAAK,WAC3DjK,EAAQG,QAAQnH,EAAOI,UAAUH,EAAMzG,EAAQ0G,SAAW,QAEvD8G,EAqNCkiC,CAAqBl3B,EAAKk2B,SAAUl2B,EAAKrL,KAAMiiC,EAAK7D,GAAU9zB,MAAK,SAAS5Q,GACxEtG,EAAOyuC,IAAMnoC,EACbwoC,IAAiB9uC,EAAOyuC,KAAOzuC,EAAOmN,QAAUnN,EAAOmN,aAG5C,WAAZvC,GACPkgC,EAAoB5oC,KAAKisC,SAAUjsC,KAAK0K,KAAM5M,EAAQ6uC,EAAK7D,GAElC,mBAAlB9oC,KAAKktC,UACZltC,KAAKktC,SAASpvC,KAGtB8B,GAAGosC,aAAeA,EArQtB,GAuQApsC,GAAG83B,eAAiB,SAAS9xB,GACzB,aACA,SAASunC,EAAMC,GACX,MAAoC,QAA7BA,EAAG1kC,QAAQF,cAEtB,SAAS6kC,EAASD,GACd,MAAoC,WAA7BA,EAAG1kC,QAAQF,cAStB,SAAS8kC,EAAwBC,GAC7B,IAAIC,EAAeD,EAAa3oC,MAAM,KAAMxJ,EAAOoyC,EAAaA,EAAavoC,OAAS,GAAGL,MAAM,KAAK,GAAI4oB,EAAY5tB,GAAGuQ,aAAa/U,GAEpI,OADAoyB,EAAYA,GAAaA,EAAUhlB,eAEjC,IAAK,OACL,IAAK,MACH,MAAO,aAET,IAAK,MACH,MAAO,YAET,IAAK,MACH,MAAO,YAET,IAAK,MACH,MAAO,YAET,IAAK,OACL,IAAK,MACH,MAAO,cAGf,SAASilC,EAAc/T,GACnB,IAAgDgU,EAAgBC,EAAgBC,EAA5EC,EAAe9kC,SAASC,cAAc,KAK1C,OAJA6kC,EAAaC,KAAOpU,EACpBgU,EAAiBG,EAAaE,SAC9BH,EAAaC,EAAaG,KAC1BL,EAAiBE,EAAaI,SAC1BP,EAAellC,gBAAkBnD,OAAO6oC,SAASH,SAASvlC,gBAG1DmlC,EAAenlC,gBAAkBnD,OAAO6oC,SAASD,SAASzlC,eAG1DolC,IAAevoC,OAAO6oC,SAASF,OAASpuC,GAAGwM,MAuBnD,SAAS+hC,EAAkCrvB,EAAa/T,GACpD,IAAIqjC,EAAajB,EAAMruB,IAAgBuuB,EAASvuB,GAShD,OARIquB,EAAMruB,GApBd,SAAkC+pB,EAAK99B,GACnC89B,EAAI59B,OAAS,WACT49B,EAAI59B,OAAS,KACb49B,EAAI19B,QAAU,KACdJ,EAAQG,QAAQ29B,IAEpBA,EAAI19B,QAAU,WACV09B,EAAI59B,OAAS,KACb49B,EAAI19B,QAAU,KACdvF,EAAI,6BAA8B,SAClCmF,EAAQK,QAAQy9B,EAAK,+BAWrBwF,CAAyBvvB,EAAa/T,GAC/BsiC,EAASvuB,GATxB,SAAyC/a,EAAQgH,GAC7ChH,EAAOqmC,gBAAkB,WACrBr/B,EAAQG,QAAQnH,IAQhBuqC,CAAgCxvB,EAAa/T,IAE7CA,EAAQK,QAAQ0T,GAChBlZ,EAAIhG,GAAGqH,OAAO,iDAAkD6X,EAAYpW,SAAU,UAEnF0lC,EAyCX,SAASG,EAAyB7U,EAAK8U,EAAaC,EAAM1vB,EAASE,GAC/D,IAAIyvB,EAAU,IAAIvC,MAASwC,EAAgB,IAAI/uC,GAAGoL,QAClDmjC,EAAkCO,EAASC,GACvClB,EAAc/T,KACdgV,EAAQE,YAAc,aAE1BF,EAAQnC,IAAM7S,EACdiV,EAAc35B,MAAK,WACfm5B,EAAkCK,EAAaC,GACnC,IAAI7uC,GAAGosC,aAAa0C,GAC1BhC,OAAO8B,EAAa,CACtBvZ,SAAUlW,EACViW,UAAWjW,EACX/a,KAAMspC,EAAwB5T,GAC9B8P,OAAQvqB,MAEbwvB,EAAKrjC,SAEZ,SAASyjC,EAA+BnV,EAAKmP,EAAK4F,EAAM1vB,GACpDovB,EAAkCtF,EAAK4F,GACvC7uC,GAAGipC,GAAK5nC,IAAI,CACRg0B,SAAUlW,EAAU,KACpBiW,UAAWjW,EAAU,OAEzB8pB,EAAI0D,IAAM7S,EAEd,SAASoV,EAAYpV,EAAKla,EAAWjiB,GACjC,IA1IIwG,EA0IA0qC,EAAO,IAAI7uC,GAAGoL,QAAWsU,EAAQ/hB,EAAQ+hB,MAAOP,EAAUO,EAAQ/hB,EAAQwhB,QAAU,KAgBxF,OAfIO,GAAS6tB,EAAM3tB,IA3Ifzb,EAASgF,SAASC,cAAc,WACtBsgC,YAAcvlC,EAAOulC,WAAW,MA4IlCmE,EAAc/T,SAhJS/1B,KAA5B,IAAIwoC,OAAQyC,YAiJPC,EAA+BnV,EAAKla,EAAWivB,EAAM1vB,GAErDwvB,EAAyB7U,EAAKla,EAAWivB,EAAM1vB,GAGnD8vB,EAA+BnV,EAAKla,EAAWivB,EAAM1vB,GAElDsuB,EAAS7tB,GAChB+uB,EAAyB7U,EAAKla,EAAWivB,EAAM1vB,GACxCovB,EAAkC3uB,EAAWivB,KACpDjvB,EAAU+sB,IAAM7S,GAEb+U,EAEX7uC,GAAG2B,OAAOvB,KAAM,CACZyf,SAAU,SAASsvB,EAAevvB,EAAWjiB,GACzC,OAAIqC,GAAG+G,SAASooC,IACZnpC,EAAI,4DACGkpC,EAAYC,EAAevvB,EAAWjiB,GAAW,MAExDqI,EAAI,iDA1FhB,SAAcqE,EAAYuV,EAAWjiB,GACjC,IAAIyxC,EAAc,IAAIpvC,GAAGoL,QAAWqb,EAAa,IAAIzmB,GAAGqvC,SAAShlC,EAAYrE,GAAMmZ,EAAUxhB,EAAQwhB,QAASqY,EAA2B,MAAlB75B,EAAQ65B,QAAwB75B,EAAQ65B,OAAQ8X,EAAsB,WACzL1vB,EAAUrU,QAAU,KACpBqU,EAAUvU,OAAS,KACnBrF,EAAI,mDAAoD,SACxDopC,EAAY5jC,QAAQoU,EAAW,iCAgCnC,OA9BA6G,EAAW8oB,gBAAgBn6B,MAAK,SAAShR,GACrC,IAAIorC,EAAY,CACZn/B,MAAO,WACH,OAAO,IAAIrQ,GAAGoL,SAAUE,YAE7BmkC,EAAOjY,EAAS,IAAIx3B,GAAG0vC,KAAKrlC,EAAYrE,GAAOwpC,EAAWG,EAAQ,IAAI3vC,GAAGosC,aAAa/hC,EAAYilC,GACjGf,EAAkC3uB,EAAWwvB,IAC7CK,EAAKp/B,QAAQ+E,MAAK,SAASq6B,GACvB,IAAIzF,EAAcyF,GAAQA,EAAKG,YAC/BD,EAAM7C,OAAOltB,EAAW,CACpByV,SAAUlW,EACViW,UAAWjW,EACX6qB,YAAaA,EACb5lC,KAAMA,EACNwlC,OAAQjsC,EAAQ0hB,0BAErB,SAASwwB,GACR7pC,EAAIhG,GAAGqH,OAAO,iEAAkEwoC,IAChFF,EAAM7C,OAAOltB,EAAW,CACpByV,SAAUlW,EACViW,UAAWjW,EACX/a,KAAMA,EACNwlC,OAAQjsC,EAAQ0hB,6BAI7B,WACCrZ,EAAI,mBACJopC,EAAY5jC,QAAQoU,EAAW,sBAE5BwvB,EAsDQP,CAAKM,EAAevvB,EAAWjiB,GAAW,QAI7DyC,KAAK0vC,SAAW,GAChB1vC,KAAK0vC,SAASvC,MAAQA,EACtBntC,KAAK0vC,SAASrC,SAAWA,EACzBrtC,KAAK0vC,SAASjC,cAAgBA,EAC9BztC,KAAK0vC,SAASpC,wBAA0BA,GAE5C1tC,GAAG0vC,KAAO,SAASrlC,EAAYrE,GAC3B,aACA,IAAI+pC,EAAU,CAAE,KAAOC,EAAW,CAC9BC,IAAK,CACDz0C,KAAM,cACNkP,MAAO,IAGf,SAASwlC,EAAkBC,GAEvB,IADA,IAAI3tC,EAAS,EAAG4tC,EAAM,EACfD,EAAI9qC,OAAS,GAChB7C,GAAUy+B,SAASkP,EAAItoC,UAAU,EAAG,GAAI,IAAMpG,KAAK2uC,IAAI,EAAGA,GAC1DD,EAAMA,EAAItoC,UAAU,EAAGsoC,EAAI9qC,QAC3B+qC,GAAO,EAEX,OAAO5tC,EAuBX,SAAS6tC,IACL,IAAIllC,EAAU,IAAInL,GAAGoL,QAYrB,OAXApL,GAAG6K,cAAcR,EAAY,EAAG,GAAG+K,MAAK,SAAS+6B,GACjB,IAAxBA,EAAIlrC,QAAQ,QACZkG,EAAQK,QAAQ,qBAzB5B,SAAS8kC,EAAWC,EAAQplC,GACxB,IAAIqlC,EAAYD,EAAQE,EAAatlC,EAkBrC,YAjBkBpH,IAAdysC,IACAA,EAAY,EACZC,EAAa,IAAIzwC,GAAGoL,SAExBpL,GAAG6K,cAAcR,EAAYmmC,EAAW,GAAGp7B,MAAK,SAAS+6B,GACrD,IAAqCO,EAAjCr9B,EAAQ,cAAcxP,KAAKssC,GAC3B98B,EACiB,MAAbA,EAAM,IACNq9B,EAAgBzP,SAASkP,EAAI3oC,MAAM,EAAG,GAAI,IAC1C8oC,EAAWE,EAAYE,EAAgB,EAAGD,IAE1CA,EAAWnlC,QAAQklC,GAGvBC,EAAWjlC,QAAQ,kCAGpBilC,EAQCH,GAAal7B,MAAK,SAASm7B,GACvBplC,EAAQG,QAAQilC,MACjB,SAAS5mC,GACRwB,EAAQK,QAAQ7B,SAIrBwB,EAiDXnL,GAAG2B,OAAOvB,KAAM,CACZiQ,MAAO,WACH,IAAIsgC,EAAS,IAAI3wC,GAAGoL,QAAWwlC,EAAiB,SAAS3qC,GACrDD,EAAIhG,GAAGqH,OAAO,kCAAmCpB,IACjD0qC,EAAOnlC,QAAQvF,IAgBnB,OAdAoqC,IAAgBj7B,MAAK,SAASy7B,GArDtC,IAAwBC,EAChB3lC,EAqDInF,EAAIhG,GAAGqH,OAAO,wDAAwEtD,IAApBsG,EAAW7O,KAAqB,OAAS6O,EAAW7O,QAtD1Gs1C,EAuDGD,EAtDnB1lC,EAAU,IAAInL,GAAGoL,QACrBpL,GAAG6K,cAAcR,EAAYymC,EAAY,GAAI,GAAG17B,MAAK,SAAS+6B,GAC1DhlC,EAAQG,QAAgB,SAAR6kC,MAEbhlC,GAkD4BiK,MAAK,SAAS27B,GACrC/qC,EAAIhG,GAAGqH,OAAO,+BAAgC0pC,EAAe,SAAW,QAjDxF,SAA0BD,EAAWC,GACjC,IAAI5lC,EAAU,IAAInL,GAAGoL,QAQrB,OAPApL,GAAG6K,cAAcR,EAAYymC,EAAY,GAAI,GAAG17B,MAAK,SAAS+6B,GAC1D,GAAIY,EACA,OAAO5lC,EAAQG,QAAQ4kC,EAAkBC,IAEzChlC,EAAQG,QAAQ21B,SAASkP,EAAK,QAG/BhlC,EAyCK6lC,CAAiBH,EAAYE,GAAc37B,MAAK,SAAS67B,GACrDjrC,EAAIhG,GAAGqH,OAAO,kCAAmC4pC,IAxCrE,SAAgBH,EAAWI,GACvB,IAAIX,EAASO,EAAY,GAAIpmC,EAAqB,GAAbwmC,EACrC,OAAOlxC,GAAG6K,cAAcR,EAAYkmC,EAAQ7lC,GAuC5BymC,CAAON,EAAYI,GAAe77B,MAAK,SAASg8B,GAC5C,IAAIF,EAtC5B,SAAuBE,GAEnB,IADA,IAAI34B,EAAU,GAAI83B,EAAS,EACpBA,EAAS,IAAMa,EAAO/rC,QACzBoT,EAAQ3V,KAAKsuC,EAAO5pC,MAAM+oC,EAAQA,EAAS,KAC3CA,GAAU,GAEd,OAAO93B,EAgC8B44B,CAAcD,GAASE,EA9BhE,SAAsBP,EAAcG,GAChC,IAAyBK,EAAavxC,GAAG2B,OAAO,GAAIouC,GAAUyB,EAAO,GAcrE,OAbAxxC,GAAG4C,KAAKsuC,GAAY,SAASruC,EAAKq1B,GAC9B,IAA2IuZ,EAAW3oC,EAAS4oC,EAA3JC,EAAQzZ,EAAM1wB,MAAM,EAAG,GAAIkR,EAAKq4B,EAAeb,EAAkByB,GAAS1Q,SAAS0Q,EAAO,IAAKC,EAAgBL,EAAWtsC,QAAQyT,GAQtI,GAPIk5B,GAAiB,IACjB9oC,EAAUknC,EAASt3B,GAAIld,KACvBk2C,EAAe1B,EAASt3B,GAAIhO,MAC5B+mC,EAAYvZ,EAAM1wB,MANL,MAM2D,EAAfkqC,GACzDF,EAAK1oC,GAAWioC,EAAeb,EAAkBuB,GAAaxQ,SAASwQ,EAAW,IAClFF,EAAWh3B,OAAOq3B,EAAe,IAEX,IAAtBL,EAAWlsC,OACX,OAAO,KAGRmsC,EAeiEK,CAAad,EAAcG,GAC/ElrC,EAAI,sCACJ2qC,EAAOrlC,QAAQgmC,KAChBV,KACJA,KACJA,KACJA,GACID,KAGfvwC,KAAK0vC,SAAW,GAChB1vC,KAAK0vC,SAASI,kBAAoBA,GAEtClwC,GAAGqvC,SAAW,SAAShlC,EAAYrE,GAC/B,aAWAhG,GAAG2B,OAAOvB,KAAM,CACZmvC,cAAe,WACX,IAAIp5B,EAAO/V,KAAMqmB,EAAa,IAAIzmB,GAAGoL,QAAW0mC,GAAc,EAAOt2C,OAA2BuI,IAApBsG,EAAW7O,KAAqB,OAAS6O,EAAW7O,KA0BhI,OAzBAwK,EAAIhG,GAAGqH,OAAO,gEAAiE7L,IAC/EwK,EAAI,oDACA5F,KAAK2xC,qBACL/rC,EAAI,sDACJhG,GAAG6K,cAAcR,EAAY,EAAG,GAAG+K,MAAK,SAAS+6B,GAC7CnwC,GAAG4C,KAAKuT,EAAK67B,wBAAwB,SAAS5tC,EAAMsG,GAChD,GAnBgBunC,EAmBU9B,EAlBtC+B,GAAe,EAAOC,EAAoB,GAAG/zC,OAkBdsM,GAjBnC1K,GAAG4C,KAAKuvC,GAAmB,SAAStvC,EAAKuvC,GACrC,GAAwD,IAApDH,EAAkBhtC,QAAQmtC,GAE1B,OADAF,GAAe,GACR,KAGRA,EAgBa,OAJa,eAAT9tC,GAAyBpE,GAAGwR,kBAAkBmD,gBAC9Cm9B,GAAc,EACdrrB,EAAWnb,QAAQlH,KAEhB,EAxB/B,IAAoC6tC,EAC5BC,EAAsBC,KA0BdnsC,EAAIhG,GAAGqH,OAAO,iDAAkD7L,EAAMs2C,EAAc,GAAK,QACpFA,GACDrrB,EAAWjb,aAEhB,WACCxF,EAAI,+BAAiCxK,EAAO,gDAC5CirB,EAAWjb,cAGfib,EAAWjb,UAERib,GAEXsrB,kBAAmB,WACf,IAAIM,EAAWhoC,EAAW/J,KAAMgyC,EAAoBtyC,GAAGiF,QAAQtJ,OAAO6C,KAAK4B,KAAK4xC,wBAAyBK,IAAa,EAAGP,GAAc,EAAOt2C,OAA2BuI,IAApBsG,EAAW7O,KAAqB,OAAS6O,EAAW7O,KASzM,OARI82C,IAEIR,EADa,eAAbO,GACcryC,GAAGwR,kBAAkBmD,eAK1Cm9B,GAAe9rC,EAAIxK,EAAO,gEACpBs2C,MAInB9xC,GAAGqvC,SAASxyC,UAAUm1C,uBAAyB,CAC3C,aAAc,SACd,YAAa,SACb,YAAa,SACb,YAAa,OACb,aAAc,CAAE,WAAY,aAEhChyC,GAAGi0B,gBAAkB,SAASnpB,EAAM9E,GAChC,aA0DA5F,KAAK8zB,SAAW,SAASqe,GACrB,IA/CIC,EA+CAC,EAAmB,IAAIzyC,GAAGoL,QAc9B,OAbApF,EAAI,kCA3DR,SAA0BusC,GACtB,IAAIG,GAAa,EAOjB,OANA1yC,GAAG4C,KAAK2vC,GAAQ,SAASI,EAAOz2C,GAC5B,GAAIA,EAAQ,EAER,OADAw2C,GAAa,GACN,KAGRA,EAoDHE,CAAiBL,GAUjBE,EAAiBnnC,WA3DjBknC,EAAoB,IAAIxyC,GAAGoL,QAC/B,IAAIpL,GAAGqvC,SAASvkC,EAAM9E,GAAKupC,gBAAgBn6B,MAAK,WAC5C,IAAI+e,EAAQ,IAAIoY,MAASzS,EAAMr0B,OAAO+mC,KAAO/mC,OAAO+mC,IAAIC,gBAAkBhnC,OAAO+mC,IAAM/mC,OAAOinC,WAAajnC,OAAOinC,UAAUD,gBAAkBhnC,OAAOinC,UAAY,KAC7J5S,GACA3F,EAAM5oB,QAAU,WACZvF,EAAI,4DAA6D,SACjEwsC,EAAkBhnC,WAEtB2oB,EAAM9oB,OAAS,WACXmnC,EAAkBlnC,QAAQ,CACtBk+B,MAAOppC,KAAKopC,MACZjyB,OAAQnX,KAAKmX,UAGrB4c,EAAMwY,IAAM7S,EAAI2S,gBAAgB3hC,KAEhC9E,EAAI,+DAAgE,SACpEwsC,EAAkBhnC,aAEvBgnC,EAAkBhnC,SACdgnC,GA8Bcp9B,MAAK,SAASy9B,GAC3B,IAAIC,EA7BhB,SAAyBP,EAAQM,GAC7B,IAAIC,EAqBJ,OApBA9yC,GAAG4C,KAAK2vC,GAAQ,SAASQ,EAAWC,GAChC,GAAIA,EAAa,EAAG,CAChB,IAAIC,EAAe,0BAA0BpvC,KAAKkvC,GAAYG,EAAoBD,EAAa,GAAGtkC,OAAO,GAAG/F,cAAgBqqC,EAAa,GAAGzrC,MAAM,GAAI2rC,EAAcN,EAAWK,GAC/K,OAAQD,EAAa,IACnB,IAAK,MACH,GAAIE,EAAcH,EAEd,OADAF,EAAeC,GACR,EAEX,MAEF,IAAK,MACH,GAAII,EAAcH,EAEd,OADAF,EAAeC,GACR,OAMhBD,EAOoBM,CAAgBb,EAAQM,GACvCC,EACAL,EAAiBjnC,QAAQsnC,GAEzBL,EAAiBnnC,YAEtBmnC,EAAiBnnC,SAIjBmnC,IAGfzyC,GAAGmzB,QAAU,SAASva,GAClB,aACA,IAAIjb,EAAU,CACV0e,SAAU,KACVD,OAAQ,GACRoJ,cAAe,GACfG,KAAM,GACN0N,cAAe,SAAShP,KACxBre,IAAK,SAASC,EAASC,MAS3B,SAASmtC,EAAgBC,EAAWhoC,EAASya,EAAU5a,GACnD,IAAIooC,GAAmB,GACvBjoC,EAAUA,GARd,SAA6B4kB,GACzB,GAAIlwB,GAAGhC,QAAQkyB,GACX,OAAO,EAEXvyB,EAAQqI,IAAI,oCAAqC,SAI5BwtC,CAAoBF,KAErCtzC,GAAG4C,KAAK0wC,GAAW,SAASzwC,EAAK85B,GAC7B,GAAqB,MAAjBA,EAAS3jB,KACTu6B,GAAmB,EACnB51C,EAAQqI,IAAIhG,GAAGqH,OAAO,oEAAqExE,GAAM,cAC9F,GAAqB,MAAjB85B,EAASnhC,KAChB+3C,GAAmB,EACnB51C,EAAQqI,IAAIhG,GAAGqH,OAAO,oEAAqExE,GAAM,cAEjG,IAEI,OADAlF,EAAQ01B,cAAcsJ,IACf,EACT,MAAO8W,GACLF,GAAmB,EACnB51C,EAAQqI,IAAIytC,EAAIxtC,QAAS,SAGjC,OAAO,KAGfkF,EAAQG,IAAYioC,EAAmB,UAAY,WAAWD,EAAWvtB,GA9B7E/lB,GAAG2B,OAAOhE,EAASib,GAAM,GAgCzBxY,KAAKkzB,QAAU,WACX,IAAIogB,EAAgB,IAAI1zC,GAAGoL,QAExBuoC,EAAmB3zC,GAAG2B,OAAO,GAAIhE,GAIpC,OAJ0D,IAAIqC,GAAG4zC,qBAAqB5zC,GAAG2B,OAAOgyC,EAAkB,CAC9GvqB,WAH4D,SAAS8G,EAAU5kB,EAASya,GACxFstB,EAAgBnjB,EAAU5kB,EAASya,EAAU2tB,OAIvCG,cACHH,IAGf1zC,GAAG4zC,qBAAuB,SAASh7B,GAC/B,aACA,IAAIkwB,EAAWnrC,EAAU,CACrB0e,SAAU,KACVmJ,cAAe,GACfpJ,OAAQ,GACRuJ,KAAM,CACF6I,UAAU,EACV4I,iBAAiB,GAErBhO,WAAY,SAAS8G,EAAU5kB,EAASya,KACxC/f,IAAK,SAASsB,EAAKpB,MAEvBlG,GAAG2B,OAAOhE,EAASib,GAanBkwB,EAAY9oC,GAAG2B,OAAOvB,KAAM,IAAIJ,GAAGm4B,cAAc,CAC7CI,aAAc,mBACdC,aAAc,CAAE,OAChBtT,OAAQ,MACRQ,cAAe,CACX5pB,IAAK,WACD,OAAO6B,EAAQ0e,WAGvBmJ,cAAe7nB,EAAQ6nB,cACvBxf,IAAKrI,EAAQqI,IACbojB,WAvBJ,SAAoB1Q,EAAIqN,EAAUC,GAC9B,IAAIkK,EAAW,KACf,GAA6B,MAAzBnK,EAAS+tB,aACT,IACI5jB,EAAWlwB,GAAGkQ,UAAU6V,EAAS+tB,cACnC,MAAOL,GACL91C,EAAQqI,IAAI,qCAAuCytC,EAAIxtC,QAAS,SAChE+f,GAAU,EAGlBroB,EAAQyrB,WAAW8G,GAAWlK,EAASD,IAcvCJ,KAAMhoB,EAAQgoB,QAElB3lB,GAAG2B,OAAOvB,KAAM,CACZyzC,YAAa,WACT,IAAIz3B,EAASpc,GAAG2B,OAAO,GAAIhE,EAAQye,QACnCze,EAAQqI,IAAI,0BACZ8iC,EAAUvN,cAAc,kBAAkBK,WAAWxf,GAAQ8f,kBAAkBb,WAI3Fr7B,GAAG0iB,OAAS,SAAS9J,EAAM5S,GACvB,aACA,IAAiBqZ,EAAuBzG,EAAK0e,cAAeyc,EAAkBn7B,EAAK2e,aAAcC,EAAS5e,EAAK4e,OAAQC,EAAc7e,EAAK6e,YAAaC,EAAiB9e,EAAK8e,eAAiB,IAAKsc,EAAoBp7B,EAAK+e,YAAaC,EAAchf,EAAKgf,YAAaC,EAAQz3B,KAAK6zC,gBAAgBr7B,EAAKif,OAC3S73B,GAAG2B,OAAOvB,KAAM,CACZqe,QAASze,GAAGwR,kBAAkBkD,SAAWmjB,EAAMxyB,OAAS,EACxD6uC,eAAgB,SAASC,EAAkBC,EAAkBC,GACzD,IAAIl+B,EAAO/V,KAAMk0C,EAAU,GAAIC,EAAeF,EAAuBvpC,KAAOupC,EAAuBvpC,KAAOupC,EAyC1G,OAzC+I,IAAIr0C,GAAGqvC,SAASkF,EAAcvuC,GAC9J+rC,qBACX/xC,GAAG4C,KAAKi1B,GAAO,SAASh1B,EAAK2xC,GACzB,IAAIC,EAAat+B,EAAKu+B,qBAAqB,CACvCjd,YAAaA,EACbkd,cAAeH,EAAWl0C,KAC1Bs0C,QAASL,EAAaj0C,OAE1Bg0C,EAAQxxC,KAAK,CACTkW,KAAMhZ,GAAGsM,cACT9Q,KAAM2a,EAAK0+B,SAAST,EAAkB,CAClC54C,KAAMg5C,EAAWh5C,KACjB8E,KAAMm0C,EACNG,QAASL,EAAaj0C,OAE1BwK,KAAM,IAAI9K,GAAG8V,UAAUy+B,EAAcv0C,GAAGvD,KAAK0Z,EAAK2+B,qBAAsB3+B,EAAM,CAC1EkJ,qBAAsBA,EACtBF,QAASq1B,EAAWr1B,QACpBqY,OAAQA,EACRl3B,KAAMm0C,EACNpwC,QAASqzB,EACTqd,WAAYf,EACZpc,YAAaA,EACb5xB,IAAKA,UAIjBsuC,EAAQxxC,KAAK,CACTkW,KAAMm7B,EACN34C,KAAM44C,EACNn7B,KAAMs7B,EAAat7B,KACnBnO,KAAMipC,EAAkBQ,EAAe,QAG3CD,EAAQxxC,KAAK,CACTkW,KAAMm7B,EACN34C,KAAM44C,EACNn7B,KAAMs7B,EAAat7B,KACnBnO,KAAMypC,IAGPD,GAEXtc,cAAe,SAAS9e,EAAM1d,EAAMwd,EAAMC,EAAMyU,EAAUvU,EAASkM,EAAe2vB,GAClD97B,EAAKyL,YAAczL,EAAKpO,MAAQoO,EAAKpO,KAAK6Z,WAAtE,IA8CgBswB,EA9CkEC,EAAY,GAAIC,EAAa,KAAM3nB,EAAmBwnB,EAAIxnB,iBAAkBxP,EAAag3B,EAAIh3B,WAAYyH,EAAcuvB,EAAIvvB,YAAarM,EAAepZ,GAAGsM,cAC5OtM,GAAG4C,KADQxC,KACE8zC,eAAel7B,EAAMxd,EAAM0d,IAAO,SAASrW,EAAKqX,GACzD,IAA4BxB,EAAxB08B,EAAWl7B,EAAOjB,KAClBiB,EAAOpP,gBAAgB9K,GAAG8V,YAC1Bs/B,GAAY,GAEhB18B,EAAKsF,EAAWrF,QAAQ,CACpBK,KAAMkB,EAAOlB,KACbxd,KAAM0e,EAAO1e,KACbyd,KAAMm8B,EACNj8B,QAASA,EACTC,aAAcA,IAEdc,EAAOpP,gBAAgB9K,GAAG8V,UAC1Bo/B,EAAUpyC,KAAK4V,GAEfy8B,EAAaz8B,EAEbwB,EAAOpP,MACP0iB,EAAiB9U,EAAIwB,EAAOpP,MAC5B4iB,EAAS5qB,KAAK,CACV4V,GAAIA,EACJQ,KAAMgB,EAAOpP,QAGjBkT,EAAW7D,UAAUzB,EAAI1Y,GAAG6Y,OAAOwC,aAGxB,OAAf85B,IACAn1C,GAAG4C,KAAKsyC,GAAW,SAASryC,EAAKwyC,GAC7B,IAAIj5B,EAAS,CACTk5B,aAAct3B,EAAWzE,SAAS,CAC9Bb,GAAIy8B,IACLn8B,KACHu8B,aAAcv3B,EAAWzE,SAAS,CAC9Bb,GAAIy8B,IACLl8B,MAEPmD,EAAOiJ,GAAiBrH,EAAWzE,SAAS,CACxCb,GAAI28B,IACLr8B,KACHgF,EAAWjD,YAAYs6B,EAAUF,GACjC1vB,EAAY6B,YAAY+tB,EAAUj5B,MAElC84B,EAAU7vC,UAEF4vC,EAAQ,IACN5vB,GAAiBrH,EAAWzE,SAAS,CACvCb,GAAIy8B,IACLn8B,KACHyM,EAAY6B,YAAY6tB,EAAYF,SAO5Dj1C,GAAG2B,OAAO3B,GAAG0iB,OAAO7lB,UAAW,CAC3B2lB,WAAY,SAAS9J,EAAI+J,EAAOuyB,GAC5B,aACA,IAAKh1C,GAAGwR,kBAAkBkD,QACtB,MAAM,IAAI1U,GAAGN,MAAM,6CAEvB,IAAI81C,EAAgB,IAAIx1C,GAAGoL,QAAWpF,EAAMgvC,EAAIhvC,IAAKkT,EAAO87B,EAAIr1B,QAAQjH,GAAKsF,EAAag3B,EAAIh3B,WAAWzE,SAAS,CAC9Gb,GAAIA,IACJld,EAAOwiB,GAAcA,EAAWxiB,KAAMwd,EAAOgF,GAAcA,EAAWhF,KAAMy8B,EAAiB,CAC7Fne,cAAe7U,EAAM6U,cACrBC,cAAc,EACdC,OAAQ/U,EAAM+U,OACdC,YAAahV,EAAMniB,MAAQ,KAC3Bo3B,eAAgBjV,EAAMpe,QACtB2vC,kBAAmB,kBACnBnc,MAAO,CAAE,CACLr8B,KAAM,GACN2jB,QAASsD,EAAMtD,WAEpBu2B,EAAS,IAAI11C,GAAG0iB,OAAO+yB,EAAgBzvC,GAe1C,OAdKhG,GAAG0iB,QAAW1iB,GAAGwR,kBAAkB4C,eAAkB8E,EAItDlZ,GAAGvD,MAAK,WACJ,IAAIyd,EAASw7B,EAAOxB,eAAel7B,EAAMxd,EAAM0d,GAAM,GACjDgB,GAAUA,EAAOpP,gBAAgB9K,GAAG8V,UACpCoE,EAAOpP,KAAKvO,SAAS6Y,KAAKogC,EAAclqC,QAASkqC,EAAchqC,UAE/DxF,EAAI0S,EAAK,4BAA6B,SACtC88B,EAAchqC,aAEnBpL,KARHJ,IAHAw1C,EAAchqC,UACdxF,EAAI,iDAAmD0S,EAAK,uFAA6F,UAYtJ88B,GAEXd,qBAAsB,SAAS97B,GAC3B,aACA,IAAI+7B,EAAgB/7B,EAAK+7B,cAAeld,EAAc7e,EAAK6e,YAAake,EAAgB/8B,EAAKg8B,QAC7F,OAAKnd,GAAgBkd,EAMhBA,GAGD30C,GAAGiF,QAAQtJ,OAAO6C,KAAKwB,GAAGqvC,SAASxyC,UAAUm1C,wBAAyB2C,IAAkB,EAClE,eAAlBA,EACO30C,GAAGwR,kBAAkBmD,aAAeggC,EAAgBld,EAExDkd,EANAld,EANe,eAAlBke,EACO,YAEJA,GAafd,SAAU,SAAS97B,EAAc68B,GAC7B,aACA,IAAIC,EAAa98B,EAAarI,YAAY,KAAMolC,EAAcF,EAAwBt1C,MAAQ,YAAaq1C,EAAgBC,EAAwBhB,QAASmB,EAAa,GAAIC,EAAYh2C,GAAGuQ,aAAawI,GAAek9B,EAAgB,GAaxO,OAZIL,EAAwBp6C,MAAQo6C,EAAwBp6C,KAAK4L,OAAO/B,SACpE4wC,EAAgB,KAAOL,EAAwBp6C,KAAO,KAEtDq6C,GAAc,GACdE,EAAah9B,EAAapI,OAAO,EAAGklC,GAChCF,IAAkBG,IAClBE,EAAYF,EAAY9wC,MAAM,KAAK,IAEvC+wC,GAAcE,EAAgB,IAAMD,GAEpCD,EAAah9B,EAAek9B,EAEzBF,GAEX9B,gBAAiB,SAASpc,GACtB,aAEA,OADAA,EAAQ73B,GAAG2B,OAAO,GAAIk2B,IACTqe,MAAK,SAASC,EAAGC,GAC1B,OAAID,EAAEh3B,QAAUi3B,EAAEj3B,QACP,EAEPg3B,EAAEh3B,QAAUi3B,EAAEj3B,SACN,EAEL,MAGf21B,qBAAsB,SAASl8B,EAAMy9B,GACjC,aACA,IAAIlgC,EAAO/V,KAAMif,EAAuBzG,EAAKyG,qBAAsBrZ,EAAM4S,EAAK5S,IAAKmZ,EAAUvG,EAAKuG,QAASqY,EAAS5e,EAAK4e,OAAQl3B,EAAOsY,EAAKtY,KAAM+D,EAAUuU,EAAKvU,QAAS0wC,EAAan8B,EAAKm8B,WAAYnd,EAAchf,EAAKgf,aAAmC,eAApBye,EAAW/1C,MAAkC,eAATA,EAAuBk1C,EAAgB,IAAIx1C,GAAGoL,QAAWkrC,EAAiB,IAAIt2C,GAAG83B,eAAe9xB,GAAM7B,EAASgF,SAASC,cAAc,UA2BrZ,OA1BApD,EAAI,6CAA+CqwC,EAAW76C,MAC9D86C,EAAez2B,SAASw2B,EAAYlyC,EAAQ,CACxCgb,QAASA,EACTqY,OAAQA,EACRnY,qBAAsBA,IACvBjK,MAAK,WACJ,IAAImhC,EAAqBpyC,EAAOI,UAAUjE,EAAM+D,GAAUmyC,EAAgB,WACtExwC,EAAI,yCAA2CqwC,EAAW76C,MAC1D,IAAIsP,EAAO9K,GAAGsE,cAAciyC,GAC5Bf,EAAclqC,QAAQR,IAEtB8sB,EACAzhB,EAAKsgC,kBAAkBJ,EAAYE,EAAoBvwC,GAAKoP,MAAK,SAASshC,GACtEH,EAAqBG,EACrBF,OACD,WACCxwC,EAAI,wFAAyF,SAC7FwwC,OAGJA,OAEL,WACCxwC,EAAI,iDAAmDqwC,EAAW76C,KAAM,SACxEg6C,EAAchqC,QAAQupC,MAEnBS,GAEXiB,kBAAmB,SAASE,EAAeJ,EAAoBvwC,GAC3D,aACA,IAAI4wC,EAAS,IAAI1rC,WAAc2rC,EAAkB,IAAI72C,GAAGoL,QAAW0rC,EAAuB,GAU1F,OATAF,EAAOvrC,OAAS,WACZyrC,EAAuBF,EAAOp0C,OAC9Bq0C,EAAgBvrC,QAAQtL,GAAGgE,aAAagoC,QAAQ8K,EAAsBP,KAE1EK,EAAOrrC,QAAU,WACbvF,EAAI,mBAAqB2wC,EAAcn7C,KAAO,2DAA4D,SAC1Gq7C,EAAgBrrC,WAEpBorC,EAAOG,cAAcJ,GACdE,GAEXG,eAAgB,SAASxyC,GACrB,aACA,IAAIE,EAAYE,EAAYH,EAAaE,EAYzC,OAVID,EADAF,EAAQQ,MAAM,KAAK,GAAGC,QAAQ,WAAa,EAC9BC,KAAKV,EAAQQ,MAAM,KAAK,IAExBG,UAAUX,EAAQQ,MAAM,KAAK,IAE9CJ,EAAaJ,EAAQQ,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGA,MAAM,KAAK,GAC5DP,EAAc,IAAIW,YAAYV,EAAWW,QACzCV,EAAW,IAAIW,WAAWb,GAC1BzE,GAAG4C,KAAK8B,GAAY,SAAS7B,EAAK0C,GAC9BZ,EAAS9B,GAAO0C,EAAUC,WAAW,MAElCpF,KAAK62C,YAAYxyC,EAAaG,IAEzCqyC,YAAa,SAASpyC,EAAMT,GACxB,aACA,IAAIU,EAAcW,OAAOX,aAAeW,OAAOC,mBAAqBD,OAAOE,gBAAkBF,OAAOG,cAAeb,EAAcD,GAAe,IAAIA,EACpJ,OAAIC,GACAA,EAAYc,OAAOhB,GACZE,EAAYe,QAAQ1B,IAEpB,IAAI2B,KAAK,CAAElB,GAAQ,CACtBvE,KAAM8D,OAKtBpE,GAAGgE,cACKA,aAAe,CACnBA,QAAuB,oEACvBA,SAAwB,SAASkF,GAC7B,IAAiBguC,EAAMC,EAAiBC,EAAMC,EAAMC,EAAhDC,EAAS,GAAgBC,EAAO,GAAsBC,EAAO,GAAIx8C,EAAI,EACzE,GAIIm8C,GAHAF,EAAOhuC,EAAMjO,OAGE,EACfo8C,GAAe,EAAPH,IAAa,GAHrBC,EAAOjuC,EAAMjO,OAGoB,EACjCq8C,GAAe,GAAPH,IAAc,GAHtBK,EAAOtuC,EAAMjO,OAGqB,EAClCw8C,EAAc,GAAPD,EACHE,MAAMP,GACNG,EAAOG,EAAO,GACPC,MAAMF,KACbC,EAAO,IAEXF,EAASA,EAASn3C,KAAKu3C,QAAQhpC,OAAOyoC,GAAQh3C,KAAKu3C,QAAQhpC,OAAO0oC,GAAQj3C,KAAKu3C,QAAQhpC,OAAO2oC,GAAQl3C,KAAKu3C,QAAQhpC,OAAO8oC,GAC1HP,EAAOC,EAAOK,EAAO,GACrBJ,EAAOC,EAAOC,EAAOG,EAAO,SACvBx8C,EAAIiO,EAAM7D,QACnB,OAAOkyC,GAEXvzC,QAAuB,SAAS4zC,EAAgBC,GAE5C,IAAKD,EAAevkC,MADO,2BAEvB,OAAOwkC,EAEX,IAAIC,EAAW13C,KAAK23C,SAASH,EAAex1C,QAJjB,0BAI+C,KACtE41C,EAAW53C,KAAK63C,eAAeH,GAC/B3jB,EAAQ/zB,KAAK83C,iBAAiBL,EAAmBG,GACrD,MAP2B,0BAOG53C,KAAK+3C,SAAShkB,IAEhDnwB,iBAAgC,SAAS6zC,EAAmBG,GACxD,IAAII,EAAYh4C,KAAKi4C,aAAaL,GAAWM,EAAgBl4C,KAAKm4C,WAAWV,EAAmBO,GAChG,OADsH,IAAI9yC,WAAWgzC,IAGzIt0C,aAA4B,SAASg0C,GAEjC,IADA,IAAIQ,EACKC,EAAI,EAAGA,EAAIT,EAAS3yC,OAAQozC,IAEjC,GAAc,MADdD,EAAMR,EAASS,IACP,GAAsB,KAAVD,EAAI,GACpB,OAAOA,EAGf,MAAO,IAEXx0C,WAA0B,SAAS6zC,EAAmBO,GAClD,IAAIM,EAAYb,EAAkBz1C,QAAQ,0BAA2B,IAAKu2C,EAAMv4C,KAAK23C,SAASW,GAAYE,EAAgBD,EAAI1zC,QAAQ,IAAK,GAAI4zC,EAAMF,EAAInxC,MAAM,EAAGoxC,GAAgBE,EAAMH,EAAInxC,MAAMoxC,GAAgBn5C,EAAQo5C,EAG1N,OADAp5C,GADAA,EAAQA,EAAMrB,OAAOg6C,IACPh6C,OAAO06C,IAGzB90C,eAA8B,SAAS+0C,GAEnC,IADA,IAAIC,EAAO,EAAGhB,EAAW,KAEM,KAAvBe,EAAcC,GAA0C,KAA3BD,EAAcC,EAAO,KADhD,CAIN,GAA2B,KAAvBD,EAAcC,GAA0C,KAA3BD,EAAcC,EAAO,GAClDA,GAAQ,MACL,CACH,IAAsEC,EAAWD,GAA1C,IAA1BD,EAAcC,EAAO,GAAWD,EAAcC,EAAO,IAA+B,EAAGR,EAAMO,EAAcvxC,MAAMwxC,EAAMC,GACpIjB,EAASl1C,KAAK01C,GACdQ,EAAOC,EAEX,GAAID,EAAOD,EAAc1zC,OACrB,MAGR,OAAO2yC,GAEXh0C,SAAwB,SAASkF,GAC7B,IAAiBguC,EAAMC,EAAuBE,EAAMC,EAAvBE,EAAO,GAAsBC,EAAO,GAAIx8C,EAAI,EAAG09C,EAAM,GAElF,GADiB,sBACF90C,KAAKqF,GAChB,MAAM,IAAIxJ,MAAM,wHAEpBwJ,EAAQA,EAAM9G,QAAQ,sBAAuB,IAC7C,GAKI80C,EAJO92C,KAAKu3C,QAAQ1yC,QAAQiE,EAAMyF,OAAO1T,OAI1B,GAHfo8C,EAAOj3C,KAAKu3C,QAAQ1yC,QAAQiE,EAAMyF,OAAO1T,QAGd,EAC3Bk8C,GAAe,GAAPE,IAAc,GAHtBC,EAAOl3C,KAAKu3C,QAAQ1yC,QAAQiE,EAAMyF,OAAO1T,QAGP,EAClCu8C,GAAe,EAAPF,IAAa,GAHrBG,EAAOr3C,KAAKu3C,QAAQ1yC,QAAQiE,EAAMyF,OAAO1T,OAIzC09C,EAAI71C,KAAKo0C,GACG,IAARI,GACAqB,EAAI71C,KAAKq0C,GAED,IAARM,GACAkB,EAAI71C,KAAK00C,GAEbN,EAAOC,EAAOK,EAAO,GACdH,EAAOC,EAAOG,EAAO,SACvBx8C,EAAIiO,EAAM7D,QACnB,OAAOszC,IAEJ30C,cAEXhE,GAAGi4B,cAAgB,SAAS1pB,EAAUoS,GAClC,aACA,IAAIu4B,EAAkB,GAAIC,EAAc,EAAGC,EAAY,EAAGC,GAAkB,EAAGC,GAAiB,EAAGC,EAAgB,SAAStwB,EAAQC,GAC5HD,IAAWowB,GAAkBnwB,IAAUowB,GACvC/qC,EAAS0a,EAAQC,GAErBmwB,EAAiBpwB,EACjBqwB,EAAgBpwB,GAkBjBswB,EAAQ,SAAS9gC,GAChB,IAAIO,EAAO0H,EAAQjI,GACfO,EAAO,IACPwgC,EAAoB/gC,EAAI,EAAGO,GAC3BigC,EAAgBxgC,GAAM,CAClBuQ,OAAQ,EACRC,MAAOjQ,KAGhBwgC,EAAsB,SAAS/gC,EAAIghC,EAAWC,GAC7C,IAAIC,EAAYV,EAAgBxgC,GAAMwgC,EAAgBxgC,GAAIuQ,OAAS,EAAG4wB,EAAWX,EAAgBxgC,GAAMwgC,EAAgBxgC,GAAIwQ,MAAQ,GAChH,IAAfwwB,IAAkC,IAAdC,GACpBR,GAAeS,EACfR,GAAaS,IAETH,IACAP,GAAeO,EAAYE,GAE3BD,IACAP,GAAaO,EAAWE,IAGhCN,EAAcJ,EAAaC,IAE/Bp5C,GAAG2B,OAAOvB,KAAM,CACZ0wB,cA9Be,SAASF,EAAYC,EAAQipB,IACtB,IAAlBjpB,EAAOxrB,QAbO,SAASwrB,EAAQipB,GACnC,IAAIC,GAAO,EAOX,OANA/5C,GAAG4C,KAAKiuB,GAAQ,SAAShuB,EAAKm3C,GAC1B,GAAIh6C,GAAGiF,QAAQ60C,EAAWE,IAAa,EAEnC,OADAD,GAAO,GACA,KAGRA,EAKoBE,CAAiBppB,EAAQipB,MAChDP,EAAcH,EAAWA,GACzBh5C,KAAK4X,UA4BTsB,eAAgB,SAASZ,EAAI2B,EAAWD,GAChCA,IAAcpa,GAAG6Y,OAAO0C,UAAYnB,IAAcpa,GAAG6Y,OAAOwC,SAnC1D,SAAS3C,GACnB+gC,EAAoB/gC,GAAK,GAAI,UACtBwgC,EAAgBxgC,GAkCf8Q,CAAS9Q,GACF0B,IAAcpa,GAAG6Y,OAAOC,YAC/B0gC,EAAM9gC,IAGd8Y,qBAAsB,SAAS9Y,EAAIuQ,EAAQC,GACvCuwB,EAAoB/gC,EAAIuQ,EAAQC,GAChCgwB,EAAgBxgC,GAAM,CAClBuQ,OAAQA,EACRC,MAAOA,IAGfuK,UAAW,SAAS/a,GAChB8gC,EAAM9gC,IAEVV,MAAO,WACHkhC,EAAkB,GAClBC,EAAc,EACdC,EAAY,MAIxBp5C,GAAGkmB,aAAe,SAASxqB,GACvB,aACA,IAAIiC,EAASu8C,EACbv8C,EAAU,CACNwoB,cAAe,KACfrB,UAAW,CACP9e,IAAK,SAASC,EAASC,KACvBmgB,cAAe,SAASvb,OAwBhC9K,GAAG2B,OAAOhE,EAASjC,GAjBfw+C,EAAqBl6C,GAAGrC,EAAQwoB,eAAe9lB,OAAO,SAAS,SAAS4yB,GACpE,IAAIknB,EAAgBlnB,EAAMknB,cACtBA,GACAn6C,GAAG4C,KAAKu3C,EAAcrwC,OAAO,SAASjH,EAAKgE,GACvC,GARhB,SAAiBA,GACb,OAAOA,EAAKvG,MAAwC,IAAhCuG,EAAKvG,KAAK2E,QAAQ,UAOtBm1C,CAAQvzC,GAAO,CACf,IAAIiE,EAAOjE,EAAKwzC,YAChB18C,EAAQmnB,UAAUuB,cAAcvb,UAapD9K,GAAG2B,OAAOvB,KAAM,CACZ4X,MAAO,WAPHkiC,GACAA,QAWZl6C,GAAGiuB,YAAc,SAAStwB,EAAS28C,EAAat0C,GAC5C,aACA,IAAImQ,EAAO/V,KAAMi3B,EAAkB15B,EAAQ05B,gBAAiBkjB,EAAS58C,EAAQW,QAAS8vB,EAAazwB,EAAQywB,WAiB3G,SAASosB,EAAaD,EAAQE,GAC1B,IAAIF,EAAOG,eAAkBH,EAAOG,gBAIhC,OAAO,EAHP10C,EAAI,yDAA0D,SAC9Dy0C,IAnBRz6C,GAAG2B,OAAOvB,KAAM,CACZkuB,YAAa,KACbD,cAAeD,EACfF,gBAAgB,EAChBC,sBAAuB,WACnB,OAAc,MAAVosB,EACO,KAEJpkC,EAAKwkC,UAAUJ,MA4C9BA,EAbA,SAAyBA,GAWrB,OAVIA,IACIv6C,GAAG+G,SAASwzC,KACZA,EAASpxC,SAAS66B,eAAeuW,IAEjCA,IACAv0C,EAAI,8BAlChB,SAA8Bu0C,GACtBA,EAAOz2C,aAAa,YACpBqS,EAAKmY,YAAcisB,EAAOz2C,aAAa,WAiCnC82C,CAAqBL,GACrBljB,GAvBZ,SAA6BkjB,GACzB,IAAIE,EAAeF,EAAOM,OAC1B76C,GAAGu6C,GAAQl6C,OAAO,UAAU,SAAS4yB,IACjCA,EAAQA,GAASxtB,OAAOwtB,OACdjlB,eACNilB,EAAMjlB,iBAENilB,EAAM/kB,aAAc,EAExBssC,EAAaD,EAAQE,IAAiBH,OAE1CC,EAAOM,OAAS,WACZL,EAAaD,EAAQE,IAAiBH,KAWfQ,CAAoBP,KAGxCA,EAEFQ,CAAgBR,GACzBn6C,KAAK8tB,iBAAmBqsB,GAE5Bv6C,GAAG2B,OAAO3B,GAAGiuB,YAAYpxB,UAAW,CAChC89C,UAAW,SAAS5qC,GAChB,aACA,IAAId,EAAM,GAKP+rC,EAAc,SAASxN,GACtB,OAH0BltC,EAGNktC,EAAGltC,KAFhBN,GAAGiF,QAAQ,CAAE,WAAY,SAAW3E,EAAKsI,gBAAkB,IAEjC4kC,EAAGyN,SAG7BzN,EAAGz6B,UAAsC,WAA1By6B,EAAGltC,KAAKsI,cANb,IAAStI,GA2B9B,OAVAN,GAAG4C,KAAKmN,EAAKmrC,UAAU,SAASr4C,EAAK2qC,GACjC,IAAKxtC,GAAGuI,QAAQilC,GAAI,IAAsC,aAA7BA,EAAG1kC,QAAQF,iBArBDtI,EAqBoDktC,EAAGltC,KAnBvFN,GAAGiF,QADY,CAAE,SAAU,QAAS,QAAS,UACjB3E,EAAKsI,eAAiB,KAmB+CoyC,EAAYxN,GAChHv+B,EAAIu+B,EAAGhyC,MAAQgyC,EAAGtxC,WACf,GAAiC,WAA7BsxC,EAAG1kC,QAAQF,gBAA+BoyC,EAAYxN,GAAK,CAClE,IAAItxC,EAdK,SAASi/C,GACtB,IAAIj/C,EAAQ,KAOZ,OANA8D,GAAG4C,KAAK5C,GAAGm7C,GAAQn4C,YAAY,SAASH,EAAKI,GACzC,GAAoC,WAAhCA,EAAM6F,QAAQF,eAA8B3F,EAAMm4C,SAElD,OADAl/C,EAAQ+G,EAAM/G,OACP,KAGRA,EAMSm/C,CAAY7N,GACV,OAAVtxC,IACA+S,EAAIu+B,EAAGhyC,MAAQU,GA1BO,IAASoE,KA8BpC2O,KAGfjP,GAAG4hC,YAAc5hC,GAAG4hC,aAAe,GACnC5hC,GAAG4hC,YAAY0B,kBAAoB,SAAS3lC,EAAS8+B,GACjD,aACA,IAAIpP,EAAUjtB,KAAM8d,EAAUue,EAAMve,QAASgD,EAAUub,EAAMvb,QAASlb,EAAMy2B,EAAMz2B,IAgClF5F,KAAKkhC,WAAa,SAAS5oB,GACvB,IAAkG3I,EAA9F7G,EAAQmkB,EAAQ3V,SAASgB,GAAKqrB,EAAS1W,EAAQsX,cAAcjsB,GAAKvN,EAAU,IAAInL,GAAGoL,QAmBvF,OAlBA2E,EAdJ,SAAoB2I,EAAIqrB,GACpB,IAAI3nB,EAASze,EAAQ8nB,YAAY3pB,IAAI4c,GAAKwM,EAA0C,QAAjCvnB,EAAQunB,OAAOtc,cAA0B,MAAQ,OAAQyT,EAAW1e,EAAQ+nB,cAAc5pB,IAAI4c,GAAKld,EAAO0iB,EAAQxF,GAGrK,OAFA0D,EAAOze,EAAQ4nB,UAAYrE,EAAQxI,GACnC0D,EAAOze,EAAQm3B,eAAiBt5B,EACzB6xB,EAAQwX,mBAAmB,CAC9B3f,OAAQA,EACR7I,SAAUA,EACVD,OAAQA,EACR6Y,aAAct3B,EAAQs3B,aACtB6P,WAAYf,EAAOvoC,OAKhB8/C,CAAW5iC,EAAIqrB,IACjB9zB,YAAY/G,GACjBmkB,EAAQ8W,iBAAiBJ,GAAQ,SAASwX,GACtCv1C,EAAI,iBACJ,IAAIkqB,EAAWqrB,GArCvB,SAA8B7iC,EAAIqrB,GAC9B,IAAI7T,EAAUsrB,EAAKC,EACnB,IAEIA,GADAD,EAAMzX,EAAOU,iBAAmBV,EAAO2X,cAAcvyC,UACrCu7B,KAAKr2B,UACrBrI,EAAI,yCACJA,EAAI,eAAiBy1C,GACjBA,GAAaA,EAAUpoC,MAAM,YAC7BooC,EAAYD,EAAI9W,KAAKxhC,WAAWA,WAAWy4C,WAE/CzrB,EAAW7C,EAAQiX,mBAAmBmX,GACxC,MAAO9xC,GACL3D,EAAI,wDAA0D2D,EAAM1D,QAAU,IAAK,SACnFiqB,EAAW,CACP5kB,SAAS,GAGjB,OAAO4kB,EAoBwD0rB,CAAqBljC,EAAIqrB,GACpF1W,EAAQkX,iBAAiB7rB,GACpB/a,EAAQgoB,KAAK6I,UACdxuB,GAAG+jC,GAAQ5iC,SAEX+uB,EAAS5kB,QACTH,EAAQG,QAAQ4kB,GAEhB/kB,EAAQK,QAAQ0kB,MAGxBlqB,EAAI,8BAAgC0S,GACpC3I,EAAK8qC,SACL76C,GAAG+P,GAAM5O,SACFgK,GAEXnL,GAAG2B,OAAOvB,KAAM,IAAIJ,GAAGsjC,kBAAkB,CACrC3lC,QAAS,CACLgmC,OAAQhmC,EAAQgoB,KAAK6I,SACrBlG,UAAW3qB,EAAQ2qB,WAEvBmU,MAAO,CACHjT,SAAU7rB,EAAQ6rB,SAClBtL,QAASA,EACTgD,QAASA,EACTlb,IAAKA,OAIjBhG,GAAG4hC,YAAc5hC,GAAG4hC,aAAe,GACnC5hC,GAAG4hC,YAAYoD,iBAAmB,SAASpsB,EAAM6jB,GAC7C,aACA,IAAIpP,EAAUjtB,KAAM8d,EAAUue,EAAMve,QAASyC,EAAU8b,EAAM9b,QAASO,EAAUub,EAAMvb,QAASlb,EAAMy2B,EAAMz2B,IAAK61C,EAAYjjC,EAAKmc,gBAAkBnc,EAAKqc,aAYrJ6mB,EAAyB,IAAI97C,GAAG4hC,YAAYma,2BAA2B,CACtEp2B,KAAM/M,EAAK+M,KACXtJ,SAAUzD,EAAKjF,SAASrI,QAAQ+Q,SAChCuG,QAAShK,EAAKjF,SAASrI,QAAQsX,QAC/BkU,YAAale,EAAKjF,SAASrI,QAAQwrB,YACnC9wB,IAAKA,EACLkf,OAAQtM,EAAKjF,SAASrI,QAAQ4Z,OAC9B9I,OAAQxD,EAAKjF,SAASrI,QAAQ8Q,SAC9B4/B,EAAiC,SAAStjC,EAAI2Q,GAC9C,IAAIle,EAAU,IAAInL,GAAGoL,QAWrB,OAVAie,EAAImR,mBAAqB,WACrB,GAAuB,IAAnBnR,EAAIoR,WAAkB,CACtB,IAAIj4B,EAASy5C,EAAwBvjC,EAAI2Q,GACrC7mB,EAAO8I,QACPH,EAAQG,QAAQ9I,EAAO0tB,SAAU7G,GAEjCle,EAAQK,QAAQhJ,EAAO0tB,SAAU7G,KAItCle,GAQR+wC,EAAwB,SAAS7yB,EAAK6G,GACrC,OAAOlwB,GAAGiF,QAAQ,CAAE,IAAK,IAAK,IAAK,IAAK,KAAOokB,EAAIxQ,QAAU,GAAKD,EAAKsc,qBAAuBhF,EAAS5kB,SAAW4kB,EAASlY,OAC5HikC,EAA0B,SAASvjC,EAAI2Q,GACtC,IAAI6G,EAIJ,OAHAlqB,EAAI,sCAAwC0S,GAC5C1S,EAAI,kBAAoBqjB,EAAIyqB,cAC5B5jB,EAAWisB,GAAc,EAAM9yB,GACxB,CACH/d,SAAU4wC,EAAsB7yB,EAAK6G,GACrCA,SAAUA,IAEfisB,EAAgB,SAAS3yC,EAAQ6f,GAChC,IAAI6G,EAAW,GACf,IACIlqB,EAAIhG,GAAGqH,OAAO,4CAA6CgiB,EAAIxQ,OAAQwQ,EAAIyqB,eAC3E5jB,EAAWlwB,GAAGkQ,UAAUmZ,EAAIyqB,cAC9B,MAAOnqC,GACLH,GAAUoP,EAAKsc,oBAAsBlvB,EAAI,qDAAuD2D,EAAM1D,QAAU,IAAK,SAEzH,OAAOiqB,GACRksB,EAA4B,SAAS1jC,GACpC,IAAIvN,EAAU,IAAInL,GAAGoL,QAMrB,OALA0wC,EAAuBO,SAAS3jC,EAAI2U,EAAQwZ,WAAWnuB,GA7B9B,SAASA,GAClC,IAAI0D,EAASxD,EAAK6M,YAAY3pB,IAAI4c,GAAKld,EAAO0iB,EAAQxF,GAAKO,EAAO0H,EAAQjI,GAK1E,OAJA0D,EAAOxD,EAAK2M,UAAYrE,EAAQxI,GAChC0D,EAAOxD,EAAKkc,eAAiBt5B,EAC7B4gB,EAAOxD,EAAKuc,mBAAqBlc,EACjCmD,EAAOxD,EAAKjF,SAAS6iB,WAAWI,YAAcvJ,EAAQiS,gBAAgB5mB,GAC/D0D,EAuBqDkgC,CAAwB5jC,GAAKE,EAAK4M,cAAc1pB,IAAI4c,IAAKtD,MAAK,SAASiU,GAC/Hle,EAAQG,QAAQ6wC,GAAc,EAAO9yB,GAAMA,MAC5C,SAASA,GACRle,EAAQK,QAAQ2wC,GAAc,EAAO9yB,GAAMA,MAExCle,GACRoxC,EAA8B,SAASC,GACtC,IAOIpgC,EAPA/R,EAAamyC,EAAmBnyC,WAChCqO,EAAK8jC,EAAmB9jC,GACxB2Q,EAAMmzB,EAAmBnzB,IACzBozB,EAAeD,EAAmBC,cAAgB,GAClDC,EAAeF,EAAmBE,cAAgB,GAClDC,EAAgBH,EAAmBpgC,QAAU,GAC7CwgC,EAAoBH,EAAargC,QAAU,GAE3CxM,EAAWisC,EAAY,IAAIvyC,SAAa,KAAM4b,EAASu3B,EAAav3B,QAAUtM,EAAKsM,OAAQ7I,EAAWogC,EAAapgC,UAAYzD,EAAK8M,cAAc5pB,IAAI4c,GAAKld,EAAO0iB,EAAQxF,GAAKO,EAAO0H,EAAQjI,GAuBlM,OAtBIE,EAAKoc,mBACL5Y,EAASpc,GAAG2B,OAAO,GAAI+6C,GACvB18C,GAAG2B,OAAOya,EAAQwgC,KAElBxgC,EAASpc,GAAG2B,OAAO,GAAI+6C,GACvB18C,GAAG2B,OAAOya,EAAQwgC,GAClB58C,GAAG2B,OAAOya,EAAQugC,GAClBvgC,EAAOxD,EAAK2M,UAAYrE,EAAQxI,GAChC0D,EAAOxD,EAAKkc,eAAiBt5B,EACzBqgD,EACAz/B,EAAOxD,EAAKuc,mBAAqBlc,EACzBL,EAAKqc,eACb7Y,EAAOxD,EAAK0P,WAAa9sB,IAG5Bod,EAAKqc,eACN5Y,EAAWrc,GAAGgP,QAAQoN,EAAQC,IAElCgN,EAAIwR,KAAK3V,EAAQ7I,GAAU,GACvBzD,EAAK+M,KAAK6I,UAAY5V,EAAK+M,KAAKyR,kBAChC/N,EAAI3W,iBAAkB,GAEtBmpC,GACIjjC,EAAKqc,cACLj1B,GAAG2P,aAAayM,EAAQxM,GAE5BA,EAAS/J,OAAO+S,EAAK0P,UAAWje,GACzBuF,GAEJvF,GACRwyC,EAAmB,SAASC,GAC3B,IAAIC,EAAkBD,EAAeC,gBACjCrkC,EAAKokC,EAAepkC,GACpB2Q,EAAMyzB,EAAezzB,IACzB,GAAI0zB,EACA/8C,GAAG4C,KAAKm6C,GAAiB,SAASC,EAAYC,GAC1C5zB,EAAI4R,iBAAiB+hB,EAAYC,UAElC,CACH,IAAIC,EAAetkC,EAAK4M,cAAc1pB,IAAI4c,GAAKrO,EAAagjB,EAAQ1N,QAAQjH,GAC5E2Q,EAAI4R,iBAAiB,SAAU,oBAC/B5R,EAAI4R,iBAAiB,mBAAoB,kBACzC5R,EAAI4R,iBAAiB,gBAAiB,YACjC4gB,IACDxyB,EAAI4R,iBAAiB,eAAgB,4BACrC5R,EAAI4R,iBAAiB,cAAe5wB,EAAW/J,OAEnDN,GAAG4C,KAAKs6C,GAAc,SAAS1hD,EAAMsC,GACjCurB,EAAI4R,iBAAiBz/B,EAAMsC,QAIvCkC,GAAG2B,OAAOvB,KAAM,CACZ0/B,YAAa,SAASqd,GAClB,IAI6FhyC,EAASiyC,EAAQV,EAJ1GhkC,EAAKykC,EAAkBzkC,GACvB4kB,EAAW6f,EAAkB7f,SAC7BuC,EAAYsd,EAAkBtd,WAAa,GAC3C5I,EAAWkmB,EAAkBlmB,SAC7BhN,EAAYoD,EAAQkQ,cAAc7kB,EAAI4kB,GAAWjU,EAAMgE,EAAQwZ,WAAWnuB,EAAI4kB,GAA0ClhB,EAAS,GAsBrI,OArBAjR,EAAU6wC,EAA+BtjC,EAAI2Q,GAC7CgE,EAAQ2a,yBAAyBtvB,EAAI4kB,EAAUrT,EAAUhR,MACzDyjC,EAAe9jC,EAAK6M,YAAY3pB,IAAI4c,GA3IsJ,SAASA,EAAI0D,EAAQ6N,GACnN,IAAIhR,EAAO0H,EAAQjI,GAAKld,EAAO0iB,EAAQxF,GAClCE,EAAKoc,oBACN5Y,EAAOxD,EAAKjF,SAAS6iB,WAAWpM,WAAaH,EAAUmd,KACvDhrB,EAAOxD,EAAKjF,SAAS6iB,WAAWC,gBAAkBxM,EAAU3f,MAC5D8R,EAAOxD,EAAKjF,SAAS6iB,WAAWE,WAAazM,EAAUhR,KACvDmD,EAAOxD,EAAKjF,SAAS6iB,WAAWI,YAAc3M,EAAUod,MACxDjrB,EAAOxD,EAAKuc,mBAAqBlc,GAEjC4iC,IAAcjjC,EAAKoc,oBACnB5Y,EAAOxD,EAAKkc,eAAiBt5B,GAkI7B6hD,CAA0B3kC,EAAI0D,EAAQ6N,GAClCgN,IACA7a,EAAOxD,EAAKnE,OAAO+hB,WAAWS,WAAY,GAE9CmmB,EAASb,EAA4B,CACjClyC,WAAY4f,EAAUnf,KACtB4N,GAAIA,EACJgkC,aAAcA,EACdtgC,OAAQA,EACRiN,IAAKA,EACLozB,aAAc5c,IAElBgd,EAAiB,CACbE,gBAAiBld,EAAUjd,QAC3BlK,GAAIA,EACJ2Q,IAAKA,IAETA,EAAIgS,KAAK+hB,GACFjyC,GAEXm2B,WAAY,SAAS5oB,GACjB,IAAsCvN,EAASke,EAAKqzB,EAAcU,EAA9D/yC,EAAagjB,EAAQ1N,QAAQjH,GAgBjC,OAfA2Q,EAAMgE,EAAQwZ,WAAWnuB,GACzB2U,EAAQ2a,yBAAyBtvB,GACjCvN,EAAU6wC,EAA+BtjC,EAAI2Q,GAC7CqzB,EAAe9jC,EAAK6M,YAAY3pB,IAAI4c,GACpC0kC,EAASb,EAA4B,CACjClyC,WAAYA,EACZqO,GAAIA,EACJgkC,aAAcA,EACdrzB,IAAKA,IAETwzB,EAAiB,CACbnkC,GAAIA,EACJ2Q,IAAKA,IAETA,EAAIgS,KAAK+hB,GACFjyC,KAGfnL,GAAG2B,OAAOvB,KAAM,IAAIJ,GAAGglC,iBAAiB,CACpCrnC,QAASqC,GAAG2B,OAAO,CACfinB,UAAW,eACZhQ,GACH6jB,MAAOz8B,GAAG2B,OAAO,CACbwe,YAAavH,EAAK8M,cAAc5pB,KACjC2gC,MAEPz8B,GAAG6L,SAASzL,MAAM,SAAS2L,GACvB,MAAO,CACH6xB,eAAgB,SAASllB,GAErB,OADA+jB,EAAMqF,aAAappB,GACfE,EAAKjF,SAASrI,QAAQ+Q,SACf+/B,EAA0B1jC,GAE1B3M,EAAO6xB,eAAellB,EAAI1Y,GAAGvD,KAAK0/C,EAAe/7C,MAAM,UAMlFJ,GAAG4hC,YAAYma,2BAA6B,SAASrgD,GACjD,aACA,IAAIotC,EAAWnrC,EAAU,CACrBgoB,KAAM,CACF8I,UAAU,EACVD,UAAU,EACV4I,iBAAiB,GAErB/a,SAAU,KACVrW,IAAK,SAASsB,EAAKpB,KACnBgf,OAAQ,QACTo4B,EAAW,GAAIC,EAAkB,CAChCzhD,IAAK,SAAS4c,GACV,OAAI1Y,GAAGsG,WAAW3I,EAAQ0e,UACf1e,EAAQ0e,SAAS3D,GAErB/a,EAAQ0e,WAGvBrc,GAAG2B,OAAOhE,EAASjC,GACnBotC,EAAY9oC,GAAG2B,OAAOvB,KAAM,IAAIJ,GAAGm4B,cAAc,CAC7CI,aAAc,mBACdE,YAAa96B,EAAQm5B,YAAc,mBAAqB,oCACxD0B,aAAc,CAAE76B,EAAQunB,QACxBA,OAAQvnB,EAAQunB,OAChBQ,cAAe63B,EACf5kB,oCAAoC,EACpChT,KAAMhoB,EAAQgoB,KACd3f,IAAKrI,EAAQqI,IACbojB,WAAY,SAAS1Q,EAAI2Q,EAAKrD,GAC1B,IAAI7a,EAAUmyC,EAAS5kC,UAChB4kC,EAAS5kC,GACZsN,EACA7a,EAAQK,QAAQ6d,GAEhBle,EAAQG,QAAQ+d,OAI5BrpB,GAAG2B,OAAOvB,KAAM,CACZi8C,SAAU,SAAS3jC,EAAI2Q,EAAKjN,EAAQwG,GAChC,IAAIzX,EAAU,IAAInL,GAAGoL,QAIrB,OAHAzN,EAAQqI,IAAI,0CAA4C0S,GACxD4kC,EAAS5kC,GAAMvN,EACf29B,EAAUvN,cAAc7iB,GAAIkjB,WAAWj+B,EAAQye,OAAO1D,IAAO0D,GAAQ2f,YAAYp+B,EAAQilB,QAAQlK,IAAOkK,GAASyY,KAAKhS,GAC/Gle,MA1oLvB,CA8oLG1F,S,gBC/oLH,IAAI+3C,EAAW,EAAQ,GACnBC,EAAkB,WAatBziD,EAAOD,QAAU,SAASmD,EAAQw/C,GAChC,SAAS17C,EAAK07C,GACZ,IAAIl7C,EAASg7C,EAASE,EAASx/C,EAAQu/C,GAGvC,OAAOj7C,GAAUA,EAAO6C,QAAU,EAGpC,OAAOq4C,EAAU17C,EAAK07C,EAAQ14C,MAAM,KAAK,IAAMhD,I,6CCtBjD,mCACA,SAAUjC,QACN,IAAIC,GAAK,SAALA,EAAc1B,GACd,aACA,MAAO,CACH2B,KAAM,WAEF,OADA3B,EAAQ4B,MAAMC,QAAU,OACjBC,MAEXC,OAAQ,SAASC,EAAMC,GAMnB,OALIjC,EAAQkC,iBACRlC,EAAQkC,iBAAiBF,EAAMC,GAAI,GAC5BjC,EAAQmC,aACfnC,EAAQmC,YAAY,KAAOH,EAAMC,GAE9B,WACHP,EAAG1B,GAASoC,OAAOJ,EAAMC,KAGjCG,OAAQ,SAASJ,EAAMC,GAMnB,OALIjC,EAAQqC,oBACRrC,EAAQqC,oBAAoBL,EAAMC,GAAI,GAC/BjC,EAAQmC,aACfnC,EAAQsC,YAAY,KAAON,EAAMC,GAE9BH,MAEXS,SAAU,SAASC,GACf,QAAKA,IAGDxC,IAAYwC,IAGZxC,EAAQuC,SACDvC,EAAQuC,SAASC,MAEgC,EAA9CA,EAAWC,wBAAwBzC,OAGrD0C,aAAc,SAASC,GAEnB,OADAA,EAASC,WAAWF,aAAa1C,EAAS2C,GACnCb,MAEXe,OAAQ,WAEJ,OADA7C,EAAQ4C,WAAWE,YAAY9C,GACxB8B,MAEXiB,IAAK,SAASC,GACV,GAAqB,MAAjBhD,EAAQ4B,MACR,MAAM,IAAIF,EAAGN,MAAM,8EAQvB,OANsB,MAAlB4B,EAAOC,SAC8B,iBAA1BjD,EAAQ4B,MAAMqB,cAAmD,IAApBjD,EAAQkD,UAC5DF,EAAO5C,OAAS,iBAAmB+C,KAAKC,MAAM,IAAMJ,EAAOC,SAAW,KAG9EvB,EAAG2B,OAAOrD,EAAQ4B,MAAOoB,GAClBlB,MAEXwB,SAAU,SAASpG,EAAMqG,GACrB,IAAIC,EAAK,IAAIC,OAAO,QAAUvG,EAAO,SACrC,OAAOsG,EAAGE,KAAK1D,EAAQ2D,eAAiBJ,IAAkBC,EAAGE,KAAK1D,EAAQ4C,WAAWe,aAEzFC,SAAU,SAAS1G,GAIf,OAHKwE,EAAG1B,GAASsD,SAASpG,KACtB8C,EAAQ2D,WAAa,IAAMzG,GAExB4E,MAEX+B,YAAa,SAAS3G,GAClB,IAAIsG,EAAK,IAAIC,OAAO,QAAUvG,EAAO,SAErC,OADA8C,EAAQ2D,UAAY3D,EAAQ2D,UAAUG,QAAQN,EAAI,KAAKM,QAAQ,aAAc,IACtEhC,MAEXiC,WAAY,SAASJ,EAAWK,GAC5B,IAAIC,EAAYC,EAAS,GACzB,OAAIF,GAAShE,EAAQmE,cACVnE,EAAQmE,cAAc,IAAMR,GAC5B3D,EAAQoE,iBACRpE,EAAQoE,iBAAiB,IAAMT,IAE1CM,EAAajE,EAAQqE,qBAAqB,KAC1C3C,EAAG4C,KAAKL,GAAY,SAASM,EAAK/E,GAC1BkC,EAAGlC,GAAK8D,SAASK,IACjBO,EAAOM,KAAKhF,MAGbwE,EAAQE,EAAO,GAAKA,IAE/BO,gBAAiB,SAASd,GACtB,OAAOjC,EAAG1B,GAAS+D,WAAWJ,GAAW,IAE7Ce,SAAU,WAEN,IADA,IAAIA,EAAW,GAAIC,EAAQ3E,EAAQ4E,WAC5BD,GACoB,IAAnBA,EAAME,UACNH,EAASF,KAAKG,GAElBA,EAAQA,EAAMG,YAElB,OAAOJ,GAEXK,QAAS,SAASC,GAGd,OAFAhF,EAAQiF,UAAYD,EACpBhF,EAAQkF,YAAcF,EACflD,MAEXqD,UAAW,WACP,OAAOzD,EAAG1B,GAAS+E,QAAQ,KAE/BK,aAAc,SAASC,GACnB,IAAIC,EACJ,OAAItF,EAAQoF,eACHpF,EAAQoF,aAAaC,IAGgC,MAAnD,WAAWE,KAAKvF,EAAQwF,aAAaH,SAG5BI,KADhBH,EAAUtF,EAAQqF,KAIiB,MAA5B,WAAWE,KAAKD,OAKvC,WACI,aAqRe,IACPK,IArRRjE,GAAGkE,aAAe,SAASC,EAAQC,EAAMC,GACrC,OAAOrE,GAAGsE,cAAcH,EAAOI,UAAUH,EAAMC,KAEnDrE,GAAGsE,cAAgB,SAASE,GACxB,IAAIC,EAAaC,EAUdC,EAAUC,EAVsCC,EAAMT,EACjDU,EAA+GC,EAqBvH,OAVIL,EADAF,EAAQQ,MAAM,KAAK,GAAGC,QAAQ,WAAa,EAC9BC,KAAKV,EAAQQ,MAAM,KAAK,IAExBG,UAAUX,EAAQQ,MAAM,KAAK,IAE9CJ,EAAaJ,EAAQQ,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGA,MAAM,KAAK,GAC5DP,EAAc,IAAIW,YAAYV,EAAWW,QACzCV,EAAW,IAAIW,WAAWb,GAC1BzE,GAAG4C,KAAK8B,GAAY,SAAS7B,EAAK0C,GAC9BZ,EAAS9B,GAAO0C,EAAUC,WAAW,MApBUX,EAsBjCJ,EAtBuCL,EAsB1BQ,EArBvBE,EAAcW,OAAOX,aAAeW,OAAOC,mBAAqBD,OAAOE,gBAAkBF,OAAOG,eAAeb,EAAcD,GAAe,IAAIA,IAEhJC,EAAYc,OAAOhB,GACZE,EAAYe,QAAQ1B,IAEpB,IAAI2B,KAAK,CAAElB,GAAQ,CACtBvE,KAAM8D,KAiBtBpE,GAAGgG,IAAM,SAASC,EAASC,GACnBT,OAAOU,UACFD,GAAmB,SAAVA,EAGNT,OAAOU,QAAQD,GACfT,OAAOU,QAAQD,GAAOD,GAEtBR,OAAOU,QAAQH,IAAI,IAAME,EAAQ,KAAOD,GAL5CR,OAAOU,QAAQH,IAAIC,KAU/BjG,GAAGoG,SAAW,SAASC,GACnB,OAAOA,IAAaA,EAASlD,UAAyD,oBAA7CxH,OAAOkB,UAAUO,SAAShC,KAAKiL,IAE5ErG,GAAGsG,WAAa,SAASD,GACrB,MAA2B,mBAAbA,GAElBrG,GAAGhC,QAAU,SAAS9B,GAClB,MAAiD,mBAA1CP,OAAOkB,UAAUO,SAAShC,KAAKc,IAA+BA,GAASuJ,OAAOL,aAAelJ,EAAMqK,QAAUrK,EAAMqK,OAAOC,cAAgBpB,aAErJpF,GAAGyG,WAAa,SAASC,GACrB,MAAyD,kCAAlD/K,OAAOkB,UAAUO,SAAShC,KAAKsL,IAE1C1G,GAAG2G,WAAa,SAASC,GACrB,MAAyD,sBAAlDjL,OAAOkB,UAAUO,SAAShC,KAAKwL,IAA0CA,EAAcC,MAAQD,EAAcE,WAExH9G,GAAG+G,SAAW,SAASC,GACnB,MAAuD,oBAAhDrL,OAAOkB,UAAUO,SAAShC,KAAK4L,IAE1ChH,GAAGiH,QAAU,SAASC,GAClB,OAAIC,OAAOtK,UAAUuK,KACVF,EAAOE,OAEXF,EAAO9E,QAAQ,aAAc,KAExCpC,GAAGqH,OAAS,SAASC,GACjB,IAAIC,EAAOxJ,MAAMlB,UAAU2K,MAAMpM,KAAKqM,UAAW,GAAIC,EAASJ,EAAKK,EAAmBD,EAAOzC,QAAQ,MASrG,OARAjF,GAAG4C,KAAK2E,GAAM,SAAS1E,EAAK/E,GACxB,IAAI8J,EAAYF,EAAOG,UAAU,EAAGF,GAAmBG,EAAWJ,EAAOG,UAAUF,EAAmB,GAGtG,IADAA,GADAD,EAASE,EAAY9J,EAAMgK,GACD7C,QAAQ,KAAM0C,EAAmB7J,EAAIuH,SACxC,EACnB,OAAO,KAGRqC,GAEX1H,GAAG+H,OAAS,SAASC,GACjB,OAAOvC,OAAOwC,MAAsD,kBAA9CtM,OAAOkB,UAAUO,SAAShC,KAAK4M,IAEzDhI,GAAGkI,WAAa,SAASC,GACrB,OAAO1C,OAAO2C,UAA8D,sBAAlDzM,OAAOkB,UAAUO,SAAShC,KAAK+M,IAE7DnI,GAAGqI,cAAgB,SAASC,GACxB,OAAOtI,GAAG+H,OAAOO,IAAqBtI,GAAGuI,QAAQD,IAErDtI,GAAGuI,QAAU,SAASC,EAAYC,GAC9B,IAAIC,EAAe,SAASpI,GACxB,IAAIqI,EAAiBrI,EAAKsI,cAC1B,OAAIH,EAC0B,SAAnBE,EAEe,SAAnBA,GAEX,SAAIlD,OAAOoD,kBAC4C,8BAA/ClN,OAAOkB,UAAUO,SAAShC,KAAKoN,IAC3BA,EAAWlI,MAAQoI,EAAaF,EAAWlI,WAKnDkI,EAAWM,SAC8B,UAArCN,EAAWM,QAAQF,eACfJ,EAAWlI,MAAQoI,EAAaF,EAAWlI,QAO3DN,GAAG+I,OAAS,SAASC,GACjB,GAAIvD,OAAOM,MAAsD,kBAA9CpK,OAAOkB,UAAUO,SAAShC,KAAK4N,GAC9C,OAAO,GAGfhJ,GAAGiJ,qBAAuB,WACtB,IAAIC,EAAQC,SAASC,cAAc,SAEnC,OADAF,EAAM5I,KAAO,YACayD,IAAnBmF,EAAMG,UAA0C,oBAATpB,MAA4C,oBAAbqB,eAAqE,IAAlCtJ,GAAGuJ,oBAAoBC,QAE3IxJ,GAAGuJ,kBAAoB,WACnB,GAAI9D,OAAOgE,eACP,OAAO,IAAIA,eAEf,IACI,OAAO,IAAIC,cAAc,sBAC3B,MAAOC,GAEL,OADA3J,GAAGgG,IAAI,wCAAyC,SACzC,OAGfhG,GAAG4J,sBAAwB,SAASC,GAChC,OAAOA,EAAaC,OAASD,EAAaC,MAAMzE,OAAS,GAAKwE,EAAaC,MAAM,GAAGC,kBAExF/J,GAAGgK,wBAA0B,WACzB,OAAQhK,GAAGiK,gBAAkBjK,GAAGiJ,8BAAoDlF,IAAzBkE,KAAKpL,UAAU2K,YAAsDzD,IAA/BkE,KAAKpL,UAAUqN,kBAAyDnG,IAA5BkE,KAAKpL,UAAUsN,WAEhKnK,GAAGoK,UAAY,SAASC,EAAYC,EAAOC,GAEvC,OADaF,EAAW7C,OAAS6C,EAAWF,UAAYE,EAAWH,aACrD9O,KAAKiP,EAAYC,EAAOC,IAE1CvK,GAAGwK,iBAAmB,SAASjE,GAC3B,IAAIkE,EAAa,GAAIC,EAAQ,IAAIpF,WAAWiB,GAQ5C,OAPAvG,GAAG4C,KAAK8H,GAAO,SAAS7H,EAAK8H,GACzB,IAAIC,EAAeD,EAAIvN,SAAS,IAC5BwN,EAAavF,OAAS,IACtBuF,EAAe,IAAMA,GAEzBH,GAAcG,KAEXH,GAEXzK,GAAG6K,cAAgB,SAASC,EAAMC,EAAa1F,GAC3C,IAAI2F,EAAchL,GAAGoK,UAAUU,EAAMC,EAAaA,EAAc1F,GAAS4F,EAAa,IAAIC,WAAcC,EAAU,IAAInL,GAAGoL,QAMzH,OALAH,EAAWI,OAAS,WAChBF,EAAQG,QAAQtL,GAAGwK,iBAAiBS,EAAWzI,UAEnDyI,EAAWM,QAAUJ,EAAQK,QAC7BP,EAAWQ,kBAAkBT,GACtBG,GAEXnL,GAAG2B,OAAS,SAASW,EAAOoJ,EAAQC,GAWhC,OAVA3L,GAAG4C,KAAK8I,GAAQ,SAASE,EAAM9N,GACvB6N,GAAgB3L,GAAGoG,SAAStI,SACRiG,IAAhBzB,EAAMsJ,KACNtJ,EAAMsJ,GAAQ,IAElB5L,GAAG2B,OAAOW,EAAMsJ,GAAO9N,GAAK,IAE5BwE,EAAMsJ,GAAQ9N,KAGfwE,GAEXtC,GAAG6L,SAAW,SAAS3N,EAAQ4N,GAC3B,IAAIC,EAAS,GAAI5N,EAAS2N,EAASC,GAOnC,OANA/L,GAAG4C,KAAKzE,GAAQ,SAAS6N,EAAaC,QACNlI,IAAxB7F,EAAO8N,KACPD,EAAOC,GAAe9N,EAAO8N,IAEjC9N,EAAO8N,GAAeC,KAEnB/N,GAEX8B,GAAGiF,QAAU,SAASiH,EAAKC,EAAKC,GAC5B,GAAIF,EAAIjH,QACJ,OAAOiH,EAAIjH,QAAQkH,EAAKC,GAE5BA,EAAOA,GAAQ,EACf,IAAIC,EAAMH,EAAI7G,OAId,IAHI+G,EAAO,IACPA,GAAQC,GAEND,EAAOC,EAAKD,GAAQ,EACtB,GAAIF,EAAIpP,eAAesP,IAASF,EAAIE,KAAUD,EAC1C,OAAOC,EAGf,OAAQ,GAEZpM,GAAGsM,YAAc,WACb,MAAO,uCAAuClK,QAAQ,SAAS,SAAS9G,GACpE,IAAIS,EAAoB,GAAhB0F,KAAK8K,SAAgB,EAC7B,OADyC,KAALjR,EAAWS,EAAQ,EAAJA,EAAQ,GAClDqB,SAAS,QAG1B4C,GAAGwM,GAAK,WACJ,OAAgD,IAAzCC,UAAUC,UAAUzH,QAAQ,UAA8D,IAA5CwH,UAAUC,UAAUzH,QAAQ,YAErFjF,GAAG2M,IAAM,WACL,OAAkD,IAA3CF,UAAUC,UAAUzH,QAAQ,WAEvCjF,GAAG4M,IAAM,WACL,OAAkD,IAA3CH,UAAUC,UAAUzH,QAAQ,WAEvCjF,GAAG6M,KAAO,WACN,OAAmD,IAA5CJ,UAAUC,UAAUzH,QAAQ,YAEvCjF,GAAG8M,KAAO,WACN,OAAO9M,GAAGwM,OAAkD,IAA1CC,UAAUC,UAAUzH,QAAQ,UAElDjF,GAAG+M,KAAO,WACN,OAAON,UAAUC,UAAUzH,QAAQ,SAAW,GAElDjF,GAAGgN,OAAS,WACR,YAA4BjJ,IAArB0I,UAAUQ,SAA+D,IAAvCR,UAAUQ,OAAOhI,QAAQ,UAEtEjF,GAAGkN,OAAS,WACR,YAA4BnJ,IAArB0I,UAAUQ,SAAgE,IAAxCR,UAAUQ,OAAOhI,QAAQ,WAEtEjF,GAAGmN,MAAQ,WACP,YAA4BpJ,IAArB0I,UAAUQ,SAA+D,IAAvCR,UAAUQ,OAAOhI,QAAQ,UAEtEjF,GAAGoN,QAAU,WACT,OAAQpN,GAAG+M,SAAW/M,GAAG8M,SAAsD,IAA5CL,UAAUC,UAAUzH,QAAQ,iBAA0ClB,IAArB0I,UAAUQ,QAA6C,KAArBR,UAAUQ,QAEpIjN,GAAGqN,QAAU,WACT,MAA8B,UAAvBZ,UAAUa,UAErBtN,GAAGuN,QAAU,WACT,OAAiE,IAA1Dd,UAAUC,UAAU9D,cAAc3D,QAAQ,YAErDjF,GAAGiK,aAAe,WACd,OAAOjK,GAAGuN,WAAad,UAAUC,UAAU9D,cAAc3D,QAAQ,UAAY,GAAKwH,UAAUC,UAAU9D,cAAc3D,QAAQ,WAAa,GAE7IjF,GAAGwN,KAAO,WACN,OAAOxN,GAAGyN,QAAoD,IAA3ChB,UAAUC,UAAUzH,QAAQ,WAEnDjF,GAAG0N,KAAO,WACN,OAAO1N,GAAGyN,QAAoD,IAA3ChB,UAAUC,UAAUzH,QAAQ,WAEnDjF,GAAG2N,KAAO,WACN,OAAO3N,GAAGyN,QAAoD,IAA3ChB,UAAUC,UAAUzH,QAAQ,WAEnDjF,GAAG4N,OAAS,WACR,OAAO5N,GAAGyN,QAAsD,IAA7ChB,UAAUC,UAAUzH,QAAQ,aAEnDjF,GAAGyN,IAAM,WACL,OAAgD,IAAzChB,UAAUC,UAAUzH,QAAQ,UAA2D,IAAzCwH,UAAUC,UAAUzH,QAAQ,UAA6D,IAA3CwH,UAAUC,UAAUzH,QAAQ,WAEnIjF,GAAG6N,UAAY,WACX,OAAO7N,GAAGyN,QAAmD,IAA1ChB,UAAUC,UAAUzH,QAAQ,UAEnDjF,GAAG8N,UAAY,WACX,OAAO9N,GAAGyN,QAAUzN,GAAG6N,cAA0D,IAA3CpB,UAAUC,UAAUzH,QAAQ,WAEtEjF,GAAG+N,iBAAmB,WAClB,OAAO/N,GAAGyN,QAAUzN,GAAG6N,cAAgB7N,GAAG8N,aAE9C9N,GAAGgO,eAAiB,SAASC,GACrBA,EAAED,eACFC,EAAED,iBAEFC,EAAEC,aAAc,GAGxBlO,GAAGmO,WACKlK,IAAMkF,SAASC,cAAc,OAC1B,SAASgF,GACZnK,IAAIoK,UAAYD,EAChB,IAAI9P,EAAU2F,IAAIf,WAElB,OADAe,IAAI7C,YAAY9C,GACTA,IAGf0B,GAAG4C,KAAO,SAAS0L,EAAcC,GAC7B,IAAIC,EACJ,GAAIF,EACA,GAAI7I,OAAOgJ,SAAWH,EAAa9H,cAAgBf,OAAOgJ,QACtD,IAAKD,EAAa,EAAGA,EAAaF,EAAajJ,SAE5B,IADNkJ,EAASD,EAAa9R,IAAIgS,GAAaF,EAAaI,QAAQJ,EAAa9R,IAAIgS,KADnCA,UAMpD,GAAIxO,GAAGhC,QAAQsQ,IAAiBtO,GAAGyG,WAAW6H,IAAiBtO,GAAG2G,WAAW2H,GAChF,IAAKE,EAAa,EAAGA,EAAaF,EAAajJ,SAE5B,IADNkJ,EAASC,EAAYF,EAAaE,IADQA,UAMpD,GAAIxO,GAAG+G,SAASuH,GACnB,IAAKE,EAAa,EAAGA,EAAaF,EAAajJ,SAE5B,IADNkJ,EAASC,EAAYF,EAAaK,OAAOH,IADCA,UAOvD,IAAKA,KAAcF,EACf,GAAI3S,OAAOkB,UAAUC,eAAe1B,KAAKkT,EAAcE,KAEpC,IADND,EAASC,EAAYF,EAAaE,IAEvC,OAOxBxO,GAAGvD,KAAO,SAASmS,EAASC,GACxB,GAAI7O,GAAGsG,WAAWsI,GAAU,CACxB,IAAIrH,EAAOxJ,MAAMlB,UAAU2K,MAAMpM,KAAKqM,UAAW,GACjD,OAAO,WACH,IAAIqH,EAAU9O,GAAG2B,OAAO,GAAI4F,GAI5B,OAHIE,UAAUpC,SACVyJ,EAAUA,EAAQ1Q,OAAOL,MAAMlB,UAAU2K,MAAMpM,KAAKqM,aAEjDmH,EAAQG,MAAMF,EAASC,IAGtC,MAAM,IAAIpP,MAAM,wCAEpBM,GAAGgP,QAAU,SAASC,EAAKC,EAAMC,GAC7B,IAAIC,EAAa,GAAIC,EAAS,IAAKC,EAAM,SAASC,EAAStU,GACvD,IAAIuU,EAAWN,EAAO,QAAQlN,KAAKkN,GAAQA,EAAOA,EAAO,IAAMjU,EAAI,IAAMA,EACxD,cAAbuU,GAAkC,cAANvU,GAC5BmU,EAAWtM,KAAwB,iBAAZyM,EAAuBvP,GAAGgP,QAAQO,EAASC,GAAU,GAAoD,sBAA5C7T,OAAOkB,UAAUO,SAAShC,KAAKmU,GAAmCE,mBAAmBD,GAAY,IAAMC,mBAAmBF,KAAaE,mBAAmBD,GAAY,IAAMC,mBAAmBF,KAkB3R,OAfKJ,GAAcD,GACfG,EAAS,KAAKrN,KAAKkN,GAAQ,MAAMlN,KAAKkN,GAAQ,GAAK,IAAM,IACzDE,EAAWtM,KAAKoM,GAChBE,EAAWtM,KAAK9C,GAAGgP,QAAQC,KACoB,mBAAxCtT,OAAOkB,UAAUO,SAAShC,KAAK6T,SAA4C,IAARA,EAC1EjP,GAAG4C,KAAKqM,GAAK,SAASpM,EAAK/E,GACvBwR,EAAIxR,EAAK+E,MAEN,MAAOoM,GAAsD,iBAARA,EAC5DjP,GAAG4C,KAAKqM,GAAK,SAASrD,EAAM9N,GACxBwR,EAAIxR,EAAK8N,MAGbwD,EAAWtM,KAAK2M,mBAAmBP,GAAQ,IAAMO,mBAAmBR,IAEpEC,EACOE,EAAWM,KAAKL,GAEhBD,EAAWM,KAAKL,GAAQjN,QAAQ,KAAM,IAAIA,QAAQ,OAAQ,MAGzEpC,GAAG2P,aAAe,SAASV,EAAKW,EAAUC,GActC,OAbKD,IACDA,EAAW,IAAItG,UAEnBtJ,GAAG4C,KAAKqM,GAAK,SAASzS,EAAKsB,GACvBtB,EAAMqT,EAAeA,EAAe,IAAMrT,EAAM,IAAMA,EAClDwD,GAAGoG,SAAStI,GACZkC,GAAG2P,aAAa7R,EAAK8R,EAAUpT,GACxBwD,GAAGsG,WAAWxI,GACrB8R,EAAS/J,OAAOrJ,EAAKsB,KAErB8R,EAAS/J,OAAOrJ,EAAKsB,MAGtB8R,GAEX5P,GAAG8P,WAAa,SAASb,EAAKc,GAC1B,IAAI7G,EAYJ,OAXK6G,IACDA,EAAO5G,SAASC,cAAc,SAElCpJ,GAAG2P,aAAaV,EAAK,CACjBpJ,OAAQ,SAASrJ,EAAKsB,IAClBoL,EAAQC,SAASC,cAAc,UACzB4G,aAAa,OAAQxT,GAC3B0M,EAAM8G,aAAa,QAASlS,GAC5BiS,EAAKE,YAAY/G,MAGlB6G,GAEX/P,GAAGkQ,UAAY,SAASC,MACpB,OAAI1K,OAAO2K,MAAQpQ,GAAGsG,WAAW8J,KAAKC,OAC3BD,KAAKC,MAAMF,MAEXG,KAAK,IAAMH,KAAO,MAGjCnQ,GAAGuQ,aAAe,SAASC,GACvB,IAAIC,EAASD,EAASE,YAAY,KAAO,EACzC,GAAID,EAAS,EACT,OAAOD,EAASG,OAAOF,EAAQD,EAASnL,OAASoL,IAGzDzQ,GAAG4Q,YAAc,SAASC,GACtB,OAAI7Q,GAAGuI,QAAQsI,GACJA,EAAgB3U,MAAMkG,QAAQ,YAAa,IAC3CpC,GAAG+H,OAAO8I,IACgB,OAA7BA,EAAgBC,eAAkD/M,IAA7B8M,EAAgBC,SAC9CD,EAAgBC,SAGxBD,EAAgBrV,MAE3BwE,GAAG+Q,eAAiB,WAChB,IAAIC,EAAY,GAChB,MAAO,CACHC,QAAS,WACL,IAAIC,EACJ,IACIA,EAAWF,EAAUG,UAEjBD,UAECA,IAEb7Q,OAAQ,WACJ,IAAIkH,EAAOE,UACXrH,KAAKgR,YAAYpR,GAAGuH,EAAK,IAAIlH,OAAO0O,MAAM3O,KAAMrC,MAAMlB,UAAU2K,MAAMpM,KAAKqM,UAAW,MAE1F2J,YAAa,SAASC,GAClBL,EAAUlO,KAAKuO,MAnb/B,GAwbA,WACI,kBAEU,KAANC,yCACI,OAAOtR,IADL,kGAHd,GAYAA,GAAGuR,QAAU,QACbvR,GAAGwR,kBAAoB,WACnB,aACA,IAAIC,EAAmBC,EAAwBC,EAAkBC,EAA2BC,EAAoBC,EAAkBC,EAAgBC,EAAwBC,EAAoBC,EAAuBC,EAA2BC,EAAwBC,EAAyBC,EAAuBC,EA6ChTC,EAQAtJ,EAnCR,SAASuJ,IACL,QAAIhN,OAAOgE,qBAEwB1F,IADrB/D,GAAGuJ,oBACFmJ,gBAInB,SAASC,IACL,YAAiC5O,IAA1B0B,OAAOmN,eA8ClB,OAxBAnB,EA/CA,WACI,IAAsBoB,EAAlBC,GAAY,EAChB,KACID,EAAY1J,SAASC,cAAc,UACzB9I,KAAO,OACjBN,GAAG6S,GAAW5S,OACV4S,EAAUE,WACVD,GAAY,GAElB,MAAOE,GACLF,GAAY,EAEhB,OAAOA,EAmCSG,GAEpBvB,GADAE,EAA4BH,GAAqBzR,GAAGiJ,0BACGjJ,GAAGiK,eAE1D4H,GADAF,EAAmBC,KALP,cADJY,EAAOrJ,SAASC,cAAc,UACH,gBAAiBoJ,GAAQ,WAAYA,KAAUxS,GAAGuN,YAAcvN,GAAGyN,WAO9FvE,EAAQC,SAASC,cAAc,UAC7B9I,KAAO,UACH,oBAAsB4I,GAASC,SAASzG,iBAAiB,oBAAoB,MAE3FoP,EAAmBF,GAA6B5R,GAAGgK,0BACnD+H,EAAiBH,GAA6BE,GArB9C,WACI,IACI,QAASrM,OAAOyN,cAAgBlT,GAAGsG,WAAWb,OAAOyN,aAAaC,SACpE,MAAOxJ,GACL,OAAO,GAiBmDyJ,GAClEpB,EAAyBJ,IA3Cb5R,GAAGkN,UAAYlN,GAAGmN,eAAiFpJ,IAArE0I,UAAUC,UAAU2G,MAAM,uCA4CpEpB,EAAqBR,SAA6C1N,IAAvB0B,OAAO6N,aAA6B1B,GAC/EO,EAA4BM,IAC5BP,EAAwBS,IACxBP,IAlCQK,KAGGE,IAgCXN,OA7B+DtO,IAApDoF,SAASC,cAAc,SAASmK,gBA8B3CjB,EAAwBV,QAAmD7N,IAAtB0B,OAAOyF,WAC5DqH,IACQX,IACQ5R,GAAGiK,iBAAmBjK,GAAG6N,YAIlC,CACH2F,cAAe5B,EACf6B,cAAe/B,EACfgC,iBAAkB9B,EAClB+B,SAAU7B,EACV8B,eAAgBxB,EAChByB,kBAAmB3B,EACnB4B,kBAAmB3B,EACnB4B,gBAAiBtO,OAAOuO,kBACxBC,SAAUtC,EACVuC,WAAYrC,EACZsC,gBAAiB9B,EACjB+B,cAAe9B,EACf+B,gBAAiB/B,EACjBgC,mBAAoB1C,EACpB2C,MAAOzC,EACP0C,YAAajC,EACbkC,OAAQ1C,EACR2C,QAASpC,GAAyBZ,EAClCiD,aAAc3U,GAAGgN,SACjB4H,0BAA2B5U,GAAGyN,MAC9BoH,UAAWpD,EACXqD,WAAY7C,EACZ8C,oBAAqBnD,EACrBoD,mBAAoBpD,EACpBqD,eAAgBjD,GAnGD,GAsGvBhS,GAAGkV,iBAAmB,SAASC,GAC3B,aACA,SAAUA,GAAgBA,EAAaC,MAAQpV,GAAGsG,WAAW6O,EAAaC,QAE9EpV,GAAGoL,QAAU,WACT,aACA,IAAIiK,EAAaC,EAAaC,EAAmB,GAAIC,EAAmB,GAAIC,EAAgB,GAAIC,EAAQ,EACxG1V,GAAG2B,OAAOvB,KAAM,CACZgV,KAAM,SAASO,EAAWC,GAatB,OAZc,IAAVF,GACIC,GACAJ,EAAiBzS,KAAK6S,GAEtBC,GACAJ,EAAiB1S,KAAK8S,KAER,IAAXF,EACPE,GAAaA,EAAU7G,MAAM,KAAMuG,GAC5BK,GACPA,EAAU5G,MAAM,KAAMsG,GAEnBjV,MAEXyV,KAAM,SAAStH,GAMX,OALc,IAAVmH,EACAD,EAAc3S,KAAKyL,GAEnBA,EAASQ,MAAM,UAAsBhL,IAAhBuR,EAA4BD,EAAcC,GAE5DlV,MAEXkL,QAAS,WAaL,OAZAoK,EAAQ,EACRL,EAAc5N,UACV8N,EAAiBlQ,QACjBrF,GAAG4C,KAAK2S,GAAkB,SAAS1S,EAAK0L,GACpCA,EAASQ,MAAM,KAAMsG,MAGzBI,EAAcpQ,QACdrF,GAAG4C,KAAK6S,GAAe,SAAS5S,EAAK0L,GACjCA,EAASQ,MAAM,KAAMsG,MAGtBjV,MAEXoL,QAAS,WAaL,OAZAkK,GAAS,EACTJ,EAAc7N,UACV+N,EAAiBnQ,QACjBrF,GAAG4C,KAAK4S,GAAkB,SAAS3S,EAAK0L,GACpCA,EAASQ,MAAM,KAAMuG,MAGzBG,EAAcpQ,QACdrF,GAAG4C,KAAK6S,GAAe,SAAS5S,EAAK0L,GACjCA,EAASQ,MAAM,KAAMuG,MAGtBlV,SAInBJ,GAAG29C,YAAc,SAASjiD,GACtB,aACA,IAAIiC,EAuJIigD,EAAsCC,EAvJjCC,EAAwB,eAAgBC,EAAyB,mBAAoBC,EAAkB,GAAIC,EAAe,GAAI7nC,EAAiB,IAAIpW,GAAG+Q,eAgBnK,SAASmtC,EAAiBhmB,GACtB,IAAIimB,EAAoB,IAAIn+C,GAAGoL,QA6B/B,OA5BI8sB,EAAMnwB,OACNmwB,EAAMhf,MAAK,SAASA,GAChBA,EAAKklC,OAASC,EAAqBnmB,GACnC+lB,EAAan7C,KAAKoW,GAClBilC,EAAkB7yC,aACnB,SAASgzC,GACR3gD,EAAQmnB,UAAUy5B,QAAQ,oBAAsBrmB,EAAMsmB,SAAW,sBAAwBF,EAAUxvB,KAAO,IAAK,SAC/GqvB,EAAkB3yC,aAEf0sB,EAAMumB,aA6BrB,SAASC,EAAoBxmB,EAAO0e,EAAQ+H,EAAcC,GACtD,IAAIzzC,EAAUyzC,GAAmB,IAAI5+C,GAAGoL,QAAWyzC,EAAYjI,GAAU1e,EAAM4mB,eAC/ED,EAAUE,aAAY,SAAqBtmC,GACvC,IAAIumC,EAAaL,EAAeA,EAAavgD,OAAOqa,GAAWA,EAC3DA,EAAQpT,OACRqiB,YAAW,WACPg3B,EAAoBxmB,EAAO2mB,EAAWG,EAAY7zC,KACnD,GAEHA,EAAQG,QAAQ0zC,KAErB7zC,EAAQK,SACX,OAAOL,EAxCHuzC,CAAoBxmB,GAAO9iB,MAAK,SAAwBqD,GACpD,IAAIwmC,EAAcxmC,EAAQpT,OAC1BrF,GAAG4C,KAAK6V,GAAS,SAAS5V,EAAKq1B,GAC3BgmB,EAAiBhmB,GAAOriB,MAAK,WAEL,KADpBopC,GAAe,IAEXd,EAAkB7yC,gBAIzBmN,EAAQpT,QACT84C,EAAkB7yC,aAEvB,SAAqBgzC,GACpB3gD,EAAQmnB,UAAUy5B,QAAQ,oBAAsBrmB,EAAMsmB,SAAW,sBAAwBF,EAAUxvB,KAAO,IAAK,SAC/GqvB,EAAkB3yC,aAGnB2yC,EAEX,SAASE,EAAqBnmB,GAC1B,IAAI18B,EAAO08B,EAAM18B,KAAMgjD,EAAWtmB,EAAMsmB,SAAUU,EAAwBV,EAAS9tC,YAAYlV,GAK/F,MAH2B,OAD3BgjD,EAAWA,EAAS7tC,OAAO,EAAGuuC,IACjBvwC,OAAO,KAChB6vC,EAAWA,EAAS7tC,OAAO,IAExB6tC,EAoDX,SAASW,EAAcC,GACnB,IAAIC,EAAW,IAAIr/C,GAAGs/C,eAAe,CACjCxB,sBAAuBA,EACvBx/C,QAAS8gD,EACTG,QAAS,SAAStxC,GACdjO,GAAGo/C,GAAUl9C,SAASvE,EAAQoqB,QAAQy3B,YACtC7hD,EAAQmnB,UAAU26B,YAClBxxC,EAAEyxC,mBAENC,sBAAuB,SAAS1xC,GAC5BjO,GAAGo/C,GAAUj9C,YAAYxE,EAAQoqB,QAAQy3B,YACzC7hD,EAAQmnB,UAAU86B,aAEtBC,OAAQ,SAAS5xC,GAjDzB,IAA4BpE,EAAci2C,EAClCC,EAA4BC,GADRn2C,EAkDGoE,EAAEpE,aAlDSi2C,EAkDKT,EAjDvCU,EAAwB,GAAIC,EAA4B,IAAIhgD,GAAGoL,QACnEzN,EAAQmnB,UAAUm7B,yBAClBH,EAAeI,cAAa,GACxBr2C,EAAa+T,MAAMvY,OAAS,IAAM1H,EAAQwiD,oBAC1CxiD,EAAQmnB,UAAUs7B,+BAA+B,IACjDziD,EAAQmnB,UAAUu7B,UAAU,oBAAqB,IACjDP,EAAeI,cAAa,GAC5BF,EAA0Bx0C,YAE1ByyC,EAAe,GACXj+C,GAAG4J,sBAAsBC,GACzB7J,GAAG4C,KAAKiH,EAAaC,OAAO,SAASjH,EAAKgE,GACtC,IAAIqxB,EAAQrxB,EAAKkD,mBACbmuB,IACIA,EAAMnwB,OACNk2C,EAAan7C,KAAK+D,EAAKwzC,aAEvB0F,EAAsBj9C,KAAKo7C,EAAiBhmB,GAAOriB,MAAK,WACpDkqC,EAAsB5e,MACe,IAAjC4e,EAAsB16C,QACtB26C,EAA0B10C,kBAO9C2yC,EAAep0C,EAAa+T,MAEK,IAAjCmiC,EAAsB16C,QACtB26C,EAA0B10C,WAG3B00C,GAgB8C5qC,MAAK,YA9G9D,SAA4BwI,EAAOkiC,GAC/B,IAAIQ,EAAeviD,MAAMlB,UAAU2K,MAAMpM,KAAKwiB,GAC9CjgB,EAAQmnB,UAAUy5B,QAAQ,WAAa3gC,EAAMvY,OAAS,mBACtDy6C,EAAeI,cAAa,GAC5BviD,EAAQmnB,UAAUs7B,+BAA+BE,EAAcR,EAAeS,cA2GlEC,CAAmBvC,EAAcoB,MAClC,WACC1hD,EAAQmnB,UAAUy5B,QAAQ,sEAAuE,eAS7G,OALAnoC,EAAehF,aAAY,WACvBiuC,EAASpuC,aAEbjR,GAAGo/C,GAAU17C,aAAaq6C,IAA2B/9C,GAAGo/C,GAAUn/C,OAClE+9C,EAAgBl7C,KAAKu8C,GACdA,EAEX,SAASoB,EAAWC,GAChB,IAAIC,EAOJ,OANA3gD,GAAG4C,KAAK89C,EAAU72C,aAAa+2C,OAAO,SAASpkD,EAAKsB,GAChD,GAAY,UAARA,EAEA,OADA6iD,GAAW,GACJ,KAGRA,EA7IXhjD,EAAU,CACNkjD,iBAAkB,GAClBV,oBAAoB,EACpBp4B,QAAS,CACLy3B,WAAY,MAEhB16B,UAAW,IAAI9kB,GAAG29C,YAAY74B,WAElC9kB,GAAG2B,OAAOhE,EAASjC,GAAG,GA8IdkiD,EAAYjgD,EAAQkjD,iBAAkBhD,EAAqB,WAC3Dn2B,YAAW,WACP1nB,GAAG4C,KAAKg7C,GAAW,SAAS/6C,EAAKw8C,GAC7Br/C,GAAGq/C,GAAU37C,aAAaq6C,IAA2B/9C,GAAGq/C,GAAUp/C,OAClED,GAAGq/C,GAAUl9C,YAAYxE,EAAQoqB,QAAQy3B,iBAE9C,KAEPx/C,GAAG4C,KAAKg7C,GAAW,SAAS/6C,EAAKw8C,GAC7B,IAAIS,EAAiBX,EAAcE,GAC/BzB,EAAUv4C,QAAUrF,GAAGwR,kBAAkByC,UACzCmC,EAAe/V,OAAO8I,SAAU,aAAa,SAAS8E,IAC7C6xC,EAAeI,gBAAkBO,EAAWxyC,IAC7CjO,GAAG4C,KAAKg7C,GAAW,SAAS/6C,EAAKw8C,GACzBA,aAAoByB,aAAe9gD,GAAGq/C,GAAU37C,aAAaq6C,IAC7D/9C,GAAGq/C,GAAUh+C,IAAI,CACblB,QAAS,mBAQrCiW,EAAe/V,OAAO8I,SAAU,aAAa,SAAS8E,IA/B1D,SAA4BA,GACxB,OAAIjO,GAAGgN,SACIiB,EAAEwqC,EAAI,GAAKxqC,EAAE8yC,EAAI,EAEb,IAAR9yC,EAAEwqC,GAAmB,IAARxqC,EAAE8yC,GA4BdC,CAAmB/yC,IACnB4vC,OAGRznC,EAAe/V,OAAOL,GAAGmJ,UAAUnG,WAAW,GAAI,cAAc,SAASiL,GACrE4vC,OAEJznC,EAAe/V,OAAO8I,SAAU,QAAQ,SAAS8E,GACzCwyC,EAAWxyC,KACXA,EAAED,iBACF6vC,QAGRznC,EAAe/V,OAAO8I,SAAU20C,EAAuBD,GAG3D79C,GAAG2B,OAAOvB,KAAM,CACZ6gD,mBAAoB,SAAS3iD,GACzBX,EAAQkjD,iBAAiB/9C,KAAKxE,GAC9B6gD,EAAc7gD,IAElB4iD,eAAgB,SAAS5iD,GACrB,IAAIrD,EAAGkmD,EAAMxjD,EAAQkjD,iBACrB,IAAK5lD,KAAKkmD,EACN,GAAIA,EAAIlmD,KAAOqD,EACX,OAAO6iD,EAAI5mC,OAAOtf,EAAG,IAIjCgW,QAAS,WACLmF,EAAenF,UACfjR,GAAG4C,KAAKo7C,GAAiB,SAASn7C,EAAKw8C,GACnCA,EAASpuC,gBAIrB7Q,KAAK0vC,SAAW,GAChB1vC,KAAK0vC,SAASuO,qBAAuBA,GAEzCr+C,GAAG29C,YAAY74B,UAAY,WACvB,aACA,MAAO,CACH26B,UAAW,aACXG,UAAW,aACXK,uBAAwB,aACxBG,+BAAgC,SAASxiC,EAAOwjC,KAChDf,UAAW,SAASvxB,EAAMuyB,GACtBrhD,GAAGgG,IAAI,2BAA6B8oB,EAAO,2BAA6BuyB,EAAiB,IAAK,UAElG9C,QAAS,SAASt4C,EAASC,GACvBlG,GAAGgG,IAAIC,EAASC,MAI5BlG,GAAGs/C,eAAiB,SAAS5jD,GACzB,aACA,IAA8CiC,EAASW,EAASgjD,EAAaC,EAAzEnrC,EAAiB,IAAIpW,GAAG+Q,eAU5B,SAASywC,IACL,OAAOxhD,GAAGgN,UAAYhN,GAAGoN,WAAapN,GAAGqN,UAmB7C,SAASo0C,EAAgBxzC,GACrB,IAAKjO,GAAGwR,kBAAkByC,SACtB,OAAO,EAEX,IAAIytC,EAAYC,EAAK1zC,EAAEpE,aAAc+3C,EAAW5hD,GAAGgN,SAEnD,OADA00C,KAAa1hD,GAAGwM,OAAQxM,GAAGwR,kBAAkByC,WAAuC,SAArB0tC,EAAGE,cAC3DF,GAAMD,IAAeC,EAAG/jC,OAAS+jC,EAAG/jC,MAAMvY,SAAWu8C,GAAYD,EAAGf,MAAM//C,UAAY8gD,EAAGf,MAAM//C,SAAS,UAAY8gD,EAAGf,MAAMkB,UAAYH,EAAGf,MAAMkB,SAAS,UAEtK,SAASC,EAAoBC,GAIzB,YAHmBj+C,IAAfi+C,IACAV,EAAcU,GAEXV,EAzCX3jD,EAAU,CACNW,QAAS,KACTihD,QAAS,SAAStxC,KAClBilB,QAAS,SAASjlB,KAClB0xC,sBAAuB,SAAS1xC,KAChC4xC,OAAQ,SAAS5xC,MAErBjO,GAAG2B,OAAOhE,EAASjC,GACnB4C,EAAUX,EAAQW,QAKTijD,IACGC,EACAprC,EAAe/V,OAAO8I,SAAU,YAAY,SAAS8E,GACjDA,EAAED,oBAGNoI,EAAe/V,OAAO8I,SAAU,YAAY,SAAS8E,GAC7CA,EAAEpE,eACFoE,EAAEpE,aAAao4C,WAAa,OAC5Bh0C,EAAED,qBAIduzC,GAAsB,GAmC1BnrC,EAAe/V,OAAO/B,EAAS,YAAY,SAAS2P,GAChD,GAAKwzC,EAAgBxzC,GAArB,CAGA,IAAIi0C,EAASliD,GAAGwM,MAAQxM,GAAGwR,kBAAkByC,SAAW,KAAOhG,EAAEpE,aAAag4C,cAE1E5zC,EAAEpE,aAAao4C,WADJ,SAAXC,GAAgC,aAAXA,EACO,OAEA,OAEhCj0C,EAAEyxC,kBACFzxC,EAAED,qBAENoI,EAAe/V,OAAO/B,EAAS,aAAa,SAAS2P,GACjD,IAAK8zC,IAAuB,CACxB,IAAKN,EAAgBxzC,GACjB,OAEJtQ,EAAQ4hD,QAAQtxC,OAGxBmI,EAAe/V,OAAO/B,EAAS,aAAa,SAAS2P,GACjD,GAAKwzC,EAAgBxzC,GAArB,CAGAtQ,EAAQu1B,QAAQjlB,GAChB,IAAIk0C,EAAgBh5C,SAASi5C,iBAAiBn0C,EAAEo0C,QAASp0C,EAAEq0C,SACvDtiD,GAAGI,MAAMS,SAASshD,IAGtBxkD,EAAQgiD,sBAAsB1xC,OAElCmI,EAAe/V,OAAO/B,EAAS,QAAQ,SAAS2P,GAC5C,IAAK8zC,IAAuB,CACxB,IAAKN,EAAgBxzC,GACjB,OAEJA,EAAED,iBACFC,EAAEyxC,kBACF/hD,EAAQkiD,OAAO5xC,GAzD3B,WACI,IAAIs0C,EACJ,SAASC,KACLD,EAAiBp5C,SAASs5C,YAAY,UACvBC,UAAU/kD,EAAQmgD,uBAAuB,GAAM,GAElE,GAAIr4C,OAAOk9C,YACP,IACIJ,EAAiB,IAAII,YAAYhlD,EAAQmgD,uBAC3C,MAAOrK,GACL+O,SAGJA,IAEJr5C,SAASy5C,cAAcL,GA2CfM,OAMZ7iD,GAAG2B,OAAOvB,KAAM,CACZ8/C,aAAc,SAAS8B,GACnB,OAAOD,EAAoBC,IAE/B/wC,QAAS,WACLmF,EAAenF,WAEnBsvC,WAAY,WACR,OAAOjiD,KAGf8B,KAAK0vC,SAAW,GAChB1vC,KAAK0vC,SAAS2R,gBAAkBA,GA3kCxC,CA6kCGh8C,S,6BChjCH,SAASq9C,EAAgBx/C,EAAMy/C,GAC7B3iD,KAAKkD,KAAOA,EAAOA,GAAQ,GAC3BlD,KAAK4iD,SAAW1/C,EAAK2B,QAAQ,KAC7B7E,KAAK2iD,UAAYA,EACjB3iD,KAAKsmC,MAAQpjC,EAAK0B,MAAM+9C,GAG1BD,EAAgBjmD,UAAUwW,MAAQ,SAASnK,GACzC,IAEI+5C,EAEAC,EAJAC,GAAU,EACVzc,EAAQtmC,KAAKsmC,MAEb0c,EAAa1c,EAAMrhC,OAGvB,GAAoB,iBAAT6D,GAAqBA,aAAiB/B,OAC/C,GAAK/G,KAAK4iD,SAAW5iD,KAAKkD,MAAQ4F,EAE3B,CAEL,IADAg6C,GAAah6C,GAAS,IAAIlE,MAAM5E,KAAK2iD,WAChCE,EAAK,EAAGE,GAAWF,EAAKG,EAAYH,IACrB,MAAdvc,EAAMuc,KAGRE,EADSF,EAAKC,EAAU79C,QACdqhC,EAAMuc,KAAQC,EAAUD,IAOtCE,EAAUA,GAAWD,OAdrBC,GAAU,OAiBT,GAA2B,mBAAhBj6C,EAAMqR,OAGpB,IAFA4oC,EAAU,GAELF,EAAK/5C,EAAM7D,OAAQ49C,KAClB7iD,KAAKiT,MAAMnK,EAAM+5C,MACnBE,EAAQA,EAAQ99C,QAAU6D,EAAM+5C,SAIjC,GAAoB,iBAAT/5C,EAGd,IAAK,IAAI1M,KAFT2mD,EAAU,GAEMj6C,EACV9I,KAAKiT,MAAM7W,KACb2mD,EAAQ3mD,GAAO0M,EAAM1M,IAK3B,OAAO2mD,GAGTnoD,EAAOD,QAAU,SAASuI,EAAMtB,EAAM+gD,GACpC,IAAIM,EAAU,IAAIP,EAAgBx/C,EAAMy/C,GAAa,UACrD,YAAmB,IAAR/gD,EACFqhD,EAAQhwC,MAAMrR,GAGhBqhD,I,sEC3FT,IAAIhlD,EAAM,CACT,WAAY,EACZ,WAAY,GACZ,gBAAiB,GACjB,cAAe,GACf,YAAa,GACb,YAAa,GACb,YAAa,GACb,aAAc,GACd,YAAa,GACb,aAAc,GACd,YAAa,GACb,YAAa,GACb,YAAa,GACb,YAAa,GACb,YAAa,GACb,YAAa,GACb,YAAa,GACb,YAAa,GACb,YAAa,GACb,YAAa,GACb,gBAAiB,GACjB,cAAe,GACf,YAAa,GACb,YAAa,GACb,YAAa,IAId,SAASilD,EAAeC,GACvB,IAAI7qC,EAAK8qC,EAAsBD,GAC/B,OAAO1oD,EAAoB6d,GAE5B,SAAS8qC,EAAsBD,GAC9B,IAAI1oD,EAAoBa,EAAE2C,EAAKklD,GAAM,CACpC,IAAIt1C,EAAI,IAAIvO,MAAM,uBAAyB6jD,EAAM,KAEjD,MADAt1C,EAAE6gB,KAAO,mBACH7gB,EAEP,OAAO5P,EAAIklD,GAEZD,EAAe9kD,KAAO,WACrB,OAAO7C,OAAO6C,KAAKH,IAEpBilD,EAAeG,QAAUD,EACzBxoD,EAAOD,QAAUuoD,EACjBA,EAAe5qC,GAAK,G,gBC9CpB1d,EAAOD,QAAU,IAA0B,gB,gBCA3CC,EAAOD,QAAU,IAA0B,gB,gBCA3CC,EAAOD,QAAU,IAA0B,qB,gBCA3CC,EAAOD,QAAU,IAA0B,mB,gBCA3CC,EAAOD,QAAU,IAA0B,iB,gBCA3CC,EAAOD,QAAU,IAA0B,iB,gBCA3CC,EAAOD,QAAU,IAA0B,iB,gBCA3CC,EAAOD,QAAU,IAA0B,kB,gBCA3CC,EAAOD,QAAU,IAA0B,iB,gBCA3CC,EAAOD,QAAU,IAA0B,kB,gBCA3CC,EAAOD,QAAU,IAA0B,iB,gBCA3CC,EAAOD,QAAU,IAA0B,iB,gBCA3CC,EAAOD,QAAU,IAA0B,iB,gBCA3CC,EAAOD,QAAU,IAA0B,iB,gBCA3CC,EAAOD,QAAU,IAA0B,iB,gBCA3CC,EAAOD,QAAU,IAA0B,iB,gBCA3CC,EAAOD,QAAU,IAA0B,iB,gBCA3CC,EAAOD,QAAU,IAA0B,iB,gBCA3CC,EAAOD,QAAU,IAA0B,iB,gBCA3CC,EAAOD,QAAU,IAA0B,iB,gBCA3CC,EAAOD,QAAU,IAA0B,qB,gBCA3CC,EAAOD,QAAU,IAA0B,mB,gBCA3CC,EAAOD,QAAU,IAA0B,iB,gBCA3CC,EAAOD,QAAU,IAA0B,iB,gBCA3CC,EAAOD,QAAU,IAA0B,iB,sFCK3C,MAAM2oD,EAAej+C,OAAOk+C,WAAWD,aAOvC,SAASE,IACLlkD,MAAMqP,MAAM3O,KAAMqH,WAClBrH,KAAK5E,KAAO,kBACRkE,MAAMmkD,kBACNnkD,MAAMmkD,kBAAkBzjD,KAAMwjD,GAE9BxjD,KAAK0jD,OAAS,IAAIpkD,OAASokD,MAanC,SAASC,EAASzlD,EAASX,GACvByC,KAAK4jD,MAAQroD,OAAOsoD,OAAO,CACvBnqB,IAAK,GACLzwB,UAAU,EACV+b,eAAgB,EAChBxD,OAAQ,KACRsiC,UAAW,KACXC,UAAW,KACXt8B,WAAY,GACZrmB,QAAS,IACV7D,GAEHyC,KAAK9B,QAAUA,EACf8B,KAAKgkD,SAAWhkD,KAAKikD,gBAgNzB,SAASC,EAAehmD,GACpB,MAAM8d,EAAS,GACTmoC,EAAUjmD,EAAQimD,QAMxB,OALA5oD,OAAO6C,KAAK+lD,GAASrlD,SAAQ,SAAS1D,GAC9B,wBAAwBwG,KAAKxG,KAC7B4gB,EAAO5gB,GAAQ+oD,EAAQ/oD,OAGxB4gB,EA9OXwnC,EAAgB/mD,UAAYlB,OAAOY,OAAOmD,MAAM7C,WAyBhDknD,EAASlnD,UAAYlB,OAAOY,OAAOmnD,EAAa7mD,WAEhDknD,EAASlnD,UAAUo9B,UAAY,WAC3B,MAAoC,mBAAzB75B,KAAK4jD,MAAMG,UACXxoD,OAAOsoD,OAAOK,EAAelkD,KAAK9B,SAAU8B,KAAK4jD,MAAMG,UAAU/oD,KAAKgF,OACtC,iBAAzBA,KAAK4jD,MAAMG,UAClBxoD,OAAOsoD,OAAOK,EAAelkD,KAAK9B,SAAU8B,KAAK4jD,MAAMG,WAEvDG,EAAelkD,KAAK9B,UAInCylD,EAASlnD,UAAUwnD,cAAgB,WAC/B,MAAMG,EAAQpkD,KAGd,IAAIqkD,GAAa,EAEbL,EAAW,IAAIzvB,oBAAkB,CACjC/S,OAAQxhB,KAAK4jD,MAAMpiC,OACnBvY,SAAUjJ,KAAK4jD,MAAM36C,SACrB+b,eAAgBhlB,KAAK4jD,MAAM5+B,eAC3BE,QAAS,CACLjJ,SAAUjc,KAAK4jD,MAAMlqB,IACrB1d,OAAQhc,KAAK65B,aAEjBtmB,SAAU,CACN8K,SAAS,EACToY,SAAU,QACVP,WAAY,CACR7X,SAAS,IAGjBnb,KAAM,CACFklB,eAAgB,IAEpBX,WAAY,CACR0I,wBAAwB,EACxBf,UAAWg1B,EAAMR,MAAMn8B,WAAW2H,WAAa,EAC/CnZ,YAAamuC,EAAMR,MAAMn8B,WAAWxR,aAAe,KACnDyR,kBAAmB08B,EAAMR,MAAMn8B,WAAWC,mBAAqB,IAEnEoH,SAAU,CACN0G,UAAW,uEACXC,UAAW,4DAEf/Q,UAAW,CACP8O,SAAU,SAASlb,GACf,MAAM0rC,EAAWhkD,KACX8Y,EAAOkrC,EAASzkC,QAAQjH,GAE9B,GAAI+rC,IAAeD,EAAMR,MAAM36C,SAC3B,OAAO,EAMX,GAJIo7C,GAAa,EAIbD,EAAMR,MAAMxiD,SAAWgjD,EAAMR,MAAMxiD,QAAQ6D,OAC3C,IAAK,IAAIwU,EAAM,EAAGA,EAAM2qC,EAAMR,MAAMxiD,QAAQ6D,OAAQwU,IAAS,CACzD,MAAMnb,EAAS8lD,EAAMR,MAAMxiD,QAAQqY,GACnC,IACInb,EAAOtD,KAAKgpD,EAAU1rC,EAAIQ,GAC5B,MAAOvP,GAEL,OADA66C,EAAME,QAAQ,QAAS,CAAChsC,EAAI/O,EAAM1D,WAC3B,GAKnB,MAAM0+C,EAAoBH,EAAMR,MAAMn8B,WACtC,GAAI9f,iBAAOmR,GAAO,CAEd,MAAM0rC,EAAmBD,EAAkBtuC,YAC3C,GAAIuuC,GAAoBA,EAAiBv/C,OAAQ,CAC7C,IAAIqpB,GAAU,EASd,GARI3wB,MAAMC,QAAQ4mD,GACdl2B,EAAUk2B,EAAiBC,MAAK,SAASC,GACrC,OAAOzxC,IAAM6F,EAAK5Y,KAAMwkD,MAEO,iBAArBF,IACdl2B,EAAUrb,IAAM6F,EAAK5Y,KAAMskD,KAG1Bl2B,EAAS,CACV,MAAM3O,EAAU,KAAI7G,EAAK1d,mCAAmC0d,EAAK5Y,QAEjE,OADAkkD,EAAME,QAAQ,QAAS,CAAChsC,EAAIqH,KACrB,GAKf,GAAI4kC,EAAkBxwB,MAClB,OAAO,IAAI/oB,SAAQ,SAASq4C,EAASsB,GACjC,MAAM5wB,EAAQ,IAAIoY,MACZzS,EAAMr0B,OAAO+mC,KAAO/mC,OAAO+mC,IAAIC,gBAAkBhnC,OAAO+mC,IAAM/mC,OAAOinC,WAAajnC,OAAOinC,UAAUD,gBAAkBhnC,OAAOinC,UAAY,KAC1I5S,GACA3F,EAAM5oB,QAAU,WACZw5C,EAAO,gEAEX5wB,EAAM9oB,OAAS,WACXo4C,EAAQ,CACJja,MAAOppC,KAAKopC,MACZjyB,OAAQnX,KAAKmX,UAGrB4c,EAAMwY,IAAM7S,EAAI2S,gBAAgBvzB,IAEhC6rC,EAAO,mEAEZ3vC,MAAK,SAAS6D,GACb,GAAI0rC,EAAkBK,eAAkB/rC,EAAKuwB,MAAQmb,EAAkBK,cAAgB,CACnF,MAAMjlC,EAAU,KAAI7G,EAAK1d,+CAA+CmpD,EAAkBK,kBAE1F,MADAR,EAAME,QAAQ,QAAS,CAAChsC,EAAIqH,IACtB,IAAIrgB,MAAMqgB,GAEpB,GAAI4kC,EAAkBM,gBAAmBhsC,EAAK1B,OAASotC,EAAkBM,eAAiB,CACtF,MAAMllC,EAAU,KAAI7G,EAAK1d,gDAAgDmpD,EAAkBM,mBAE3F,MADAT,EAAME,QAAQ,QAAS,CAAChsC,EAAIqH,IACtB,IAAIrgB,MAAMqgB,GAEpB,GAAI4kC,EAAkBO,eAAkBjsC,EAAKuwB,MAAQmb,EAAkBO,cAAgB,CACnF,MAAMnlC,EAAU,KAAI7G,EAAK1d,wCAAwCmpD,EAAkBO,kBAEnF,MADAV,EAAME,QAAQ,QAAS,CAAChsC,EAAIqH,IACtB,IAAIrgB,MAAMqgB,GAEpB,GAAI4kC,EAAkBQ,gBAAmBlsC,EAAK1B,OAASotC,EAAkBQ,eAAiB,CACtF,MAAMplC,EAAU,KAAI7G,EAAK1d,yCAAyCmpD,EAAkBQ,mBAEpF,MADAX,EAAME,QAAQ,QAAS,CAAChsC,EAAIqH,IACtB,IAAIrgB,MAAMqgB,OAMhC,IACIykC,EAAME,QAAQ,SAAU,CAAChsC,IAC3B,MAAOzK,GACL,GAAe,oBAAXA,EAAEzS,KACF,OAAO,EAEP,MAAMyS,IAIlB2jB,YAAa,SAASlZ,GAClB8rC,EAAME,QAAQ,YAAa,CAAChsC,KAEhCmR,SAAU,SAASnR,GACf8rC,EAAME,QAAQ,SAAU,CAAChsC,KAE7BsQ,WAAY,SAAStQ,EAAIld,EAAM4pD,EAAeC,GAC1C,MAAMC,EAAa7jD,KAAKkmC,KAAYyd,EAAgBC,EAAvB,KAC7Bb,EAAME,QAAQ,WAAY,CAAChsC,EAAI4sC,KAEnC97B,SAAU,SAAS9Q,GACf8rC,EAAME,QAAQ,SAAU,CAAChsC,KAE7B0Q,WAAY,SAAS1Q,EAAIld,EAAM00B,GACvBA,EAAS5kB,SACTk5C,EAAME,QAAQ,WAAY,CAAChsC,EAAIwX,KAGvCY,cAAe,SAASy0B,EAAW10B,GAC/B4zB,GAAa,EACbD,EAAME,QAAQ,eAAgB,CAACa,EAAW10B,KAE9C9L,QAAS,SAASrM,EAAIld,EAAMukB,EAAQsJ,GAChC,IAAI6G,EAAUhB,EACd,IACIgB,EAAW9f,KAAKC,MAAMgZ,EAAIyqB,cAC5B,MAAOnqC,IAKLulB,EADAgB,IACWA,EAASs1B,QAAUt1B,EAASvmB,QAE5BoW,EAGfykC,EAAME,QAAQ,QAAS,CAAChsC,EAAIwW,QAoBxC,OAfI9uB,KAAK4jD,MAAME,WAAa9jD,KAAK4jD,MAAME,UAAU7+C,QAC7C,IAAIs4C,cAAY,CACZkD,iBAAkBzgD,KAAK4jD,MAAME,UAC7B/D,mBAAoB//C,KAAK4jD,MAAM36C,SAC/B0e,QAAS,CACLy3B,WAAY,wBAEhB16B,UAAW,CACPs7B,+BAAgC,SAASxiC,GACrCwmC,EAAS9nC,SAASsB,OAM3BwmC,GCvPX,MAAMqB,EAAUhgD,OAAOk+C,WAAW8B,QAElC,IAAIC,EAAU,GAGd,SAASC,EAAaH,GAClB,GAAIznD,MAAMC,QAAQwnD,GAAS,CACvB,GAAsB,IAAlBA,EAAOngD,OACP,OAAOmgD,EAAO,GACX,CACH,IAAIjO,EAAS,CACR,uCACA,0BAEL,IAAK,IAAIt8C,EAAE,EAAGC,EAAEsqD,EAAOngD,OAAQpK,EAAEC,EAAGD,IAChCs8C,EAAOz0C,KAAM,OAAM0iD,EAAOvqD,WAI9B,OAFAs8C,EAAOz0C,KAAM,SACby0C,EAASA,EAAO7nC,KAAK,OAI7B,OAAO81C,EASX,SAASI,EAAUj8C,GACfxD,QAAQkb,MAAO,eAAc1X,KAC7B+d,YAAW,WACP+9B,EAAQ11B,MAAM,CACVpZ,MAAO,QACP1Q,QAAS0/C,EAAah8C,QC9BlC,MAAM+5C,EAAej+C,OAAOk+C,WAAWD,aACjC+B,EAAUhgD,OAAOk+C,WAAW8B,QAC5BI,EAAYpgD,OAAOk+C,WAAWkC,UAC9BC,EAAYrgD,OAAOk+C,WAAWmC,UAcpC,SAASC,EAAWznD,EAASX,GAuBzB,GAnBAyC,KAAK4jD,MAAQnmD,IAAU,CACnBqL,MAAO,GACP88C,aAAc,GACdC,aAAc,GACdC,aAAc,GACdC,aAAc,GAEdC,KAAM,GAENC,KAAM,CACF78C,OAAQ,GACR88C,OAAQ,GACRC,OAAQ,KAEb5oD,GAAW,IAEdyC,KAAK9B,QAAUA,EAEf8B,KAAK8I,MAAQ9I,KAAK9B,QAAQmE,cAAcrC,KAAK4jD,MAAM96C,QAC9C9I,KAAK8I,MACN,MAAM,IAAIxJ,MAAO,sBAAqBU,KAAK4jD,MAAM96C,UAIrD,GADA9I,KAAK4lD,aAAe5lD,KAAK9B,QAAQmE,cAAcrC,KAAK4jD,MAAMgC,eACrD5lD,KAAK4lD,aACN,MAAM,IAAItmD,MAAO,sBAAqBU,KAAK4jD,MAAMgC,iBAIrD,GADA5lD,KAAK6lD,aAAe7lD,KAAK9B,QAAQmE,cAAcrC,KAAK4jD,MAAMiC,eACrD7lD,KAAK6lD,aACN,MAAM,IAAIvmD,MAAO,sBAAqBU,KAAK4jD,MAAMiC,iBAIrD,GADA7lD,KAAK8lD,aAAe9lD,KAAK9B,QAAQmE,cAAcrC,KAAK4jD,MAAMkC,eACrD9lD,KAAK8lD,aACN,MAAM,IAAIxmD,MAAO,sBAAqBU,KAAK4jD,MAAMkC,iBAIrD,GADA9lD,KAAK+lD,aAAe/lD,KAAK9B,QAAQmE,cAAcrC,KAAK4jD,MAAMmC,eACrD/lD,KAAK+lD,aACN,MAAM,IAAIzmD,MAAO,sBAAqBU,KAAK4jD,MAAMmC,iBAIrD/lD,KAAKomD,SAAU,EACfpmD,KAAKqmD,MAAQ/O,MAAMt3C,KAAKsmD,YAExBtmD,KAAKgkD,SAAWhkD,KAAKumD,eACrBvmD,KAAKwmD,eAGTb,EAAWlpD,UAAYlB,OAAOY,OAAOmnD,EAAa7mD,WAElDlB,OAAOC,eAAemqD,EAAWlpD,UAAW,aAAc,CACtDf,IAAK,WACD,OAAOmlC,SAAS7gC,KAAK8I,MAAMhN,QAE/B4mB,IAAK,SAAS5mB,GACVkE,KAAK8I,MAAMhN,MAAQ+kC,SAAS/kC,IAAU,MAI9CP,OAAOC,eAAemqD,EAAWlpD,UAAW,QAAS,CACjDf,IAAK,WACD,OAAO+qD,QAAQzmD,KAAK0mD,SAExBhkC,IAAK,SAAS5mB,GACV,MAAM6qD,EAAWF,QAAQ3qD,GACrB6qD,IAAaF,QAAQzmD,KAAK0mD,UAG1BC,EACA3mD,KAAK9B,QAAQ0oD,UAAU13C,IAAI,SAE3BlP,KAAK9B,QAAQ0oD,UAAU7lD,OAAO,SAElCf,KAAK0mD,OAASC,MAItBprD,OAAOC,eAAemqD,EAAWlpD,UAAW,UAAW,CACnDf,IAAK,WACD,OAAO+qD,QAAQzmD,KAAK6mD,WAExBnkC,IAAK,SAAS5mB,GACV,MAAM6qD,EAAWF,QAAQ3qD,GACrB6qD,IAAaF,QAAQzmD,KAAK6mD,YAG1BF,EACA3mD,KAAK9B,QAAQ0oD,UAAU13C,IAAI,YAE3BlP,KAAK9B,QAAQ0oD,UAAU7lD,OAAO,WAC9Bf,KAAK9B,QAAQ0oD,UAAU7lD,OAAO,eAElCf,KAAK6mD,SAAWF,MAOxBhB,EAAWlpD,UAAU8pD,aAAe,WAChC,MAAMnC,EAAQpkD,KACd,OAAO,IAAI2jD,EAAS3jD,KAAK9B,QAAS,CAC9Bw7B,IAAK15B,KAAK4jD,MAAMqC,KAAK78C,OACrBoY,OAAQxhB,KAAK4lD,aACb9B,UAAW9jD,KAAK9B,QAAQoE,iBAAiB,qBACzCmlB,WAAYzX,KAAKC,MAAMjQ,KAAK9B,QAAQimD,QAAQ18B,cAC7Cq/B,GAAG,aAAa,SAASxuC,GACxB8rC,EAAME,QAAQ,mBAAoB,CAAChsC,OACpCwuC,GAAG,UAAU,SAASxuC,GACrB8rC,EAAMgC,SAAU,EAEhB,MAAMhyC,EAAcgwC,EAAMlmD,QAAQmE,cAAc,iBAChD+R,IAAgBA,EAAYtU,MAAMspC,MAAQ,IAC1Cgb,EAAME,QAAQ,gBAAiB,CAAChsC,OACjCwuC,GAAG,YAAY,SAASxuC,EAAI4sC,GAC3B,MAAM9wC,EAAcgwC,EAAMlmD,QAAQmE,cAAc,iBAChD+R,IAAgBA,EAAYtU,MAAMspC,MAAQ8b,EAAa,KAEnDA,GAAc,KACdd,EAAMlmD,QAAQ0oD,UAAU13C,IAAI,iBAEjC43C,GAAG,YAAY,SAASxuC,EAAIwX,GAC3Bs0B,EAAMiC,OAAQ,EACdjC,EAAMkC,WAAax2B,EAASi3B,YAC5B3C,EAAME,QAAQ,kBAEd,MAAM5zC,EAAW0zC,EAAMlmD,QAAQmE,cAAc,cAC7CqO,IAAaA,EAAStN,YAAc0sB,EAAS10B,MAE7C,MAAM4rD,EAAW5C,EAAMlmD,QAAQmE,cAAc,cAC7C2kD,IAAaA,EAAS5jD,YAAc0sB,EAASm3B,WAE7C,MAAMC,EAAc9C,EAAMlmD,QAAQmE,cAAc+hD,EAAMR,MAAMoC,MAC5DkB,IAAgBA,EAAYpZ,KAAOhe,EAAS4J,KAE5C0qB,EAAME,QAAQ,sBACfwC,GAAG,UAAU,SAASxuC,GACrB8rC,EAAME,QAAQ,gBAAiB,CAAChsC,OACjCwuC,GAAG,SAAS,SAASxuC,EAAIwW,GACxB02B,EAAU12B,MACXg4B,GAAG,gBAAgB,WAClB1C,EAAMgC,SAAU,MASxBT,EAAWlpD,UAAU0qD,QAAU,SAASC,GACpC,GAAI9P,MAAMt3C,KAAKsmD,YACX,OAGJ,MAAMlC,EAAQpkD,KACRqnD,EAAQD,EAAQE,KAAK,QAC3Bt8C,QAAQ5L,IAAI,CACRqmD,EAAU8B,OACVC,MAAMH,EAAM77C,KAAK,UAAW,CACxBsZ,OAAQ,OACR2iC,YAAa,cACbnjB,KAAM,IAAIp7B,SAASm+C,EAAM3rD,IAAI,QAElCsZ,MAAK,SAASiS,GACb,MAAM6I,EAAW7I,EAAO,GACxB,IAAK6I,EAAS43B,GAAI,CACd,MAAMn+C,EAAQ,IAAIjK,MAAO,GAAEwwB,EAASrX,UAAUqX,EAAS63B,cAEvD,MADAp+C,EAAMumB,SAAWA,EACXvmB,EAEV,OAAOumB,EAAS/f,UACjBiF,MAAK,SAAS8a,GACb,GAAIA,EAASs1B,QAAUt1B,EAASs1B,OAAOngD,OAAQ,CAC3C,MAAMsE,EAAQ,IAAIjK,MAAM,mBAExB,MADAiK,EAAMumB,SAAWA,EACXvmB,EAKV,GAFAk8C,EAAU5lD,OACV6lD,EAAUkC,gBAAgBP,EAAM3rD,IAAI,IAChCo0B,EAAS+3B,YACTnC,EAAUoC,sBAAsBT,EAAM3rD,IAAI,GAAIo0B,EAAS+3B,iBACpD,CACHT,EAAQW,MAAM,QAEd,MAAMr3C,EAAW0zC,EAAMlmD,QAAQmE,cAAc,cAC7CqO,IAAaA,EAAStN,YAAc0sB,EAAS10B,MAE7C,MAAM4rD,EAAW5C,EAAMlmD,QAAQmE,cAAc,cAC7C2kD,IAAaA,EAAS5jD,YAAc0sB,EAASm3B,WAE7C,MAAMC,EAAc9C,EAAMlmD,QAAQmE,cAAc+hD,EAAMR,MAAMoC,MAC5DkB,IAAgBA,EAAYpZ,KAAOhe,EAAS4J,SAEjDsuB,OAAM,SAASz+C,GACdk8C,EAAU5lD,OACY,iBAAV0J,GAAuBA,EAAMumB,UAAYvmB,EAAMumB,SAASs1B,OAChEI,EAAUj8C,EAAMumB,SAASs1B,QAClB77C,aAAiBjK,MACxBkmD,EAAUj8C,EAAM1D,SAEhB2/C,EAAUj8C,OAStBo8C,EAAWlpD,UAAUwrD,QAAU,WAC3B,GAAI3Q,MAAMt3C,KAAKsmD,YACX,OAGJ,MAAM7hD,EAAO,IAAIyE,SACX8S,EAASkoC,EAAelkD,KAAK9B,SACnC3C,OAAO6C,KAAK4d,GAAQld,SAAQ,SAAS1D,GACjCqJ,EAAKgB,OAAOrK,EAAM4gB,EAAO5gB,OAE7BqJ,EAAKgB,OAAO,cAAezF,KAAKsmD,WAAWtpD,YAE3C,MAAMonD,EAAQpkD,KACdgL,QAAQ5L,IAAI,CACRqmD,EAAU8B,OACVC,MAAMxnD,KAAK4jD,MAAMqC,KAAKE,OAAQ,CAC1BrhC,OAAQ,OACR2iC,YAAa,cACbnjB,KAAM7/B,MAEXuQ,MAAK,SAASiS,GACb,MAAM6I,EAAW7I,EAAO,GACxB,IAAK6I,EAAS43B,GAAI,CACd,MAAMn+C,EAAQ,IAAIjK,MAAO,GAAEwwB,EAASrX,UAAUqX,EAAS63B,cAEvD,MADAp+C,EAAMumB,SAAWA,EACXvmB,EAEV,OAAOumB,EAAS/f,UACjBiF,MAAK,SAAS8a,GACb,GAAIA,EAASs1B,QAAUt1B,EAASs1B,OAAOngD,OAAQ,CAC3C,MAAMsE,EAAQ,IAAIjK,MAAM,mBAExB,MADAiK,EAAMumB,SAAWA,EACXvmB,EAGVk8C,EAAU5lD,OACVukD,EAAMiC,OAAQ,EACdjC,EAAMkC,WAAa,GAEnB,MAAM51C,EAAW0zC,EAAMlmD,QAAQmE,cAAc,cAC7CqO,IAAaA,EAAStN,YAAc,IAEpC,MAAM4jD,EAAW5C,EAAMlmD,QAAQmE,cAAc,cAC7C2kD,IAAaA,EAAS5jD,YAAc,IAEpCghD,EAAME,QAAQ,qBACf0D,OAAM,SAASz+C,GACdk8C,EAAU5lD,OACY,iBAAV0J,GAAuBA,EAAMumB,UAAYvmB,EAAMumB,SAASs1B,OAChEI,EAAUj8C,EAAMumB,SAASs1B,QAClB77C,aAAiBjK,MACxBkmD,EAAUj8C,EAAM1D,SAEhB2/C,EAAUj8C,OAKtBo8C,EAAWlpD,UAAU+pD,aAAe,WAChC,MAAMpC,EAAQpkD,KAGdA,KAAK6lD,aAAazlD,iBAAiB,SAAS,SAASyyB,GACjDA,EAAMjlB,iBACNw2C,EAAMgC,SAAU,EAChBhC,EAAMJ,SAASA,SAAShmC,eAI5Bhe,KAAK+lD,aAAa3lD,iBAAiB,SAAS,SAASyyB,GACjDA,EAAMjlB,iBAENy3C,EAAQ6C,OAAO,CACXrvC,KAAM,QACNtC,MAAO4xC,QAAQ,gBACftiD,QAASsiD,QAAQ,qDACjBC,UAAU,EACVC,QAAS,CACL1qC,OAAQ,CACJ2qC,MAAOH,QAAQ,UACftmD,UAAW,oBAEf0mD,QAAS,CACLD,MAAOH,QAAQ,UACftmD,UAAW,aACXsM,SAAU,WACNi2C,EAAM6D,kBAQ1BjoD,KAAK8lD,aAAa1lD,iBAAiB,SAAS,SAASyyB,GACjDA,EAAMjlB,iBAEN,MAAMnJ,EAAO,IAAIyE,SACX8S,EAASkoC,EAAeE,EAAMlmD,SACpC3C,OAAO6C,KAAK4d,GAAQld,SAAQ,SAAS1D,GACjCqJ,EAAKgB,OAAOrK,EAAM4gB,EAAO5gB,OAE7BqJ,EAAKgB,OAAO,cAAe2+C,EAAMkC,WAAWtpD,YAC5C,MAAMwrD,EAAc,IAAIC,gBAAgBhkD,GAAMzH,WAE9CgO,QAAQ5L,IAAI,CACRqmD,EAAU8B,OACVC,MAAO,GAAEpD,EAAMR,MAAMqC,KAAKC,UAAUsC,IAAe,CAC/Cf,YAAa,kBAElBzyC,MAAK,SAASiS,GACb,MAAM6I,EAAW7I,EAAO,GACxB,IAAK6I,EAAS43B,GAAI,CACd,MAAMn+C,EAAQ,IAAIjK,MAAO,GAAEwwB,EAASrX,UAAUqX,EAAS63B,cAEvD,MADAp+C,EAAMumB,SAAWA,EACXvmB,EAGV,OAAOumB,EAAS/f,UACjBiF,MAAK,SAAS8a,GACb,GAAIA,EAASs1B,QAAUt1B,EAASs1B,OAAOngD,OAAQ,CAC3C,MAAMsE,EAAQ,IAAIjK,MAAM,mBAExB,MADAiK,EAAMumB,SAAWA,EACXvmB,EAGVk8C,EAAU5lD,OACV,MAAMunD,EAAU/B,EAAQ6C,OAAO,CAC3B3xC,MAAO4xC,QAAQ,aACftiD,QAASiqB,EAASngB,KAClBy4C,UAAU,EACVC,QAAS,CACL1qC,OAAQ,CACJ2qC,MAAOH,QAAQ,UACftmD,UAAW,oBAEf6lD,GAAI,CACAY,MAAOH,QAAQ,QACftmD,UAAW,cACXsM,SAAU,WAEN,OADAi2C,EAAM+C,QAAQnnD,OACP,OAMTonD,EAAQE,KAAK,QACrBR,GAAG,UAAU,WAEf,OADA1C,EAAM+C,QAAQC,IACP,QAEZY,OAAM,SAASz+C,GACdk8C,EAAU5lD,OACY,iBAAV0J,GAAuBA,EAAMumB,UAAYvmB,EAAMumB,SAASs1B,OAChEI,EAAUj8C,EAAMumB,SAASs1B,QAClB77C,aAAiBjK,MACxBkmD,EAAUj8C,EAAM1D,SAEhB2/C,EAAUj8C,U,KC9Y1B,MAAMm/C,EAAerjD,OAAOk+C,WAAWmF,aACjCC,EAAWtjD,OAAOk+C,WAAWoF,SAOnC,SAASC,EAAW1qD,GACZA,EAAQ2qD,QAAQ,gBAIpB,IAAIlD,EAAWznD,EAAS,CACpB4K,MAAO,wBACP88C,aAAc,gCACdC,aAAc,gCACdC,aAAc,gCACdC,aAAc,gCACdC,KAAM,uBACNC,KAAM,CACF78C,OAAQlL,EAAQimD,QAAQ2E,UACxB5C,OAAQhoD,EAAQimD,QAAQ4E,UACxB5C,OAAQjoD,EAAQimD,QAAQ6E,aAMpC,SAASC,EAAYC,EAAOngD,SAASu7B,MAEjC4kB,EAAKnG,QADe,mBACW6F,EAAWM,GAC1CA,EAAK5mD,iBAFe,kBAEiBxD,QAAQ8pD,GAIjDF,EAAaO,GACbN,EAASQ,IAAIrC,GAAG,SAAUmC,G,KCrC1B,MAAMP,EAAerjD,OAAOk+C,WAAWmF,aACjCC,EAAWtjD,OAAOk+C,WAAWoF,SAMnC,SAASC,EAAW1qD,GACZA,EAAQ2qD,QAAQ,gBAIpB,IAAIlD,EAAWznD,EAAS,CACpB4K,MAAO,yBACP88C,aAAc,iCACdC,aAAc,iCACdC,aAAc,iCACdC,aAAc,iCACdC,KAAM,wBACNC,KAAM,CACF78C,OAAQlL,EAAQimD,QAAQ2E,UACxB5C,OAAQhoD,EAAQimD,QAAQ4E,UACxB5C,OAAQjoD,EAAQimD,QAAQ6E,aAMpC,SAASC,EAAYC,EAAOngD,SAASu7B,MAEjC4kB,EAAKnG,QADe,oBACW6F,EAAWM,GAC1CA,EAAK5mD,iBAFe,mBAEiBxD,QAAQ8pD,GAIjDF,EAAaO,GACbN,EAASQ,IAAIrC,GAAG,SAAUmC,G,KChC1B,MAAM3F,EAAej+C,OAAOk+C,WAAWD,aACjCoF,EAAerjD,OAAOk+C,WAAWmF,aACjCU,EAAW/jD,OAAOk+C,WAAW6F,SAC7B/D,EAAUhgD,OAAOk+C,WAAW8B,QAC5BsD,EAAWtjD,OAAOk+C,WAAWoF,SAC7BlD,EAAYpgD,OAAOk+C,WAAWkC,UAC9BC,EAAYrgD,OAAOk+C,WAAWmC,UAiBpC,SAAS2D,EAAWnrD,EAASX,GAwCzB,GApCAyC,KAAK4jD,MAAQnmD,IAAU,CACnBqL,MAAO,qBACPwgD,cAAe,qBACf7iD,KAAM,oBACN8iD,aAAc,6BACd3D,aAAc,6BACdG,aAAc,6BACdyD,cAAe,+BACfC,kBAAmB,8BAEnBC,YAAa,4BACbC,SAAU,yBACVC,aAAc,6BACdC,SAAU,yBACVC,iBAAkB,kCAClBC,iBAAkB,kCAClBC,iBAAkB,kCAClBC,qBAAsB,gCAEtBC,qBAAsB,oBACtBC,iBAAkB,4BAClBC,kBAAmB,6BAEnBnE,KAAM,CACFoE,iBAAkB,GAClBC,iBAAkB,GAClBC,WAAY,GACZC,WAAY,GACZC,WAAY,GACZC,UAAW,KAEhBntD,GAAW,IAEdyC,KAAK9B,QAAUA,EAEf8B,KAAK8I,MAAQ9I,KAAK9B,QAAQmE,cAAcrC,KAAK4jD,MAAM96C,QAC9C9I,KAAK8I,MACN,MAAM,IAAIxJ,MAAO,sBAAqBU,KAAK4jD,MAAM96C,UAIrD,GADA9I,KAAKspD,cAAgBtpD,KAAK9B,QAAQmE,cAAcrC,KAAK4jD,MAAM0F,gBACtDtpD,KAAKspD,cACN,MAAM,IAAIhqD,MAAO,sBAAqBU,KAAK4jD,MAAM0F,kBAIrD,GADAtpD,KAAKupD,aAAevpD,KAAK9B,QAAQmE,cAAcrC,KAAK4jD,MAAM2F,eACrDvpD,KAAKupD,aACN,MAAM,IAAIjqD,MAAO,sBAAqBU,KAAK4jD,MAAM2F,iBAIrD,GADAvpD,KAAK4lD,aAAe5lD,KAAK9B,QAAQmE,cAAcrC,KAAK4jD,MAAMgC,eACrD5lD,KAAK4lD,aACN,MAAM,IAAItmD,MAAO,sBAAqBU,KAAK4jD,MAAMgC,iBAIrD,GADA5lD,KAAK+lD,aAAe/lD,KAAK9B,QAAQmE,cAAcrC,KAAK4jD,MAAMmC,eACrD/lD,KAAK+lD,aACN,MAAM,IAAIzmD,MAAO,sBAAqBU,KAAK4jD,MAAMmC,iBAGrD/lD,KAAK2qD,OAqvBT,SAAS/B,EAAW1qD,GACZA,EAAQ2qD,QAAQ,gBAIpB,IAAIQ,EAAWnrD,EAAS,CACpB+nD,KAAM,CACFoE,iBAAkBnsD,EAAQimD,QAAQyG,oBAClCN,iBAAkBpsD,EAAQimD,QAAQ0G,oBAClCN,WAAYrsD,EAAQimD,QAAQ2G,cAC5BN,WAAYtsD,EAAQimD,QAAQ4G,cAC5BN,WAAYvsD,EAAQimD,QAAQ6G,cAC5BN,UAAWxsD,EAAQimD,QAAQ8G,gBAMvC,SAAShC,EAAYC,EAAOngD,SAASu7B,MAEjC4kB,EAAKnG,QADe,gBACW6F,EAAWM,GAC1CA,EAAK5mD,iBAFe,eAEiBxD,QAAQ8pD,GCn2BjD,IAAmBjtD,ED4FnB0tD,EAAW5sD,UAAYlB,OAAOY,OAAOmnD,EAAa7mD,WAElDlB,OAAOC,eAAe6tD,EAAW5sD,UAAW,eAAgB,CACxDf,IAAK,WACD,OAAOmlC,SAAS7gC,KAAK8I,MAAMhN,QAE/B4mB,IAAK,SAAS5mB,GACV,MAAM6qD,EAAW9lB,SAAS/kC,GAC1B,GAAIw7C,MAAMqP,GAAW,CAEjB3mD,KAAK8I,MAAMhN,MAAQ,GACnBkE,KAAKupD,aAAa52C,UAAW,EAC7B3S,KAAK4lD,aAAajzC,UAAW,EAC7B3S,KAAK+lD,aAAapzC,UAAW,EAC7B3S,KAAK9B,QAAQ0oD,UAAU13C,IAAIlP,KAAK4jD,MAAMsG,sBAEtC,MAAMgB,EAAclrD,KAAK4lD,aAAavjD,cAAc,sBACpD6oD,IAAgBA,EAAYv4C,UAAW,OACpC,CAEH3S,KAAK8I,MAAMhN,MAAQ6qD,EACnB3mD,KAAKupD,aAAa52C,UAAW,EAC7B3S,KAAK4lD,aAAajzC,UAAW,EAC7B3S,KAAK+lD,aAAapzC,UAAW,EAC7B3S,KAAK9B,QAAQ0oD,UAAU7lD,OAAOf,KAAK4jD,MAAMsG,sBAEzC,MAAMgB,EAAclrD,KAAK4lD,aAAavjD,cAAc,sBACpD6oD,IAAgBA,EAAYv4C,UAAW,OAQnD02C,EAAW5sD,UAAUkuD,KAAO,WACxB3qD,KAAKgkD,SAAWhkD,KAAKumD,eACrBvmD,KAAKmrD,SAAWnrD,KAAKorD,eACrBprD,KAAKqrD,aAAerrD,KAAK8I,MAAMhN,MAC/BkE,KAAKwmD,gBAMT6C,EAAW5sD,UAAU8pD,aAAe,WAChC,MAAMnC,EAAQpkD,KACd,OAAO,IAAI2jD,EAAS3jD,KAAK9B,QAAS,CAC9Bw7B,IAAK15B,KAAK4jD,MAAMqC,KAAKsE,WACrBthD,UAAU,EACV+b,eAAgB,EAChBxD,OAAQxhB,KAAK4lD,aACb9B,UAAW9jD,KAAK9B,QAAQoE,iBAAiB,qBACzCmlB,WAAYzX,KAAKC,MAAMjQ,KAAK9B,QAAQimD,QAAQ18B,YAC5Cs8B,UAAW,CACPsH,aAAc,WACV,OAAOjH,EAAMiH,iBAGtBvE,GAAG,UAAU,WACZ,GAAIxP,MAAM8M,EAAMiH,cACZ,MAAM,IAAI7H,KAEfsD,GAAG,aAAa,SAASxuC,GACxB,MAAMosC,EAAWN,EAAMlmD,QAAQmE,cAAc+hD,EAAMR,MAAM6F,mBACnDjsD,EAAQuL,SAASuiD,WAAW5G,EAAS6G,SAAS,GAE9C9F,EAAYjoD,EAAM6E,cAAc+hD,EAAMR,MAAMn9C,MAClDg/C,EAAUtB,QAAQqH,QAAUlzC,EAC5BmtC,EAAUmB,UAAU13C,IAAK,kBAAiBoJ,KAE1C,MAAMQ,EAAO9Y,KAAKgkD,SAASzkC,QAAQjH,GAC7B5H,EAAW+0C,EAAUpjD,cAAc+hD,EAAMR,MAAMiG,UACjDn5C,IACAA,EAAS6F,MAAQuC,EAAK1d,KACtBsV,EAAStN,YAAc0V,EAAK1d,MAGhCgpD,EAAMkF,cAAc7jD,OAAOjI,GAE3B4mD,EAAME,QAAQ,yBAA0B,CAACmB,EAAWntC,OACrDwuC,GAAG,UAAU,SAASxuC,GACrB,MAAMmtC,EAAYrB,EAAMkF,cAAcjnD,cAAe,mBAAkBiW,KACvE8rC,EAAME,QAAQ,yBAA0B,CAACmB,EAAWntC,OACrDwuC,GAAG,YAAY,SAASxuC,EAAI4sC,GAC3B,MAAMO,EAAYrB,EAAMkF,cAAcjnD,cAAe,mBAAkBiW,KACjElE,EAAcqxC,EAAUpjD,cAAc,iBAC5C+R,IAAgBA,EAAYtU,MAAMqX,OAAS+tC,EAAa,KAEpDA,GAAc,KACdO,EAAUmB,UAAU13C,IAAI,iBAE7B43C,GAAG,YAAY,SAASxuC,EAAIwX,GACvBwnB,MAAM8M,EAAMiH,gBACZjH,EAAMiH,aAAev7B,EAASu7B,aAC9BjH,EAAME,QAAQ,uBAGlB,MAAMmB,EAAYrB,EAAMkF,cAAcjnD,cAAe,mBAAkBiW,KACvE8rC,EAAME,QAAQ,2BAA4B,CAACmB,EAAWntC,IAEtD,MAAMmzC,EAAW37B,EAAS47B,UACpBC,EAAmBvH,EAAMR,MAAMqG,qBAAqBjoD,QAAQ,KAAMypD,GAClE/G,EAAWN,EAAMlmD,QAAQmE,cAAcspD,GAC7C,GAAKjH,EAAL,CAGO,CACH,MAAMlnD,EAAQuL,SAASuiD,WAAW5G,EAAS6G,SAAS,GAC9C9kD,EAAOjJ,EAAM6E,cAAc+hD,EAAMR,MAAMn9C,MAC7CA,EAAKmJ,aAAa,UAAWkgB,EAASxX,IACtC7R,EAAKmJ,aAAa,iBAAkB67C,GAEpC,MAAMG,EAAUpuD,EAAM6E,cAAc+hD,EAAMR,MAAM8F,aAChDkC,IAAYA,EAAQ39C,UAAY6hB,EAAS87B,SAEzC,MAAM1E,EAAc1pD,EAAM6E,cAAc+hD,EAAMR,MAAM+F,UACpDzC,IAAgBA,EAAYpZ,KAAOhe,EAAS4J,KAE5C,MAAMhpB,EAAWlT,EAAM6E,cAAc+hD,EAAMR,MAAMiG,UAC7Cn5C,IACAA,EAAS6F,MAAQuZ,EAAS10B,KAC1BsV,EAAStN,YAAc0sB,EAAS10B,MAGpCqqD,EAAUoG,OAAOruD,GAGrBioD,EAAU1kD,cAvBNqjD,EAAME,QAAQ,QAAS,CAAChsC,EAAK,sBAAqBmzC,SAwBvD3E,GAAG,UAAU,SAASxuC,GACrB,MAAMmtC,EAAYrB,EAAMkF,cAAcjnD,cAAe,mBAAkBiW,KACvE8rC,EAAME,QAAQ,yBAA0B,CAACmB,EAAWntC,IAChDmtC,IAEAA,EAAUrlD,iBAAiB,gBAAgB,WACvCqlD,EAAU1kD,YAEd0kD,EAAUmB,UAAU13C,IAAIk1C,EAAMR,MAAMwG,uBAEzCtD,GAAG,SAAS,SAASxuC,EAAIwW,GJ9LhC,IAAsBvlB,II+LDulB,EJ9LjB/oB,QAAQkb,MAAO,kBAAiB1X,KACX,iBAAVA,EACP+7C,EAAQ5iD,KAAK6G,GACN5L,MAAMC,QAAQ2L,KACrB+7C,EAAUA,EAAQtnD,OAAOuL,II2LzB,MAAMk8C,EAAYrB,EAAMkF,cAAcjnD,cAAe,mBAAkBiW,KACnEmtC,IAEAA,EAAUrlD,iBAAiB,gBAAgB,WACvCqlD,EAAU1kD,YAEd0kD,EAAUmB,UAAU13C,IAAIk1C,EAAMR,MAAMwG,uBAEzCtD,GAAG,gBAAgB,WJ3LjBxB,GAAYA,EAAQrgD,QAIzBqiB,YAAW,WACFg+B,GAAYA,EAAQrgD,SAIzBogD,EAAQ11B,MAAM,CACVpZ,MAAO,QACP1Q,QAAS0/C,EAAaD,KAG1BA,EAAU,WIkLlB+D,EAAW5sD,UAAU2uD,aAAe,WAChC,MAAMhH,EAAQpkD,KACd,OAAOopD,EAASjtD,OAAO6D,KAAKspD,cAAe,CACvCwC,UAAW,EACXC,UAAW/rD,KAAK4jD,MAAMn9C,KACtBnI,OAAQ0B,KAAK4jD,MAAM4F,cACnBwC,OAAQ,oBACRC,WAAY,iBACZC,MAAO,WACH,MACMC,EADQxuD,MAAMqO,KAAKo4C,EAAMkF,cAAchnD,iBAAiB8hD,EAAMR,MAAMn9C,OACtDxI,KAAI,SAASwI,GAC7B,IAAKA,EAAKs8C,QAAQqB,EAAMR,MAAM4F,eAC1B,OAAO/iD,EAAK09C,QAAQiI,MAEzB9tD,OAAOmoD,SAEJhiD,EAAO,IAAIyE,SACX8S,EAASkoC,EAAeE,EAAMlmD,SACpC3C,OAAO6C,KAAK4d,GAAQld,SAAQ,SAAS1D,GACjCqJ,EAAKgB,OAAOrK,EAAM4gB,EAAO5gB,OAE7BqJ,EAAKgB,OAAO,eAAgB2+C,EAAMiH,aAAaruD,YAC/CyH,EAAKgB,OAAO,QAAS0mD,EAAM78C,KAAK,MAEhCk4C,MAAMpD,EAAMR,MAAMqC,KAAKyE,UAAW,CAC9B5lC,OAAQ,OACR2iC,YAAa,cACbnjB,KAAM7/B,IACPuQ,MAAK,SAAS8a,GACb,IAAKA,EAAS43B,GAAI,CACd,MAAMn+C,EAAQ,IAAIjK,MAAO,GAAEwwB,EAASrX,UAAUqX,EAAS63B,cAEvD,MADAp+C,EAAMumB,SAAWA,EACXvmB,EAEV,OAAOumB,EAAS/f,UACjBiF,MAAK,SAAS8a,GACb,GAAIA,EAASs1B,QAAUt1B,EAASs1B,OAAOngD,OAAQ,CAC3C,MAAMsE,EAAQ,IAAIjK,MAAM,mBAExB,MADAiK,EAAMumB,SAAWA,EACXvmB,MAEXy+C,OAAM,SAASz+C,GACQ,iBAAVA,GAAuBA,EAAMumB,UAAYvmB,EAAMumB,SAASs1B,OAChEI,EAAUj8C,EAAMumB,SAASs1B,QAClB77C,aAAiBjK,MACxBkmD,EAAUj8C,EAAM1D,SAEhB2/C,EAAUj8C,UAU9B8/C,EAAW5sD,UAAU4vD,WAAa,WAC9B,KAAOrsD,KAAKspD,cAAcxmD,YACtB9C,KAAKspD,cAActoD,YAAYhB,KAAKspD,cAAcxmD,aAQ1DumD,EAAW5sD,UAAU6vD,kBAAoB,WACrC,IAAKhV,MAAMt3C,KAAKqrD,cACZ,OAGJ,MAAM5mD,EAAO,IAAIyE,SACX8S,EAASkoC,EAAelkD,KAAK9B,SACnC3C,OAAO6C,KAAK4d,GAAQld,SAAQ,SAAS1D,GACjCqJ,EAAKgB,OAAOrK,EAAM4gB,EAAO5gB,OAG7B,MAAMgpD,EAAQpkD,KACdgL,QAAQ5L,IAAI,CACRqmD,EAAU8B,OACVC,MAAMxnD,KAAK4jD,MAAMqC,KAAKoE,iBAAkB,CACpCvlC,OAAQ,OACR2iC,YAAa,cACbnjB,KAAM7/B,MAEXuQ,MAAK,SAASiS,GACb,MAAM6I,EAAW7I,EAAO,GACxB,IAAK6I,EAAS43B,GAAI,CACd,MAAMn+C,EAAQ,IAAIjK,MAAO,GAAEwwB,EAASrX,UAAUqX,EAAS63B,cAEvD,MADAp+C,EAAMumB,SAAWA,EACXvmB,EAEV,OAAOumB,EAAS/f,UACjBiF,MAAK,SAAS8a,GACb,GAAIA,EAASs1B,QAAUt1B,EAASs1B,OAAOngD,OAAQ,CAC3C,MAAMsE,EAAQ,IAAIjK,MAAM,mBAExB,MADAiK,EAAMumB,SAAWA,EACXvmB,EAGVk8C,EAAU5lD,OACVukD,EAAMiH,aAAev7B,EAASy8B,cAC9BnI,EAAME,QAAQ,yBACf0D,OAAM,SAASz+C,GACdk8C,EAAU5lD,OACY,iBAAV0J,GAAuBA,EAAMumB,UAAYvmB,EAAMumB,SAASs1B,OAChEI,EAAUj8C,EAAMumB,SAASs1B,QAClB77C,aAAiBjK,MACxBkmD,EAAUj8C,EAAM1D,SAEhB2/C,EAAUj8C,OAUtB8/C,EAAW5sD,UAAU+vD,YAAc,SAAS/lD,GACxC,GAAI6wC,MAAMt3C,KAAKqrD,cACX,OAGJ,MAAMtE,EAAclmB,SAASp6B,GAAQA,EAAK09C,QAAQiI,IAClD,GAAI9U,MAAMyP,GACN,OAGJ,MAAMtiD,EAAO,IAAIyE,SACX8S,EAASkoC,EAAelkD,KAAK9B,SACnC3C,OAAO6C,KAAK4d,GAAQld,SAAQ,SAAS1D,GACjCqJ,EAAKgB,OAAOrK,EAAM4gB,EAAO5gB,OAE7BqJ,EAAKgB,OAAO,eAAgBzF,KAAKqrD,aAAaruD,YAC9CyH,EAAKgB,OAAO,cAAeshD,EAAY/pD,YACvCyH,EAAKgB,OAAO,YAAagB,EAAK09C,QAAQsH,UAEtC,MAAMrH,EAAQpkD,KACdgL,QAAQ5L,IAAI,CACRqmD,EAAU8B,OACVC,MAAMxnD,KAAK4jD,MAAMqC,KAAKwE,WAAY,CAC9B3lC,OAAQ,OACR2iC,YAAa,cACbnjB,KAAM7/B,MAEXuQ,MAAK,SAASiS,GACb,MAAM6I,EAAW7I,EAAO,GACxB,IAAK6I,EAAS43B,GAAI,CACd,MAAMn+C,EAAQ,IAAIjK,MAAO,GAAEwwB,EAASrX,UAAUqX,EAAS63B,cAEvD,MADAp+C,EAAMumB,SAAWA,EACXvmB,EAGV,OAAOumB,EAAS/f,UACjBiF,MAAK,SAAS8a,GACb,GAAIA,EAASs1B,QAAUt1B,EAASs1B,OAAOngD,OAAQ,CAC3C,MAAMsE,EAAQ,IAAIjK,MAAM,mBAExB,MADAiK,EAAMumB,SAAWA,EACXvmB,EAGVk8C,EAAU5lD,OAGV4G,EAAKrG,iBAAiB,gBAAgB,WAClCqG,EAAK1F,YAET0F,EAAKmgD,UAAU13C,IAAIk1C,EAAMR,MAAMwG,sBAChCpC,OAAM,SAASz+C,GACdk8C,EAAU5lD,OACY,iBAAV0J,GAAuBA,EAAMumB,UAAYvmB,EAAMumB,SAASs1B,OAChEI,EAAUj8C,EAAMumB,SAASs1B,QAClB77C,aAAiBjK,MACxBkmD,EAAUj8C,EAAM1D,SAEhB2/C,EAAUj8C,OAWtB8/C,EAAW5sD,UAAUgwD,YAAc,SAAShmD,EAAM2gD,GAC9C,GAAI9P,MAAMt3C,KAAKqrD,cACX,OAGJ,MAAMtE,EAAclmB,SAASp6B,GAAQA,EAAK09C,QAAQiI,IAClD,GAAI9U,MAAMyP,GACN,OAGJ,MAAM3C,EAAQpkD,KACRqnD,EAAQD,EAAQE,KAAK,QAC3Bt8C,QAAQ5L,IAAI,CACRqmD,EAAU8B,OACVC,MAAMH,EAAM77C,KAAK,UAAW,CACxBsZ,OAAQ,OACR2iC,YAAa,cACbnjB,KAAM,IAAIp7B,SAASm+C,EAAM3rD,IAAI,QAElCsZ,MAAK,SAASiS,GACb,MAAM6I,EAAW7I,EAAO,GACxB,IAAK6I,EAAS43B,GAAI,CACd,MAAMn+C,EAAQ,IAAIjK,MAAO,GAAEwwB,EAASrX,UAAUqX,EAAS63B,cAEvD,MADAp+C,EAAMumB,SAAWA,EACXvmB,EAGV,OAAOumB,EAAS/f,UACjBiF,MAAK,SAAS8a,GACb,GAAIA,EAASs1B,QAAUt1B,EAASs1B,OAAOngD,OAAQ,CAC3C,MAAMsE,EAAQ,IAAIjK,MAAM,mBAExB,MADAiK,EAAMumB,SAAWA,EACXvmB,EAKV,GAFAk8C,EAAU5lD,OACV6lD,EAAUkC,gBAAgBP,EAAM3rD,IAAI,IAChCo0B,EAAS+3B,YACTnC,EAAUoC,sBAAsBT,EAAM3rD,IAAI,GAAIo0B,EAAS+3B,iBACpD,CACHT,EAAQW,MAAM,QAEd,MAAM6D,EAAUnlD,EAAKpE,cAAc+hD,EAAMR,MAAM8F,aAC/CkC,IAAYA,EAAQ39C,UAAY6hB,EAAS87B,SAEzC,MAAM1E,EAAczgD,EAAKpE,cAAc+hD,EAAMR,MAAM+F,UACnDzC,IAAgBA,EAAYpZ,KAAOhe,EAAS4J,KAE5C,MAAMhpB,EAAWjK,EAAKpE,cAAc+hD,EAAMR,MAAMiG,UAC5Cn5C,IACAA,EAAS6F,MAAQuZ,EAAS10B,KAC1BsV,EAAStN,YAAc0sB,EAAS10B,UAGzC4sD,OAAM,SAASz+C,GACdk8C,EAAU5lD,OACY,iBAAV0J,GAAuBA,EAAMumB,UAAYvmB,EAAMumB,SAASs1B,OAChEI,EAAUj8C,EAAMumB,SAASs1B,QAClB77C,aAAiBjK,MACxBkmD,EAAUj8C,EAAM1D,SAEhB2/C,EAAUj8C,OAStB8/C,EAAW5sD,UAAUiwD,kBAAoB,WACrC,GAAIpV,MAAMt3C,KAAKqrD,cACX,OAGJ,MAAM5mD,EAAO,IAAIyE,SACX8S,EAASkoC,EAAelkD,KAAK9B,SACnC3C,OAAO6C,KAAK4d,GAAQld,SAAQ,SAAS1D,GACjCqJ,EAAKgB,OAAOrK,EAAM4gB,EAAO5gB,OAE7BqJ,EAAKgB,OAAO,eAAgBzF,KAAKqrD,aAAaruD,YAE9C,MAAMonD,EAAQpkD,KACdgL,QAAQ5L,IAAI,CACRqmD,EAAU8B,OACVC,MAAMxnD,KAAK4jD,MAAMqC,KAAKqE,iBAAkB,CACpCxlC,OAAQ,OACR2iC,YAAa,cACbnjB,KAAM7/B,MAEXuQ,MAAK,SAASiS,GACb,MAAM6I,EAAW7I,EAAO,GACxB,IAAK6I,EAAS43B,GAAI,CACd,MAAMn+C,EAAQ,IAAIjK,MAAO,GAAEwwB,EAASrX,UAAUqX,EAAS63B,cAEvD,MADAp+C,EAAMumB,SAAWA,EACXvmB,EAEV,OAAOumB,EAAS/f,UACjBiF,MAAK,SAAS8a,GACb,GAAIA,EAASs1B,QAAUt1B,EAASs1B,OAAOngD,OAAQ,CAC3C,MAAMsE,EAAQ,IAAIjK,MAAM,mBAExB,MADAiK,EAAMumB,SAAWA,EACXvmB,EAGVk8C,EAAU5lD,OACV,IAAI8sD,EAAW,KACfhvD,MAAMqO,KAAKo4C,EAAMkF,cAAc1mD,UAAU9D,SAAQ,SAAS2H,GACtDA,EAAKmgD,UAAU13C,IAAIk1C,EAAMR,MAAMwG,mBAC/BuC,EAAWlmD,KAGXkmD,EACAA,EAASvsD,iBAAiB,gBAAgB,WACtCgkD,EAAMiI,aACNjI,EAAMiH,aAAe,GACrBjH,EAAME,QAAQ,0BAGlBF,EAAMiI,aACNjI,EAAMiH,aAAe,GACrBjH,EAAME,QAAQ,0BAEnB0D,OAAM,SAASz+C,GACdk8C,EAAU5lD,OACY,iBAAV0J,GAAuBA,EAAMumB,UAAYvmB,EAAMumB,SAASs1B,OAChEI,EAAUj8C,EAAMumB,SAASs1B,QAClB77C,aAAiBjK,MACxBkmD,EAAUj8C,EAAM1D,SAEhB2/C,EAAUj8C,OAWtB8/C,EAAW5sD,UAAUmwD,WAAa,SAASnmD,EAAM6O,GAAM,GACnD7O,EAAKmgD,UAAUiG,OAAO7sD,KAAK4jD,MAAMuG,iBAAkB70C,GAClC7O,EAAKpE,cAAcrC,KAAK4jD,MAAMgG,cACtC/O,QAAUvlC,GAGvB+zC,EAAW5sD,UAAU+pD,aAAe,WAChC,MAAMpC,EAAQpkD,KAGdA,KAAK9B,QAAQkC,iBAAiB,SAAS,SAASyyB,GACvCA,EAAM/0B,OAAO+qD,QAAQzE,EAAMR,MAAM2F,gBAItC12B,EAAMjlB,iBACNw2C,EAAMkI,wBAIVtsD,KAAK9B,QAAQkC,iBAAiB,SAAS,SAASyyB,GACvCA,EAAM/0B,OAAO+qD,QAAQzE,EAAMR,MAAMmC,gBAItClzB,EAAMjlB,iBAENy3C,EAAQ6C,OAAO,CACXrvC,KAAM,QACNtC,MAAO4xC,QAAQ,gBACftiD,QAASsiD,QAAQ,2DACjBC,UAAU,EACVC,QAAS,CACL1qC,OAAQ,CACJ2qC,MAAOH,QAAQ,UACftmD,UAAW,oBAEf0mD,QAAS,CACLD,MAAOH,QAAQ,UACftmD,UAAW,aACXsM,SAAU,WACNi2C,EAAMsI,6BAQ1B1sD,KAAK9B,QAAQkC,iBAAiB,SAAS,SAASyyB,GAC5C,IAAKA,EAAM/0B,OAAO+qD,QAAQzE,EAAMR,MAAMkG,kBAClC,OAGJj3B,EAAMjlB,iBAEN,MAAMnH,EAAOosB,EAAM/0B,OAAO+qD,QAAQzE,EAAMR,MAAMn9C,MACxCsgD,EAAclmB,SAASp6B,GAAQA,EAAK09C,QAAQiI,IAClD,GAAI9U,MAAMyP,GACN,OAGJ,MAAMtiD,EAAO,IAAIyE,SACX8S,EAASkoC,EAAeE,EAAMlmD,SACpC3C,OAAO6C,KAAK4d,GAAQld,SAAQ,SAAS1D,GACjCqJ,EAAKgB,OAAOrK,EAAM4gB,EAAO5gB,OAE7BqJ,EAAKgB,OAAO,eAAgB2+C,EAAMiH,aAAaruD,YAC/CyH,EAAKgB,OAAO,cAAeshD,EAAY/pD,YACvCyH,EAAKgB,OAAO,YAAagB,EAAK09C,QAAQsH,UACtC,MAAMjD,EAAc,IAAIC,gBAAgBhkD,GAAMzH,WAE9CgO,QAAQ5L,IAAI,CACRqmD,EAAU8B,OACVC,MAAO,GAAEpD,EAAMR,MAAMqC,KAAKuE,cAAchC,IAAe,CACnDf,YAAa,kBAElBzyC,MAAK,SAASiS,GACb,MAAM6I,EAAW7I,EAAO,GACxB,IAAK6I,EAAS43B,GAAI,CACd,MAAMn+C,EAAQ,IAAIjK,MAAO,GAAEwwB,EAASrX,UAAUqX,EAAS63B,cAEvD,MADAp+C,EAAMumB,SAAWA,EACXvmB,EAGV,OAAOumB,EAAS/f,UACjBiF,MAAK,SAAS8a,GACb,GAAIA,EAASs1B,QAAUt1B,EAASs1B,OAAOngD,OAAQ,CAC3C,MAAMsE,EAAQ,IAAIjK,MAAM,mBAExB,MADAiK,EAAMumB,SAAWA,EACXvmB,EAGVk8C,EAAU5lD,OACV,MAAMunD,EAAU/B,EAAQ6C,OAAO,CAC3B3xC,MAAO4xC,QAAQ,aACftiD,QAASiqB,EAASngB,KAClBy4C,UAAU,EACVC,QAAS,CACL1qC,OAAQ,CACJ2qC,MAAOH,QAAQ,UACftmD,UAAW,oBAEf6lD,GAAI,CACAY,MAAOH,QAAQ,QACftmD,UAAW,cACXsM,SAAU,WAEN,OADAi2C,EAAMqI,YAAYhmD,EAAMzG,OACjB,OAMTonD,EAAQE,KAAK,QACrBR,GAAG,UAAU,WAEf,OADA1C,EAAMqI,YAAYhmD,EAAM2gD,IACjB,QAEZY,OAAM,SAASz+C,GACdk8C,EAAU5lD,OACY,iBAAV0J,GAAuBA,EAAMumB,UAAYvmB,EAAMumB,SAASs1B,OAChEI,EAAUj8C,EAAMumB,SAASs1B,QAClB77C,aAAiBjK,MACxBkmD,EAAUj8C,EAAM1D,SAEhB2/C,EAAUj8C,SAMtBvJ,KAAK9B,QAAQkC,iBAAiB,SAAS,SAASyyB,GAC5C,IAAKA,EAAM/0B,OAAO+qD,QAAQzE,EAAMR,MAAMmG,kBAClC,OAGJl3B,EAAMjlB,iBACN,MAAMnH,EAAOosB,EAAM/0B,OAAO+qD,QAAQzE,EAAMR,MAAMn9C,MACxC+kD,EAAU3qB,SAASp6B,EAAK09C,QAAQqH,SACtCpH,EAAMJ,SAASA,SAASrmC,OAAO6tC,MAInCxrD,KAAK9B,QAAQkC,iBAAiB,SAAS,SAASyyB,GACvCA,EAAM/0B,OAAO+qD,QAAQzE,EAAMR,MAAMoG,oBAItCn3B,EAAMjlB,iBAENy3C,EAAQ6C,OAAO,CACXrvC,KAAM,QACNtC,MAAO4xC,QAAQ,gBACftiD,QAASsiD,QAAQ,qDACjBC,UAAU,EACVC,QAAS,CACL1qC,OAAQ,CACJ2qC,MAAOH,QAAQ,UACftmD,UAAW,oBAEf0mD,QAAS,CACLD,MAAOH,QAAQ,UACftmD,UAAW,aACXsM,SAAU,WACN,MAAM1H,EAAOosB,EAAM/0B,OAAO+qD,QAAQzE,EAAMR,MAAMn9C,MAC9C29C,EAAMoI,YAAY/lD,YAQtC,IAAIqmD,EAAc,KAClB9sD,KAAK9B,QAAQkC,iBAAiB,SAAS,SAASyyB,GAC5C,MAAMpsB,EAAOosB,EAAM/0B,OAAO+qD,QAAQzE,EAAMR,MAAMn9C,MAC9C,IAAKA,EACD,OAGJ,IAAIsmD,EACAC,EAAWn6B,EAAM/0B,OAAO+qD,QAAQzE,EAAMR,MAAMgG,cAChD,GAAKoD,EAcDD,EAAeC,EAASnS,YAdb,CAGX,IAAKhoB,EAAMo6B,UAAYp6B,EAAMq6B,SACzB,OAIJ,KADAF,EAAWvmD,EAAKpE,cAAc+hD,EAAMR,MAAMgG,eAEtC,OAEJmD,GAAgBC,EAASnS,QAM7B,GAAIiS,GAAej6B,EAAMq6B,UAAaJ,IAAgBrmD,EAAO,CACzD,MAAMiD,EAAQ/L,MAAMqO,KAAKo4C,EAAMkF,cAAchnD,iBAAiB8hD,EAAMR,MAAMn9C,OACpE0mD,EAAYzjD,EAAM7E,QAAQioD,GAC1BM,EAAc1jD,EAAM7E,QAAQ4B,GAC5B4mD,EAAahsD,KAAKisD,IAAIH,EAAWC,GACjCG,EAAWlsD,KAAK+pB,IAAI+hC,EAAWC,GAClB1jD,EAAMtC,MAAMimD,EAAYE,EAAW,GAC3CzuD,SAAQ,SAAS2H,GACxB29C,EAAMwI,WAAWnmD,EAAMsmD,WAG3B3I,EAAMwI,WAAWnmD,EAAMsmD,GAG3BD,EAAcrmD,KAIlBzG,KAAK9B,QAAQkC,iBAAiB,SAAS,SAASyyB,GAC5C,GAAmB,WAAfA,EAAMnE,KAAmB,CACzB,MACM8+B,EADQ7vD,MAAMqO,KAAKo4C,EAAMkF,cAAchnD,iBAAiB8hD,EAAMR,MAAMn9C,OAC/CnI,QAAO,SAASmI,GAEvC,OADiBA,EAAKpE,cAAc+hD,EAAMR,MAAMgG,cAChC/O,WAGhB2S,EAAavoD,QACbogD,EAAQ6C,OAAO,CACXrvC,KAAM,QACNtC,MAAO4xC,QAAQ,gBACftiD,QAASsiD,QAAS,0DAAyDqF,EAAavoD,uBACxFmjD,UAAU,EACVC,QAAS,CACL1qC,OAAQ,CACJ2qC,MAAOH,QAAQ,UACftmD,UAAW,oBAEf0mD,QAAS,CACLD,MAAOH,QAAQ,UACftmD,UAAW,aACXsM,SAAU,WACNq/C,EAAa1uD,SAAQ,SAAS2H,GAC1B29C,EAAMoI,YAAY/lD,eAWlDzG,KAAK9B,QAAQkC,iBAAiB,YAAY,SAASyyB,GAC/C,MAAMpsB,EAAOosB,EAAM/0B,OAAO+qD,QAAQzE,EAAMR,MAAMn9C,MAC9C,IAAKA,EACD,OAGJ,MAAMkjD,EAAWljD,EAAKpE,cAAc+hD,EAAMR,MAAM+F,UAC5CA,GACAA,EAASnH,cAAc,IAAIiL,WAAW,QAAS,CAC3CC,SAAS,EACTC,YAAY,SAgC5BjF,EAAaO,GACbN,EAASQ,IAAIrC,GAAG,SAAUmC,ICx2BPttD,EAGTiyD,MAFGxvD,OAAOH,IAAItC","file":"widget.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/static/paper_uploads/dist/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 34);\n","'use strict';\n\nvar isMergeableObject = function isMergeableObject(value) {\n\treturn isNonNullObject(value)\n\t\t&& !isSpecial(value)\n};\n\nfunction isNonNullObject(value) {\n\treturn !!value && typeof value === 'object'\n}\n\nfunction isSpecial(value) {\n\tvar stringValue = Object.prototype.toString.call(value);\n\n\treturn stringValue === '[object RegExp]'\n\t\t|| stringValue === '[object Date]'\n\t\t|| isReactElement(value)\n}\n\n// see https://github.com/facebook/react/blob/b5ac963fb791d1298e7f396236383bc955f916c1/src/isomorphic/classic/element/ReactElement.js#L21-L25\nvar canUseSymbol = typeof Symbol === 'function' && Symbol.for;\nvar REACT_ELEMENT_TYPE = canUseSymbol ? Symbol.for('react.element') : 0xeac7;\n\nfunction isReactElement(value) {\n\treturn value.$$typeof === REACT_ELEMENT_TYPE\n}\n\nfunction emptyTarget(val) {\n\treturn Array.isArray(val) ? [] : {}\n}\n\nfunction cloneUnlessOtherwiseSpecified(value, options) {\n\treturn (options.clone !== false && options.isMergeableObject(value))\n\t\t? deepmerge(emptyTarget(value), value, options)\n\t\t: value\n}\n\nfunction defaultArrayMerge(target, source, options) {\n\treturn target.concat(source).map(function(element) {\n\t\treturn cloneUnlessOtherwiseSpecified(element, options)\n\t})\n}\n\nfunction getMergeFunction(key, options) {\n\tif (!options.customMerge) {\n\t\treturn deepmerge\n\t}\n\tvar customMerge = options.customMerge(key);\n\treturn typeof customMerge === 'function' ? customMerge : deepmerge\n}\n\nfunction getEnumerableOwnPropertySymbols(target) {\n\treturn Object.getOwnPropertySymbols\n\t\t? Object.getOwnPropertySymbols(target).filter(function(symbol) {\n\t\t\treturn target.propertyIsEnumerable(symbol)\n\t\t})\n\t\t: []\n}\n\nfunction getKeys(target) {\n\treturn Object.keys(target).concat(getEnumerableOwnPropertySymbols(target))\n}\n\nfunction propertyIsOnObject(object, property) {\n\ttry {\n\t\treturn property in object\n\t} catch(_) {\n\t\treturn false\n\t}\n}\n\n// Protects from prototype poisoning and unexpected merging up the prototype chain.\nfunction propertyIsUnsafe(target, key) {\n\treturn propertyIsOnObject(target, key) // Properties are safe to merge if they don't exist in the target yet,\n\t\t&& !(Object.hasOwnProperty.call(target, key) // unsafe if they exist up the prototype chain,\n\t\t\t&& Object.propertyIsEnumerable.call(target, key)) // and also unsafe if they're nonenumerable.\n}\n\nfunction mergeObject(target, source, options) {\n\tvar destination = {};\n\tif (options.isMergeableObject(target)) {\n\t\tgetKeys(target).forEach(function(key) {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(target[key], options);\n\t\t});\n\t}\n\tgetKeys(source).forEach(function(key) {\n\t\tif (propertyIsUnsafe(target, key)) {\n\t\t\treturn\n\t\t}\n\n\t\tif (!options.isMergeableObject(source[key]) || !propertyIsOnObject(target, key)) {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(source[key], options);\n\t\t} else {\n\t\t\tdestination[key] = getMergeFunction(key, options)(target[key], source[key], options);\n\t\t}\n\t});\n\treturn destination\n}\n\nfunction deepmerge(target, source, options) {\n\toptions = options || {};\n\toptions.arrayMerge = options.arrayMerge || defaultArrayMerge;\n\toptions.isMergeableObject = options.isMergeableObject || isMergeableObject;\n\t// cloneUnlessOtherwiseSpecified is added to `options` so that custom arrayMerge()\n\t// implementations can use it. The caller may not replace it.\n\toptions.cloneUnlessOtherwiseSpecified = cloneUnlessOtherwiseSpecified;\n\n\tvar sourceIsArray = Array.isArray(source);\n\tvar targetIsArray = Array.isArray(target);\n\tvar sourceAndTargetTypesMatch = sourceIsArray === targetIsArray;\n\n\tif (!sourceAndTargetTypesMatch) {\n\t\treturn cloneUnlessOtherwiseSpecified(source, options)\n\t} else if (sourceIsArray) {\n\t\treturn options.arrayMerge(target, source, options)\n\t} else {\n\t\treturn mergeObject(target, source, options)\n\t}\n}\n\ndeepmerge.all = function deepmergeAll(array, options) {\n\tif (!Array.isArray(array)) {\n\t\tthrow new Error('first argument should be an array')\n\t}\n\n\treturn array.reduce(function(prev, next) {\n\t\treturn deepmerge(prev, next, options)\n\t}, {})\n};\n\nvar deepmerge_1 = deepmerge;\n\nmodule.exports = deepmerge_1;\n","// Fine Uploader 5.16.2 - MIT licensed. http://fineuploader.com\n(function(global) {\n    var qq = function(element) {\n        \"use strict\";\n        return {\n            hide: function() {\n                element.style.display = \"none\";\n                return this;\n            },\n            attach: function(type, fn) {\n                if (element.addEventListener) {\n                    element.addEventListener(type, fn, false);\n                } else if (element.attachEvent) {\n                    element.attachEvent(\"on\" + type, fn);\n                }\n                return function() {\n                    qq(element).detach(type, fn);\n                };\n            },\n            detach: function(type, fn) {\n                if (element.removeEventListener) {\n                    element.removeEventListener(type, fn, false);\n                } else if (element.attachEvent) {\n                    element.detachEvent(\"on\" + type, fn);\n                }\n                return this;\n            },\n            contains: function(descendant) {\n                if (!descendant) {\n                    return false;\n                }\n                if (element === descendant) {\n                    return true;\n                }\n                if (element.contains) {\n                    return element.contains(descendant);\n                } else {\n                    return !!(descendant.compareDocumentPosition(element) & 8);\n                }\n            },\n            insertBefore: function(elementB) {\n                elementB.parentNode.insertBefore(element, elementB);\n                return this;\n            },\n            remove: function() {\n                element.parentNode.removeChild(element);\n                return this;\n            },\n            css: function(styles) {\n                if (element.style == null) {\n                    throw new qq.Error(\"Can't apply style to node as it is not on the HTMLElement prototype chain!\");\n                }\n                if (styles.opacity != null) {\n                    if (typeof element.style.opacity !== \"string\" && typeof element.filters !== \"undefined\") {\n                        styles.filter = \"alpha(opacity=\" + Math.round(100 * styles.opacity) + \")\";\n                    }\n                }\n                qq.extend(element.style, styles);\n                return this;\n            },\n            hasClass: function(name, considerParent) {\n                var re = new RegExp(\"(^| )\" + name + \"( |$)\");\n                return re.test(element.className) || !!(considerParent && re.test(element.parentNode.className));\n            },\n            addClass: function(name) {\n                if (!qq(element).hasClass(name)) {\n                    element.className += \" \" + name;\n                }\n                return this;\n            },\n            removeClass: function(name) {\n                var re = new RegExp(\"(^| )\" + name + \"( |$)\");\n                element.className = element.className.replace(re, \" \").replace(/^\\s+|\\s+$/g, \"\");\n                return this;\n            },\n            getByClass: function(className, first) {\n                var candidates, result = [];\n                if (first && element.querySelector) {\n                    return element.querySelector(\".\" + className);\n                } else if (element.querySelectorAll) {\n                    return element.querySelectorAll(\".\" + className);\n                }\n                candidates = element.getElementsByTagName(\"*\");\n                qq.each(candidates, function(idx, val) {\n                    if (qq(val).hasClass(className)) {\n                        result.push(val);\n                    }\n                });\n                return first ? result[0] : result;\n            },\n            getFirstByClass: function(className) {\n                return qq(element).getByClass(className, true);\n            },\n            children: function() {\n                var children = [], child = element.firstChild;\n                while (child) {\n                    if (child.nodeType === 1) {\n                        children.push(child);\n                    }\n                    child = child.nextSibling;\n                }\n                return children;\n            },\n            setText: function(text) {\n                element.innerText = text;\n                element.textContent = text;\n                return this;\n            },\n            clearText: function() {\n                return qq(element).setText(\"\");\n            },\n            hasAttribute: function(attrName) {\n                var attrVal;\n                if (element.hasAttribute) {\n                    if (!element.hasAttribute(attrName)) {\n                        return false;\n                    }\n                    return /^false$/i.exec(element.getAttribute(attrName)) == null;\n                } else {\n                    attrVal = element[attrName];\n                    if (attrVal === undefined) {\n                        return false;\n                    }\n                    return /^false$/i.exec(attrVal) == null;\n                }\n            }\n        };\n    };\n    (function() {\n        \"use strict\";\n        qq.canvasToBlob = function(canvas, mime, quality) {\n            return qq.dataUriToBlob(canvas.toDataURL(mime, quality));\n        };\n        qq.dataUriToBlob = function(dataUri) {\n            var arrayBuffer, byteString, createBlob = function(data, mime) {\n                var BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder, blobBuilder = BlobBuilder && new BlobBuilder();\n                if (blobBuilder) {\n                    blobBuilder.append(data);\n                    return blobBuilder.getBlob(mime);\n                } else {\n                    return new Blob([ data ], {\n                        type: mime\n                    });\n                }\n            }, intArray, mimeString;\n            if (dataUri.split(\",\")[0].indexOf(\"base64\") >= 0) {\n                byteString = atob(dataUri.split(\",\")[1]);\n            } else {\n                byteString = decodeURI(dataUri.split(\",\")[1]);\n            }\n            mimeString = dataUri.split(\",\")[0].split(\":\")[1].split(\";\")[0];\n            arrayBuffer = new ArrayBuffer(byteString.length);\n            intArray = new Uint8Array(arrayBuffer);\n            qq.each(byteString, function(idx, character) {\n                intArray[idx] = character.charCodeAt(0);\n            });\n            return createBlob(arrayBuffer, mimeString);\n        };\n        qq.log = function(message, level) {\n            if (window.console) {\n                if (!level || level === \"info\") {\n                    window.console.log(message);\n                } else {\n                    if (window.console[level]) {\n                        window.console[level](message);\n                    } else {\n                        window.console.log(\"<\" + level + \"> \" + message);\n                    }\n                }\n            }\n        };\n        qq.isObject = function(variable) {\n            return variable && !variable.nodeType && Object.prototype.toString.call(variable) === \"[object Object]\";\n        };\n        qq.isFunction = function(variable) {\n            return typeof variable === \"function\";\n        };\n        qq.isArray = function(value) {\n            return Object.prototype.toString.call(value) === \"[object Array]\" || value && window.ArrayBuffer && value.buffer && value.buffer.constructor === ArrayBuffer;\n        };\n        qq.isItemList = function(maybeItemList) {\n            return Object.prototype.toString.call(maybeItemList) === \"[object DataTransferItemList]\";\n        };\n        qq.isNodeList = function(maybeNodeList) {\n            return Object.prototype.toString.call(maybeNodeList) === \"[object NodeList]\" || maybeNodeList.item && maybeNodeList.namedItem;\n        };\n        qq.isString = function(maybeString) {\n            return Object.prototype.toString.call(maybeString) === \"[object String]\";\n        };\n        qq.trimStr = function(string) {\n            if (String.prototype.trim) {\n                return string.trim();\n            }\n            return string.replace(/^\\s+|\\s+$/g, \"\");\n        };\n        qq.format = function(str) {\n            var args = Array.prototype.slice.call(arguments, 1), newStr = str, nextIdxToReplace = newStr.indexOf(\"{}\");\n            qq.each(args, function(idx, val) {\n                var strBefore = newStr.substring(0, nextIdxToReplace), strAfter = newStr.substring(nextIdxToReplace + 2);\n                newStr = strBefore + val + strAfter;\n                nextIdxToReplace = newStr.indexOf(\"{}\", nextIdxToReplace + val.length);\n                if (nextIdxToReplace < 0) {\n                    return false;\n                }\n            });\n            return newStr;\n        };\n        qq.isFile = function(maybeFile) {\n            return window.File && Object.prototype.toString.call(maybeFile) === \"[object File]\";\n        };\n        qq.isFileList = function(maybeFileList) {\n            return window.FileList && Object.prototype.toString.call(maybeFileList) === \"[object FileList]\";\n        };\n        qq.isFileOrInput = function(maybeFileOrInput) {\n            return qq.isFile(maybeFileOrInput) || qq.isInput(maybeFileOrInput);\n        };\n        qq.isInput = function(maybeInput, notFile) {\n            var evaluateType = function(type) {\n                var normalizedType = type.toLowerCase();\n                if (notFile) {\n                    return normalizedType !== \"file\";\n                }\n                return normalizedType === \"file\";\n            };\n            if (window.HTMLInputElement) {\n                if (Object.prototype.toString.call(maybeInput) === \"[object HTMLInputElement]\") {\n                    if (maybeInput.type && evaluateType(maybeInput.type)) {\n                        return true;\n                    }\n                }\n            }\n            if (maybeInput.tagName) {\n                if (maybeInput.tagName.toLowerCase() === \"input\") {\n                    if (maybeInput.type && evaluateType(maybeInput.type)) {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        };\n        qq.isBlob = function(maybeBlob) {\n            if (window.Blob && Object.prototype.toString.call(maybeBlob) === \"[object Blob]\") {\n                return true;\n            }\n        };\n        qq.isXhrUploadSupported = function() {\n            var input = document.createElement(\"input\");\n            input.type = \"file\";\n            return input.multiple !== undefined && typeof File !== \"undefined\" && typeof FormData !== \"undefined\" && typeof qq.createXhrInstance().upload !== \"undefined\";\n        };\n        qq.createXhrInstance = function() {\n            if (window.XMLHttpRequest) {\n                return new XMLHttpRequest();\n            }\n            try {\n                return new ActiveXObject(\"MSXML2.XMLHTTP.3.0\");\n            } catch (error) {\n                qq.log(\"Neither XHR or ActiveX are supported!\", \"error\");\n                return null;\n            }\n        };\n        qq.isFolderDropSupported = function(dataTransfer) {\n            return dataTransfer.items && dataTransfer.items.length > 0 && dataTransfer.items[0].webkitGetAsEntry;\n        };\n        qq.isFileChunkingSupported = function() {\n            return !qq.androidStock() && qq.isXhrUploadSupported() && (File.prototype.slice !== undefined || File.prototype.webkitSlice !== undefined || File.prototype.mozSlice !== undefined);\n        };\n        qq.sliceBlob = function(fileOrBlob, start, end) {\n            var slicer = fileOrBlob.slice || fileOrBlob.mozSlice || fileOrBlob.webkitSlice;\n            return slicer.call(fileOrBlob, start, end);\n        };\n        qq.arrayBufferToHex = function(buffer) {\n            var bytesAsHex = \"\", bytes = new Uint8Array(buffer);\n            qq.each(bytes, function(idx, byt) {\n                var byteAsHexStr = byt.toString(16);\n                if (byteAsHexStr.length < 2) {\n                    byteAsHexStr = \"0\" + byteAsHexStr;\n                }\n                bytesAsHex += byteAsHexStr;\n            });\n            return bytesAsHex;\n        };\n        qq.readBlobToHex = function(blob, startOffset, length) {\n            var initialBlob = qq.sliceBlob(blob, startOffset, startOffset + length), fileReader = new FileReader(), promise = new qq.Promise();\n            fileReader.onload = function() {\n                promise.success(qq.arrayBufferToHex(fileReader.result));\n            };\n            fileReader.onerror = promise.failure;\n            fileReader.readAsArrayBuffer(initialBlob);\n            return promise;\n        };\n        qq.extend = function(first, second, extendNested) {\n            qq.each(second, function(prop, val) {\n                if (extendNested && qq.isObject(val)) {\n                    if (first[prop] === undefined) {\n                        first[prop] = {};\n                    }\n                    qq.extend(first[prop], val, true);\n                } else {\n                    first[prop] = val;\n                }\n            });\n            return first;\n        };\n        qq.override = function(target, sourceFn) {\n            var super_ = {}, source = sourceFn(super_);\n            qq.each(source, function(srcPropName, srcPropVal) {\n                if (target[srcPropName] !== undefined) {\n                    super_[srcPropName] = target[srcPropName];\n                }\n                target[srcPropName] = srcPropVal;\n            });\n            return target;\n        };\n        qq.indexOf = function(arr, elt, from) {\n            if (arr.indexOf) {\n                return arr.indexOf(elt, from);\n            }\n            from = from || 0;\n            var len = arr.length;\n            if (from < 0) {\n                from += len;\n            }\n            for (;from < len; from += 1) {\n                if (arr.hasOwnProperty(from) && arr[from] === elt) {\n                    return from;\n                }\n            }\n            return -1;\n        };\n        qq.getUniqueId = function() {\n            return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function(c) {\n                var r = Math.random() * 16 | 0, v = c == \"x\" ? r : r & 3 | 8;\n                return v.toString(16);\n            });\n        };\n        qq.ie = function() {\n            return navigator.userAgent.indexOf(\"MSIE\") !== -1 || navigator.userAgent.indexOf(\"Trident\") !== -1;\n        };\n        qq.ie7 = function() {\n            return navigator.userAgent.indexOf(\"MSIE 7\") !== -1;\n        };\n        qq.ie8 = function() {\n            return navigator.userAgent.indexOf(\"MSIE 8\") !== -1;\n        };\n        qq.ie10 = function() {\n            return navigator.userAgent.indexOf(\"MSIE 10\") !== -1;\n        };\n        qq.ie11 = function() {\n            return qq.ie() && navigator.userAgent.indexOf(\"rv:11\") !== -1;\n        };\n        qq.edge = function() {\n            return navigator.userAgent.indexOf(\"Edge\") >= 0;\n        };\n        qq.safari = function() {\n            return navigator.vendor !== undefined && navigator.vendor.indexOf(\"Apple\") !== -1;\n        };\n        qq.chrome = function() {\n            return navigator.vendor !== undefined && navigator.vendor.indexOf(\"Google\") !== -1;\n        };\n        qq.opera = function() {\n            return navigator.vendor !== undefined && navigator.vendor.indexOf(\"Opera\") !== -1;\n        };\n        qq.firefox = function() {\n            return !qq.edge() && !qq.ie11() && navigator.userAgent.indexOf(\"Mozilla\") !== -1 && navigator.vendor !== undefined && navigator.vendor === \"\";\n        };\n        qq.windows = function() {\n            return navigator.platform === \"Win32\";\n        };\n        qq.android = function() {\n            return navigator.userAgent.toLowerCase().indexOf(\"android\") !== -1;\n        };\n        qq.androidStock = function() {\n            return qq.android() && navigator.userAgent.toLowerCase().indexOf(\"chrome\") < 0 && navigator.userAgent.toLowerCase().indexOf(\"firefox\") < 0;\n        };\n        qq.ios6 = function() {\n            return qq.ios() && navigator.userAgent.indexOf(\" OS 6_\") !== -1;\n        };\n        qq.ios7 = function() {\n            return qq.ios() && navigator.userAgent.indexOf(\" OS 7_\") !== -1;\n        };\n        qq.ios8 = function() {\n            return qq.ios() && navigator.userAgent.indexOf(\" OS 8_\") !== -1;\n        };\n        qq.ios800 = function() {\n            return qq.ios() && navigator.userAgent.indexOf(\" OS 8_0 \") !== -1;\n        };\n        qq.ios = function() {\n            return navigator.userAgent.indexOf(\"iPad\") !== -1 || navigator.userAgent.indexOf(\"iPod\") !== -1 || navigator.userAgent.indexOf(\"iPhone\") !== -1;\n        };\n        qq.iosChrome = function() {\n            return qq.ios() && navigator.userAgent.indexOf(\"CriOS\") !== -1;\n        };\n        qq.iosSafari = function() {\n            return qq.ios() && !qq.iosChrome() && navigator.userAgent.indexOf(\"Safari\") !== -1;\n        };\n        qq.iosSafariWebView = function() {\n            return qq.ios() && !qq.iosChrome() && !qq.iosSafari();\n        };\n        qq.preventDefault = function(e) {\n            if (e.preventDefault) {\n                e.preventDefault();\n            } else {\n                e.returnValue = false;\n            }\n        };\n        qq.toElement = function() {\n            var div = document.createElement(\"div\");\n            return function(html) {\n                div.innerHTML = html;\n                var element = div.firstChild;\n                div.removeChild(element);\n                return element;\n            };\n        }();\n        qq.each = function(iterableItem, callback) {\n            var keyOrIndex, retVal;\n            if (iterableItem) {\n                if (window.Storage && iterableItem.constructor === window.Storage) {\n                    for (keyOrIndex = 0; keyOrIndex < iterableItem.length; keyOrIndex++) {\n                        retVal = callback(iterableItem.key(keyOrIndex), iterableItem.getItem(iterableItem.key(keyOrIndex)));\n                        if (retVal === false) {\n                            break;\n                        }\n                    }\n                } else if (qq.isArray(iterableItem) || qq.isItemList(iterableItem) || qq.isNodeList(iterableItem)) {\n                    for (keyOrIndex = 0; keyOrIndex < iterableItem.length; keyOrIndex++) {\n                        retVal = callback(keyOrIndex, iterableItem[keyOrIndex]);\n                        if (retVal === false) {\n                            break;\n                        }\n                    }\n                } else if (qq.isString(iterableItem)) {\n                    for (keyOrIndex = 0; keyOrIndex < iterableItem.length; keyOrIndex++) {\n                        retVal = callback(keyOrIndex, iterableItem.charAt(keyOrIndex));\n                        if (retVal === false) {\n                            break;\n                        }\n                    }\n                } else {\n                    for (keyOrIndex in iterableItem) {\n                        if (Object.prototype.hasOwnProperty.call(iterableItem, keyOrIndex)) {\n                            retVal = callback(keyOrIndex, iterableItem[keyOrIndex]);\n                            if (retVal === false) {\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n        };\n        qq.bind = function(oldFunc, context) {\n            if (qq.isFunction(oldFunc)) {\n                var args = Array.prototype.slice.call(arguments, 2);\n                return function() {\n                    var newArgs = qq.extend([], args);\n                    if (arguments.length) {\n                        newArgs = newArgs.concat(Array.prototype.slice.call(arguments));\n                    }\n                    return oldFunc.apply(context, newArgs);\n                };\n            }\n            throw new Error(\"first parameter must be a function!\");\n        };\n        qq.obj2url = function(obj, temp, prefixDone) {\n            var uristrings = [], prefix = \"&\", add = function(nextObj, i) {\n                var nextTemp = temp ? /\\[\\]$/.test(temp) ? temp : temp + \"[\" + i + \"]\" : i;\n                if (nextTemp !== \"undefined\" && i !== \"undefined\") {\n                    uristrings.push(typeof nextObj === \"object\" ? qq.obj2url(nextObj, nextTemp, true) : Object.prototype.toString.call(nextObj) === \"[object Function]\" ? encodeURIComponent(nextTemp) + \"=\" + encodeURIComponent(nextObj()) : encodeURIComponent(nextTemp) + \"=\" + encodeURIComponent(nextObj));\n                }\n            };\n            if (!prefixDone && temp) {\n                prefix = /\\?/.test(temp) ? /\\?$/.test(temp) ? \"\" : \"&\" : \"?\";\n                uristrings.push(temp);\n                uristrings.push(qq.obj2url(obj));\n            } else if (Object.prototype.toString.call(obj) === \"[object Array]\" && typeof obj !== \"undefined\") {\n                qq.each(obj, function(idx, val) {\n                    add(val, idx);\n                });\n            } else if (typeof obj !== \"undefined\" && obj !== null && typeof obj === \"object\") {\n                qq.each(obj, function(prop, val) {\n                    add(val, prop);\n                });\n            } else {\n                uristrings.push(encodeURIComponent(temp) + \"=\" + encodeURIComponent(obj));\n            }\n            if (temp) {\n                return uristrings.join(prefix);\n            } else {\n                return uristrings.join(prefix).replace(/^&/, \"\").replace(/%20/g, \"+\");\n            }\n        };\n        qq.obj2FormData = function(obj, formData, arrayKeyName) {\n            if (!formData) {\n                formData = new FormData();\n            }\n            qq.each(obj, function(key, val) {\n                key = arrayKeyName ? arrayKeyName + \"[\" + key + \"]\" : key;\n                if (qq.isObject(val)) {\n                    qq.obj2FormData(val, formData, key);\n                } else if (qq.isFunction(val)) {\n                    formData.append(key, val());\n                } else {\n                    formData.append(key, val);\n                }\n            });\n            return formData;\n        };\n        qq.obj2Inputs = function(obj, form) {\n            var input;\n            if (!form) {\n                form = document.createElement(\"form\");\n            }\n            qq.obj2FormData(obj, {\n                append: function(key, val) {\n                    input = document.createElement(\"input\");\n                    input.setAttribute(\"name\", key);\n                    input.setAttribute(\"value\", val);\n                    form.appendChild(input);\n                }\n            });\n            return form;\n        };\n        qq.parseJson = function(json) {\n            if (window.JSON && qq.isFunction(JSON.parse)) {\n                return JSON.parse(json);\n            } else {\n                return eval(\"(\" + json + \")\");\n            }\n        };\n        qq.getExtension = function(filename) {\n            var extIdx = filename.lastIndexOf(\".\") + 1;\n            if (extIdx > 0) {\n                return filename.substr(extIdx, filename.length - extIdx);\n            }\n        };\n        qq.getFilename = function(blobOrFileInput) {\n            if (qq.isInput(blobOrFileInput)) {\n                return blobOrFileInput.value.replace(/.*(\\/|\\\\)/, \"\");\n            } else if (qq.isFile(blobOrFileInput)) {\n                if (blobOrFileInput.fileName !== null && blobOrFileInput.fileName !== undefined) {\n                    return blobOrFileInput.fileName;\n                }\n            }\n            return blobOrFileInput.name;\n        };\n        qq.DisposeSupport = function() {\n            var disposers = [];\n            return {\n                dispose: function() {\n                    var disposer;\n                    do {\n                        disposer = disposers.shift();\n                        if (disposer) {\n                            disposer();\n                        }\n                    } while (disposer);\n                },\n                attach: function() {\n                    var args = arguments;\n                    this.addDisposer(qq(args[0]).attach.apply(this, Array.prototype.slice.call(arguments, 1)));\n                },\n                addDisposer: function(disposeFunction) {\n                    disposers.push(disposeFunction);\n                }\n            };\n        };\n    })();\n    (function() {\n        \"use strict\";\n        if (typeof define === \"function\" && define.amd) {\n            define(function() {\n                return qq;\n            });\n        } else if (typeof module !== \"undefined\" && module.exports) {\n            module.exports = qq;\n        } else {\n            global.qq = qq;\n        }\n    })();\n    (function() {\n        \"use strict\";\n        qq.Error = function(message) {\n            this.message = \"[Fine Uploader \" + qq.version + \"] \" + message;\n        };\n        qq.Error.prototype = new Error();\n    })();\n    qq.version = \"6.0.3\";\n    qq.supportedFeatures = function() {\n        \"use strict\";\n        var supportsUploading, supportsUploadingBlobs, supportsFileDrop, supportsAjaxFileUploading, supportsFolderDrop, supportsChunking, supportsResume, supportsUploadViaPaste, supportsUploadCors, supportsDeleteFileXdr, supportsDeleteFileCorsXhr, supportsDeleteFileCors, supportsFolderSelection, supportsImagePreviews, supportsUploadProgress;\n        function testSupportsFileInputElement() {\n            var supported = true, tempInput;\n            try {\n                tempInput = document.createElement(\"input\");\n                tempInput.type = \"file\";\n                qq(tempInput).hide();\n                if (tempInput.disabled) {\n                    supported = false;\n                }\n            } catch (ex) {\n                supported = false;\n            }\n            return supported;\n        }\n        function isChrome14OrHigher() {\n            return (qq.chrome() || qq.opera()) && navigator.userAgent.match(/Chrome\\/[1][4-9]|Chrome\\/[2-9][0-9]/) !== undefined;\n        }\n        function isCrossOriginXhrSupported() {\n            if (window.XMLHttpRequest) {\n                var xhr = qq.createXhrInstance();\n                return xhr.withCredentials !== undefined;\n            }\n            return false;\n        }\n        function isXdrSupported() {\n            return window.XDomainRequest !== undefined;\n        }\n        function isCrossOriginAjaxSupported() {\n            if (isCrossOriginXhrSupported()) {\n                return true;\n            }\n            return isXdrSupported();\n        }\n        function isFolderSelectionSupported() {\n            return document.createElement(\"input\").webkitdirectory !== undefined;\n        }\n        function isLocalStorageSupported() {\n            try {\n                return !!window.localStorage && qq.isFunction(window.localStorage.setItem);\n            } catch (error) {\n                return false;\n            }\n        }\n        function isDragAndDropSupported() {\n            var span = document.createElement(\"span\");\n            return (\"draggable\" in span || \"ondragstart\" in span && \"ondrop\" in span) && !qq.android() && !qq.ios();\n        }\n        supportsUploading = testSupportsFileInputElement();\n        supportsAjaxFileUploading = supportsUploading && qq.isXhrUploadSupported();\n        supportsUploadingBlobs = supportsAjaxFileUploading && !qq.androidStock();\n        supportsFileDrop = supportsAjaxFileUploading && isDragAndDropSupported();\n        supportsFolderDrop = supportsFileDrop && function() {\n            var input = document.createElement(\"input\");\n            input.type = \"file\";\n            return !!(\"webkitdirectory\" in (input || document.querySelectorAll(\"input[type=file]\")[0]));\n        }();\n        supportsChunking = supportsAjaxFileUploading && qq.isFileChunkingSupported();\n        supportsResume = supportsAjaxFileUploading && supportsChunking && isLocalStorageSupported();\n        supportsUploadViaPaste = supportsAjaxFileUploading && isChrome14OrHigher();\n        supportsUploadCors = supportsUploading && (window.postMessage !== undefined || supportsAjaxFileUploading);\n        supportsDeleteFileCorsXhr = isCrossOriginXhrSupported();\n        supportsDeleteFileXdr = isXdrSupported();\n        supportsDeleteFileCors = isCrossOriginAjaxSupported();\n        supportsFolderSelection = isFolderSelectionSupported();\n        supportsImagePreviews = supportsAjaxFileUploading && window.FileReader !== undefined;\n        supportsUploadProgress = function() {\n            if (supportsAjaxFileUploading) {\n                return !qq.androidStock() && !qq.iosChrome();\n            }\n            return false;\n        }();\n        return {\n            ajaxUploading: supportsAjaxFileUploading,\n            blobUploading: supportsUploadingBlobs,\n            canDetermineSize: supportsAjaxFileUploading,\n            chunking: supportsChunking,\n            deleteFileCors: supportsDeleteFileCors,\n            deleteFileCorsXdr: supportsDeleteFileXdr,\n            deleteFileCorsXhr: supportsDeleteFileCorsXhr,\n            dialogElement: !!window.HTMLDialogElement,\n            fileDrop: supportsFileDrop,\n            folderDrop: supportsFolderDrop,\n            folderSelection: supportsFolderSelection,\n            imagePreviews: supportsImagePreviews,\n            imageValidation: supportsImagePreviews,\n            itemSizeValidation: supportsAjaxFileUploading,\n            pause: supportsChunking,\n            progressBar: supportsUploadProgress,\n            resume: supportsResume,\n            scaling: supportsImagePreviews && supportsUploadingBlobs,\n            tiffPreviews: qq.safari(),\n            unlimitedScaledImageSize: !qq.ios(),\n            uploading: supportsUploading,\n            uploadCors: supportsUploadCors,\n            uploadCustomHeaders: supportsAjaxFileUploading,\n            uploadNonMultipart: supportsAjaxFileUploading,\n            uploadViaPaste: supportsUploadViaPaste\n        };\n    }();\n    qq.isGenericPromise = function(maybePromise) {\n        \"use strict\";\n        return !!(maybePromise && maybePromise.then && qq.isFunction(maybePromise.then));\n    };\n    qq.Promise = function() {\n        \"use strict\";\n        var successArgs, failureArgs, successCallbacks = [], failureCallbacks = [], doneCallbacks = [], state = 0;\n        qq.extend(this, {\n            then: function(onSuccess, onFailure) {\n                if (state === 0) {\n                    if (onSuccess) {\n                        successCallbacks.push(onSuccess);\n                    }\n                    if (onFailure) {\n                        failureCallbacks.push(onFailure);\n                    }\n                } else if (state === -1) {\n                    onFailure && onFailure.apply(null, failureArgs);\n                } else if (onSuccess) {\n                    onSuccess.apply(null, successArgs);\n                }\n                return this;\n            },\n            done: function(callback) {\n                if (state === 0) {\n                    doneCallbacks.push(callback);\n                } else {\n                    callback.apply(null, failureArgs === undefined ? successArgs : failureArgs);\n                }\n                return this;\n            },\n            success: function() {\n                state = 1;\n                successArgs = arguments;\n                if (successCallbacks.length) {\n                    qq.each(successCallbacks, function(idx, callback) {\n                        callback.apply(null, successArgs);\n                    });\n                }\n                if (doneCallbacks.length) {\n                    qq.each(doneCallbacks, function(idx, callback) {\n                        callback.apply(null, successArgs);\n                    });\n                }\n                return this;\n            },\n            failure: function() {\n                state = -1;\n                failureArgs = arguments;\n                if (failureCallbacks.length) {\n                    qq.each(failureCallbacks, function(idx, callback) {\n                        callback.apply(null, failureArgs);\n                    });\n                }\n                if (doneCallbacks.length) {\n                    qq.each(doneCallbacks, function(idx, callback) {\n                        callback.apply(null, failureArgs);\n                    });\n                }\n                return this;\n            }\n        });\n    };\n    qq.BlobProxy = function(referenceBlob, onCreate) {\n        \"use strict\";\n        qq.extend(this, {\n            referenceBlob: referenceBlob,\n            create: function() {\n                return onCreate(referenceBlob);\n            }\n        });\n    };\n    qq.UploadButton = function(o) {\n        \"use strict\";\n        var self = this, disposeSupport = new qq.DisposeSupport(), options = {\n            acceptFiles: null,\n            element: null,\n            focusClass: \"qq-upload-button-focus\",\n            folders: false,\n            hoverClass: \"qq-upload-button-hover\",\n            ios8BrowserCrashWorkaround: false,\n            multiple: false,\n            name: \"qqfile\",\n            onChange: function(input) {},\n            title: null\n        }, input, buttonId;\n        qq.extend(options, o);\n        buttonId = qq.getUniqueId();\n        function createInput() {\n            var input = document.createElement(\"input\");\n            input.setAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME, buttonId);\n            input.setAttribute(\"title\", options.title);\n            self.setMultiple(options.multiple, input);\n            if (options.folders && qq.supportedFeatures.folderSelection) {\n                input.setAttribute(\"webkitdirectory\", \"\");\n            }\n            if (options.acceptFiles) {\n                input.setAttribute(\"accept\", options.acceptFiles);\n            }\n            input.setAttribute(\"type\", \"file\");\n            input.setAttribute(\"name\", options.name);\n            qq(input).css({\n                position: \"absolute\",\n                right: 0,\n                top: 0,\n                fontFamily: \"Arial\",\n                fontSize: qq.ie() && !qq.ie8() ? \"3500px\" : \"118px\",\n                margin: 0,\n                padding: 0,\n                cursor: \"pointer\",\n                opacity: 0\n            });\n            !qq.ie7() && qq(input).css({\n                height: \"100%\"\n            });\n            options.element.appendChild(input);\n            disposeSupport.attach(input, \"change\", function() {\n                options.onChange(input);\n            });\n            disposeSupport.attach(input, \"mouseover\", function() {\n                qq(options.element).addClass(options.hoverClass);\n            });\n            disposeSupport.attach(input, \"mouseout\", function() {\n                qq(options.element).removeClass(options.hoverClass);\n            });\n            disposeSupport.attach(input, \"focus\", function() {\n                qq(options.element).addClass(options.focusClass);\n            });\n            disposeSupport.attach(input, \"blur\", function() {\n                qq(options.element).removeClass(options.focusClass);\n            });\n            return input;\n        }\n        qq(options.element).css({\n            position: \"relative\",\n            overflow: \"hidden\",\n            direction: \"ltr\"\n        });\n        qq.extend(this, {\n            getInput: function() {\n                return input;\n            },\n            getButtonId: function() {\n                return buttonId;\n            },\n            setMultiple: function(isMultiple, optInput) {\n                var input = optInput || this.getInput();\n                if (options.ios8BrowserCrashWorkaround && qq.ios8() && (qq.iosChrome() || qq.iosSafariWebView())) {\n                    input.setAttribute(\"multiple\", \"\");\n                } else {\n                    if (isMultiple) {\n                        input.setAttribute(\"multiple\", \"\");\n                    } else {\n                        input.removeAttribute(\"multiple\");\n                    }\n                }\n            },\n            setAcceptFiles: function(acceptFiles) {\n                if (acceptFiles !== options.acceptFiles) {\n                    input.setAttribute(\"accept\", acceptFiles);\n                }\n            },\n            reset: function() {\n                if (input.parentNode) {\n                    qq(input).remove();\n                }\n                qq(options.element).removeClass(options.focusClass);\n                input = null;\n                input = createInput();\n            }\n        });\n        input = createInput();\n    };\n    qq.UploadButton.BUTTON_ID_ATTR_NAME = \"qq-button-id\";\n    qq.UploadData = function(uploaderProxy) {\n        \"use strict\";\n        var data = [], byUuid = {}, byStatus = {}, byProxyGroupId = {}, byBatchId = {};\n        function getDataByIds(idOrIds) {\n            if (qq.isArray(idOrIds)) {\n                var entries = [];\n                qq.each(idOrIds, function(idx, id) {\n                    entries.push(data[id]);\n                });\n                return entries;\n            }\n            return data[idOrIds];\n        }\n        function getDataByUuids(uuids) {\n            if (qq.isArray(uuids)) {\n                var entries = [];\n                qq.each(uuids, function(idx, uuid) {\n                    entries.push(data[byUuid[uuid]]);\n                });\n                return entries;\n            }\n            return data[byUuid[uuids]];\n        }\n        function getDataByStatus(status) {\n            var statusResults = [], statuses = [].concat(status);\n            qq.each(statuses, function(index, statusEnum) {\n                var statusResultIndexes = byStatus[statusEnum];\n                if (statusResultIndexes !== undefined) {\n                    qq.each(statusResultIndexes, function(i, dataIndex) {\n                        statusResults.push(data[dataIndex]);\n                    });\n                }\n            });\n            return statusResults;\n        }\n        qq.extend(this, {\n            addFile: function(spec) {\n                var status = spec.status || qq.status.SUBMITTING, id = data.push({\n                    name: spec.name,\n                    originalName: spec.name,\n                    uuid: spec.uuid,\n                    size: spec.size == null ? -1 : spec.size,\n                    status: status,\n                    file: spec.file\n                }) - 1;\n                if (spec.batchId) {\n                    data[id].batchId = spec.batchId;\n                    if (byBatchId[spec.batchId] === undefined) {\n                        byBatchId[spec.batchId] = [];\n                    }\n                    byBatchId[spec.batchId].push(id);\n                }\n                if (spec.proxyGroupId) {\n                    data[id].proxyGroupId = spec.proxyGroupId;\n                    if (byProxyGroupId[spec.proxyGroupId] === undefined) {\n                        byProxyGroupId[spec.proxyGroupId] = [];\n                    }\n                    byProxyGroupId[spec.proxyGroupId].push(id);\n                }\n                data[id].id = id;\n                byUuid[spec.uuid] = id;\n                if (byStatus[status] === undefined) {\n                    byStatus[status] = [];\n                }\n                byStatus[status].push(id);\n                spec.onBeforeStatusChange && spec.onBeforeStatusChange(id);\n                uploaderProxy.onStatusChange(id, null, status);\n                return id;\n            },\n            retrieve: function(optionalFilter) {\n                if (qq.isObject(optionalFilter) && data.length) {\n                    if (optionalFilter.id !== undefined) {\n                        return getDataByIds(optionalFilter.id);\n                    } else if (optionalFilter.uuid !== undefined) {\n                        return getDataByUuids(optionalFilter.uuid);\n                    } else if (optionalFilter.status) {\n                        return getDataByStatus(optionalFilter.status);\n                    }\n                } else {\n                    return qq.extend([], data, true);\n                }\n            },\n            removeFileRef: function(id) {\n                var record = getDataByIds(id);\n                if (record) {\n                    delete record.file;\n                }\n            },\n            reset: function() {\n                data = [];\n                byUuid = {};\n                byStatus = {};\n                byBatchId = {};\n            },\n            setStatus: function(id, newStatus) {\n                var oldStatus = data[id].status, byStatusOldStatusIndex = qq.indexOf(byStatus[oldStatus], id);\n                byStatus[oldStatus].splice(byStatusOldStatusIndex, 1);\n                data[id].status = newStatus;\n                if (byStatus[newStatus] === undefined) {\n                    byStatus[newStatus] = [];\n                }\n                byStatus[newStatus].push(id);\n                uploaderProxy.onStatusChange(id, oldStatus, newStatus);\n            },\n            uuidChanged: function(id, newUuid) {\n                var oldUuid = data[id].uuid;\n                data[id].uuid = newUuid;\n                byUuid[newUuid] = id;\n                delete byUuid[oldUuid];\n            },\n            updateName: function(id, newName) {\n                data[id].name = newName;\n            },\n            updateSize: function(id, newSize) {\n                data[id].size = newSize;\n            },\n            setParentId: function(targetId, parentId) {\n                data[targetId].parentId = parentId;\n            },\n            getIdsInProxyGroup: function(id) {\n                var proxyGroupId = data[id].proxyGroupId;\n                if (proxyGroupId) {\n                    return byProxyGroupId[proxyGroupId];\n                }\n                return [];\n            },\n            getIdsInBatch: function(id) {\n                var batchId = data[id].batchId;\n                return byBatchId[batchId];\n            }\n        });\n    };\n    qq.status = {\n        SUBMITTING: \"submitting\",\n        SUBMITTED: \"submitted\",\n        REJECTED: \"rejected\",\n        QUEUED: \"queued\",\n        CANCELED: \"canceled\",\n        PAUSED: \"paused\",\n        UPLOADING: \"uploading\",\n        UPLOAD_FINALIZING: \"upload finalizing\",\n        UPLOAD_RETRYING: \"retrying upload\",\n        UPLOAD_SUCCESSFUL: \"upload successful\",\n        UPLOAD_FAILED: \"upload failed\",\n        DELETE_FAILED: \"delete failed\",\n        DELETING: \"deleting\",\n        DELETED: \"deleted\"\n    };\n    (function() {\n        \"use strict\";\n        qq.basePublicApi = {\n            addBlobs: function(blobDataOrArray, params, endpoint) {\n                this.addFiles(blobDataOrArray, params, endpoint);\n            },\n            addInitialFiles: function(cannedFileList) {\n                var self = this;\n                qq.each(cannedFileList, function(index, cannedFile) {\n                    self._addCannedFile(cannedFile);\n                });\n            },\n            addFiles: function(data, params, endpoint) {\n                this._maybeHandleIos8SafariWorkaround();\n                var batchId = this._storedIds.length === 0 ? qq.getUniqueId() : this._currentBatchId, processBlob = qq.bind(function(blob) {\n                    this._handleNewFile({\n                        blob: blob,\n                        name: this._options.blobs.defaultName\n                    }, batchId, verifiedFiles);\n                }, this), processBlobData = qq.bind(function(blobData) {\n                    this._handleNewFile(blobData, batchId, verifiedFiles);\n                }, this), processCanvas = qq.bind(function(canvas) {\n                    var blob = qq.canvasToBlob(canvas);\n                    this._handleNewFile({\n                        blob: blob,\n                        name: this._options.blobs.defaultName + \".png\"\n                    }, batchId, verifiedFiles);\n                }, this), processCanvasData = qq.bind(function(canvasData) {\n                    var normalizedQuality = canvasData.quality && canvasData.quality / 100, blob = qq.canvasToBlob(canvasData.canvas, canvasData.type, normalizedQuality);\n                    this._handleNewFile({\n                        blob: blob,\n                        name: canvasData.name\n                    }, batchId, verifiedFiles);\n                }, this), processFileOrInput = qq.bind(function(fileOrInput) {\n                    if (qq.isInput(fileOrInput) && qq.supportedFeatures.ajaxUploading) {\n                        var files = Array.prototype.slice.call(fileOrInput.files), self = this;\n                        qq.each(files, function(idx, file) {\n                            self._handleNewFile(file, batchId, verifiedFiles);\n                        });\n                    } else {\n                        this._handleNewFile(fileOrInput, batchId, verifiedFiles);\n                    }\n                }, this), normalizeData = function() {\n                    if (qq.isFileList(data)) {\n                        data = Array.prototype.slice.call(data);\n                    }\n                    data = [].concat(data);\n                }, self = this, verifiedFiles = [];\n                this._currentBatchId = batchId;\n                if (data) {\n                    normalizeData();\n                    qq.each(data, function(idx, fileContainer) {\n                        if (qq.isFileOrInput(fileContainer)) {\n                            processFileOrInput(fileContainer);\n                        } else if (qq.isBlob(fileContainer)) {\n                            processBlob(fileContainer);\n                        } else if (qq.isObject(fileContainer)) {\n                            if (fileContainer.blob && fileContainer.name) {\n                                processBlobData(fileContainer);\n                            } else if (fileContainer.canvas && fileContainer.name) {\n                                processCanvasData(fileContainer);\n                            }\n                        } else if (fileContainer.tagName && fileContainer.tagName.toLowerCase() === \"canvas\") {\n                            processCanvas(fileContainer);\n                        } else {\n                            self.log(fileContainer + \" is not a valid file container!  Ignoring!\", \"warn\");\n                        }\n                    });\n                    this.log(\"Received \" + verifiedFiles.length + \" files.\");\n                    this._prepareItemsForUpload(verifiedFiles, params, endpoint);\n                }\n            },\n            cancel: function(id) {\n                var uploadData = this._uploadData.retrieve({\n                    id: id\n                });\n                if (uploadData && uploadData.status === qq.status.UPLOAD_FINALIZING) {\n                    this.log(qq.format(\"Ignoring cancel for file ID {} ({}).  Finalizing upload.\", id, this.getName(id)), \"error\");\n                } else {\n                    this._handler.cancel(id);\n                }\n            },\n            cancelAll: function() {\n                var storedIdsCopy = [], self = this;\n                qq.extend(storedIdsCopy, this._storedIds);\n                qq.each(storedIdsCopy, function(idx, storedFileId) {\n                    self.cancel(storedFileId);\n                });\n                this._handler.cancelAll();\n            },\n            clearStoredFiles: function() {\n                this._storedIds = [];\n            },\n            continueUpload: function(id) {\n                var uploadData = this._uploadData.retrieve({\n                    id: id\n                });\n                if (!qq.supportedFeatures.pause || !this._options.chunking.enabled) {\n                    return false;\n                }\n                if (uploadData.status === qq.status.PAUSED) {\n                    this.log(qq.format(\"Paused file ID {} ({}) will be continued.  Not paused.\", id, this.getName(id)));\n                    this._uploadFile(id);\n                    return true;\n                } else {\n                    this.log(qq.format(\"Ignoring continue for file ID {} ({}).  Not paused.\", id, this.getName(id)), \"error\");\n                }\n                return false;\n            },\n            deleteFile: function(id) {\n                return this._onSubmitDelete(id);\n            },\n            doesExist: function(fileOrBlobId) {\n                return this._handler.isValid(fileOrBlobId);\n            },\n            drawThumbnail: function(fileId, imgOrCanvas, maxSize, fromServer, customResizeFunction) {\n                var promiseToReturn = new qq.Promise(), fileOrUrl, options;\n                if (this._imageGenerator) {\n                    fileOrUrl = this._thumbnailUrls[fileId];\n                    options = {\n                        customResizeFunction: customResizeFunction,\n                        maxSize: maxSize > 0 ? maxSize : null,\n                        scale: maxSize > 0\n                    };\n                    if (!fromServer && qq.supportedFeatures.imagePreviews) {\n                        fileOrUrl = this.getFile(fileId);\n                    }\n                    if (fileOrUrl == null) {\n                        promiseToReturn.failure({\n                            container: imgOrCanvas,\n                            error: \"File or URL not found.\"\n                        });\n                    } else {\n                        this._imageGenerator.generate(fileOrUrl, imgOrCanvas, options).then(function success(modifiedContainer) {\n                            promiseToReturn.success(modifiedContainer);\n                        }, function failure(container, reason) {\n                            promiseToReturn.failure({\n                                container: container,\n                                error: reason || \"Problem generating thumbnail\"\n                            });\n                        });\n                    }\n                } else {\n                    promiseToReturn.failure({\n                        container: imgOrCanvas,\n                        error: \"Missing image generator module\"\n                    });\n                }\n                return promiseToReturn;\n            },\n            getButton: function(fileId) {\n                return this._getButton(this._buttonIdsForFileIds[fileId]);\n            },\n            getEndpoint: function(fileId) {\n                return this._endpointStore.get(fileId);\n            },\n            getFile: function(fileOrBlobId) {\n                var file = this._handler.getFile(fileOrBlobId);\n                var uploadDataRecord;\n                if (!file) {\n                    uploadDataRecord = this._uploadData.retrieve({\n                        id: fileOrBlobId\n                    });\n                    if (uploadDataRecord) {\n                        file = uploadDataRecord.file;\n                    }\n                }\n                return file || null;\n            },\n            getInProgress: function() {\n                return this._uploadData.retrieve({\n                    status: [ qq.status.UPLOADING, qq.status.UPLOAD_RETRYING, qq.status.QUEUED ]\n                }).length;\n            },\n            getName: function(id) {\n                return this._uploadData.retrieve({\n                    id: id\n                }).name;\n            },\n            getParentId: function(id) {\n                var uploadDataEntry = this.getUploads({\n                    id: id\n                }), parentId = null;\n                if (uploadDataEntry) {\n                    if (uploadDataEntry.parentId !== undefined) {\n                        parentId = uploadDataEntry.parentId;\n                    }\n                }\n                return parentId;\n            },\n            getResumableFilesData: function() {\n                return this._handler.getResumableFilesData();\n            },\n            getSize: function(id) {\n                return this._uploadData.retrieve({\n                    id: id\n                }).size;\n            },\n            getNetUploads: function() {\n                return this._netUploaded;\n            },\n            getRemainingAllowedItems: function() {\n                var allowedItems = this._currentItemLimit;\n                if (allowedItems > 0) {\n                    return allowedItems - this._netUploadedOrQueued;\n                }\n                return null;\n            },\n            getUploads: function(optionalFilter) {\n                return this._uploadData.retrieve(optionalFilter);\n            },\n            getUuid: function(id) {\n                return this._uploadData.retrieve({\n                    id: id\n                }).uuid;\n            },\n            isResumable: function(id) {\n                return this._handler.hasResumeRecord(id);\n            },\n            log: function(str, level) {\n                if (this._options.debug && (!level || level === \"info\")) {\n                    qq.log(\"[Fine Uploader \" + qq.version + \"] \" + str);\n                } else if (level && level !== \"info\") {\n                    qq.log(\"[Fine Uploader \" + qq.version + \"] \" + str, level);\n                }\n            },\n            pauseUpload: function(id) {\n                var uploadData = this._uploadData.retrieve({\n                    id: id\n                });\n                if (!qq.supportedFeatures.pause || !this._options.chunking.enabled) {\n                    return false;\n                }\n                if (qq.indexOf([ qq.status.UPLOADING, qq.status.UPLOAD_RETRYING ], uploadData.status) >= 0) {\n                    if (this._handler.pause(id)) {\n                        this._uploadData.setStatus(id, qq.status.PAUSED);\n                        return true;\n                    } else {\n                        this.log(qq.format(\"Unable to pause file ID {} ({}).\", id, this.getName(id)), \"error\");\n                    }\n                } else {\n                    this.log(qq.format(\"Ignoring pause for file ID {} ({}).  Not in progress.\", id, this.getName(id)), \"error\");\n                }\n                return false;\n            },\n            removeFileRef: function(id) {\n                this._handler.expunge(id);\n                this._uploadData.removeFileRef(id);\n            },\n            reset: function() {\n                this.log(\"Resetting uploader...\");\n                this._handler.reset();\n                this._storedIds = [];\n                this._autoRetries = [];\n                this._retryTimeouts = [];\n                this._preventRetries = [];\n                this._thumbnailUrls = [];\n                qq.each(this._buttons, function(idx, button) {\n                    button.reset();\n                });\n                this._paramsStore.reset();\n                this._endpointStore.reset();\n                this._netUploadedOrQueued = 0;\n                this._netUploaded = 0;\n                this._uploadData.reset();\n                this._buttonIdsForFileIds = [];\n                this._pasteHandler && this._pasteHandler.reset();\n                this._options.session.refreshOnReset && this._refreshSessionData();\n                this._succeededSinceLastAllComplete = [];\n                this._failedSinceLastAllComplete = [];\n                this._totalProgress && this._totalProgress.reset();\n                this._customResumeDataStore.reset();\n            },\n            retry: function(id) {\n                return this._manualRetry(id);\n            },\n            scaleImage: function(id, specs) {\n                var self = this;\n                return qq.Scaler.prototype.scaleImage(id, specs, {\n                    log: qq.bind(self.log, self),\n                    getFile: qq.bind(self.getFile, self),\n                    uploadData: self._uploadData\n                });\n            },\n            setCustomHeaders: function(headers, id) {\n                this._customHeadersStore.set(headers, id);\n            },\n            setCustomResumeData: function(id, data) {\n                this._customResumeDataStore.set(data, id);\n            },\n            setDeleteFileCustomHeaders: function(headers, id) {\n                this._deleteFileCustomHeadersStore.set(headers, id);\n            },\n            setDeleteFileEndpoint: function(endpoint, id) {\n                this._deleteFileEndpointStore.set(endpoint, id);\n            },\n            setDeleteFileParams: function(params, id) {\n                this._deleteFileParamsStore.set(params, id);\n            },\n            setEndpoint: function(endpoint, id) {\n                this._endpointStore.set(endpoint, id);\n            },\n            setForm: function(elementOrId) {\n                this._updateFormSupportAndParams(elementOrId);\n            },\n            setItemLimit: function(newItemLimit) {\n                this._currentItemLimit = newItemLimit;\n            },\n            setName: function(id, newName) {\n                this._uploadData.updateName(id, newName);\n            },\n            setParams: function(params, id) {\n                this._paramsStore.set(params, id);\n            },\n            setUuid: function(id, newUuid) {\n                return this._uploadData.uuidChanged(id, newUuid);\n            },\n            setStatus: function(id, newStatus) {\n                var fileRecord = this.getUploads({\n                    id: id\n                });\n                if (!fileRecord) {\n                    throw new qq.Error(id + \" is not a valid file ID.\");\n                }\n                switch (newStatus) {\n                  case qq.status.DELETED:\n                    this._onDeleteComplete(id, null, false);\n                    break;\n\n                  case qq.status.DELETE_FAILED:\n                    this._onDeleteComplete(id, null, true);\n                    break;\n\n                  default:\n                    var errorMessage = \"Method setStatus called on '\" + name + \"' not implemented yet for \" + newStatus;\n                    this.log(errorMessage);\n                    throw new qq.Error(errorMessage);\n                }\n            },\n            uploadStoredFiles: function() {\n                if (this._storedIds.length === 0) {\n                    this._itemError(\"noFilesError\");\n                } else {\n                    this._uploadStoredFiles();\n                }\n            }\n        };\n        qq.basePrivateApi = {\n            _addCannedFile: function(sessionData) {\n                var self = this;\n                return this._uploadData.addFile({\n                    uuid: sessionData.uuid,\n                    name: sessionData.name,\n                    size: sessionData.size,\n                    status: qq.status.UPLOAD_SUCCESSFUL,\n                    onBeforeStatusChange: function(id) {\n                        sessionData.deleteFileEndpoint && self.setDeleteFileEndpoint(sessionData.deleteFileEndpoint, id);\n                        sessionData.deleteFileParams && self.setDeleteFileParams(sessionData.deleteFileParams, id);\n                        if (sessionData.thumbnailUrl) {\n                            self._thumbnailUrls[id] = sessionData.thumbnailUrl;\n                        }\n                        self._netUploaded++;\n                        self._netUploadedOrQueued++;\n                    }\n                });\n            },\n            _annotateWithButtonId: function(file, associatedInput) {\n                if (qq.isFile(file)) {\n                    file.qqButtonId = this._getButtonId(associatedInput);\n                }\n            },\n            _batchError: function(message) {\n                this._options.callbacks.onError(null, null, message, undefined);\n            },\n            _createDeleteHandler: function() {\n                var self = this;\n                return new qq.DeleteFileAjaxRequester({\n                    method: this._options.deleteFile.method.toUpperCase(),\n                    maxConnections: this._options.maxConnections,\n                    uuidParamName: this._options.request.uuidName,\n                    customHeaders: this._deleteFileCustomHeadersStore,\n                    paramsStore: this._deleteFileParamsStore,\n                    endpointStore: this._deleteFileEndpointStore,\n                    cors: this._options.cors,\n                    log: qq.bind(self.log, self),\n                    onDelete: function(id) {\n                        self._onDelete(id);\n                        self._options.callbacks.onDelete(id);\n                    },\n                    onDeleteComplete: function(id, xhrOrXdr, isError) {\n                        self._onDeleteComplete(id, xhrOrXdr, isError);\n                        self._options.callbacks.onDeleteComplete(id, xhrOrXdr, isError);\n                    }\n                });\n            },\n            _createPasteHandler: function() {\n                var self = this;\n                return new qq.PasteSupport({\n                    targetElement: this._options.paste.targetElement,\n                    callbacks: {\n                        log: qq.bind(self.log, self),\n                        pasteReceived: function(blob) {\n                            self._handleCheckedCallback({\n                                name: \"onPasteReceived\",\n                                callback: qq.bind(self._options.callbacks.onPasteReceived, self, blob),\n                                onSuccess: qq.bind(self._handlePasteSuccess, self, blob),\n                                identifier: \"pasted image\"\n                            });\n                        }\n                    }\n                });\n            },\n            _createStore: function(initialValue, _readOnlyValues_) {\n                var store = {}, catchall = initialValue, perIdReadOnlyValues = {}, readOnlyValues = _readOnlyValues_, copy = function(orig) {\n                    if (qq.isObject(orig)) {\n                        return qq.extend({}, orig);\n                    }\n                    return orig;\n                }, getReadOnlyValues = function() {\n                    if (qq.isFunction(readOnlyValues)) {\n                        return readOnlyValues();\n                    }\n                    return readOnlyValues;\n                }, includeReadOnlyValues = function(id, existing) {\n                    if (readOnlyValues && qq.isObject(existing)) {\n                        qq.extend(existing, getReadOnlyValues());\n                    }\n                    if (perIdReadOnlyValues[id]) {\n                        qq.extend(existing, perIdReadOnlyValues[id]);\n                    }\n                };\n                return {\n                    set: function(val, id) {\n                        if (id == null) {\n                            store = {};\n                            catchall = copy(val);\n                        } else {\n                            store[id] = copy(val);\n                        }\n                    },\n                    get: function(id) {\n                        var values;\n                        if (id != null && store[id]) {\n                            values = store[id];\n                        } else {\n                            values = copy(catchall);\n                        }\n                        includeReadOnlyValues(id, values);\n                        return copy(values);\n                    },\n                    addReadOnly: function(id, values) {\n                        if (qq.isObject(store)) {\n                            if (id === null) {\n                                if (qq.isFunction(values)) {\n                                    readOnlyValues = values;\n                                } else {\n                                    readOnlyValues = readOnlyValues || {};\n                                    qq.extend(readOnlyValues, values);\n                                }\n                            } else {\n                                perIdReadOnlyValues[id] = perIdReadOnlyValues[id] || {};\n                                qq.extend(perIdReadOnlyValues[id], values);\n                            }\n                        }\n                    },\n                    remove: function(fileId) {\n                        return delete store[fileId];\n                    },\n                    reset: function() {\n                        store = {};\n                        perIdReadOnlyValues = {};\n                        catchall = initialValue;\n                    }\n                };\n            },\n            _createUploadDataTracker: function() {\n                var self = this;\n                return new qq.UploadData({\n                    getName: function(id) {\n                        return self.getName(id);\n                    },\n                    getUuid: function(id) {\n                        return self.getUuid(id);\n                    },\n                    getSize: function(id) {\n                        return self.getSize(id);\n                    },\n                    onStatusChange: function(id, oldStatus, newStatus) {\n                        self._onUploadStatusChange(id, oldStatus, newStatus);\n                        self._options.callbacks.onStatusChange(id, oldStatus, newStatus);\n                        self._maybeAllComplete(id, newStatus);\n                        if (self._totalProgress) {\n                            setTimeout(function() {\n                                self._totalProgress.onStatusChange(id, oldStatus, newStatus);\n                            }, 0);\n                        }\n                    }\n                });\n            },\n            _createUploadButton: function(spec) {\n                var self = this, acceptFiles = spec.accept || this._options.validation.acceptFiles, allowedExtensions = spec.allowedExtensions || this._options.validation.allowedExtensions, button;\n                function allowMultiple() {\n                    if (qq.supportedFeatures.ajaxUploading) {\n                        if (self._options.workarounds.iosEmptyVideos && qq.ios() && !qq.ios6() && self._isAllowedExtension(allowedExtensions, \".mov\")) {\n                            return false;\n                        }\n                        if (spec.multiple === undefined) {\n                            return self._options.multiple;\n                        }\n                        return spec.multiple;\n                    }\n                    return false;\n                }\n                button = new qq.UploadButton({\n                    acceptFiles: acceptFiles,\n                    element: spec.element,\n                    focusClass: this._options.classes.buttonFocus,\n                    folders: spec.folders,\n                    hoverClass: this._options.classes.buttonHover,\n                    ios8BrowserCrashWorkaround: this._options.workarounds.ios8BrowserCrash,\n                    multiple: allowMultiple(),\n                    name: this._options.request.inputName,\n                    onChange: function(input) {\n                        self._onInputChange(input);\n                    },\n                    title: spec.title == null ? this._options.text.fileInputTitle : spec.title\n                });\n                this._disposeSupport.addDisposer(function() {\n                    button.dispose();\n                });\n                self._buttons.push(button);\n                return button;\n            },\n            _createUploadHandler: function(additionalOptions, namespace) {\n                var self = this, lastOnProgress = {}, options = {\n                    debug: this._options.debug,\n                    maxConnections: this._options.maxConnections,\n                    cors: this._options.cors,\n                    paramsStore: this._paramsStore,\n                    endpointStore: this._endpointStore,\n                    chunking: this._options.chunking,\n                    resume: this._options.resume,\n                    blobs: this._options.blobs,\n                    log: qq.bind(self.log, self),\n                    preventRetryParam: this._options.retry.preventRetryResponseProperty,\n                    onProgress: function(id, name, loaded, total) {\n                        if (loaded < 0 || total < 0) {\n                            return;\n                        }\n                        if (lastOnProgress[id]) {\n                            if (lastOnProgress[id].loaded !== loaded || lastOnProgress[id].total !== total) {\n                                self._onProgress(id, name, loaded, total);\n                                self._options.callbacks.onProgress(id, name, loaded, total);\n                            }\n                        } else {\n                            self._onProgress(id, name, loaded, total);\n                            self._options.callbacks.onProgress(id, name, loaded, total);\n                        }\n                        lastOnProgress[id] = {\n                            loaded: loaded,\n                            total: total\n                        };\n                    },\n                    onComplete: function(id, name, result, xhr) {\n                        delete lastOnProgress[id];\n                        var status = self.getUploads({\n                            id: id\n                        }).status, retVal;\n                        if (status === qq.status.UPLOAD_SUCCESSFUL || status === qq.status.UPLOAD_FAILED) {\n                            return;\n                        }\n                        retVal = self._onComplete(id, name, result, xhr);\n                        if (retVal instanceof qq.Promise) {\n                            retVal.done(function() {\n                                self._options.callbacks.onComplete(id, name, result, xhr);\n                            });\n                        } else {\n                            self._options.callbacks.onComplete(id, name, result, xhr);\n                        }\n                    },\n                    onCancel: function(id, name, cancelFinalizationEffort) {\n                        var promise = new qq.Promise();\n                        self._handleCheckedCallback({\n                            name: \"onCancel\",\n                            callback: qq.bind(self._options.callbacks.onCancel, self, id, name),\n                            onFailure: promise.failure,\n                            onSuccess: function() {\n                                cancelFinalizationEffort.then(function() {\n                                    self._onCancel(id, name);\n                                });\n                                promise.success();\n                            },\n                            identifier: id\n                        });\n                        return promise;\n                    },\n                    onUploadPrep: qq.bind(this._onUploadPrep, this),\n                    onUpload: function(id, name) {\n                        self._onUpload(id, name);\n                        var onUploadResult = self._options.callbacks.onUpload(id, name);\n                        if (qq.isGenericPromise(onUploadResult)) {\n                            self.log(qq.format(\"onUpload for {} returned a Promise - waiting for resolution.\", id));\n                            return onUploadResult;\n                        }\n                        return new qq.Promise().success();\n                    },\n                    onUploadChunk: function(id, name, chunkData) {\n                        self._onUploadChunk(id, chunkData);\n                        var onUploadChunkResult = self._options.callbacks.onUploadChunk(id, name, chunkData);\n                        if (qq.isGenericPromise(onUploadChunkResult)) {\n                            self.log(qq.format(\"onUploadChunk for {}.{} returned a Promise - waiting for resolution.\", id, chunkData.partIndex));\n                            return onUploadChunkResult;\n                        }\n                        return new qq.Promise().success();\n                    },\n                    onUploadChunkSuccess: function(id, chunkData, result, xhr) {\n                        self._onUploadChunkSuccess(id, chunkData);\n                        self._options.callbacks.onUploadChunkSuccess.apply(self, arguments);\n                    },\n                    onResume: function(id, name, chunkData, customResumeData) {\n                        return self._options.callbacks.onResume(id, name, chunkData, customResumeData);\n                    },\n                    onAutoRetry: function(id, name, responseJSON, xhr) {\n                        return self._onAutoRetry.apply(self, arguments);\n                    },\n                    onUuidChanged: function(id, newUuid) {\n                        self.log(\"Server requested UUID change from '\" + self.getUuid(id) + \"' to '\" + newUuid + \"'\");\n                        self.setUuid(id, newUuid);\n                    },\n                    getName: qq.bind(self.getName, self),\n                    getUuid: qq.bind(self.getUuid, self),\n                    getSize: qq.bind(self.getSize, self),\n                    setSize: qq.bind(self._setSize, self),\n                    getDataByUuid: function(uuid) {\n                        return self.getUploads({\n                            uuid: uuid\n                        });\n                    },\n                    isQueued: function(id) {\n                        var status = self.getUploads({\n                            id: id\n                        }).status;\n                        return status === qq.status.QUEUED || status === qq.status.SUBMITTED || status === qq.status.UPLOAD_RETRYING || status === qq.status.PAUSED;\n                    },\n                    getIdsInProxyGroup: self._uploadData.getIdsInProxyGroup,\n                    getIdsInBatch: self._uploadData.getIdsInBatch,\n                    isInProgress: function(id) {\n                        return self.getUploads({\n                            id: id\n                        }).status === qq.status.UPLOADING;\n                    },\n                    getCustomResumeData: qq.bind(self._getCustomResumeData, self),\n                    setStatus: function(id, status) {\n                        self._uploadData.setStatus(id, status);\n                    }\n                };\n                qq.each(this._options.request, function(prop, val) {\n                    options[prop] = val;\n                });\n                options.customHeaders = this._customHeadersStore;\n                if (additionalOptions) {\n                    qq.each(additionalOptions, function(key, val) {\n                        options[key] = val;\n                    });\n                }\n                return new qq.UploadHandlerController(options, namespace);\n            },\n            _fileOrBlobRejected: function(id) {\n                this._netUploadedOrQueued--;\n                this._uploadData.setStatus(id, qq.status.REJECTED);\n            },\n            _formatSize: function(bytes) {\n                if (bytes === 0) {\n                    return bytes + this._options.text.sizeSymbols[0];\n                }\n                var i = -1;\n                do {\n                    bytes = bytes / 1024;\n                    i++;\n                } while (bytes > 1023);\n                return Math.max(bytes, .1).toFixed(1) + this._options.text.sizeSymbols[i];\n            },\n            _generateExtraButtonSpecs: function() {\n                var self = this;\n                this._extraButtonSpecs = {};\n                qq.each(this._options.extraButtons, function(idx, extraButtonOptionEntry) {\n                    var multiple = extraButtonOptionEntry.multiple, validation = qq.extend({}, self._options.validation, true), extraButtonSpec = qq.extend({}, extraButtonOptionEntry);\n                    if (multiple === undefined) {\n                        multiple = self._options.multiple;\n                    }\n                    if (extraButtonSpec.validation) {\n                        qq.extend(validation, extraButtonOptionEntry.validation, true);\n                    }\n                    qq.extend(extraButtonSpec, {\n                        multiple: multiple,\n                        validation: validation\n                    }, true);\n                    self._initExtraButton(extraButtonSpec);\n                });\n            },\n            _getButton: function(buttonId) {\n                var extraButtonsSpec = this._extraButtonSpecs[buttonId];\n                if (extraButtonsSpec) {\n                    return extraButtonsSpec.element;\n                } else if (buttonId === this._defaultButtonId) {\n                    return this._options.button;\n                }\n            },\n            _getButtonId: function(buttonOrFileInputOrFile) {\n                var inputs, fileInput, fileBlobOrInput = buttonOrFileInputOrFile;\n                if (fileBlobOrInput instanceof qq.BlobProxy) {\n                    fileBlobOrInput = fileBlobOrInput.referenceBlob;\n                }\n                if (fileBlobOrInput && !qq.isBlob(fileBlobOrInput)) {\n                    if (qq.isFile(fileBlobOrInput)) {\n                        return fileBlobOrInput.qqButtonId;\n                    } else if (fileBlobOrInput.tagName.toLowerCase() === \"input\" && fileBlobOrInput.type.toLowerCase() === \"file\") {\n                        return fileBlobOrInput.getAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME);\n                    }\n                    inputs = fileBlobOrInput.getElementsByTagName(\"input\");\n                    qq.each(inputs, function(idx, input) {\n                        if (input.getAttribute(\"type\") === \"file\") {\n                            fileInput = input;\n                            return false;\n                        }\n                    });\n                    if (fileInput) {\n                        return fileInput.getAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME);\n                    }\n                }\n            },\n            _getCustomResumeData: function(fileId) {\n                return this._customResumeDataStore.get(fileId);\n            },\n            _getNotFinished: function() {\n                return this._uploadData.retrieve({\n                    status: [ qq.status.UPLOADING, qq.status.UPLOAD_RETRYING, qq.status.QUEUED, qq.status.SUBMITTING, qq.status.SUBMITTED, qq.status.PAUSED ]\n                }).length;\n            },\n            _getValidationBase: function(buttonId) {\n                var extraButtonSpec = this._extraButtonSpecs[buttonId];\n                return extraButtonSpec ? extraButtonSpec.validation : this._options.validation;\n            },\n            _getValidationDescriptor: function(fileWrapper) {\n                if (fileWrapper.file instanceof qq.BlobProxy) {\n                    return {\n                        name: qq.getFilename(fileWrapper.file.referenceBlob),\n                        size: fileWrapper.file.referenceBlob.size\n                    };\n                }\n                return {\n                    name: this.getUploads({\n                        id: fileWrapper.id\n                    }).name,\n                    size: this.getUploads({\n                        id: fileWrapper.id\n                    }).size\n                };\n            },\n            _getValidationDescriptors: function(fileWrappers) {\n                var self = this, fileDescriptors = [];\n                qq.each(fileWrappers, function(idx, fileWrapper) {\n                    fileDescriptors.push(self._getValidationDescriptor(fileWrapper));\n                });\n                return fileDescriptors;\n            },\n            _handleCameraAccess: function() {\n                if (this._options.camera.ios && qq.ios()) {\n                    var acceptIosCamera = \"image/*;capture=camera\", button = this._options.camera.button, buttonId = button ? this._getButtonId(button) : this._defaultButtonId, optionRoot = this._options;\n                    if (buttonId && buttonId !== this._defaultButtonId) {\n                        optionRoot = this._extraButtonSpecs[buttonId];\n                    }\n                    optionRoot.multiple = false;\n                    if (optionRoot.validation.acceptFiles === null) {\n                        optionRoot.validation.acceptFiles = acceptIosCamera;\n                    } else {\n                        optionRoot.validation.acceptFiles += \",\" + acceptIosCamera;\n                    }\n                    qq.each(this._buttons, function(idx, button) {\n                        if (button.getButtonId() === buttonId) {\n                            button.setMultiple(optionRoot.multiple);\n                            button.setAcceptFiles(optionRoot.acceptFiles);\n                            return false;\n                        }\n                    });\n                }\n            },\n            _handleCheckedCallback: function(details) {\n                var self = this, callbackRetVal = details.callback();\n                if (qq.isGenericPromise(callbackRetVal)) {\n                    this.log(details.name + \" - waiting for \" + details.name + \" promise to be fulfilled for \" + details.identifier);\n                    return callbackRetVal.then(function(successParam) {\n                        self.log(details.name + \" promise success for \" + details.identifier);\n                        details.onSuccess(successParam);\n                    }, function() {\n                        if (details.onFailure) {\n                            self.log(details.name + \" promise failure for \" + details.identifier);\n                            details.onFailure();\n                        } else {\n                            self.log(details.name + \" promise failure for \" + details.identifier);\n                        }\n                    });\n                }\n                if (callbackRetVal !== false) {\n                    details.onSuccess(callbackRetVal);\n                } else {\n                    if (details.onFailure) {\n                        this.log(details.name + \" - return value was 'false' for \" + details.identifier + \".  Invoking failure callback.\");\n                        details.onFailure();\n                    } else {\n                        this.log(details.name + \" - return value was 'false' for \" + details.identifier + \".  Will not proceed.\");\n                    }\n                }\n                return callbackRetVal;\n            },\n            _handleNewFile: function(file, batchId, newFileWrapperList) {\n                var self = this, uuid = qq.getUniqueId(), size = -1, name = qq.getFilename(file), actualFile = file.blob || file, handler = this._customNewFileHandler ? this._customNewFileHandler : qq.bind(self._handleNewFileGeneric, self);\n                if (!qq.isInput(actualFile) && actualFile.size >= 0) {\n                    size = actualFile.size;\n                }\n                handler(actualFile, name, uuid, size, newFileWrapperList, batchId, this._options.request.uuidName, {\n                    uploadData: self._uploadData,\n                    paramsStore: self._paramsStore,\n                    addFileToHandler: function(id, file) {\n                        self._handler.add(id, file);\n                        self._netUploadedOrQueued++;\n                        self._trackButton(id);\n                    }\n                });\n            },\n            _handleNewFileGeneric: function(file, name, uuid, size, fileList, batchId) {\n                var id = this._uploadData.addFile({\n                    uuid: uuid,\n                    name: name,\n                    size: size,\n                    batchId: batchId,\n                    file: file\n                });\n                this._handler.add(id, file);\n                this._trackButton(id);\n                this._netUploadedOrQueued++;\n                fileList.push({\n                    id: id,\n                    file: file\n                });\n            },\n            _handlePasteSuccess: function(blob, extSuppliedName) {\n                var extension = blob.type.split(\"/\")[1], name = extSuppliedName;\n                if (name == null) {\n                    name = this._options.paste.defaultName;\n                }\n                name += \".\" + extension;\n                this.addFiles({\n                    name: name,\n                    blob: blob\n                });\n            },\n            _handleDeleteSuccess: function(id) {\n                if (this.getUploads({\n                    id: id\n                }).status !== qq.status.DELETED) {\n                    var name = this.getName(id);\n                    this._netUploadedOrQueued--;\n                    this._netUploaded--;\n                    this._handler.expunge(id);\n                    this._uploadData.setStatus(id, qq.status.DELETED);\n                    this.log(\"Delete request for '\" + name + \"' has succeeded.\");\n                }\n            },\n            _handleDeleteFailed: function(id, xhrOrXdr) {\n                var name = this.getName(id);\n                this._uploadData.setStatus(id, qq.status.DELETE_FAILED);\n                this.log(\"Delete request for '\" + name + \"' has failed.\", \"error\");\n                if (!xhrOrXdr || xhrOrXdr.withCredentials === undefined) {\n                    this._options.callbacks.onError(id, name, \"Delete request failed\", xhrOrXdr);\n                } else {\n                    this._options.callbacks.onError(id, name, \"Delete request failed with response code \" + xhrOrXdr.status, xhrOrXdr);\n                }\n            },\n            _initExtraButton: function(spec) {\n                var button = this._createUploadButton({\n                    accept: spec.validation.acceptFiles,\n                    allowedExtensions: spec.validation.allowedExtensions,\n                    element: spec.element,\n                    folders: spec.folders,\n                    multiple: spec.multiple,\n                    title: spec.fileInputTitle\n                });\n                this._extraButtonSpecs[button.getButtonId()] = spec;\n            },\n            _initFormSupportAndParams: function() {\n                this._formSupport = qq.FormSupport && new qq.FormSupport(this._options.form, qq.bind(this.uploadStoredFiles, this), qq.bind(this.log, this));\n                if (this._formSupport && this._formSupport.attachedToForm) {\n                    this._paramsStore = this._createStore(this._options.request.params, this._formSupport.getFormInputsAsObject);\n                    this._options.autoUpload = this._formSupport.newAutoUpload;\n                    if (this._formSupport.newEndpoint) {\n                        this._options.request.endpoint = this._formSupport.newEndpoint;\n                    }\n                } else {\n                    this._paramsStore = this._createStore(this._options.request.params);\n                }\n            },\n            _isDeletePossible: function() {\n                if (!qq.DeleteFileAjaxRequester || !this._options.deleteFile.enabled) {\n                    return false;\n                }\n                if (this._options.cors.expected) {\n                    if (qq.supportedFeatures.deleteFileCorsXhr) {\n                        return true;\n                    }\n                    if (qq.supportedFeatures.deleteFileCorsXdr && this._options.cors.allowXdr) {\n                        return true;\n                    }\n                    return false;\n                }\n                return true;\n            },\n            _isAllowedExtension: function(allowed, fileName) {\n                var valid = false;\n                if (!allowed.length) {\n                    return true;\n                }\n                qq.each(allowed, function(idx, allowedExt) {\n                    if (qq.isString(allowedExt)) {\n                        var extRegex = new RegExp(\"\\\\.\" + allowedExt + \"$\", \"i\");\n                        if (fileName.match(extRegex) != null) {\n                            valid = true;\n                            return false;\n                        }\n                    }\n                });\n                return valid;\n            },\n            _itemError: function(code, maybeNameOrNames, item) {\n                var message = this._options.messages[code], allowedExtensions = [], names = [].concat(maybeNameOrNames), name = names[0], buttonId = this._getButtonId(item), validationBase = this._getValidationBase(buttonId), extensionsForMessage, placeholderMatch;\n                function r(name, replacement) {\n                    message = message.replace(name, replacement);\n                }\n                qq.each(validationBase.allowedExtensions, function(idx, allowedExtension) {\n                    if (qq.isString(allowedExtension)) {\n                        allowedExtensions.push(allowedExtension);\n                    }\n                });\n                extensionsForMessage = allowedExtensions.join(\", \").toLowerCase();\n                r(\"{file}\", this._options.formatFileName(name));\n                r(\"{extensions}\", extensionsForMessage);\n                r(\"{sizeLimit}\", this._formatSize(validationBase.sizeLimit));\n                r(\"{minSizeLimit}\", this._formatSize(validationBase.minSizeLimit));\n                placeholderMatch = message.match(/(\\{\\w+\\})/g);\n                if (placeholderMatch !== null) {\n                    qq.each(placeholderMatch, function(idx, placeholder) {\n                        r(placeholder, names[idx]);\n                    });\n                }\n                this._options.callbacks.onError(null, name, message, undefined);\n                return message;\n            },\n            _manualRetry: function(id, callback) {\n                if (this._onBeforeManualRetry(id)) {\n                    this._netUploadedOrQueued++;\n                    this._uploadData.setStatus(id, qq.status.UPLOAD_RETRYING);\n                    if (callback) {\n                        callback(id);\n                    } else {\n                        this._handler.retry(id);\n                    }\n                    return true;\n                }\n            },\n            _maybeAllComplete: function(id, status) {\n                var self = this, notFinished = this._getNotFinished();\n                if (status === qq.status.UPLOAD_SUCCESSFUL) {\n                    this._succeededSinceLastAllComplete.push(id);\n                } else if (status === qq.status.UPLOAD_FAILED || status === qq.status.REJECTED || status === qq.status.CANCELED) {\n                    this._failedSinceLastAllComplete.push(id);\n                }\n                if (notFinished === 0 && (this._succeededSinceLastAllComplete.length || this._failedSinceLastAllComplete.length)) {\n                    setTimeout(function() {\n                        if (self._succeededSinceLastAllComplete.length || self._failedSinceLastAllComplete.length) {\n                            self._onAllComplete(self._succeededSinceLastAllComplete, self._failedSinceLastAllComplete);\n                        }\n                    }, 0);\n                }\n            },\n            _maybeHandleIos8SafariWorkaround: function() {\n                var self = this;\n                if (this._options.workarounds.ios8SafariUploads && qq.ios800() && qq.iosSafari()) {\n                    setTimeout(function() {\n                        window.alert(self._options.messages.unsupportedBrowserIos8Safari);\n                    }, 0);\n                    throw new qq.Error(this._options.messages.unsupportedBrowserIos8Safari);\n                }\n            },\n            _maybeParseAndSendUploadError: function(id, name, response, xhr) {\n                if (!response.success) {\n                    if (xhr && xhr.status !== 200 && !response.error) {\n                        this._options.callbacks.onError(id, name, \"XHR returned response code \" + xhr.status, xhr);\n                    } else {\n                        var errorReason = response.error ? response.error : this._options.text.defaultResponseError;\n                        this._options.callbacks.onError(id, name, errorReason, xhr);\n                    }\n                }\n            },\n            _maybeProcessNextItemAfterOnValidateCallback: function(validItem, items, index, params, endpoint) {\n                var self = this;\n                if (items.length > index) {\n                    if (validItem || !this._options.validation.stopOnFirstInvalidFile) {\n                        setTimeout(function() {\n                            var validationDescriptor = self._getValidationDescriptor(items[index]), buttonId = self._getButtonId(items[index].file), button = self._getButton(buttonId);\n                            self._handleCheckedCallback({\n                                name: \"onValidate\",\n                                callback: qq.bind(self._options.callbacks.onValidate, self, validationDescriptor, button),\n                                onSuccess: qq.bind(self._onValidateCallbackSuccess, self, items, index, params, endpoint),\n                                onFailure: qq.bind(self._onValidateCallbackFailure, self, items, index, params, endpoint),\n                                identifier: \"Item '\" + validationDescriptor.name + \"', size: \" + validationDescriptor.size\n                            });\n                        }, 0);\n                    } else if (!validItem) {\n                        for (;index < items.length; index++) {\n                            self._fileOrBlobRejected(items[index].id);\n                        }\n                    }\n                }\n            },\n            _onAllComplete: function(successful, failed) {\n                this._totalProgress && this._totalProgress.onAllComplete(successful, failed, this._preventRetries);\n                this._options.callbacks.onAllComplete(qq.extend([], successful), qq.extend([], failed));\n                this._succeededSinceLastAllComplete = [];\n                this._failedSinceLastAllComplete = [];\n            },\n            _onAutoRetry: function(id, name, responseJSON, xhr, callback) {\n                var self = this;\n                self._preventRetries[id] = responseJSON[self._options.retry.preventRetryResponseProperty];\n                if (self._shouldAutoRetry(id)) {\n                    var retryWaitPeriod = self._options.retry.autoAttemptDelay * 1e3;\n                    self._maybeParseAndSendUploadError.apply(self, arguments);\n                    self._options.callbacks.onAutoRetry(id, name, self._autoRetries[id]);\n                    self._onBeforeAutoRetry(id, name);\n                    self._uploadData.setStatus(id, qq.status.UPLOAD_RETRYING);\n                    self._retryTimeouts[id] = setTimeout(function() {\n                        self.log(\"Starting retry for \" + name + \"...\");\n                        if (callback) {\n                            callback(id);\n                        } else {\n                            self._handler.retry(id);\n                        }\n                    }, retryWaitPeriod);\n                    return true;\n                }\n            },\n            _onBeforeAutoRetry: function(id, name) {\n                this.log(\"Waiting \" + this._options.retry.autoAttemptDelay + \" seconds before retrying \" + name + \"...\");\n            },\n            _onBeforeManualRetry: function(id) {\n                var itemLimit = this._currentItemLimit, fileName;\n                if (this._preventRetries[id]) {\n                    this.log(\"Retries are forbidden for id \" + id, \"warn\");\n                    return false;\n                } else if (this._handler.isValid(id)) {\n                    fileName = this.getName(id);\n                    if (this._options.callbacks.onManualRetry(id, fileName) === false) {\n                        return false;\n                    }\n                    if (itemLimit > 0 && this._netUploadedOrQueued + 1 > itemLimit) {\n                        this._itemError(\"retryFailTooManyItems\");\n                        return false;\n                    }\n                    this.log(\"Retrying upload for '\" + fileName + \"' (id: \" + id + \")...\");\n                    return true;\n                } else {\n                    this.log(\"'\" + id + \"' is not a valid file ID\", \"error\");\n                    return false;\n                }\n            },\n            _onCancel: function(id, name) {\n                this._netUploadedOrQueued--;\n                clearTimeout(this._retryTimeouts[id]);\n                var storedItemIndex = qq.indexOf(this._storedIds, id);\n                if (!this._options.autoUpload && storedItemIndex >= 0) {\n                    this._storedIds.splice(storedItemIndex, 1);\n                }\n                this._uploadData.setStatus(id, qq.status.CANCELED);\n            },\n            _onComplete: function(id, name, result, xhr) {\n                if (!result.success) {\n                    this._netUploadedOrQueued--;\n                    this._uploadData.setStatus(id, qq.status.UPLOAD_FAILED);\n                    if (result[this._options.retry.preventRetryResponseProperty] === true) {\n                        this._preventRetries[id] = true;\n                    }\n                } else {\n                    if (result.thumbnailUrl) {\n                        this._thumbnailUrls[id] = result.thumbnailUrl;\n                    }\n                    this._netUploaded++;\n                    this._uploadData.setStatus(id, qq.status.UPLOAD_SUCCESSFUL);\n                }\n                this._maybeParseAndSendUploadError(id, name, result, xhr);\n                return result.success ? true : false;\n            },\n            _onDelete: function(id) {\n                this._uploadData.setStatus(id, qq.status.DELETING);\n            },\n            _onDeleteComplete: function(id, xhrOrXdr, isError) {\n                var name = this.getName(id);\n                if (isError) {\n                    this._handleDeleteFailed(id, xhrOrXdr);\n                } else {\n                    this._handleDeleteSuccess(id);\n                }\n            },\n            _onInputChange: function(input) {\n                var fileIndex;\n                if (qq.supportedFeatures.ajaxUploading) {\n                    for (fileIndex = 0; fileIndex < input.files.length; fileIndex++) {\n                        this._annotateWithButtonId(input.files[fileIndex], input);\n                    }\n                    this.addFiles(input.files);\n                } else if (input.value.length > 0) {\n                    this.addFiles(input);\n                }\n                qq.each(this._buttons, function(idx, button) {\n                    button.reset();\n                });\n            },\n            _onProgress: function(id, name, loaded, total) {\n                this._totalProgress && this._totalProgress.onIndividualProgress(id, loaded, total);\n            },\n            _onSubmit: function(id, name) {},\n            _onSubmitCallbackSuccess: function(id, name) {\n                this._onSubmit.apply(this, arguments);\n                this._uploadData.setStatus(id, qq.status.SUBMITTED);\n                this._onSubmitted.apply(this, arguments);\n                if (this._options.autoUpload) {\n                    this._options.callbacks.onSubmitted.apply(this, arguments);\n                    this._uploadFile(id);\n                } else {\n                    this._storeForLater(id);\n                    this._options.callbacks.onSubmitted.apply(this, arguments);\n                }\n            },\n            _onSubmitDelete: function(id, onSuccessCallback, additionalMandatedParams) {\n                var uuid = this.getUuid(id), adjustedOnSuccessCallback;\n                if (onSuccessCallback) {\n                    adjustedOnSuccessCallback = qq.bind(onSuccessCallback, this, id, uuid, additionalMandatedParams);\n                }\n                if (this._isDeletePossible()) {\n                    this._handleCheckedCallback({\n                        name: \"onSubmitDelete\",\n                        callback: qq.bind(this._options.callbacks.onSubmitDelete, this, id),\n                        onSuccess: adjustedOnSuccessCallback || qq.bind(this._deleteHandler.sendDelete, this, id, uuid, additionalMandatedParams),\n                        identifier: id\n                    });\n                    return true;\n                } else {\n                    this.log(\"Delete request ignored for ID \" + id + \", delete feature is disabled or request not possible \" + \"due to CORS on a user agent that does not support pre-flighting.\", \"warn\");\n                    return false;\n                }\n            },\n            _onSubmitted: function(id) {},\n            _onTotalProgress: function(loaded, total) {\n                this._options.callbacks.onTotalProgress(loaded, total);\n            },\n            _onUploadPrep: function(id) {},\n            _onUpload: function(id, name) {\n                this._uploadData.setStatus(id, qq.status.UPLOADING);\n            },\n            _onUploadChunk: function(id, chunkData) {},\n            _onUploadChunkSuccess: function(id, chunkData) {\n                if (!this._preventRetries[id] && this._options.retry.enableAuto) {\n                    this._autoRetries[id] = 0;\n                }\n            },\n            _onUploadStatusChange: function(id, oldStatus, newStatus) {\n                if (newStatus === qq.status.PAUSED) {\n                    clearTimeout(this._retryTimeouts[id]);\n                }\n            },\n            _onValidateBatchCallbackFailure: function(fileWrappers) {\n                var self = this;\n                qq.each(fileWrappers, function(idx, fileWrapper) {\n                    self._fileOrBlobRejected(fileWrapper.id);\n                });\n            },\n            _onValidateBatchCallbackSuccess: function(validationDescriptors, items, params, endpoint, button) {\n                var errorMessage, itemLimit = this._currentItemLimit, proposedNetFilesUploadedOrQueued = this._netUploadedOrQueued;\n                if (itemLimit === 0 || proposedNetFilesUploadedOrQueued <= itemLimit) {\n                    if (items.length > 0) {\n                        this._handleCheckedCallback({\n                            name: \"onValidate\",\n                            callback: qq.bind(this._options.callbacks.onValidate, this, validationDescriptors[0], button),\n                            onSuccess: qq.bind(this._onValidateCallbackSuccess, this, items, 0, params, endpoint),\n                            onFailure: qq.bind(this._onValidateCallbackFailure, this, items, 0, params, endpoint),\n                            identifier: \"Item '\" + items[0].file.name + \"', size: \" + items[0].file.size\n                        });\n                    } else {\n                        this._itemError(\"noFilesError\");\n                    }\n                } else {\n                    this._onValidateBatchCallbackFailure(items);\n                    errorMessage = this._options.messages.tooManyItemsError.replace(/\\{netItems\\}/g, proposedNetFilesUploadedOrQueued).replace(/\\{itemLimit\\}/g, itemLimit);\n                    this._batchError(errorMessage);\n                }\n            },\n            _onValidateCallbackFailure: function(items, index, params, endpoint) {\n                var nextIndex = index + 1;\n                this._fileOrBlobRejected(items[index].id, items[index].file.name);\n                this._maybeProcessNextItemAfterOnValidateCallback(false, items, nextIndex, params, endpoint);\n            },\n            _onValidateCallbackSuccess: function(items, index, params, endpoint) {\n                var self = this, nextIndex = index + 1, validationDescriptor = this._getValidationDescriptor(items[index]);\n                this._validateFileOrBlobData(items[index], validationDescriptor).then(function() {\n                    self._upload(items[index].id, params, endpoint);\n                    self._maybeProcessNextItemAfterOnValidateCallback(true, items, nextIndex, params, endpoint);\n                }, function() {\n                    self._maybeProcessNextItemAfterOnValidateCallback(false, items, nextIndex, params, endpoint);\n                });\n            },\n            _prepareItemsForUpload: function(items, params, endpoint) {\n                if (items.length === 0) {\n                    this._itemError(\"noFilesError\");\n                    return;\n                }\n                var validationDescriptors = this._getValidationDescriptors(items), buttonId = this._getButtonId(items[0].file), button = this._getButton(buttonId);\n                this._handleCheckedCallback({\n                    name: \"onValidateBatch\",\n                    callback: qq.bind(this._options.callbacks.onValidateBatch, this, validationDescriptors, button),\n                    onSuccess: qq.bind(this._onValidateBatchCallbackSuccess, this, validationDescriptors, items, params, endpoint, button),\n                    onFailure: qq.bind(this._onValidateBatchCallbackFailure, this, items),\n                    identifier: \"batch validation\"\n                });\n            },\n            _preventLeaveInProgress: function() {\n                var self = this;\n                this._disposeSupport.attach(window, \"beforeunload\", function(e) {\n                    if (self.getInProgress()) {\n                        e = e || window.event;\n                        e.returnValue = self._options.messages.onLeave;\n                        return self._options.messages.onLeave;\n                    }\n                });\n            },\n            _refreshSessionData: function() {\n                var self = this, options = this._options.session;\n                if (qq.Session && this._options.session.endpoint != null) {\n                    if (!this._session) {\n                        qq.extend(options, {\n                            cors: this._options.cors\n                        });\n                        options.log = qq.bind(this.log, this);\n                        options.addFileRecord = qq.bind(this._addCannedFile, this);\n                        this._session = new qq.Session(options);\n                    }\n                    setTimeout(function() {\n                        self._session.refresh().then(function(response, xhrOrXdr) {\n                            self._sessionRequestComplete();\n                            self._options.callbacks.onSessionRequestComplete(response, true, xhrOrXdr);\n                        }, function(response, xhrOrXdr) {\n                            self._options.callbacks.onSessionRequestComplete(response, false, xhrOrXdr);\n                        });\n                    }, 0);\n                }\n            },\n            _sessionRequestComplete: function() {},\n            _setSize: function(id, newSize) {\n                this._uploadData.updateSize(id, newSize);\n                this._totalProgress && this._totalProgress.onNewSize(id);\n            },\n            _shouldAutoRetry: function(id) {\n                var uploadData = this._uploadData.retrieve({\n                    id: id\n                });\n                if (!this._preventRetries[id] && this._options.retry.enableAuto && uploadData.status !== qq.status.PAUSED) {\n                    if (this._autoRetries[id] === undefined) {\n                        this._autoRetries[id] = 0;\n                    }\n                    if (this._autoRetries[id] < this._options.retry.maxAutoAttempts) {\n                        this._autoRetries[id] += 1;\n                        return true;\n                    }\n                }\n                return false;\n            },\n            _storeForLater: function(id) {\n                this._storedIds.push(id);\n            },\n            _trackButton: function(id) {\n                var buttonId;\n                if (qq.supportedFeatures.ajaxUploading) {\n                    buttonId = this._handler.getFile(id).qqButtonId;\n                } else {\n                    buttonId = this._getButtonId(this._handler.getInput(id));\n                }\n                if (buttonId) {\n                    this._buttonIdsForFileIds[id] = buttonId;\n                }\n            },\n            _updateFormSupportAndParams: function(formElementOrId) {\n                this._options.form.element = formElementOrId;\n                this._formSupport = qq.FormSupport && new qq.FormSupport(this._options.form, qq.bind(this.uploadStoredFiles, this), qq.bind(this.log, this));\n                if (this._formSupport && this._formSupport.attachedToForm) {\n                    this._paramsStore.addReadOnly(null, this._formSupport.getFormInputsAsObject);\n                    this._options.autoUpload = this._formSupport.newAutoUpload;\n                    if (this._formSupport.newEndpoint) {\n                        this.setEndpoint(this._formSupport.newEndpoint);\n                    }\n                }\n            },\n            _upload: function(id, params, endpoint) {\n                var name = this.getName(id);\n                if (params) {\n                    this.setParams(params, id);\n                }\n                if (endpoint) {\n                    this.setEndpoint(endpoint, id);\n                }\n                this._handleCheckedCallback({\n                    name: \"onSubmit\",\n                    callback: qq.bind(this._options.callbacks.onSubmit, this, id, name),\n                    onSuccess: qq.bind(this._onSubmitCallbackSuccess, this, id, name),\n                    onFailure: qq.bind(this._fileOrBlobRejected, this, id, name),\n                    identifier: id\n                });\n            },\n            _uploadFile: function(id) {\n                if (!this._handler.upload(id)) {\n                    this._uploadData.setStatus(id, qq.status.QUEUED);\n                }\n            },\n            _uploadStoredFiles: function() {\n                var idToUpload, stillSubmitting, self = this;\n                while (this._storedIds.length) {\n                    idToUpload = this._storedIds.shift();\n                    this._uploadFile(idToUpload);\n                }\n                stillSubmitting = this.getUploads({\n                    status: qq.status.SUBMITTING\n                }).length;\n                if (stillSubmitting) {\n                    qq.log(\"Still waiting for \" + stillSubmitting + \" files to clear submit queue. Will re-parse stored IDs array shortly.\");\n                    setTimeout(function() {\n                        self._uploadStoredFiles();\n                    }, 1e3);\n                }\n            },\n            _validateFileOrBlobData: function(fileWrapper, validationDescriptor) {\n                var self = this, file = function() {\n                    if (fileWrapper.file instanceof qq.BlobProxy) {\n                        return fileWrapper.file.referenceBlob;\n                    }\n                    return fileWrapper.file;\n                }(), name = validationDescriptor.name, size = validationDescriptor.size, buttonId = this._getButtonId(fileWrapper.file), validationBase = this._getValidationBase(buttonId), validityChecker = new qq.Promise();\n                validityChecker.then(function() {}, function() {\n                    self._fileOrBlobRejected(fileWrapper.id, name);\n                });\n                if (qq.isFileOrInput(file) && !this._isAllowedExtension(validationBase.allowedExtensions, name)) {\n                    this._itemError(\"typeError\", name, file);\n                    return validityChecker.failure();\n                }\n                if (!this._options.validation.allowEmpty && size === 0) {\n                    this._itemError(\"emptyError\", name, file);\n                    return validityChecker.failure();\n                }\n                if (size > 0 && validationBase.sizeLimit && size > validationBase.sizeLimit) {\n                    this._itemError(\"sizeError\", name, file);\n                    return validityChecker.failure();\n                }\n                if (size > 0 && size < validationBase.minSizeLimit) {\n                    this._itemError(\"minSizeError\", name, file);\n                    return validityChecker.failure();\n                }\n                if (qq.ImageValidation && qq.supportedFeatures.imagePreviews && qq.isFile(file)) {\n                    new qq.ImageValidation(file, qq.bind(self.log, self)).validate(validationBase.image).then(validityChecker.success, function(errorCode) {\n                        self._itemError(errorCode + \"ImageError\", name, file);\n                        validityChecker.failure();\n                    });\n                } else {\n                    validityChecker.success();\n                }\n                return validityChecker;\n            },\n            _wrapCallbacks: function() {\n                var self, safeCallback, prop;\n                self = this;\n                safeCallback = function(name, callback, args) {\n                    var errorMsg;\n                    try {\n                        return callback.apply(self, args);\n                    } catch (exception) {\n                        errorMsg = exception.message || exception.toString();\n                        self.log(\"Caught exception in '\" + name + \"' callback - \" + errorMsg, \"error\");\n                    }\n                };\n                for (prop in this._options.callbacks) {\n                    (function() {\n                        var callbackName, callbackFunc;\n                        callbackName = prop;\n                        callbackFunc = self._options.callbacks[callbackName];\n                        self._options.callbacks[callbackName] = function() {\n                            return safeCallback(callbackName, callbackFunc, arguments);\n                        };\n                    })();\n                }\n            }\n        };\n    })();\n    (function() {\n        \"use strict\";\n        qq.FineUploaderBasic = function(o) {\n            var self = this;\n            this._options = {\n                debug: false,\n                button: null,\n                multiple: true,\n                maxConnections: 3,\n                disableCancelForFormUploads: false,\n                autoUpload: true,\n                warnBeforeUnload: true,\n                request: {\n                    customHeaders: {},\n                    endpoint: \"/server/upload\",\n                    filenameParam: \"qqfilename\",\n                    forceMultipart: true,\n                    inputName: \"qqfile\",\n                    method: \"POST\",\n                    omitDefaultParams: false,\n                    params: {},\n                    paramsInBody: true,\n                    requireSuccessJson: true,\n                    totalFileSizeName: \"qqtotalfilesize\",\n                    uuidName: \"qquuid\"\n                },\n                validation: {\n                    allowedExtensions: [],\n                    sizeLimit: 0,\n                    minSizeLimit: 0,\n                    itemLimit: 0,\n                    stopOnFirstInvalidFile: true,\n                    acceptFiles: null,\n                    image: {\n                        maxHeight: 0,\n                        maxWidth: 0,\n                        minHeight: 0,\n                        minWidth: 0\n                    },\n                    allowEmpty: false\n                },\n                callbacks: {\n                    onSubmit: function(id, name) {},\n                    onSubmitted: function(id, name) {},\n                    onComplete: function(id, name, responseJSON, maybeXhr) {},\n                    onAllComplete: function(successful, failed) {},\n                    onCancel: function(id, name) {},\n                    onUpload: function(id, name) {},\n                    onUploadChunk: function(id, name, chunkData) {},\n                    onUploadChunkSuccess: function(id, chunkData, responseJSON, xhr) {},\n                    onResume: function(id, fileName, chunkData, customResumeData) {},\n                    onProgress: function(id, name, loaded, total) {},\n                    onTotalProgress: function(loaded, total) {},\n                    onError: function(id, name, reason, maybeXhrOrXdr) {},\n                    onAutoRetry: function(id, name, attemptNumber) {},\n                    onManualRetry: function(id, name) {},\n                    onValidateBatch: function(fileOrBlobData) {},\n                    onValidate: function(fileOrBlobData) {},\n                    onSubmitDelete: function(id) {},\n                    onDelete: function(id) {},\n                    onDeleteComplete: function(id, xhrOrXdr, isError) {},\n                    onPasteReceived: function(blob) {},\n                    onStatusChange: function(id, oldStatus, newStatus) {},\n                    onSessionRequestComplete: function(response, success, xhrOrXdr) {}\n                },\n                messages: {\n                    typeError: \"{file} has an invalid extension. Valid extension(s): {extensions}.\",\n                    sizeError: \"{file} is too large, maximum file size is {sizeLimit}.\",\n                    minSizeError: \"{file} is too small, minimum file size is {minSizeLimit}.\",\n                    emptyError: \"{file} is empty, please select files again without it.\",\n                    noFilesError: \"No files to upload.\",\n                    tooManyItemsError: \"Too many items ({netItems}) would be uploaded.  Item limit is {itemLimit}.\",\n                    maxHeightImageError: \"Image is too tall.\",\n                    maxWidthImageError: \"Image is too wide.\",\n                    minHeightImageError: \"Image is not tall enough.\",\n                    minWidthImageError: \"Image is not wide enough.\",\n                    retryFailTooManyItems: \"Retry failed - you have reached your file limit.\",\n                    onLeave: \"The files are being uploaded, if you leave now the upload will be canceled.\",\n                    unsupportedBrowserIos8Safari: \"Unrecoverable error - this browser does not permit file uploading of any kind due to serious bugs in iOS8 Safari.  Please use iOS8 Chrome until Apple fixes these issues.\"\n                },\n                retry: {\n                    enableAuto: false,\n                    maxAutoAttempts: 3,\n                    autoAttemptDelay: 5,\n                    preventRetryResponseProperty: \"preventRetry\"\n                },\n                classes: {\n                    buttonHover: \"qq-upload-button-hover\",\n                    buttonFocus: \"qq-upload-button-focus\"\n                },\n                chunking: {\n                    enabled: false,\n                    concurrent: {\n                        enabled: false\n                    },\n                    mandatory: false,\n                    paramNames: {\n                        partIndex: \"qqpartindex\",\n                        partByteOffset: \"qqpartbyteoffset\",\n                        chunkSize: \"qqchunksize\",\n                        totalFileSize: \"qqtotalfilesize\",\n                        totalParts: \"qqtotalparts\"\n                    },\n                    partSize: function(id) {\n                        return 2e6;\n                    },\n                    success: {\n                        endpoint: null,\n                        headers: function(id) {\n                            return null;\n                        },\n                        jsonPayload: false,\n                        method: \"POST\",\n                        params: function(id) {\n                            return null;\n                        },\n                        resetOnStatus: []\n                    }\n                },\n                resume: {\n                    enabled: false,\n                    recordsExpireIn: 7,\n                    paramNames: {\n                        resuming: \"qqresume\"\n                    },\n                    customKeys: function(fileId) {\n                        return [];\n                    }\n                },\n                formatFileName: function(fileOrBlobName) {\n                    return fileOrBlobName;\n                },\n                text: {\n                    defaultResponseError: \"Upload failure reason unknown\",\n                    fileInputTitle: \"file input\",\n                    sizeSymbols: [ \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\" ]\n                },\n                deleteFile: {\n                    enabled: false,\n                    method: \"DELETE\",\n                    endpoint: \"/server/upload\",\n                    customHeaders: {},\n                    params: {}\n                },\n                cors: {\n                    expected: false,\n                    sendCredentials: false,\n                    allowXdr: false\n                },\n                blobs: {\n                    defaultName: \"misc_data\"\n                },\n                paste: {\n                    targetElement: null,\n                    defaultName: \"pasted_image\"\n                },\n                camera: {\n                    ios: false,\n                    button: null\n                },\n                extraButtons: [],\n                session: {\n                    endpoint: null,\n                    params: {},\n                    customHeaders: {},\n                    refreshOnReset: true\n                },\n                form: {\n                    element: \"qq-form\",\n                    autoUpload: false,\n                    interceptSubmit: true\n                },\n                scaling: {\n                    customResizer: null,\n                    sendOriginal: true,\n                    orient: true,\n                    defaultType: null,\n                    defaultQuality: 80,\n                    failureText: \"Failed to scale\",\n                    includeExif: false,\n                    sizes: []\n                },\n                workarounds: {\n                    iosEmptyVideos: true,\n                    ios8SafariUploads: true,\n                    ios8BrowserCrash: false\n                }\n            };\n            qq.extend(this._options, o, true);\n            this._buttons = [];\n            this._extraButtonSpecs = {};\n            this._buttonIdsForFileIds = [];\n            this._wrapCallbacks();\n            this._disposeSupport = new qq.DisposeSupport();\n            this._storedIds = [];\n            this._autoRetries = [];\n            this._retryTimeouts = [];\n            this._preventRetries = [];\n            this._thumbnailUrls = [];\n            this._netUploadedOrQueued = 0;\n            this._netUploaded = 0;\n            this._uploadData = this._createUploadDataTracker();\n            this._initFormSupportAndParams();\n            this._customHeadersStore = this._createStore(this._options.request.customHeaders);\n            this._deleteFileCustomHeadersStore = this._createStore(this._options.deleteFile.customHeaders);\n            this._deleteFileParamsStore = this._createStore(this._options.deleteFile.params);\n            this._endpointStore = this._createStore(this._options.request.endpoint);\n            this._deleteFileEndpointStore = this._createStore(this._options.deleteFile.endpoint);\n            this._handler = this._createUploadHandler();\n            this._deleteHandler = qq.DeleteFileAjaxRequester && this._createDeleteHandler();\n            if (this._options.button) {\n                this._defaultButtonId = this._createUploadButton({\n                    element: this._options.button,\n                    title: this._options.text.fileInputTitle\n                }).getButtonId();\n            }\n            this._generateExtraButtonSpecs();\n            this._handleCameraAccess();\n            if (this._options.paste.targetElement) {\n                if (qq.PasteSupport) {\n                    this._pasteHandler = this._createPasteHandler();\n                } else {\n                    this.log(\"Paste support module not found\", \"error\");\n                }\n            }\n            this._options.warnBeforeUnload && this._preventLeaveInProgress();\n            this._imageGenerator = qq.ImageGenerator && new qq.ImageGenerator(qq.bind(this.log, this));\n            this._refreshSessionData();\n            this._succeededSinceLastAllComplete = [];\n            this._failedSinceLastAllComplete = [];\n            this._scaler = qq.Scaler && new qq.Scaler(this._options.scaling, qq.bind(this.log, this)) || {};\n            if (this._scaler.enabled) {\n                this._customNewFileHandler = qq.bind(this._scaler.handleNewFile, this._scaler);\n            }\n            if (qq.TotalProgress && qq.supportedFeatures.progressBar) {\n                this._totalProgress = new qq.TotalProgress(qq.bind(this._onTotalProgress, this), function(id) {\n                    var entry = self._uploadData.retrieve({\n                        id: id\n                    });\n                    return entry && entry.size || 0;\n                });\n            }\n            this._currentItemLimit = this._options.validation.itemLimit;\n            this._customResumeDataStore = this._createStore();\n        };\n        qq.FineUploaderBasic.prototype = qq.basePublicApi;\n        qq.extend(qq.FineUploaderBasic.prototype, qq.basePrivateApi);\n    })();\n    qq.AjaxRequester = function(o) {\n        \"use strict\";\n        var log, shouldParamsBeInQueryString, queue = [], requestData = {}, options = {\n            acceptHeader: null,\n            validMethods: [ \"PATCH\", \"POST\", \"PUT\" ],\n            method: \"POST\",\n            contentType: \"application/x-www-form-urlencoded\",\n            maxConnections: 3,\n            customHeaders: {},\n            endpointStore: {},\n            paramsStore: {},\n            mandatedParams: {},\n            allowXRequestedWithAndCacheControl: true,\n            successfulResponseCodes: {\n                DELETE: [ 200, 202, 204 ],\n                PATCH: [ 200, 201, 202, 203, 204 ],\n                POST: [ 200, 201, 202, 203, 204 ],\n                PUT: [ 200, 201, 202, 203, 204 ],\n                GET: [ 200 ]\n            },\n            cors: {\n                expected: false,\n                sendCredentials: false\n            },\n            log: function(str, level) {},\n            onSend: function(id) {},\n            onComplete: function(id, xhrOrXdr, isError) {},\n            onProgress: null\n        };\n        qq.extend(options, o);\n        log = options.log;\n        if (qq.indexOf(options.validMethods, options.method) < 0) {\n            throw new Error(\"'\" + options.method + \"' is not a supported method for this type of request!\");\n        }\n        function isSimpleMethod() {\n            return qq.indexOf([ \"GET\", \"POST\", \"HEAD\" ], options.method) >= 0;\n        }\n        function containsNonSimpleHeaders(headers) {\n            var containsNonSimple = false;\n            qq.each(containsNonSimple, function(idx, header) {\n                if (qq.indexOf([ \"Accept\", \"Accept-Language\", \"Content-Language\", \"Content-Type\" ], header) < 0) {\n                    containsNonSimple = true;\n                    return false;\n                }\n            });\n            return containsNonSimple;\n        }\n        function isXdr(xhr) {\n            return options.cors.expected && xhr.withCredentials === undefined;\n        }\n        function getCorsAjaxTransport() {\n            var xhrOrXdr;\n            if (window.XMLHttpRequest || window.ActiveXObject) {\n                xhrOrXdr = qq.createXhrInstance();\n                if (xhrOrXdr.withCredentials === undefined) {\n                    xhrOrXdr = new XDomainRequest();\n                    xhrOrXdr.onload = function() {};\n                    xhrOrXdr.onerror = function() {};\n                    xhrOrXdr.ontimeout = function() {};\n                    xhrOrXdr.onprogress = function() {};\n                }\n            }\n            return xhrOrXdr;\n        }\n        function getXhrOrXdr(id, suppliedXhr) {\n            var xhrOrXdr = requestData[id] && requestData[id].xhr;\n            if (!xhrOrXdr) {\n                if (suppliedXhr) {\n                    xhrOrXdr = suppliedXhr;\n                } else {\n                    if (options.cors.expected) {\n                        xhrOrXdr = getCorsAjaxTransport();\n                    } else {\n                        xhrOrXdr = qq.createXhrInstance();\n                    }\n                }\n                requestData[id].xhr = xhrOrXdr;\n            }\n            return xhrOrXdr;\n        }\n        function dequeue(id) {\n            var i = qq.indexOf(queue, id), max = options.maxConnections, nextId;\n            delete requestData[id];\n            queue.splice(i, 1);\n            if (queue.length >= max && i < max) {\n                nextId = queue[max - 1];\n                sendRequest(nextId);\n            }\n        }\n        function onComplete(id, xdrError) {\n            var xhr = getXhrOrXdr(id), method = options.method, isError = xdrError === true;\n            dequeue(id);\n            if (isError) {\n                log(method + \" request for \" + id + \" has failed\", \"error\");\n            } else if (!isXdr(xhr) && !isResponseSuccessful(xhr.status)) {\n                isError = true;\n                log(method + \" request for \" + id + \" has failed - response code \" + xhr.status, \"error\");\n            }\n            options.onComplete(id, xhr, isError);\n        }\n        function getParams(id) {\n            var onDemandParams = requestData[id].additionalParams, mandatedParams = options.mandatedParams, params;\n            if (options.paramsStore.get) {\n                params = options.paramsStore.get(id);\n            }\n            if (onDemandParams) {\n                qq.each(onDemandParams, function(name, val) {\n                    params = params || {};\n                    params[name] = val;\n                });\n            }\n            if (mandatedParams) {\n                qq.each(mandatedParams, function(name, val) {\n                    params = params || {};\n                    params[name] = val;\n                });\n            }\n            return params;\n        }\n        function sendRequest(id, optXhr) {\n            var xhr = getXhrOrXdr(id, optXhr), method = options.method, params = getParams(id), payload = requestData[id].payload, url;\n            options.onSend(id);\n            url = createUrl(id, params, requestData[id].additionalQueryParams);\n            if (isXdr(xhr)) {\n                xhr.onload = getXdrLoadHandler(id);\n                xhr.onerror = getXdrErrorHandler(id);\n            } else {\n                xhr.onreadystatechange = getXhrReadyStateChangeHandler(id);\n            }\n            registerForUploadProgress(id);\n            xhr.open(method, url, true);\n            if (options.cors.expected && options.cors.sendCredentials && !isXdr(xhr)) {\n                xhr.withCredentials = true;\n            }\n            setHeaders(id);\n            log(\"Sending \" + method + \" request for \" + id);\n            if (payload) {\n                xhr.send(payload);\n            } else if (shouldParamsBeInQueryString || !params) {\n                xhr.send();\n            } else if (params && options.contentType && options.contentType.toLowerCase().indexOf(\"application/x-www-form-urlencoded\") >= 0) {\n                xhr.send(qq.obj2url(params, \"\"));\n            } else if (params && options.contentType && options.contentType.toLowerCase().indexOf(\"application/json\") >= 0) {\n                xhr.send(JSON.stringify(params));\n            } else {\n                xhr.send(params);\n            }\n            return xhr;\n        }\n        function createUrl(id, params, additionalQueryParams) {\n            var endpoint = options.endpointStore.get(id), addToPath = requestData[id].addToPath;\n            if (addToPath != undefined) {\n                endpoint += \"/\" + addToPath;\n            }\n            if (shouldParamsBeInQueryString && params) {\n                endpoint = qq.obj2url(params, endpoint);\n            }\n            if (additionalQueryParams) {\n                endpoint = qq.obj2url(additionalQueryParams, endpoint);\n            }\n            return endpoint;\n        }\n        function getXhrReadyStateChangeHandler(id) {\n            return function() {\n                if (getXhrOrXdr(id).readyState === 4) {\n                    onComplete(id);\n                }\n            };\n        }\n        function registerForUploadProgress(id) {\n            var onProgress = options.onProgress;\n            if (onProgress) {\n                getXhrOrXdr(id).upload.onprogress = function(e) {\n                    if (e.lengthComputable) {\n                        onProgress(id, e.loaded, e.total);\n                    }\n                };\n            }\n        }\n        function getXdrLoadHandler(id) {\n            return function() {\n                onComplete(id);\n            };\n        }\n        function getXdrErrorHandler(id) {\n            return function() {\n                onComplete(id, true);\n            };\n        }\n        function setHeaders(id) {\n            var xhr = getXhrOrXdr(id), customHeaders = options.customHeaders, onDemandHeaders = requestData[id].additionalHeaders || {}, method = options.method, allHeaders = {};\n            if (!isXdr(xhr)) {\n                options.acceptHeader && xhr.setRequestHeader(\"Accept\", options.acceptHeader);\n                if (options.allowXRequestedWithAndCacheControl) {\n                    if (!options.cors.expected || (!isSimpleMethod() || containsNonSimpleHeaders(customHeaders))) {\n                        xhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n                        xhr.setRequestHeader(\"Cache-Control\", \"no-cache\");\n                    }\n                }\n                if (options.contentType && (method === \"POST\" || method === \"PUT\")) {\n                    xhr.setRequestHeader(\"Content-Type\", options.contentType);\n                }\n                qq.extend(allHeaders, qq.isFunction(customHeaders) ? customHeaders(id) : customHeaders);\n                qq.extend(allHeaders, onDemandHeaders);\n                qq.each(allHeaders, function(name, val) {\n                    xhr.setRequestHeader(name, val);\n                });\n            }\n        }\n        function isResponseSuccessful(responseCode) {\n            return qq.indexOf(options.successfulResponseCodes[options.method], responseCode) >= 0;\n        }\n        function prepareToSend(id, optXhr, addToPath, additionalParams, additionalQueryParams, additionalHeaders, payload) {\n            requestData[id] = {\n                addToPath: addToPath,\n                additionalParams: additionalParams,\n                additionalQueryParams: additionalQueryParams,\n                additionalHeaders: additionalHeaders,\n                payload: payload\n            };\n            var len = queue.push(id);\n            if (len <= options.maxConnections) {\n                return sendRequest(id, optXhr);\n            }\n        }\n        shouldParamsBeInQueryString = options.method === \"GET\" || options.method === \"DELETE\";\n        qq.extend(this, {\n            initTransport: function(id) {\n                var path, params, headers, payload, cacheBuster, additionalQueryParams;\n                return {\n                    withPath: function(appendToPath) {\n                        path = appendToPath;\n                        return this;\n                    },\n                    withParams: function(additionalParams) {\n                        params = additionalParams;\n                        return this;\n                    },\n                    withQueryParams: function(_additionalQueryParams_) {\n                        additionalQueryParams = _additionalQueryParams_;\n                        return this;\n                    },\n                    withHeaders: function(additionalHeaders) {\n                        headers = additionalHeaders;\n                        return this;\n                    },\n                    withPayload: function(thePayload) {\n                        payload = thePayload;\n                        return this;\n                    },\n                    withCacheBuster: function() {\n                        cacheBuster = true;\n                        return this;\n                    },\n                    send: function(optXhr) {\n                        if (cacheBuster && qq.indexOf([ \"GET\", \"DELETE\" ], options.method) >= 0) {\n                            params.qqtimestamp = new Date().getTime();\n                        }\n                        return prepareToSend(id, optXhr, path, params, additionalQueryParams, headers, payload);\n                    }\n                };\n            },\n            canceled: function(id) {\n                dequeue(id);\n            }\n        });\n    };\n    qq.UploadHandler = function(spec) {\n        \"use strict\";\n        var proxy = spec.proxy, fileState = {}, onCancel = proxy.onCancel, getName = proxy.getName;\n        qq.extend(this, {\n            add: function(id, fileItem) {\n                fileState[id] = fileItem;\n                fileState[id].temp = {};\n            },\n            cancel: function(id) {\n                var self = this, cancelFinalizationEffort = new qq.Promise(), onCancelRetVal = onCancel(id, getName(id), cancelFinalizationEffort);\n                onCancelRetVal.then(function() {\n                    if (self.isValid(id)) {\n                        fileState[id].canceled = true;\n                        self.expunge(id);\n                    }\n                    cancelFinalizationEffort.success();\n                });\n            },\n            expunge: function(id) {\n                delete fileState[id];\n            },\n            getThirdPartyFileId: function(id) {\n                return fileState[id].key;\n            },\n            isValid: function(id) {\n                return fileState[id] !== undefined;\n            },\n            reset: function() {\n                fileState = {};\n            },\n            _getFileState: function(id) {\n                return fileState[id];\n            },\n            _setThirdPartyFileId: function(id, thirdPartyFileId) {\n                fileState[id].key = thirdPartyFileId;\n            },\n            _wasCanceled: function(id) {\n                return !!fileState[id].canceled;\n            }\n        });\n    };\n    qq.UploadHandlerController = function(o, namespace) {\n        \"use strict\";\n        var controller = this, chunkingPossible = false, concurrentChunkingPossible = false, chunking, preventRetryResponse, log, handler, options = {\n            paramsStore: {},\n            maxConnections: 3,\n            chunking: {\n                enabled: false,\n                multiple: {\n                    enabled: false\n                }\n            },\n            log: function(str, level) {},\n            onProgress: function(id, fileName, loaded, total) {},\n            onComplete: function(id, fileName, response, xhr) {},\n            onCancel: function(id, fileName) {},\n            onUploadPrep: function(id) {},\n            onUpload: function(id, fileName) {},\n            onUploadChunk: function(id, fileName, chunkData) {},\n            onUploadChunkSuccess: function(id, chunkData, response, xhr) {},\n            onAutoRetry: function(id, fileName, response, xhr) {},\n            onResume: function(id, fileName, chunkData, customResumeData) {},\n            onUuidChanged: function(id, newUuid) {},\n            getName: function(id) {},\n            setSize: function(id, newSize) {},\n            isQueued: function(id) {},\n            getIdsInProxyGroup: function(id) {},\n            getIdsInBatch: function(id) {},\n            isInProgress: function(id) {}\n        }, chunked = {\n            done: function(id, chunkIdx, response, xhr) {\n                var chunkData = handler._getChunkData(id, chunkIdx);\n                handler._getFileState(id).attemptingResume = false;\n                delete handler._getFileState(id).temp.chunkProgress[chunkIdx];\n                handler._getFileState(id).loaded += chunkData.size;\n                options.onUploadChunkSuccess(id, handler._getChunkDataForCallback(chunkData), response, xhr);\n            },\n            finalize: function(id) {\n                var size = options.getSize(id), name = options.getName(id);\n                log(\"All chunks have been uploaded for \" + id + \" - finalizing....\");\n                handler.finalizeChunks(id).then(function(response, xhr) {\n                    log(\"Finalize successful for \" + id);\n                    var normaizedResponse = upload.normalizeResponse(response, true);\n                    options.onProgress(id, name, size, size);\n                    handler._maybeDeletePersistedChunkData(id);\n                    upload.cleanup(id, normaizedResponse, xhr);\n                }, function(response, xhr) {\n                    var normalizedResponse = upload.normalizeResponse(response, false);\n                    log(\"Problem finalizing chunks for file ID \" + id + \" - \" + normalizedResponse.error, \"error\");\n                    if (normalizedResponse.reset || xhr && options.chunking.success.resetOnStatus.indexOf(xhr.status) >= 0) {\n                        chunked.reset(id);\n                    }\n                    if (!options.onAutoRetry(id, name, normalizedResponse, xhr)) {\n                        upload.cleanup(id, normalizedResponse, xhr);\n                    }\n                });\n            },\n            handleFailure: function(chunkIdx, id, response, xhr) {\n                var name = options.getName(id);\n                log(\"Chunked upload request failed for \" + id + \", chunk \" + chunkIdx);\n                handler.clearCachedChunk(id, chunkIdx);\n                var responseToReport = upload.normalizeResponse(response, false), inProgressIdx;\n                if (responseToReport.reset) {\n                    chunked.reset(id);\n                } else {\n                    var inProgressChunksArray = handler._getFileState(id).chunking.inProgress;\n                    inProgressIdx = inProgressChunksArray ? qq.indexOf(inProgressChunksArray, chunkIdx) : -1;\n                    if (inProgressIdx >= 0) {\n                        handler._getFileState(id).chunking.inProgress.splice(inProgressIdx, 1);\n                        handler._getFileState(id).chunking.remaining.unshift(chunkIdx);\n                    }\n                }\n                if (!handler._getFileState(id).temp.ignoreFailure) {\n                    if (concurrentChunkingPossible) {\n                        handler._getFileState(id).temp.ignoreFailure = true;\n                        log(qq.format(\"Going to attempt to abort these chunks: {}. These are currently in-progress: {}.\", JSON.stringify(Object.keys(handler._getXhrs(id))), JSON.stringify(handler._getFileState(id).chunking.inProgress)));\n                        qq.each(handler._getXhrs(id), function(ckid, ckXhr) {\n                            log(qq.format(\"Attempting to abort file {}.{}. XHR readyState {}. \", id, ckid, ckXhr.readyState));\n                            ckXhr.abort();\n                            ckXhr._cancelled = true;\n                        });\n                        handler.moveInProgressToRemaining(id);\n                        connectionManager.free(id, true);\n                    }\n                    if (!options.onAutoRetry(id, name, responseToReport, xhr)) {\n                        upload.cleanup(id, responseToReport, xhr);\n                    }\n                }\n            },\n            hasMoreParts: function(id) {\n                return !!handler._getFileState(id).chunking.remaining.length;\n            },\n            nextPart: function(id) {\n                var nextIdx = handler._getFileState(id).chunking.remaining.shift();\n                if (nextIdx >= handler._getTotalChunks(id)) {\n                    nextIdx = null;\n                }\n                return nextIdx;\n            },\n            reset: function(id) {\n                log(\"Server or callback has ordered chunking effort to be restarted on next attempt for item ID \" + id, \"error\");\n                handler._maybeDeletePersistedChunkData(id);\n                handler.reevaluateChunking(id);\n                handler._getFileState(id).loaded = 0;\n                handler._getFileState(id).attemptingResume = false;\n            },\n            sendNext: function(id) {\n                var size = options.getSize(id), name = options.getName(id), chunkIdx = chunked.nextPart(id), chunkData = handler._getChunkData(id, chunkIdx), fileState = handler._getFileState(id), resuming = fileState.attemptingResume, inProgressChunks = fileState.chunking.inProgress || [];\n                if (fileState.loaded == null) {\n                    fileState.loaded = 0;\n                }\n                if (resuming && options.onResume(id, name, chunkData, fileState.customResumeData) === false) {\n                    chunked.reset(id);\n                    chunkIdx = chunked.nextPart(id);\n                    chunkData = handler._getChunkData(id, chunkIdx);\n                    resuming = false;\n                }\n                if (chunkIdx == null && inProgressChunks.length === 0) {\n                    chunked.finalize(id);\n                } else {\n                    inProgressChunks.push(chunkIdx);\n                    handler._getFileState(id).chunking.inProgress = inProgressChunks;\n                    if (concurrentChunkingPossible) {\n                        connectionManager.open(id, chunkIdx);\n                    }\n                    if (concurrentChunkingPossible && connectionManager.available() && handler._getFileState(id).chunking.remaining.length) {\n                        chunked.sendNext(id);\n                    }\n                    if (chunkData.blob.size === 0) {\n                        log(qq.format(\"Chunk {} for file {} will not be uploaded, zero sized chunk.\", chunkIdx, id), \"error\");\n                        chunked.handleFailure(chunkIdx, id, \"File is no longer available\", null);\n                    }\n                    var onUploadChunkPromise = options.onUploadChunk(id, name, handler._getChunkDataForCallback(chunkData));\n                    onUploadChunkPromise.then(function(requestOverrides) {\n                        if (!options.isInProgress(id)) {\n                            log(qq.format(\"Not sending chunked upload request for item {}.{} - no longer in progress.\", id, chunkIdx));\n                        } else {\n                            log(qq.format(\"Sending chunked upload request for item {}.{}, bytes {}-{} of {}.\", id, chunkIdx, chunkData.start + 1, chunkData.end, size));\n                            var uploadChunkData = {\n                                chunkIdx: chunkIdx,\n                                id: id,\n                                overrides: requestOverrides,\n                                resuming: resuming\n                            };\n                            handler.uploadChunk(uploadChunkData).then(function success(response, xhr) {\n                                log(\"Chunked upload request succeeded for \" + id + \", chunk \" + chunkIdx);\n                                handler.clearCachedChunk(id, chunkIdx);\n                                var inProgressChunks = handler._getFileState(id).chunking.inProgress || [], responseToReport = upload.normalizeResponse(response, true), inProgressChunkIdx = qq.indexOf(inProgressChunks, chunkIdx);\n                                log(qq.format(\"Chunk {} for file {} uploaded successfully.\", chunkIdx, id));\n                                chunked.done(id, chunkIdx, responseToReport, xhr);\n                                if (inProgressChunkIdx >= 0) {\n                                    inProgressChunks.splice(inProgressChunkIdx, 1);\n                                }\n                                handler._maybePersistChunkedState(id);\n                                if (!chunked.hasMoreParts(id) && inProgressChunks.length === 0) {\n                                    chunked.finalize(id);\n                                } else if (chunked.hasMoreParts(id)) {\n                                    chunked.sendNext(id);\n                                } else {\n                                    log(qq.format(\"File ID {} has no more chunks to send and these chunk indexes are still marked as in-progress: {}\", id, JSON.stringify(inProgressChunks)));\n                                }\n                            }, function failure(response, xhr) {\n                                chunked.handleFailure(chunkIdx, id, response, xhr);\n                            }).done(function() {\n                                handler.clearXhr(id, chunkIdx);\n                            });\n                        }\n                    }, function(error) {\n                        chunked.handleFailure(chunkIdx, id, error, null);\n                    });\n                }\n            }\n        }, connectionManager = {\n            _open: [],\n            _openChunks: {},\n            _waiting: [],\n            available: function() {\n                var max = options.maxConnections, openChunkEntriesCount = 0, openChunksCount = 0;\n                qq.each(connectionManager._openChunks, function(fileId, openChunkIndexes) {\n                    openChunkEntriesCount++;\n                    openChunksCount += openChunkIndexes.length;\n                });\n                return max - (connectionManager._open.length - openChunkEntriesCount + openChunksCount);\n            },\n            free: function(id, dontAllowNext) {\n                var allowNext = !dontAllowNext, waitingIndex = qq.indexOf(connectionManager._waiting, id), connectionsIndex = qq.indexOf(connectionManager._open, id), nextId;\n                delete connectionManager._openChunks[id];\n                if (upload.getProxyOrBlob(id) instanceof qq.BlobProxy) {\n                    log(\"Generated blob upload has ended for \" + id + \", disposing generated blob.\");\n                    delete handler._getFileState(id).file;\n                }\n                if (waitingIndex >= 0) {\n                    connectionManager._waiting.splice(waitingIndex, 1);\n                } else if (allowNext && connectionsIndex >= 0) {\n                    connectionManager._open.splice(connectionsIndex, 1);\n                    nextId = connectionManager._waiting.shift();\n                    if (nextId >= 0) {\n                        connectionManager._open.push(nextId);\n                        upload.start(nextId);\n                    }\n                }\n            },\n            getWaitingOrConnected: function() {\n                var waitingOrConnected = [];\n                qq.each(connectionManager._openChunks, function(fileId, chunks) {\n                    if (chunks && chunks.length) {\n                        waitingOrConnected.push(parseInt(fileId));\n                    }\n                });\n                qq.each(connectionManager._open, function(idx, fileId) {\n                    if (!connectionManager._openChunks[fileId]) {\n                        waitingOrConnected.push(parseInt(fileId));\n                    }\n                });\n                waitingOrConnected = waitingOrConnected.concat(connectionManager._waiting);\n                return waitingOrConnected;\n            },\n            isUsingConnection: function(id) {\n                return qq.indexOf(connectionManager._open, id) >= 0;\n            },\n            open: function(id, chunkIdx) {\n                if (chunkIdx == null) {\n                    connectionManager._waiting.push(id);\n                }\n                if (connectionManager.available()) {\n                    if (chunkIdx == null) {\n                        connectionManager._waiting.pop();\n                        connectionManager._open.push(id);\n                    } else {\n                        (function() {\n                            var openChunksEntry = connectionManager._openChunks[id] || [];\n                            openChunksEntry.push(chunkIdx);\n                            connectionManager._openChunks[id] = openChunksEntry;\n                        })();\n                    }\n                    return true;\n                }\n                return false;\n            },\n            reset: function() {\n                connectionManager._waiting = [];\n                connectionManager._open = [];\n            }\n        }, simple = {\n            send: function(id, name) {\n                var fileState = handler._getFileState(id);\n                if (!fileState) {\n                    log(\"Ignoring send request as this upload may have been cancelled, File ID \" + id, \"warn\");\n                    return;\n                }\n                fileState.loaded = 0;\n                log(\"Sending simple upload request for \" + id);\n                handler.uploadFile(id).then(function(response, optXhr) {\n                    log(\"Simple upload request succeeded for \" + id);\n                    var responseToReport = upload.normalizeResponse(response, true), size = options.getSize(id);\n                    options.onProgress(id, name, size, size);\n                    upload.maybeNewUuid(id, responseToReport);\n                    upload.cleanup(id, responseToReport, optXhr);\n                }, function(response, optXhr) {\n                    log(\"Simple upload request failed for \" + id);\n                    var responseToReport = upload.normalizeResponse(response, false);\n                    if (!options.onAutoRetry(id, name, responseToReport, optXhr)) {\n                        upload.cleanup(id, responseToReport, optXhr);\n                    }\n                });\n            }\n        }, upload = {\n            cancel: function(id) {\n                log(\"Cancelling \" + id);\n                options.paramsStore.remove(id);\n                connectionManager.free(id);\n            },\n            cleanup: function(id, response, optXhr) {\n                var name = options.getName(id);\n                options.onComplete(id, name, response, optXhr);\n                if (handler._getFileState(id)) {\n                    handler._clearXhrs && handler._clearXhrs(id);\n                }\n                connectionManager.free(id);\n            },\n            getProxyOrBlob: function(id) {\n                return handler.getProxy && handler.getProxy(id) || handler.getFile && handler.getFile(id);\n            },\n            initHandler: function() {\n                var handlerType = namespace ? qq[namespace] : qq.traditional, handlerModuleSubtype = qq.supportedFeatures.ajaxUploading ? \"Xhr\" : \"Form\";\n                handler = new handlerType[handlerModuleSubtype + \"UploadHandler\"](options, {\n                    getCustomResumeData: options.getCustomResumeData,\n                    getDataByUuid: options.getDataByUuid,\n                    getName: options.getName,\n                    getSize: options.getSize,\n                    getUuid: options.getUuid,\n                    log: log,\n                    onCancel: options.onCancel,\n                    onProgress: options.onProgress,\n                    onUuidChanged: options.onUuidChanged,\n                    onFinalizing: function(id) {\n                        options.setStatus(id, qq.status.UPLOAD_FINALIZING);\n                    }\n                });\n                if (handler._removeExpiredChunkingRecords) {\n                    handler._removeExpiredChunkingRecords();\n                }\n            },\n            isDeferredEligibleForUpload: function(id) {\n                return options.isQueued(id);\n            },\n            maybeDefer: function(id, blob) {\n                if (blob && !handler.getFile(id) && blob instanceof qq.BlobProxy) {\n                    options.onUploadPrep(id);\n                    log(\"Attempting to generate a blob on-demand for \" + id);\n                    blob.create().then(function(generatedBlob) {\n                        log(\"Generated an on-demand blob for \" + id);\n                        handler.updateBlob(id, generatedBlob);\n                        options.setSize(id, generatedBlob.size);\n                        handler.reevaluateChunking(id);\n                        upload.maybeSendDeferredFiles(id);\n                    }, function(errorMessage) {\n                        var errorResponse = {};\n                        if (errorMessage) {\n                            errorResponse.error = errorMessage;\n                        }\n                        log(qq.format(\"Failed to generate blob for ID {}.  Error message: {}.\", id, errorMessage), \"error\");\n                        options.onComplete(id, options.getName(id), qq.extend(errorResponse, preventRetryResponse), null);\n                        upload.maybeSendDeferredFiles(id);\n                        connectionManager.free(id);\n                    });\n                } else {\n                    return upload.maybeSendDeferredFiles(id);\n                }\n                return false;\n            },\n            maybeSendDeferredFiles: function(id) {\n                var idsInGroup = options.getIdsInProxyGroup(id), uploadedThisId = false;\n                if (idsInGroup && idsInGroup.length) {\n                    log(\"Maybe ready to upload proxy group file \" + id);\n                    qq.each(idsInGroup, function(idx, idInGroup) {\n                        if (upload.isDeferredEligibleForUpload(idInGroup) && !!handler.getFile(idInGroup)) {\n                            uploadedThisId = idInGroup === id;\n                            upload.now(idInGroup);\n                        } else if (upload.isDeferredEligibleForUpload(idInGroup)) {\n                            return false;\n                        }\n                    });\n                } else {\n                    uploadedThisId = true;\n                    upload.now(id);\n                }\n                return uploadedThisId;\n            },\n            maybeNewUuid: function(id, response) {\n                if (response.newUuid !== undefined) {\n                    options.onUuidChanged(id, response.newUuid);\n                }\n            },\n            normalizeResponse: function(originalResponse, successful) {\n                var response = originalResponse;\n                if (!qq.isObject(originalResponse)) {\n                    response = {};\n                    if (qq.isString(originalResponse) && !successful) {\n                        response.error = originalResponse;\n                    }\n                }\n                response.success = successful;\n                return response;\n            },\n            now: function(id) {\n                var name = options.getName(id);\n                if (!controller.isValid(id)) {\n                    throw new qq.Error(id + \" is not a valid file ID to upload!\");\n                }\n                options.onUpload(id, name).then(function(response) {\n                    if (response && response.pause) {\n                        options.setStatus(id, qq.status.PAUSED);\n                        handler.pause(id);\n                        connectionManager.free(id);\n                    } else {\n                        if (chunkingPossible && handler._shouldChunkThisFile(id)) {\n                            chunked.sendNext(id);\n                        } else {\n                            simple.send(id, name);\n                        }\n                    }\n                }, function(error) {\n                    error = error || {};\n                    log(id + \" upload start aborted due to rejected onUpload Promise - details: \" + error, \"error\");\n                    if (!options.onAutoRetry(id, name, error.responseJSON || {})) {\n                        var response = upload.normalizeResponse(error.responseJSON, false);\n                        upload.cleanup(id, response);\n                    }\n                });\n            },\n            start: function(id) {\n                var blobToUpload = upload.getProxyOrBlob(id);\n                if (blobToUpload) {\n                    return upload.maybeDefer(id, blobToUpload);\n                } else {\n                    upload.now(id);\n                    return true;\n                }\n            }\n        };\n        qq.extend(this, {\n            add: function(id, file) {\n                handler.add.apply(this, arguments);\n            },\n            upload: function(id) {\n                if (connectionManager.open(id)) {\n                    return upload.start(id);\n                }\n                return false;\n            },\n            retry: function(id) {\n                if (concurrentChunkingPossible) {\n                    handler._getFileState(id).temp.ignoreFailure = false;\n                }\n                if (connectionManager.isUsingConnection(id)) {\n                    return upload.start(id);\n                } else {\n                    return controller.upload(id);\n                }\n            },\n            cancel: function(id) {\n                var cancelRetVal = handler.cancel(id);\n                if (qq.isGenericPromise(cancelRetVal)) {\n                    cancelRetVal.then(function() {\n                        upload.cancel(id);\n                    });\n                } else if (cancelRetVal !== false) {\n                    upload.cancel(id);\n                }\n            },\n            cancelAll: function() {\n                var waitingOrConnected = connectionManager.getWaitingOrConnected(), i;\n                if (waitingOrConnected.length) {\n                    for (i = waitingOrConnected.length - 1; i >= 0; i--) {\n                        controller.cancel(waitingOrConnected[i]);\n                    }\n                }\n                connectionManager.reset();\n            },\n            getFile: function(id) {\n                if (handler.getProxy && handler.getProxy(id)) {\n                    return handler.getProxy(id).referenceBlob;\n                }\n                return handler.getFile && handler.getFile(id);\n            },\n            isProxied: function(id) {\n                return !!(handler.getProxy && handler.getProxy(id));\n            },\n            getInput: function(id) {\n                if (handler.getInput) {\n                    return handler.getInput(id);\n                }\n            },\n            reset: function() {\n                log(\"Resetting upload handler\");\n                controller.cancelAll();\n                connectionManager.reset();\n                handler.reset();\n            },\n            expunge: function(id) {\n                if (controller.isValid(id)) {\n                    return handler.expunge(id);\n                }\n            },\n            isValid: function(id) {\n                return handler.isValid(id);\n            },\n            hasResumeRecord: function(id) {\n                var key = handler.isValid(id) && handler._getLocalStorageId && handler._getLocalStorageId(id);\n                if (key) {\n                    return !!localStorage.getItem(key);\n                }\n                return false;\n            },\n            getResumableFilesData: function() {\n                if (handler.getResumableFilesData) {\n                    return handler.getResumableFilesData();\n                }\n                return [];\n            },\n            getThirdPartyFileId: function(id) {\n                if (controller.isValid(id)) {\n                    return handler.getThirdPartyFileId(id);\n                }\n            },\n            pause: function(id) {\n                if (controller.isResumable(id) && handler.pause && controller.isValid(id) && handler.pause(id)) {\n                    connectionManager.free(id);\n                    handler.moveInProgressToRemaining(id);\n                    return true;\n                }\n                return false;\n            },\n            isAttemptingResume: function(id) {\n                return !!handler.isAttemptingResume && handler.isAttemptingResume(id);\n            },\n            isResumable: function(id) {\n                return !!handler.isResumable && handler.isResumable(id);\n            }\n        });\n        qq.extend(options, o);\n        log = options.log;\n        chunkingPossible = options.chunking.enabled && qq.supportedFeatures.chunking;\n        concurrentChunkingPossible = chunkingPossible && options.chunking.concurrent.enabled;\n        preventRetryResponse = function() {\n            var response = {};\n            response[options.preventRetryParam] = true;\n            return response;\n        }();\n        upload.initHandler();\n    };\n    qq.WindowReceiveMessage = function(o) {\n        \"use strict\";\n        var options = {\n            log: function(message, level) {}\n        }, callbackWrapperDetachers = {};\n        qq.extend(options, o);\n        qq.extend(this, {\n            receiveMessage: function(id, callback) {\n                var onMessageCallbackWrapper = function(event) {\n                    callback(event.data);\n                };\n                if (window.postMessage) {\n                    callbackWrapperDetachers[id] = qq(window).attach(\"message\", onMessageCallbackWrapper);\n                } else {\n                    log(\"iframe message passing not supported in this browser!\", \"error\");\n                }\n            },\n            stopReceivingMessages: function(id) {\n                if (window.postMessage) {\n                    var detacher = callbackWrapperDetachers[id];\n                    if (detacher) {\n                        detacher();\n                    }\n                }\n            }\n        });\n    };\n    qq.FormUploadHandler = function(spec) {\n        \"use strict\";\n        var options = spec.options, handler = this, proxy = spec.proxy, formHandlerInstanceId = qq.getUniqueId(), onloadCallbacks = {}, detachLoadEvents = {}, postMessageCallbackTimers = {}, isCors = options.isCors, inputName = options.inputName, getUuid = proxy.getUuid, log = proxy.log, corsMessageReceiver = new qq.WindowReceiveMessage({\n            log: log\n        });\n        function expungeFile(id) {\n            delete detachLoadEvents[id];\n            if (isCors) {\n                clearTimeout(postMessageCallbackTimers[id]);\n                delete postMessageCallbackTimers[id];\n                corsMessageReceiver.stopReceivingMessages(id);\n            }\n            var iframe = document.getElementById(handler._getIframeName(id));\n            if (iframe) {\n                iframe.setAttribute(\"src\", \"javascript:false;\");\n                qq(iframe).remove();\n            }\n        }\n        function getFileIdForIframeName(iframeName) {\n            return iframeName.split(\"_\")[0];\n        }\n        function initIframeForUpload(name) {\n            var iframe = qq.toElement(\"<iframe src='javascript:false;' name='\" + name + \"' />\");\n            iframe.setAttribute(\"id\", name);\n            iframe.style.display = \"none\";\n            document.body.appendChild(iframe);\n            return iframe;\n        }\n        function registerPostMessageCallback(iframe, callback) {\n            var iframeName = iframe.id, fileId = getFileIdForIframeName(iframeName), uuid = getUuid(fileId);\n            onloadCallbacks[uuid] = callback;\n            detachLoadEvents[fileId] = qq(iframe).attach(\"load\", function() {\n                if (handler.getInput(fileId)) {\n                    log(\"Received iframe load event for CORS upload request (iframe name \" + iframeName + \")\");\n                    postMessageCallbackTimers[iframeName] = setTimeout(function() {\n                        var errorMessage = \"No valid message received from loaded iframe for iframe name \" + iframeName;\n                        log(errorMessage, \"error\");\n                        callback({\n                            error: errorMessage\n                        });\n                    }, 1e3);\n                }\n            });\n            corsMessageReceiver.receiveMessage(iframeName, function(message) {\n                log(\"Received the following window message: '\" + message + \"'\");\n                var fileId = getFileIdForIframeName(iframeName), response = handler._parseJsonResponse(message), uuid = response.uuid, onloadCallback;\n                if (uuid && onloadCallbacks[uuid]) {\n                    log(\"Handling response for iframe name \" + iframeName);\n                    clearTimeout(postMessageCallbackTimers[iframeName]);\n                    delete postMessageCallbackTimers[iframeName];\n                    handler._detachLoadEvent(iframeName);\n                    onloadCallback = onloadCallbacks[uuid];\n                    delete onloadCallbacks[uuid];\n                    corsMessageReceiver.stopReceivingMessages(iframeName);\n                    onloadCallback(response);\n                } else if (!uuid) {\n                    log(\"'\" + message + \"' does not contain a UUID - ignoring.\");\n                }\n            });\n        }\n        qq.extend(this, new qq.UploadHandler(spec));\n        qq.override(this, function(super_) {\n            return {\n                add: function(id, fileInput) {\n                    super_.add(id, {\n                        input: fileInput\n                    });\n                    fileInput.setAttribute(\"name\", inputName);\n                    if (fileInput.parentNode) {\n                        qq(fileInput).remove();\n                    }\n                },\n                expunge: function(id) {\n                    expungeFile(id);\n                    super_.expunge(id);\n                },\n                isValid: function(id) {\n                    return super_.isValid(id) && handler._getFileState(id).input !== undefined;\n                }\n            };\n        });\n        qq.extend(this, {\n            getInput: function(id) {\n                return handler._getFileState(id).input;\n            },\n            _attachLoadEvent: function(iframe, callback) {\n                var responseDescriptor;\n                if (isCors) {\n                    registerPostMessageCallback(iframe, callback);\n                } else {\n                    detachLoadEvents[iframe.id] = qq(iframe).attach(\"load\", function() {\n                        log(\"Received response for \" + iframe.id);\n                        if (!iframe.parentNode) {\n                            return;\n                        }\n                        try {\n                            if (iframe.contentDocument && iframe.contentDocument.body && iframe.contentDocument.body.innerHTML == \"false\") {\n                                return;\n                            }\n                        } catch (error) {\n                            log(\"Error when attempting to access iframe during handling of upload response (\" + error.message + \")\", \"error\");\n                            responseDescriptor = {\n                                success: false\n                            };\n                        }\n                        callback(responseDescriptor);\n                    });\n                }\n            },\n            _createIframe: function(id) {\n                var iframeName = handler._getIframeName(id);\n                return initIframeForUpload(iframeName);\n            },\n            _detachLoadEvent: function(id) {\n                if (detachLoadEvents[id] !== undefined) {\n                    detachLoadEvents[id]();\n                    delete detachLoadEvents[id];\n                }\n            },\n            _getIframeName: function(fileId) {\n                return fileId + \"_\" + formHandlerInstanceId;\n            },\n            _initFormForUpload: function(spec) {\n                var method = spec.method, endpoint = spec.endpoint, params = spec.params, paramsInBody = spec.paramsInBody, targetName = spec.targetName, form = qq.toElement(\"<form method='\" + method + \"' enctype='multipart/form-data'></form>\"), url = endpoint;\n                if (paramsInBody) {\n                    qq.obj2Inputs(params, form);\n                } else {\n                    url = qq.obj2url(params, endpoint);\n                }\n                form.setAttribute(\"action\", url);\n                form.setAttribute(\"target\", targetName);\n                form.style.display = \"none\";\n                document.body.appendChild(form);\n                return form;\n            },\n            _parseJsonResponse: function(innerHtmlOrMessage) {\n                var response = {};\n                try {\n                    response = qq.parseJson(innerHtmlOrMessage);\n                } catch (error) {\n                    log(\"Error when attempting to parse iframe upload response (\" + error.message + \")\", \"error\");\n                }\n                return response;\n            }\n        });\n    };\n    qq.XhrUploadHandler = function(spec) {\n        \"use strict\";\n        var handler = this, namespace = spec.options.namespace, proxy = spec.proxy, chunking = spec.options.chunking, getChunkSize = function(id) {\n            var fileState = handler._getFileState(id);\n            if (fileState.chunkSize) {\n                return fileState.chunkSize;\n            } else {\n                var chunkSize = chunking.partSize;\n                if (qq.isFunction(chunkSize)) {\n                    chunkSize = chunkSize(id, getSize(id));\n                }\n                fileState.chunkSize = chunkSize;\n                return chunkSize;\n            }\n        }, resume = spec.options.resume, chunkFiles = chunking && spec.options.chunking.enabled && qq.supportedFeatures.chunking, resumeEnabled = resume && spec.options.resume.enabled && chunkFiles && qq.supportedFeatures.resume, getName = proxy.getName, getSize = proxy.getSize, getUuid = proxy.getUuid, getEndpoint = proxy.getEndpoint, getDataByUuid = proxy.getDataByUuid, onUuidChanged = proxy.onUuidChanged, onProgress = proxy.onProgress, log = proxy.log, getCustomResumeData = proxy.getCustomResumeData;\n        function abort(id) {\n            qq.each(handler._getXhrs(id), function(xhrId, xhr) {\n                var ajaxRequester = handler._getAjaxRequester(id, xhrId);\n                xhr.onreadystatechange = null;\n                xhr.upload.onprogress = null;\n                xhr.abort();\n                ajaxRequester && ajaxRequester.canceled && ajaxRequester.canceled(id);\n            });\n        }\n        qq.extend(this, new qq.UploadHandler(spec));\n        qq.override(this, function(super_) {\n            return {\n                add: function(id, blobOrProxy) {\n                    if (qq.isFile(blobOrProxy) || qq.isBlob(blobOrProxy)) {\n                        super_.add(id, {\n                            file: blobOrProxy\n                        });\n                    } else if (blobOrProxy instanceof qq.BlobProxy) {\n                        super_.add(id, {\n                            proxy: blobOrProxy\n                        });\n                    } else {\n                        throw new Error(\"Passed obj is not a File, Blob, or proxy\");\n                    }\n                    handler._initTempState(id);\n                    resumeEnabled && handler._maybePrepareForResume(id);\n                },\n                expunge: function(id) {\n                    abort(id);\n                    handler._maybeDeletePersistedChunkData(id);\n                    handler._clearXhrs(id);\n                    super_.expunge(id);\n                }\n            };\n        });\n        qq.extend(this, {\n            clearCachedChunk: function(id, chunkIdx) {\n                var fileState = handler._getFileState(id);\n                if (fileState) {\n                    delete fileState.temp.cachedChunks[chunkIdx];\n                }\n            },\n            clearXhr: function(id, chunkIdx) {\n                var tempState = handler._getFileState(id).temp;\n                if (tempState.xhrs) {\n                    delete tempState.xhrs[chunkIdx];\n                }\n                if (tempState.ajaxRequesters) {\n                    delete tempState.ajaxRequesters[chunkIdx];\n                }\n            },\n            finalizeChunks: function(id, responseParser) {\n                var lastChunkIdx = handler._getTotalChunks(id) - 1, xhr = handler._getXhr(id, lastChunkIdx);\n                if (responseParser) {\n                    return new qq.Promise().success(responseParser(xhr), xhr);\n                }\n                return new qq.Promise().success({}, xhr);\n            },\n            getFile: function(id) {\n                return handler.isValid(id) && handler._getFileState(id).file;\n            },\n            getProxy: function(id) {\n                return handler.isValid(id) && handler._getFileState(id).proxy;\n            },\n            getResumableFilesData: function() {\n                var resumableFilesData = [];\n                handler._iterateResumeRecords(function(key, uploadData) {\n                    handler.moveInProgressToRemaining(null, uploadData.chunking.inProgress, uploadData.chunking.remaining);\n                    var data = {\n                        name: uploadData.name,\n                        remaining: uploadData.chunking.remaining,\n                        size: uploadData.size,\n                        uuid: uploadData.uuid\n                    };\n                    if (uploadData.key) {\n                        data.key = uploadData.key;\n                    }\n                    if (uploadData.customResumeData) {\n                        data.customResumeData = uploadData.customResumeData;\n                    }\n                    resumableFilesData.push(data);\n                });\n                return resumableFilesData;\n            },\n            isAttemptingResume: function(id) {\n                return handler._getFileState(id).attemptingResume;\n            },\n            isResumable: function(id) {\n                return !!chunking && handler.isValid(id) && !handler._getFileState(id).notResumable;\n            },\n            moveInProgressToRemaining: function(id, optInProgress, optRemaining) {\n                var fileState = handler._getFileState(id) || {}, chunkingState = fileState.chunking || {}, inProgress = optInProgress || chunkingState.inProgress, remaining = optRemaining || chunkingState.remaining;\n                if (inProgress) {\n                    log(qq.format(\"Moving these chunks from in-progress {}, to remaining.\", JSON.stringify(inProgress)));\n                    inProgress.reverse();\n                    qq.each(inProgress, function(idx, chunkIdx) {\n                        remaining.unshift(chunkIdx);\n                    });\n                    inProgress.length = 0;\n                }\n            },\n            pause: function(id) {\n                if (handler.isValid(id)) {\n                    log(qq.format(\"Aborting XHR upload for {} '{}' due to pause instruction.\", id, getName(id)));\n                    handler._getFileState(id).paused = true;\n                    abort(id);\n                    return true;\n                }\n            },\n            reevaluateChunking: function(id) {\n                if (chunking && handler.isValid(id)) {\n                    var state = handler._getFileState(id), totalChunks, i;\n                    delete state.chunking;\n                    state.chunking = {};\n                    totalChunks = handler._getTotalChunks(id);\n                    if (totalChunks > 1 || chunking.mandatory) {\n                        state.chunking.enabled = true;\n                        state.chunking.parts = totalChunks;\n                        state.chunking.remaining = [];\n                        for (i = 0; i < totalChunks; i++) {\n                            state.chunking.remaining.push(i);\n                        }\n                        handler._initTempState(id);\n                    } else {\n                        state.chunking.enabled = false;\n                    }\n                }\n            },\n            updateBlob: function(id, newBlob) {\n                if (handler.isValid(id)) {\n                    handler._getFileState(id).file = newBlob;\n                }\n            },\n            _clearXhrs: function(id) {\n                var tempState = handler._getFileState(id).temp;\n                qq.each(tempState.ajaxRequesters, function(chunkId) {\n                    delete tempState.ajaxRequesters[chunkId];\n                });\n                qq.each(tempState.xhrs, function(chunkId) {\n                    delete tempState.xhrs[chunkId];\n                });\n            },\n            _createXhr: function(id, optChunkIdx) {\n                return handler._registerXhr(id, optChunkIdx, qq.createXhrInstance());\n            },\n            _getAjaxRequester: function(id, optChunkIdx) {\n                var chunkIdx = optChunkIdx == null ? -1 : optChunkIdx;\n                return handler._getFileState(id).temp.ajaxRequesters[chunkIdx];\n            },\n            _getChunkData: function(id, chunkIndex) {\n                var chunkSize = getChunkSize(id), fileSize = getSize(id), fileOrBlob = handler.getFile(id), startBytes = chunkSize * chunkIndex, endBytes = startBytes + chunkSize >= fileSize ? fileSize : startBytes + chunkSize, totalChunks = handler._getTotalChunks(id), cachedChunks = this._getFileState(id).temp.cachedChunks, blob = cachedChunks[chunkIndex] || qq.sliceBlob(fileOrBlob, startBytes, endBytes);\n                cachedChunks[chunkIndex] = blob;\n                return {\n                    part: chunkIndex,\n                    start: startBytes,\n                    end: endBytes,\n                    count: totalChunks,\n                    blob: blob,\n                    size: endBytes - startBytes\n                };\n            },\n            _getChunkDataForCallback: function(chunkData) {\n                return {\n                    partIndex: chunkData.part,\n                    startByte: chunkData.start + 1,\n                    endByte: chunkData.end,\n                    totalParts: chunkData.count\n                };\n            },\n            _getLocalStorageId: function(id) {\n                var formatVersion = \"5.0\", name = getName(id), size = getSize(id), chunkSize = getChunkSize(id), endpoint = getEndpoint(id), customKeys = resume.customKeys(id), localStorageId = qq.format(\"qq{}resume{}-{}-{}-{}-{}\", namespace, formatVersion, name, size, chunkSize, endpoint);\n                customKeys.forEach(function(key) {\n                    localStorageId += \"-\" + key;\n                });\n                return localStorageId;\n            },\n            _getMimeType: function(id) {\n                return handler.getFile(id).type;\n            },\n            _getPersistableData: function(id) {\n                return handler._getFileState(id).chunking;\n            },\n            _getTotalChunks: function(id) {\n                if (chunking) {\n                    var fileSize = getSize(id), chunkSize = getChunkSize(id);\n                    return Math.ceil(fileSize / chunkSize);\n                }\n            },\n            _getXhr: function(id, optChunkIdx) {\n                var chunkIdx = optChunkIdx == null ? -1 : optChunkIdx;\n                return handler._getFileState(id).temp.xhrs[chunkIdx];\n            },\n            _getXhrs: function(id) {\n                return handler._getFileState(id).temp.xhrs;\n            },\n            _iterateResumeRecords: function(callback) {\n                if (resumeEnabled) {\n                    qq.each(localStorage, function(key, item) {\n                        if (key.indexOf(qq.format(\"qq{}resume\", namespace)) === 0) {\n                            var uploadData = JSON.parse(item);\n                            callback(key, uploadData);\n                        }\n                    });\n                }\n            },\n            _initTempState: function(id) {\n                handler._getFileState(id).temp = {\n                    ajaxRequesters: {},\n                    chunkProgress: {},\n                    xhrs: {},\n                    cachedChunks: {}\n                };\n            },\n            _markNotResumable: function(id) {\n                handler._getFileState(id).notResumable = true;\n            },\n            _maybeDeletePersistedChunkData: function(id) {\n                var localStorageId;\n                if (resumeEnabled && handler.isResumable(id)) {\n                    localStorageId = handler._getLocalStorageId(id);\n                    if (localStorageId && localStorage.getItem(localStorageId)) {\n                        localStorage.removeItem(localStorageId);\n                        return true;\n                    }\n                }\n                return false;\n            },\n            _maybePrepareForResume: function(id) {\n                var state = handler._getFileState(id), localStorageId, persistedData;\n                if (resumeEnabled && state.key === undefined) {\n                    localStorageId = handler._getLocalStorageId(id);\n                    persistedData = localStorage.getItem(localStorageId);\n                    if (persistedData) {\n                        persistedData = JSON.parse(persistedData);\n                        if (getDataByUuid(persistedData.uuid)) {\n                            handler._markNotResumable(id);\n                        } else {\n                            log(qq.format(\"Identified file with ID {} and name of {} as resumable.\", id, getName(id)));\n                            onUuidChanged(id, persistedData.uuid);\n                            state.key = persistedData.key;\n                            state.chunking = persistedData.chunking;\n                            state.loaded = persistedData.loaded;\n                            state.customResumeData = persistedData.customResumeData;\n                            state.attemptingResume = true;\n                            handler.moveInProgressToRemaining(id);\n                        }\n                    }\n                }\n            },\n            _maybePersistChunkedState: function(id) {\n                var state = handler._getFileState(id), localStorageId, persistedData;\n                if (resumeEnabled && handler.isResumable(id)) {\n                    var customResumeData = getCustomResumeData(id);\n                    localStorageId = handler._getLocalStorageId(id);\n                    persistedData = {\n                        name: getName(id),\n                        size: getSize(id),\n                        uuid: getUuid(id),\n                        key: state.key,\n                        chunking: state.chunking,\n                        loaded: state.loaded,\n                        lastUpdated: Date.now()\n                    };\n                    if (customResumeData) {\n                        persistedData.customResumeData = customResumeData;\n                    }\n                    try {\n                        localStorage.setItem(localStorageId, JSON.stringify(persistedData));\n                    } catch (error) {\n                        log(qq.format(\"Unable to save resume data for '{}' due to error: '{}'.\", id, error.toString()), \"warn\");\n                    }\n                }\n            },\n            _registerProgressHandler: function(id, chunkIdx, chunkSize) {\n                var xhr = handler._getXhr(id, chunkIdx), name = getName(id), progressCalculator = {\n                    simple: function(loaded, total) {\n                        var fileSize = getSize(id);\n                        if (loaded === total) {\n                            onProgress(id, name, fileSize, fileSize);\n                        } else {\n                            onProgress(id, name, loaded >= fileSize ? fileSize - 1 : loaded, fileSize);\n                        }\n                    },\n                    chunked: function(loaded, total) {\n                        var chunkProgress = handler._getFileState(id).temp.chunkProgress, totalSuccessfullyLoadedForFile = handler._getFileState(id).loaded, loadedForRequest = loaded, totalForRequest = total, totalFileSize = getSize(id), estActualChunkLoaded = loadedForRequest - (totalForRequest - chunkSize), totalLoadedForFile = totalSuccessfullyLoadedForFile;\n                        chunkProgress[chunkIdx] = estActualChunkLoaded;\n                        qq.each(chunkProgress, function(chunkIdx, chunkLoaded) {\n                            totalLoadedForFile += chunkLoaded;\n                        });\n                        onProgress(id, name, totalLoadedForFile, totalFileSize);\n                    }\n                };\n                xhr.upload.onprogress = function(e) {\n                    if (e.lengthComputable) {\n                        var type = chunkSize == null ? \"simple\" : \"chunked\";\n                        progressCalculator[type](e.loaded, e.total);\n                    }\n                };\n            },\n            _registerXhr: function(id, optChunkIdx, xhr, optAjaxRequester) {\n                var xhrsId = optChunkIdx == null ? -1 : optChunkIdx, tempState = handler._getFileState(id).temp;\n                tempState.xhrs = tempState.xhrs || {};\n                tempState.ajaxRequesters = tempState.ajaxRequesters || {};\n                tempState.xhrs[xhrsId] = xhr;\n                if (optAjaxRequester) {\n                    tempState.ajaxRequesters[xhrsId] = optAjaxRequester;\n                }\n                return xhr;\n            },\n            _removeExpiredChunkingRecords: function() {\n                var expirationDays = resume.recordsExpireIn;\n                handler._iterateResumeRecords(function(key, uploadData) {\n                    var expirationDate = new Date(uploadData.lastUpdated);\n                    expirationDate.setDate(expirationDate.getDate() + expirationDays);\n                    if (expirationDate.getTime() <= Date.now()) {\n                        log(\"Removing expired resume record with key \" + key);\n                        localStorage.removeItem(key);\n                    }\n                });\n            },\n            _shouldChunkThisFile: function(id) {\n                var state = handler._getFileState(id);\n                if (state) {\n                    if (!state.chunking) {\n                        handler.reevaluateChunking(id);\n                    }\n                    return state.chunking.enabled;\n                }\n            }\n        });\n    };\n    qq.DeleteFileAjaxRequester = function(o) {\n        \"use strict\";\n        var requester, options = {\n            method: \"DELETE\",\n            uuidParamName: \"qquuid\",\n            endpointStore: {},\n            maxConnections: 3,\n            customHeaders: function(id) {\n                return {};\n            },\n            paramsStore: {},\n            cors: {\n                expected: false,\n                sendCredentials: false\n            },\n            log: function(str, level) {},\n            onDelete: function(id) {},\n            onDeleteComplete: function(id, xhrOrXdr, isError) {}\n        };\n        qq.extend(options, o);\n        function getMandatedParams() {\n            if (options.method.toUpperCase() === \"POST\") {\n                return {\n                    _method: \"DELETE\"\n                };\n            }\n            return {};\n        }\n        requester = qq.extend(this, new qq.AjaxRequester({\n            acceptHeader: \"application/json\",\n            validMethods: [ \"POST\", \"DELETE\" ],\n            method: options.method,\n            endpointStore: options.endpointStore,\n            paramsStore: options.paramsStore,\n            mandatedParams: getMandatedParams(),\n            maxConnections: options.maxConnections,\n            customHeaders: function(id) {\n                return options.customHeaders.get(id);\n            },\n            log: options.log,\n            onSend: options.onDelete,\n            onComplete: options.onDeleteComplete,\n            cors: options.cors\n        }));\n        qq.extend(this, {\n            sendDelete: function(id, uuid, additionalMandatedParams) {\n                var additionalOptions = additionalMandatedParams || {};\n                options.log(\"Submitting delete file request for \" + id);\n                if (options.method === \"DELETE\") {\n                    requester.initTransport(id).withPath(uuid).withParams(additionalOptions).send();\n                } else {\n                    additionalOptions[options.uuidParamName] = uuid;\n                    requester.initTransport(id).withParams(additionalOptions).send();\n                }\n            }\n        });\n    };\n    (function() {\n        function detectSubsampling(img) {\n            var iw = img.naturalWidth, ih = img.naturalHeight, canvas = document.createElement(\"canvas\"), ctx;\n            if (iw * ih > 1024 * 1024) {\n                canvas.width = canvas.height = 1;\n                ctx = canvas.getContext(\"2d\");\n                ctx.drawImage(img, -iw + 1, 0);\n                return ctx.getImageData(0, 0, 1, 1).data[3] === 0;\n            } else {\n                return false;\n            }\n        }\n        function detectVerticalSquash(img, iw, ih) {\n            var canvas = document.createElement(\"canvas\"), sy = 0, ey = ih, py = ih, ctx, data, alpha, ratio;\n            canvas.width = 1;\n            canvas.height = ih;\n            ctx = canvas.getContext(\"2d\");\n            ctx.drawImage(img, 0, 0);\n            data = ctx.getImageData(0, 0, 1, ih).data;\n            while (py > sy) {\n                alpha = data[(py - 1) * 4 + 3];\n                if (alpha === 0) {\n                    ey = py;\n                } else {\n                    sy = py;\n                }\n                py = ey + sy >> 1;\n            }\n            ratio = py / ih;\n            return ratio === 0 ? 1 : ratio;\n        }\n        function renderImageToDataURL(img, blob, options, doSquash) {\n            var canvas = document.createElement(\"canvas\"), mime = options.mime || \"image/jpeg\", promise = new qq.Promise();\n            renderImageToCanvas(img, blob, canvas, options, doSquash).then(function() {\n                promise.success(canvas.toDataURL(mime, options.quality || .8));\n            });\n            return promise;\n        }\n        function maybeCalculateDownsampledDimensions(spec) {\n            var maxPixels = 5241e3;\n            if (!qq.ios()) {\n                throw new qq.Error(\"Downsampled dimensions can only be reliably calculated for iOS!\");\n            }\n            if (spec.origHeight * spec.origWidth > maxPixels) {\n                return {\n                    newHeight: Math.round(Math.sqrt(maxPixels * (spec.origHeight / spec.origWidth))),\n                    newWidth: Math.round(Math.sqrt(maxPixels * (spec.origWidth / spec.origHeight)))\n                };\n            }\n        }\n        function renderImageToCanvas(img, blob, canvas, options, doSquash) {\n            var iw = img.naturalWidth, ih = img.naturalHeight, width = options.width, height = options.height, ctx = canvas.getContext(\"2d\"), promise = new qq.Promise(), modifiedDimensions;\n            ctx.save();\n            if (options.resize) {\n                return renderImageToCanvasWithCustomResizer({\n                    blob: blob,\n                    canvas: canvas,\n                    image: img,\n                    imageHeight: ih,\n                    imageWidth: iw,\n                    orientation: options.orientation,\n                    resize: options.resize,\n                    targetHeight: height,\n                    targetWidth: width\n                });\n            }\n            if (!qq.supportedFeatures.unlimitedScaledImageSize) {\n                modifiedDimensions = maybeCalculateDownsampledDimensions({\n                    origWidth: width,\n                    origHeight: height\n                });\n                if (modifiedDimensions) {\n                    qq.log(qq.format(\"Had to reduce dimensions due to device limitations from {}w / {}h to {}w / {}h\", width, height, modifiedDimensions.newWidth, modifiedDimensions.newHeight), \"warn\");\n                    width = modifiedDimensions.newWidth;\n                    height = modifiedDimensions.newHeight;\n                }\n            }\n            transformCoordinate(canvas, width, height, options.orientation);\n            if (qq.ios()) {\n                (function() {\n                    if (detectSubsampling(img)) {\n                        iw /= 2;\n                        ih /= 2;\n                    }\n                    var d = 1024, tmpCanvas = document.createElement(\"canvas\"), vertSquashRatio = doSquash ? detectVerticalSquash(img, iw, ih) : 1, dw = Math.ceil(d * width / iw), dh = Math.ceil(d * height / ih / vertSquashRatio), sy = 0, dy = 0, tmpCtx, sx, dx;\n                    tmpCanvas.width = tmpCanvas.height = d;\n                    tmpCtx = tmpCanvas.getContext(\"2d\");\n                    while (sy < ih) {\n                        sx = 0;\n                        dx = 0;\n                        while (sx < iw) {\n                            tmpCtx.clearRect(0, 0, d, d);\n                            tmpCtx.drawImage(img, -sx, -sy);\n                            ctx.drawImage(tmpCanvas, 0, 0, d, d, dx, dy, dw, dh);\n                            sx += d;\n                            dx += dw;\n                        }\n                        sy += d;\n                        dy += dh;\n                    }\n                    ctx.restore();\n                    tmpCanvas = tmpCtx = null;\n                })();\n            } else {\n                ctx.drawImage(img, 0, 0, width, height);\n            }\n            canvas.qqImageRendered && canvas.qqImageRendered();\n            promise.success();\n            return promise;\n        }\n        function renderImageToCanvasWithCustomResizer(resizeInfo) {\n            var blob = resizeInfo.blob, image = resizeInfo.image, imageHeight = resizeInfo.imageHeight, imageWidth = resizeInfo.imageWidth, orientation = resizeInfo.orientation, promise = new qq.Promise(), resize = resizeInfo.resize, sourceCanvas = document.createElement(\"canvas\"), sourceCanvasContext = sourceCanvas.getContext(\"2d\"), targetCanvas = resizeInfo.canvas, targetHeight = resizeInfo.targetHeight, targetWidth = resizeInfo.targetWidth;\n            transformCoordinate(sourceCanvas, imageWidth, imageHeight, orientation);\n            targetCanvas.height = targetHeight;\n            targetCanvas.width = targetWidth;\n            sourceCanvasContext.drawImage(image, 0, 0);\n            resize({\n                blob: blob,\n                height: targetHeight,\n                image: image,\n                sourceCanvas: sourceCanvas,\n                targetCanvas: targetCanvas,\n                width: targetWidth\n            }).then(function success() {\n                targetCanvas.qqImageRendered && targetCanvas.qqImageRendered();\n                promise.success();\n            }, promise.failure);\n            return promise;\n        }\n        function transformCoordinate(canvas, width, height, orientation) {\n            switch (orientation) {\n              case 5:\n              case 6:\n              case 7:\n              case 8:\n                canvas.width = height;\n                canvas.height = width;\n                break;\n\n              default:\n                canvas.width = width;\n                canvas.height = height;\n            }\n            var ctx = canvas.getContext(\"2d\");\n            switch (orientation) {\n              case 2:\n                ctx.translate(width, 0);\n                ctx.scale(-1, 1);\n                break;\n\n              case 3:\n                ctx.translate(width, height);\n                ctx.rotate(Math.PI);\n                break;\n\n              case 4:\n                ctx.translate(0, height);\n                ctx.scale(1, -1);\n                break;\n\n              case 5:\n                ctx.rotate(.5 * Math.PI);\n                ctx.scale(1, -1);\n                break;\n\n              case 6:\n                ctx.rotate(.5 * Math.PI);\n                ctx.translate(0, -height);\n                break;\n\n              case 7:\n                ctx.rotate(.5 * Math.PI);\n                ctx.translate(width, -height);\n                ctx.scale(-1, 1);\n                break;\n\n              case 8:\n                ctx.rotate(-.5 * Math.PI);\n                ctx.translate(-width, 0);\n                break;\n\n              default:\n                break;\n            }\n        }\n        function MegaPixImage(srcImage, errorCallback) {\n            var self = this;\n            if (window.Blob && srcImage instanceof Blob) {\n                (function() {\n                    var img = new Image(), URL = window.URL && window.URL.createObjectURL ? window.URL : window.webkitURL && window.webkitURL.createObjectURL ? window.webkitURL : null;\n                    if (!URL) {\n                        throw Error(\"No createObjectURL function found to create blob url\");\n                    }\n                    img.src = URL.createObjectURL(srcImage);\n                    self.blob = srcImage;\n                    srcImage = img;\n                })();\n            }\n            if (!srcImage.naturalWidth && !srcImage.naturalHeight) {\n                srcImage.onload = function() {\n                    var listeners = self.imageLoadListeners;\n                    if (listeners) {\n                        self.imageLoadListeners = null;\n                        setTimeout(function() {\n                            for (var i = 0, len = listeners.length; i < len; i++) {\n                                listeners[i]();\n                            }\n                        }, 0);\n                    }\n                };\n                srcImage.onerror = errorCallback;\n                this.imageLoadListeners = [];\n            }\n            this.srcImage = srcImage;\n        }\n        MegaPixImage.prototype.render = function(target, options) {\n            options = options || {};\n            var self = this, imgWidth = this.srcImage.naturalWidth, imgHeight = this.srcImage.naturalHeight, width = options.width, height = options.height, maxWidth = options.maxWidth, maxHeight = options.maxHeight, doSquash = !this.blob || this.blob.type === \"image/jpeg\", tagName = target.tagName.toLowerCase(), opt;\n            if (this.imageLoadListeners) {\n                this.imageLoadListeners.push(function() {\n                    self.render(target, options);\n                });\n                return;\n            }\n            if (width && !height) {\n                height = imgHeight * width / imgWidth << 0;\n            } else if (height && !width) {\n                width = imgWidth * height / imgHeight << 0;\n            } else {\n                width = imgWidth;\n                height = imgHeight;\n            }\n            if (maxWidth && width > maxWidth) {\n                width = maxWidth;\n                height = imgHeight * width / imgWidth << 0;\n            }\n            if (maxHeight && height > maxHeight) {\n                height = maxHeight;\n                width = imgWidth * height / imgHeight << 0;\n            }\n            opt = {\n                width: width,\n                height: height\n            }, qq.each(options, function(optionsKey, optionsValue) {\n                opt[optionsKey] = optionsValue;\n            });\n            if (tagName === \"img\") {\n                (function() {\n                    var oldTargetSrc = target.src;\n                    renderImageToDataURL(self.srcImage, self.blob, opt, doSquash).then(function(dataUri) {\n                        target.src = dataUri;\n                        oldTargetSrc === target.src && target.onload && target.onload();\n                    });\n                })();\n            } else if (tagName === \"canvas\") {\n                renderImageToCanvas(this.srcImage, this.blob, target, opt, doSquash);\n            }\n            if (typeof this.onrender === \"function\") {\n                this.onrender(target);\n            }\n        };\n        qq.MegaPixImage = MegaPixImage;\n    })();\n    qq.ImageGenerator = function(log) {\n        \"use strict\";\n        function isImg(el) {\n            return el.tagName.toLowerCase() === \"img\";\n        }\n        function isCanvas(el) {\n            return el.tagName.toLowerCase() === \"canvas\";\n        }\n        function isImgCorsSupported() {\n            return new Image().crossOrigin !== undefined;\n        }\n        function isCanvasSupported() {\n            var canvas = document.createElement(\"canvas\");\n            return canvas.getContext && canvas.getContext(\"2d\");\n        }\n        function determineMimeOfFileName(nameWithPath) {\n            var pathSegments = nameWithPath.split(\"/\"), name = pathSegments[pathSegments.length - 1].split(\"?\")[0], extension = qq.getExtension(name);\n            extension = extension && extension.toLowerCase();\n            switch (extension) {\n              case \"jpeg\":\n              case \"jpg\":\n                return \"image/jpeg\";\n\n              case \"png\":\n                return \"image/png\";\n\n              case \"bmp\":\n                return \"image/bmp\";\n\n              case \"gif\":\n                return \"image/gif\";\n\n              case \"tiff\":\n              case \"tif\":\n                return \"image/tiff\";\n            }\n        }\n        function isCrossOrigin(url) {\n            var targetAnchor = document.createElement(\"a\"), targetProtocol, targetHostname, targetPort;\n            targetAnchor.href = url;\n            targetProtocol = targetAnchor.protocol;\n            targetPort = targetAnchor.port;\n            targetHostname = targetAnchor.hostname;\n            if (targetProtocol.toLowerCase() !== window.location.protocol.toLowerCase()) {\n                return true;\n            }\n            if (targetHostname.toLowerCase() !== window.location.hostname.toLowerCase()) {\n                return true;\n            }\n            if (targetPort !== window.location.port && !qq.ie()) {\n                return true;\n            }\n            return false;\n        }\n        function registerImgLoadListeners(img, promise) {\n            img.onload = function() {\n                img.onload = null;\n                img.onerror = null;\n                promise.success(img);\n            };\n            img.onerror = function() {\n                img.onload = null;\n                img.onerror = null;\n                log(\"Problem drawing thumbnail!\", \"error\");\n                promise.failure(img, \"Problem drawing thumbnail!\");\n            };\n        }\n        function registerCanvasDrawImageListener(canvas, promise) {\n            canvas.qqImageRendered = function() {\n                promise.success(canvas);\n            };\n        }\n        function registerThumbnailRenderedListener(imgOrCanvas, promise) {\n            var registered = isImg(imgOrCanvas) || isCanvas(imgOrCanvas);\n            if (isImg(imgOrCanvas)) {\n                registerImgLoadListeners(imgOrCanvas, promise);\n            } else if (isCanvas(imgOrCanvas)) {\n                registerCanvasDrawImageListener(imgOrCanvas, promise);\n            } else {\n                promise.failure(imgOrCanvas);\n                log(qq.format(\"Element container of type {} is not supported!\", imgOrCanvas.tagName), \"error\");\n            }\n            return registered;\n        }\n        function draw(fileOrBlob, container, options) {\n            var drawPreview = new qq.Promise(), identifier = new qq.Identify(fileOrBlob, log), maxSize = options.maxSize, orient = options.orient == null ? true : options.orient, megapixErrorHandler = function() {\n                container.onerror = null;\n                container.onload = null;\n                log(\"Could not render preview, file may be too large!\", \"error\");\n                drawPreview.failure(container, \"Browser cannot render image!\");\n            };\n            identifier.isPreviewable().then(function(mime) {\n                var dummyExif = {\n                    parse: function() {\n                        return new qq.Promise().success();\n                    }\n                }, exif = orient ? new qq.Exif(fileOrBlob, log) : dummyExif, mpImg = new qq.MegaPixImage(fileOrBlob, megapixErrorHandler);\n                if (registerThumbnailRenderedListener(container, drawPreview)) {\n                    exif.parse().then(function(exif) {\n                        var orientation = exif && exif.Orientation;\n                        mpImg.render(container, {\n                            maxWidth: maxSize,\n                            maxHeight: maxSize,\n                            orientation: orientation,\n                            mime: mime,\n                            resize: options.customResizeFunction\n                        });\n                    }, function(failureMsg) {\n                        log(qq.format(\"EXIF data could not be parsed ({}).  Assuming orientation = 1.\", failureMsg));\n                        mpImg.render(container, {\n                            maxWidth: maxSize,\n                            maxHeight: maxSize,\n                            mime: mime,\n                            resize: options.customResizeFunction\n                        });\n                    });\n                }\n            }, function() {\n                log(\"Not previewable\");\n                drawPreview.failure(container, \"Not previewable\");\n            });\n            return drawPreview;\n        }\n        function drawOnCanvasOrImgFromUrl(url, canvasOrImg, draw, maxSize, customResizeFunction) {\n            var tempImg = new Image(), tempImgRender = new qq.Promise();\n            registerThumbnailRenderedListener(tempImg, tempImgRender);\n            if (isCrossOrigin(url)) {\n                tempImg.crossOrigin = \"anonymous\";\n            }\n            tempImg.src = url;\n            tempImgRender.then(function rendered() {\n                registerThumbnailRenderedListener(canvasOrImg, draw);\n                var mpImg = new qq.MegaPixImage(tempImg);\n                mpImg.render(canvasOrImg, {\n                    maxWidth: maxSize,\n                    maxHeight: maxSize,\n                    mime: determineMimeOfFileName(url),\n                    resize: customResizeFunction\n                });\n            }, draw.failure);\n        }\n        function drawOnImgFromUrlWithCssScaling(url, img, draw, maxSize) {\n            registerThumbnailRenderedListener(img, draw);\n            qq(img).css({\n                maxWidth: maxSize + \"px\",\n                maxHeight: maxSize + \"px\"\n            });\n            img.src = url;\n        }\n        function drawFromUrl(url, container, options) {\n            var draw = new qq.Promise(), scale = options.scale, maxSize = scale ? options.maxSize : null;\n            if (scale && isImg(container)) {\n                if (isCanvasSupported()) {\n                    if (isCrossOrigin(url) && !isImgCorsSupported()) {\n                        drawOnImgFromUrlWithCssScaling(url, container, draw, maxSize);\n                    } else {\n                        drawOnCanvasOrImgFromUrl(url, container, draw, maxSize);\n                    }\n                } else {\n                    drawOnImgFromUrlWithCssScaling(url, container, draw, maxSize);\n                }\n            } else if (isCanvas(container)) {\n                drawOnCanvasOrImgFromUrl(url, container, draw, maxSize);\n            } else if (registerThumbnailRenderedListener(container, draw)) {\n                container.src = url;\n            }\n            return draw;\n        }\n        qq.extend(this, {\n            generate: function(fileBlobOrUrl, container, options) {\n                if (qq.isString(fileBlobOrUrl)) {\n                    log(\"Attempting to update thumbnail based on server response.\");\n                    return drawFromUrl(fileBlobOrUrl, container, options || {});\n                } else {\n                    log(\"Attempting to draw client-side image preview.\");\n                    return draw(fileBlobOrUrl, container, options || {});\n                }\n            }\n        });\n        this._testing = {};\n        this._testing.isImg = isImg;\n        this._testing.isCanvas = isCanvas;\n        this._testing.isCrossOrigin = isCrossOrigin;\n        this._testing.determineMimeOfFileName = determineMimeOfFileName;\n    };\n    qq.Exif = function(fileOrBlob, log) {\n        \"use strict\";\n        var TAG_IDS = [ 274 ], TAG_INFO = {\n            274: {\n                name: \"Orientation\",\n                bytes: 2\n            }\n        };\n        function parseLittleEndian(hex) {\n            var result = 0, pow = 0;\n            while (hex.length > 0) {\n                result += parseInt(hex.substring(0, 2), 16) * Math.pow(2, pow);\n                hex = hex.substring(2, hex.length);\n                pow += 8;\n            }\n            return result;\n        }\n        function seekToApp1(offset, promise) {\n            var theOffset = offset, thePromise = promise;\n            if (theOffset === undefined) {\n                theOffset = 2;\n                thePromise = new qq.Promise();\n            }\n            qq.readBlobToHex(fileOrBlob, theOffset, 4).then(function(hex) {\n                var match = /^ffe([0-9])/.exec(hex), segmentLength;\n                if (match) {\n                    if (match[1] !== \"1\") {\n                        segmentLength = parseInt(hex.slice(4, 8), 16);\n                        seekToApp1(theOffset + segmentLength + 2, thePromise);\n                    } else {\n                        thePromise.success(theOffset);\n                    }\n                } else {\n                    thePromise.failure(\"No EXIF header to be found!\");\n                }\n            });\n            return thePromise;\n        }\n        function getApp1Offset() {\n            var promise = new qq.Promise();\n            qq.readBlobToHex(fileOrBlob, 0, 6).then(function(hex) {\n                if (hex.indexOf(\"ffd8\") !== 0) {\n                    promise.failure(\"Not a valid JPEG!\");\n                } else {\n                    seekToApp1().then(function(offset) {\n                        promise.success(offset);\n                    }, function(error) {\n                        promise.failure(error);\n                    });\n                }\n            });\n            return promise;\n        }\n        function isLittleEndian(app1Start) {\n            var promise = new qq.Promise();\n            qq.readBlobToHex(fileOrBlob, app1Start + 10, 2).then(function(hex) {\n                promise.success(hex === \"4949\");\n            });\n            return promise;\n        }\n        function getDirEntryCount(app1Start, littleEndian) {\n            var promise = new qq.Promise();\n            qq.readBlobToHex(fileOrBlob, app1Start + 18, 2).then(function(hex) {\n                if (littleEndian) {\n                    return promise.success(parseLittleEndian(hex));\n                } else {\n                    promise.success(parseInt(hex, 16));\n                }\n            });\n            return promise;\n        }\n        function getIfd(app1Start, dirEntries) {\n            var offset = app1Start + 20, bytes = dirEntries * 12;\n            return qq.readBlobToHex(fileOrBlob, offset, bytes);\n        }\n        function getDirEntries(ifdHex) {\n            var entries = [], offset = 0;\n            while (offset + 24 <= ifdHex.length) {\n                entries.push(ifdHex.slice(offset, offset + 24));\n                offset += 24;\n            }\n            return entries;\n        }\n        function getTagValues(littleEndian, dirEntries) {\n            var TAG_VAL_OFFSET = 16, tagsToFind = qq.extend([], TAG_IDS), vals = {};\n            qq.each(dirEntries, function(idx, entry) {\n                var idHex = entry.slice(0, 4), id = littleEndian ? parseLittleEndian(idHex) : parseInt(idHex, 16), tagsToFindIdx = tagsToFind.indexOf(id), tagValHex, tagName, tagValLength;\n                if (tagsToFindIdx >= 0) {\n                    tagName = TAG_INFO[id].name;\n                    tagValLength = TAG_INFO[id].bytes;\n                    tagValHex = entry.slice(TAG_VAL_OFFSET, TAG_VAL_OFFSET + tagValLength * 2);\n                    vals[tagName] = littleEndian ? parseLittleEndian(tagValHex) : parseInt(tagValHex, 16);\n                    tagsToFind.splice(tagsToFindIdx, 1);\n                }\n                if (tagsToFind.length === 0) {\n                    return false;\n                }\n            });\n            return vals;\n        }\n        qq.extend(this, {\n            parse: function() {\n                var parser = new qq.Promise(), onParseFailure = function(message) {\n                    log(qq.format(\"EXIF header parse failed: '{}' \", message));\n                    parser.failure(message);\n                };\n                getApp1Offset().then(function(app1Offset) {\n                    log(qq.format(\"Moving forward with EXIF header parsing for '{}'\", fileOrBlob.name === undefined ? \"blob\" : fileOrBlob.name));\n                    isLittleEndian(app1Offset).then(function(littleEndian) {\n                        log(qq.format(\"EXIF Byte order is {} endian\", littleEndian ? \"little\" : \"big\"));\n                        getDirEntryCount(app1Offset, littleEndian).then(function(dirEntryCount) {\n                            log(qq.format(\"Found {} APP1 directory entries\", dirEntryCount));\n                            getIfd(app1Offset, dirEntryCount).then(function(ifdHex) {\n                                var dirEntries = getDirEntries(ifdHex), tagValues = getTagValues(littleEndian, dirEntries);\n                                log(\"Successfully parsed some EXIF tags\");\n                                parser.success(tagValues);\n                            }, onParseFailure);\n                        }, onParseFailure);\n                    }, onParseFailure);\n                }, onParseFailure);\n                return parser;\n            }\n        });\n        this._testing = {};\n        this._testing.parseLittleEndian = parseLittleEndian;\n    };\n    qq.Identify = function(fileOrBlob, log) {\n        \"use strict\";\n        function isIdentifiable(magicBytes, questionableBytes) {\n            var identifiable = false, magicBytesEntries = [].concat(magicBytes);\n            qq.each(magicBytesEntries, function(idx, magicBytesArrayEntry) {\n                if (questionableBytes.indexOf(magicBytesArrayEntry) === 0) {\n                    identifiable = true;\n                    return false;\n                }\n            });\n            return identifiable;\n        }\n        qq.extend(this, {\n            isPreviewable: function() {\n                var self = this, identifier = new qq.Promise(), previewable = false, name = fileOrBlob.name === undefined ? \"blob\" : fileOrBlob.name;\n                log(qq.format(\"Attempting to determine if {} can be rendered in this browser\", name));\n                log(\"First pass: check type attribute of blob object.\");\n                if (this.isPreviewableSync()) {\n                    log(\"Second pass: check for magic bytes in file header.\");\n                    qq.readBlobToHex(fileOrBlob, 0, 4).then(function(hex) {\n                        qq.each(self.PREVIEWABLE_MIME_TYPES, function(mime, bytes) {\n                            if (isIdentifiable(bytes, hex)) {\n                                if (mime !== \"image/tiff\" || qq.supportedFeatures.tiffPreviews) {\n                                    previewable = true;\n                                    identifier.success(mime);\n                                }\n                                return false;\n                            }\n                        });\n                        log(qq.format(\"'{}' is {} able to be rendered in this browser\", name, previewable ? \"\" : \"NOT\"));\n                        if (!previewable) {\n                            identifier.failure();\n                        }\n                    }, function() {\n                        log(\"Error reading file w/ name '\" + name + \"'.  Not able to be rendered in this browser.\");\n                        identifier.failure();\n                    });\n                } else {\n                    identifier.failure();\n                }\n                return identifier;\n            },\n            isPreviewableSync: function() {\n                var fileMime = fileOrBlob.type, isRecognizedImage = qq.indexOf(Object.keys(this.PREVIEWABLE_MIME_TYPES), fileMime) >= 0, previewable = false, name = fileOrBlob.name === undefined ? \"blob\" : fileOrBlob.name;\n                if (isRecognizedImage) {\n                    if (fileMime === \"image/tiff\") {\n                        previewable = qq.supportedFeatures.tiffPreviews;\n                    } else {\n                        previewable = true;\n                    }\n                }\n                !previewable && log(name + \" is not previewable in this browser per the blob's type attr\");\n                return previewable;\n            }\n        });\n    };\n    qq.Identify.prototype.PREVIEWABLE_MIME_TYPES = {\n        \"image/jpeg\": \"ffd8ff\",\n        \"image/gif\": \"474946\",\n        \"image/png\": \"89504e\",\n        \"image/bmp\": \"424d\",\n        \"image/tiff\": [ \"49492a00\", \"4d4d002a\" ]\n    };\n    qq.ImageValidation = function(blob, log) {\n        \"use strict\";\n        function hasNonZeroLimits(limits) {\n            var atLeastOne = false;\n            qq.each(limits, function(limit, value) {\n                if (value > 0) {\n                    atLeastOne = true;\n                    return false;\n                }\n            });\n            return atLeastOne;\n        }\n        function getWidthHeight() {\n            var sizeDetermination = new qq.Promise();\n            new qq.Identify(blob, log).isPreviewable().then(function() {\n                var image = new Image(), url = window.URL && window.URL.createObjectURL ? window.URL : window.webkitURL && window.webkitURL.createObjectURL ? window.webkitURL : null;\n                if (url) {\n                    image.onerror = function() {\n                        log(\"Cannot determine dimensions for image.  May be too large.\", \"error\");\n                        sizeDetermination.failure();\n                    };\n                    image.onload = function() {\n                        sizeDetermination.success({\n                            width: this.width,\n                            height: this.height\n                        });\n                    };\n                    image.src = url.createObjectURL(blob);\n                } else {\n                    log(\"No createObjectURL function available to generate image URL!\", \"error\");\n                    sizeDetermination.failure();\n                }\n            }, sizeDetermination.failure);\n            return sizeDetermination;\n        }\n        function getFailingLimit(limits, dimensions) {\n            var failingLimit;\n            qq.each(limits, function(limitName, limitValue) {\n                if (limitValue > 0) {\n                    var limitMatcher = /(max|min)(Width|Height)/.exec(limitName), dimensionPropName = limitMatcher[2].charAt(0).toLowerCase() + limitMatcher[2].slice(1), actualValue = dimensions[dimensionPropName];\n                    switch (limitMatcher[1]) {\n                      case \"min\":\n                        if (actualValue < limitValue) {\n                            failingLimit = limitName;\n                            return false;\n                        }\n                        break;\n\n                      case \"max\":\n                        if (actualValue > limitValue) {\n                            failingLimit = limitName;\n                            return false;\n                        }\n                        break;\n                    }\n                }\n            });\n            return failingLimit;\n        }\n        this.validate = function(limits) {\n            var validationEffort = new qq.Promise();\n            log(\"Attempting to validate image.\");\n            if (hasNonZeroLimits(limits)) {\n                getWidthHeight().then(function(dimensions) {\n                    var failingLimit = getFailingLimit(limits, dimensions);\n                    if (failingLimit) {\n                        validationEffort.failure(failingLimit);\n                    } else {\n                        validationEffort.success();\n                    }\n                }, validationEffort.success);\n            } else {\n                validationEffort.success();\n            }\n            return validationEffort;\n        };\n    };\n    qq.Session = function(spec) {\n        \"use strict\";\n        var options = {\n            endpoint: null,\n            params: {},\n            customHeaders: {},\n            cors: {},\n            addFileRecord: function(sessionData) {},\n            log: function(message, level) {}\n        };\n        qq.extend(options, spec, true);\n        function isJsonResponseValid(response) {\n            if (qq.isArray(response)) {\n                return true;\n            }\n            options.log(\"Session response is not an array.\", \"error\");\n        }\n        function handleFileItems(fileItems, success, xhrOrXdr, promise) {\n            var someItemsIgnored = false;\n            success = success && isJsonResponseValid(fileItems);\n            if (success) {\n                qq.each(fileItems, function(idx, fileItem) {\n                    if (fileItem.uuid == null) {\n                        someItemsIgnored = true;\n                        options.log(qq.format(\"Session response item {} did not include a valid UUID - ignoring.\", idx), \"error\");\n                    } else if (fileItem.name == null) {\n                        someItemsIgnored = true;\n                        options.log(qq.format(\"Session response item {} did not include a valid name - ignoring.\", idx), \"error\");\n                    } else {\n                        try {\n                            options.addFileRecord(fileItem);\n                            return true;\n                        } catch (err) {\n                            someItemsIgnored = true;\n                            options.log(err.message, \"error\");\n                        }\n                    }\n                    return false;\n                });\n            }\n            promise[success && !someItemsIgnored ? \"success\" : \"failure\"](fileItems, xhrOrXdr);\n        }\n        this.refresh = function() {\n            var refreshEffort = new qq.Promise(), refreshCompleteCallback = function(response, success, xhrOrXdr) {\n                handleFileItems(response, success, xhrOrXdr, refreshEffort);\n            }, requesterOptions = qq.extend({}, options), requester = new qq.SessionAjaxRequester(qq.extend(requesterOptions, {\n                onComplete: refreshCompleteCallback\n            }));\n            requester.queryServer();\n            return refreshEffort;\n        };\n    };\n    qq.SessionAjaxRequester = function(spec) {\n        \"use strict\";\n        var requester, options = {\n            endpoint: null,\n            customHeaders: {},\n            params: {},\n            cors: {\n                expected: false,\n                sendCredentials: false\n            },\n            onComplete: function(response, success, xhrOrXdr) {},\n            log: function(str, level) {}\n        };\n        qq.extend(options, spec);\n        function onComplete(id, xhrOrXdr, isError) {\n            var response = null;\n            if (xhrOrXdr.responseText != null) {\n                try {\n                    response = qq.parseJson(xhrOrXdr.responseText);\n                } catch (err) {\n                    options.log(\"Problem parsing session response: \" + err.message, \"error\");\n                    isError = true;\n                }\n            }\n            options.onComplete(response, !isError, xhrOrXdr);\n        }\n        requester = qq.extend(this, new qq.AjaxRequester({\n            acceptHeader: \"application/json\",\n            validMethods: [ \"GET\" ],\n            method: \"GET\",\n            endpointStore: {\n                get: function() {\n                    return options.endpoint;\n                }\n            },\n            customHeaders: options.customHeaders,\n            log: options.log,\n            onComplete: onComplete,\n            cors: options.cors\n        }));\n        qq.extend(this, {\n            queryServer: function() {\n                var params = qq.extend({}, options.params);\n                options.log(\"Session query request.\");\n                requester.initTransport(\"sessionRefresh\").withParams(params).withCacheBuster().send();\n            }\n        });\n    };\n    qq.Scaler = function(spec, log) {\n        \"use strict\";\n        var self = this, customResizeFunction = spec.customResizer, includeOriginal = spec.sendOriginal, orient = spec.orient, defaultType = spec.defaultType, defaultQuality = spec.defaultQuality / 100, failedToScaleText = spec.failureText, includeExif = spec.includeExif, sizes = this._getSortedSizes(spec.sizes);\n        qq.extend(this, {\n            enabled: qq.supportedFeatures.scaling && sizes.length > 0,\n            getFileRecords: function(originalFileUuid, originalFileName, originalBlobOrBlobData) {\n                var self = this, records = [], originalBlob = originalBlobOrBlobData.blob ? originalBlobOrBlobData.blob : originalBlobOrBlobData, identifier = new qq.Identify(originalBlob, log);\n                if (identifier.isPreviewableSync()) {\n                    qq.each(sizes, function(idx, sizeRecord) {\n                        var outputType = self._determineOutputType({\n                            defaultType: defaultType,\n                            requestedType: sizeRecord.type,\n                            refType: originalBlob.type\n                        });\n                        records.push({\n                            uuid: qq.getUniqueId(),\n                            name: self._getName(originalFileName, {\n                                name: sizeRecord.name,\n                                type: outputType,\n                                refType: originalBlob.type\n                            }),\n                            blob: new qq.BlobProxy(originalBlob, qq.bind(self._generateScaledImage, self, {\n                                customResizeFunction: customResizeFunction,\n                                maxSize: sizeRecord.maxSize,\n                                orient: orient,\n                                type: outputType,\n                                quality: defaultQuality,\n                                failedText: failedToScaleText,\n                                includeExif: includeExif,\n                                log: log\n                            }))\n                        });\n                    });\n                    records.push({\n                        uuid: originalFileUuid,\n                        name: originalFileName,\n                        size: originalBlob.size,\n                        blob: includeOriginal ? originalBlob : null\n                    });\n                } else {\n                    records.push({\n                        uuid: originalFileUuid,\n                        name: originalFileName,\n                        size: originalBlob.size,\n                        blob: originalBlob\n                    });\n                }\n                return records;\n            },\n            handleNewFile: function(file, name, uuid, size, fileList, batchId, uuidParamName, api) {\n                var self = this, buttonId = file.qqButtonId || file.blob && file.blob.qqButtonId, scaledIds = [], originalId = null, addFileToHandler = api.addFileToHandler, uploadData = api.uploadData, paramsStore = api.paramsStore, proxyGroupId = qq.getUniqueId();\n                qq.each(self.getFileRecords(uuid, name, file), function(idx, record) {\n                    var blobSize = record.size, id;\n                    if (record.blob instanceof qq.BlobProxy) {\n                        blobSize = -1;\n                    }\n                    id = uploadData.addFile({\n                        uuid: record.uuid,\n                        name: record.name,\n                        size: blobSize,\n                        batchId: batchId,\n                        proxyGroupId: proxyGroupId\n                    });\n                    if (record.blob instanceof qq.BlobProxy) {\n                        scaledIds.push(id);\n                    } else {\n                        originalId = id;\n                    }\n                    if (record.blob) {\n                        addFileToHandler(id, record.blob);\n                        fileList.push({\n                            id: id,\n                            file: record.blob\n                        });\n                    } else {\n                        uploadData.setStatus(id, qq.status.REJECTED);\n                    }\n                });\n                if (originalId !== null) {\n                    qq.each(scaledIds, function(idx, scaledId) {\n                        var params = {\n                            qqparentuuid: uploadData.retrieve({\n                                id: originalId\n                            }).uuid,\n                            qqparentsize: uploadData.retrieve({\n                                id: originalId\n                            }).size\n                        };\n                        params[uuidParamName] = uploadData.retrieve({\n                            id: scaledId\n                        }).uuid;\n                        uploadData.setParentId(scaledId, originalId);\n                        paramsStore.addReadOnly(scaledId, params);\n                    });\n                    if (scaledIds.length) {\n                        (function() {\n                            var param = {};\n                            param[uuidParamName] = uploadData.retrieve({\n                                id: originalId\n                            }).uuid;\n                            paramsStore.addReadOnly(originalId, param);\n                        })();\n                    }\n                }\n            }\n        });\n    };\n    qq.extend(qq.Scaler.prototype, {\n        scaleImage: function(id, specs, api) {\n            \"use strict\";\n            if (!qq.supportedFeatures.scaling) {\n                throw new qq.Error(\"Scaling is not supported in this browser!\");\n            }\n            var scalingEffort = new qq.Promise(), log = api.log, file = api.getFile(id), uploadData = api.uploadData.retrieve({\n                id: id\n            }), name = uploadData && uploadData.name, uuid = uploadData && uploadData.uuid, scalingOptions = {\n                customResizer: specs.customResizer,\n                sendOriginal: false,\n                orient: specs.orient,\n                defaultType: specs.type || null,\n                defaultQuality: specs.quality,\n                failedToScaleText: \"Unable to scale\",\n                sizes: [ {\n                    name: \"\",\n                    maxSize: specs.maxSize\n                } ]\n            }, scaler = new qq.Scaler(scalingOptions, log);\n            if (!qq.Scaler || !qq.supportedFeatures.imagePreviews || !file) {\n                scalingEffort.failure();\n                log(\"Could not generate requested scaled image for \" + id + \".  \" + \"Scaling is either not possible in this browser, or the file could not be located.\", \"error\");\n            } else {\n                qq.bind(function() {\n                    var record = scaler.getFileRecords(uuid, name, file)[0];\n                    if (record && record.blob instanceof qq.BlobProxy) {\n                        record.blob.create().then(scalingEffort.success, scalingEffort.failure);\n                    } else {\n                        log(id + \" is not a scalable image!\", \"error\");\n                        scalingEffort.failure();\n                    }\n                }, this)();\n            }\n            return scalingEffort;\n        },\n        _determineOutputType: function(spec) {\n            \"use strict\";\n            var requestedType = spec.requestedType, defaultType = spec.defaultType, referenceType = spec.refType;\n            if (!defaultType && !requestedType) {\n                if (referenceType !== \"image/jpeg\") {\n                    return \"image/png\";\n                }\n                return referenceType;\n            }\n            if (!requestedType) {\n                return defaultType;\n            }\n            if (qq.indexOf(Object.keys(qq.Identify.prototype.PREVIEWABLE_MIME_TYPES), requestedType) >= 0) {\n                if (requestedType === \"image/tiff\") {\n                    return qq.supportedFeatures.tiffPreviews ? requestedType : defaultType;\n                }\n                return requestedType;\n            }\n            return defaultType;\n        },\n        _getName: function(originalName, scaledVersionProperties) {\n            \"use strict\";\n            var startOfExt = originalName.lastIndexOf(\".\"), versionType = scaledVersionProperties.type || \"image/png\", referenceType = scaledVersionProperties.refType, scaledName = \"\", scaledExt = qq.getExtension(originalName), nameAppendage = \"\";\n            if (scaledVersionProperties.name && scaledVersionProperties.name.trim().length) {\n                nameAppendage = \" (\" + scaledVersionProperties.name + \")\";\n            }\n            if (startOfExt >= 0) {\n                scaledName = originalName.substr(0, startOfExt);\n                if (referenceType !== versionType) {\n                    scaledExt = versionType.split(\"/\")[1];\n                }\n                scaledName += nameAppendage + \".\" + scaledExt;\n            } else {\n                scaledName = originalName + nameAppendage;\n            }\n            return scaledName;\n        },\n        _getSortedSizes: function(sizes) {\n            \"use strict\";\n            sizes = qq.extend([], sizes);\n            return sizes.sort(function(a, b) {\n                if (a.maxSize > b.maxSize) {\n                    return 1;\n                }\n                if (a.maxSize < b.maxSize) {\n                    return -1;\n                }\n                return 0;\n            });\n        },\n        _generateScaledImage: function(spec, sourceFile) {\n            \"use strict\";\n            var self = this, customResizeFunction = spec.customResizeFunction, log = spec.log, maxSize = spec.maxSize, orient = spec.orient, type = spec.type, quality = spec.quality, failedText = spec.failedText, includeExif = spec.includeExif && sourceFile.type === \"image/jpeg\" && type === \"image/jpeg\", scalingEffort = new qq.Promise(), imageGenerator = new qq.ImageGenerator(log), canvas = document.createElement(\"canvas\");\n            log(\"Attempting to generate scaled version for \" + sourceFile.name);\n            imageGenerator.generate(sourceFile, canvas, {\n                maxSize: maxSize,\n                orient: orient,\n                customResizeFunction: customResizeFunction\n            }).then(function() {\n                var scaledImageDataUri = canvas.toDataURL(type, quality), signalSuccess = function() {\n                    log(\"Success generating scaled version for \" + sourceFile.name);\n                    var blob = qq.dataUriToBlob(scaledImageDataUri);\n                    scalingEffort.success(blob);\n                };\n                if (includeExif) {\n                    self._insertExifHeader(sourceFile, scaledImageDataUri, log).then(function(scaledImageDataUriWithExif) {\n                        scaledImageDataUri = scaledImageDataUriWithExif;\n                        signalSuccess();\n                    }, function() {\n                        log(\"Problem inserting EXIF header into scaled image.  Using scaled image w/out EXIF data.\", \"error\");\n                        signalSuccess();\n                    });\n                } else {\n                    signalSuccess();\n                }\n            }, function() {\n                log(\"Failed attempt to generate scaled version for \" + sourceFile.name, \"error\");\n                scalingEffort.failure(failedText);\n            });\n            return scalingEffort;\n        },\n        _insertExifHeader: function(originalImage, scaledImageDataUri, log) {\n            \"use strict\";\n            var reader = new FileReader(), insertionEffort = new qq.Promise(), originalImageDataUri = \"\";\n            reader.onload = function() {\n                originalImageDataUri = reader.result;\n                insertionEffort.success(qq.ExifRestorer.restore(originalImageDataUri, scaledImageDataUri));\n            };\n            reader.onerror = function() {\n                log(\"Problem reading \" + originalImage.name + \" during attempt to transfer EXIF data to scaled version.\", \"error\");\n                insertionEffort.failure();\n            };\n            reader.readAsDataURL(originalImage);\n            return insertionEffort;\n        },\n        _dataUriToBlob: function(dataUri) {\n            \"use strict\";\n            var byteString, mimeString, arrayBuffer, intArray;\n            if (dataUri.split(\",\")[0].indexOf(\"base64\") >= 0) {\n                byteString = atob(dataUri.split(\",\")[1]);\n            } else {\n                byteString = decodeURI(dataUri.split(\",\")[1]);\n            }\n            mimeString = dataUri.split(\",\")[0].split(\":\")[1].split(\";\")[0];\n            arrayBuffer = new ArrayBuffer(byteString.length);\n            intArray = new Uint8Array(arrayBuffer);\n            qq.each(byteString, function(idx, character) {\n                intArray[idx] = character.charCodeAt(0);\n            });\n            return this._createBlob(arrayBuffer, mimeString);\n        },\n        _createBlob: function(data, mime) {\n            \"use strict\";\n            var BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder, blobBuilder = BlobBuilder && new BlobBuilder();\n            if (blobBuilder) {\n                blobBuilder.append(data);\n                return blobBuilder.getBlob(mime);\n            } else {\n                return new Blob([ data ], {\n                    type: mime\n                });\n            }\n        }\n    });\n    qq.ExifRestorer = function() {\n        var ExifRestorer = {};\n        ExifRestorer.KEY_STR = \"ABCDEFGHIJKLMNOP\" + \"QRSTUVWXYZabcdef\" + \"ghijklmnopqrstuv\" + \"wxyz0123456789+/\" + \"=\";\n        ExifRestorer.encode64 = function(input) {\n            var output = \"\", chr1, chr2, chr3 = \"\", enc1, enc2, enc3, enc4 = \"\", i = 0;\n            do {\n                chr1 = input[i++];\n                chr2 = input[i++];\n                chr3 = input[i++];\n                enc1 = chr1 >> 2;\n                enc2 = (chr1 & 3) << 4 | chr2 >> 4;\n                enc3 = (chr2 & 15) << 2 | chr3 >> 6;\n                enc4 = chr3 & 63;\n                if (isNaN(chr2)) {\n                    enc3 = enc4 = 64;\n                } else if (isNaN(chr3)) {\n                    enc4 = 64;\n                }\n                output = output + this.KEY_STR.charAt(enc1) + this.KEY_STR.charAt(enc2) + this.KEY_STR.charAt(enc3) + this.KEY_STR.charAt(enc4);\n                chr1 = chr2 = chr3 = \"\";\n                enc1 = enc2 = enc3 = enc4 = \"\";\n            } while (i < input.length);\n            return output;\n        };\n        ExifRestorer.restore = function(origFileBase64, resizedFileBase64) {\n            var expectedBase64Header = \"data:image/jpeg;base64,\";\n            if (!origFileBase64.match(expectedBase64Header)) {\n                return resizedFileBase64;\n            }\n            var rawImage = this.decode64(origFileBase64.replace(expectedBase64Header, \"\"));\n            var segments = this.slice2Segments(rawImage);\n            var image = this.exifManipulation(resizedFileBase64, segments);\n            return expectedBase64Header + this.encode64(image);\n        };\n        ExifRestorer.exifManipulation = function(resizedFileBase64, segments) {\n            var exifArray = this.getExifArray(segments), newImageArray = this.insertExif(resizedFileBase64, exifArray), aBuffer = new Uint8Array(newImageArray);\n            return aBuffer;\n        };\n        ExifRestorer.getExifArray = function(segments) {\n            var seg;\n            for (var x = 0; x < segments.length; x++) {\n                seg = segments[x];\n                if (seg[0] == 255 & seg[1] == 225) {\n                    return seg;\n                }\n            }\n            return [];\n        };\n        ExifRestorer.insertExif = function(resizedFileBase64, exifArray) {\n            var imageData = resizedFileBase64.replace(\"data:image/jpeg;base64,\", \"\"), buf = this.decode64(imageData), separatePoint = buf.indexOf(255, 3), mae = buf.slice(0, separatePoint), ato = buf.slice(separatePoint), array = mae;\n            array = array.concat(exifArray);\n            array = array.concat(ato);\n            return array;\n        };\n        ExifRestorer.slice2Segments = function(rawImageArray) {\n            var head = 0, segments = [];\n            while (1) {\n                if (rawImageArray[head] == 255 & rawImageArray[head + 1] == 218) {\n                    break;\n                }\n                if (rawImageArray[head] == 255 & rawImageArray[head + 1] == 216) {\n                    head += 2;\n                } else {\n                    var length = rawImageArray[head + 2] * 256 + rawImageArray[head + 3], endPoint = head + length + 2, seg = rawImageArray.slice(head, endPoint);\n                    segments.push(seg);\n                    head = endPoint;\n                }\n                if (head > rawImageArray.length) {\n                    break;\n                }\n            }\n            return segments;\n        };\n        ExifRestorer.decode64 = function(input) {\n            var output = \"\", chr1, chr2, chr3 = \"\", enc1, enc2, enc3, enc4 = \"\", i = 0, buf = [];\n            var base64test = /[^A-Za-z0-9\\+\\/\\=]/g;\n            if (base64test.exec(input)) {\n                throw new Error(\"There were invalid base64 characters in the input text.  \" + \"Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\");\n            }\n            input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n            do {\n                enc1 = this.KEY_STR.indexOf(input.charAt(i++));\n                enc2 = this.KEY_STR.indexOf(input.charAt(i++));\n                enc3 = this.KEY_STR.indexOf(input.charAt(i++));\n                enc4 = this.KEY_STR.indexOf(input.charAt(i++));\n                chr1 = enc1 << 2 | enc2 >> 4;\n                chr2 = (enc2 & 15) << 4 | enc3 >> 2;\n                chr3 = (enc3 & 3) << 6 | enc4;\n                buf.push(chr1);\n                if (enc3 != 64) {\n                    buf.push(chr2);\n                }\n                if (enc4 != 64) {\n                    buf.push(chr3);\n                }\n                chr1 = chr2 = chr3 = \"\";\n                enc1 = enc2 = enc3 = enc4 = \"\";\n            } while (i < input.length);\n            return buf;\n        };\n        return ExifRestorer;\n    }();\n    qq.TotalProgress = function(callback, getSize) {\n        \"use strict\";\n        var perFileProgress = {}, totalLoaded = 0, totalSize = 0, lastLoadedSent = -1, lastTotalSent = -1, callbackProxy = function(loaded, total) {\n            if (loaded !== lastLoadedSent || total !== lastTotalSent) {\n                callback(loaded, total);\n            }\n            lastLoadedSent = loaded;\n            lastTotalSent = total;\n        }, noRetryableFiles = function(failed, retryable) {\n            var none = true;\n            qq.each(failed, function(idx, failedId) {\n                if (qq.indexOf(retryable, failedId) >= 0) {\n                    none = false;\n                    return false;\n                }\n            });\n            return none;\n        }, onCancel = function(id) {\n            updateTotalProgress(id, -1, -1);\n            delete perFileProgress[id];\n        }, onAllComplete = function(successful, failed, retryable) {\n            if (failed.length === 0 || noRetryableFiles(failed, retryable)) {\n                callbackProxy(totalSize, totalSize);\n                this.reset();\n            }\n        }, onNew = function(id) {\n            var size = getSize(id);\n            if (size > 0) {\n                updateTotalProgress(id, 0, size);\n                perFileProgress[id] = {\n                    loaded: 0,\n                    total: size\n                };\n            }\n        }, updateTotalProgress = function(id, newLoaded, newTotal) {\n            var oldLoaded = perFileProgress[id] ? perFileProgress[id].loaded : 0, oldTotal = perFileProgress[id] ? perFileProgress[id].total : 0;\n            if (newLoaded === -1 && newTotal === -1) {\n                totalLoaded -= oldLoaded;\n                totalSize -= oldTotal;\n            } else {\n                if (newLoaded) {\n                    totalLoaded += newLoaded - oldLoaded;\n                }\n                if (newTotal) {\n                    totalSize += newTotal - oldTotal;\n                }\n            }\n            callbackProxy(totalLoaded, totalSize);\n        };\n        qq.extend(this, {\n            onAllComplete: onAllComplete,\n            onStatusChange: function(id, oldStatus, newStatus) {\n                if (newStatus === qq.status.CANCELED || newStatus === qq.status.REJECTED) {\n                    onCancel(id);\n                } else if (newStatus === qq.status.SUBMITTING) {\n                    onNew(id);\n                }\n            },\n            onIndividualProgress: function(id, loaded, total) {\n                updateTotalProgress(id, loaded, total);\n                perFileProgress[id] = {\n                    loaded: loaded,\n                    total: total\n                };\n            },\n            onNewSize: function(id) {\n                onNew(id);\n            },\n            reset: function() {\n                perFileProgress = {};\n                totalLoaded = 0;\n                totalSize = 0;\n            }\n        });\n    };\n    qq.PasteSupport = function(o) {\n        \"use strict\";\n        var options, detachPasteHandler;\n        options = {\n            targetElement: null,\n            callbacks: {\n                log: function(message, level) {},\n                pasteReceived: function(blob) {}\n            }\n        };\n        function isImage(item) {\n            return item.type && item.type.indexOf(\"image/\") === 0;\n        }\n        function registerPasteHandler() {\n            detachPasteHandler = qq(options.targetElement).attach(\"paste\", function(event) {\n                var clipboardData = event.clipboardData;\n                if (clipboardData) {\n                    qq.each(clipboardData.items, function(idx, item) {\n                        if (isImage(item)) {\n                            var blob = item.getAsFile();\n                            options.callbacks.pasteReceived(blob);\n                        }\n                    });\n                }\n            });\n        }\n        function unregisterPasteHandler() {\n            if (detachPasteHandler) {\n                detachPasteHandler();\n            }\n        }\n        qq.extend(options, o);\n        registerPasteHandler();\n        qq.extend(this, {\n            reset: function() {\n                unregisterPasteHandler();\n            }\n        });\n    };\n    qq.FormSupport = function(options, startUpload, log) {\n        \"use strict\";\n        var self = this, interceptSubmit = options.interceptSubmit, formEl = options.element, autoUpload = options.autoUpload;\n        qq.extend(this, {\n            newEndpoint: null,\n            newAutoUpload: autoUpload,\n            attachedToForm: false,\n            getFormInputsAsObject: function() {\n                if (formEl == null) {\n                    return null;\n                }\n                return self._form2Obj(formEl);\n            }\n        });\n        function determineNewEndpoint(formEl) {\n            if (formEl.getAttribute(\"action\")) {\n                self.newEndpoint = formEl.getAttribute(\"action\");\n            }\n        }\n        function validateForm(formEl, nativeSubmit) {\n            if (formEl.checkValidity && !formEl.checkValidity()) {\n                log(\"Form did not pass validation checks - will not upload.\", \"error\");\n                nativeSubmit();\n            } else {\n                return true;\n            }\n        }\n        function maybeUploadOnSubmit(formEl) {\n            var nativeSubmit = formEl.submit;\n            qq(formEl).attach(\"submit\", function(event) {\n                event = event || window.event;\n                if (event.preventDefault) {\n                    event.preventDefault();\n                } else {\n                    event.returnValue = false;\n                }\n                validateForm(formEl, nativeSubmit) && startUpload();\n            });\n            formEl.submit = function() {\n                validateForm(formEl, nativeSubmit) && startUpload();\n            };\n        }\n        function determineFormEl(formEl) {\n            if (formEl) {\n                if (qq.isString(formEl)) {\n                    formEl = document.getElementById(formEl);\n                }\n                if (formEl) {\n                    log(\"Attaching to form element.\");\n                    determineNewEndpoint(formEl);\n                    interceptSubmit && maybeUploadOnSubmit(formEl);\n                }\n            }\n            return formEl;\n        }\n        formEl = determineFormEl(formEl);\n        this.attachedToForm = !!formEl;\n    };\n    qq.extend(qq.FormSupport.prototype, {\n        _form2Obj: function(form) {\n            \"use strict\";\n            var obj = {}, notIrrelevantType = function(type) {\n                var irrelevantTypes = [ \"button\", \"image\", \"reset\", \"submit\" ];\n                return qq.indexOf(irrelevantTypes, type.toLowerCase()) < 0;\n            }, radioOrCheckbox = function(type) {\n                return qq.indexOf([ \"checkbox\", \"radio\" ], type.toLowerCase()) >= 0;\n            }, ignoreValue = function(el) {\n                if (radioOrCheckbox(el.type) && !el.checked) {\n                    return true;\n                }\n                return el.disabled && el.type.toLowerCase() !== \"hidden\";\n            }, selectValue = function(select) {\n                var value = null;\n                qq.each(qq(select).children(), function(idx, child) {\n                    if (child.tagName.toLowerCase() === \"option\" && child.selected) {\n                        value = child.value;\n                        return false;\n                    }\n                });\n                return value;\n            };\n            qq.each(form.elements, function(idx, el) {\n                if ((qq.isInput(el, true) || el.tagName.toLowerCase() === \"textarea\") && notIrrelevantType(el.type) && !ignoreValue(el)) {\n                    obj[el.name] = el.value;\n                } else if (el.tagName.toLowerCase() === \"select\" && !ignoreValue(el)) {\n                    var value = selectValue(el);\n                    if (value !== null) {\n                        obj[el.name] = value;\n                    }\n                }\n            });\n            return obj;\n        }\n    });\n    qq.traditional = qq.traditional || {};\n    qq.traditional.FormUploadHandler = function(options, proxy) {\n        \"use strict\";\n        var handler = this, getName = proxy.getName, getUuid = proxy.getUuid, log = proxy.log;\n        function getIframeContentJson(id, iframe) {\n            var response, doc, innerHtml;\n            try {\n                doc = iframe.contentDocument || iframe.contentWindow.document;\n                innerHtml = doc.body.innerHTML;\n                log(\"converting iframe's innerHTML to JSON\");\n                log(\"innerHTML = \" + innerHtml);\n                if (innerHtml && innerHtml.match(/^<pre/i)) {\n                    innerHtml = doc.body.firstChild.firstChild.nodeValue;\n                }\n                response = handler._parseJsonResponse(innerHtml);\n            } catch (error) {\n                log(\"Error when attempting to parse form upload response (\" + error.message + \")\", \"error\");\n                response = {\n                    success: false\n                };\n            }\n            return response;\n        }\n        function createForm(id, iframe) {\n            var params = options.paramsStore.get(id), method = options.method.toLowerCase() === \"get\" ? \"GET\" : \"POST\", endpoint = options.endpointStore.get(id), name = getName(id);\n            params[options.uuidName] = getUuid(id);\n            params[options.filenameParam] = name;\n            return handler._initFormForUpload({\n                method: method,\n                endpoint: endpoint,\n                params: params,\n                paramsInBody: options.paramsInBody,\n                targetName: iframe.name\n            });\n        }\n        this.uploadFile = function(id) {\n            var input = handler.getInput(id), iframe = handler._createIframe(id), promise = new qq.Promise(), form;\n            form = createForm(id, iframe);\n            form.appendChild(input);\n            handler._attachLoadEvent(iframe, function(responseFromMessage) {\n                log(\"iframe loaded\");\n                var response = responseFromMessage ? responseFromMessage : getIframeContentJson(id, iframe);\n                handler._detachLoadEvent(id);\n                if (!options.cors.expected) {\n                    qq(iframe).remove();\n                }\n                if (response.success) {\n                    promise.success(response);\n                } else {\n                    promise.failure(response);\n                }\n            });\n            log(\"Sending upload request for \" + id);\n            form.submit();\n            qq(form).remove();\n            return promise;\n        };\n        qq.extend(this, new qq.FormUploadHandler({\n            options: {\n                isCors: options.cors.expected,\n                inputName: options.inputName\n            },\n            proxy: {\n                onCancel: options.onCancel,\n                getName: getName,\n                getUuid: getUuid,\n                log: log\n            }\n        }));\n    };\n    qq.traditional = qq.traditional || {};\n    qq.traditional.XhrUploadHandler = function(spec, proxy) {\n        \"use strict\";\n        var handler = this, getName = proxy.getName, getSize = proxy.getSize, getUuid = proxy.getUuid, log = proxy.log, multipart = spec.forceMultipart || spec.paramsInBody, addChunkingSpecificParams = function(id, params, chunkData) {\n            var size = getSize(id), name = getName(id);\n            if (!spec.omitDefaultParams) {\n                params[spec.chunking.paramNames.partIndex] = chunkData.part;\n                params[spec.chunking.paramNames.partByteOffset] = chunkData.start;\n                params[spec.chunking.paramNames.chunkSize] = chunkData.size;\n                params[spec.chunking.paramNames.totalParts] = chunkData.count;\n                params[spec.totalFileSizeName] = size;\n            }\n            if (multipart && !spec.omitDefaultParams) {\n                params[spec.filenameParam] = name;\n            }\n        }, allChunksDoneRequester = new qq.traditional.AllChunksDoneAjaxRequester({\n            cors: spec.cors,\n            endpoint: spec.chunking.success.endpoint,\n            headers: spec.chunking.success.headers,\n            jsonPayload: spec.chunking.success.jsonPayload,\n            log: log,\n            method: spec.chunking.success.method,\n            params: spec.chunking.success.params\n        }), createReadyStateChangedHandler = function(id, xhr) {\n            var promise = new qq.Promise();\n            xhr.onreadystatechange = function() {\n                if (xhr.readyState === 4) {\n                    var result = onUploadOrChunkComplete(id, xhr);\n                    if (result.success) {\n                        promise.success(result.response, xhr);\n                    } else {\n                        promise.failure(result.response, xhr);\n                    }\n                }\n            };\n            return promise;\n        }, getChunksCompleteParams = function(id) {\n            var params = spec.paramsStore.get(id), name = getName(id), size = getSize(id);\n            params[spec.uuidName] = getUuid(id);\n            params[spec.filenameParam] = name;\n            params[spec.totalFileSizeName] = size;\n            params[spec.chunking.paramNames.totalParts] = handler._getTotalChunks(id);\n            return params;\n        }, isErrorUploadResponse = function(xhr, response) {\n            return qq.indexOf([ 200, 201, 202, 203, 204 ], xhr.status) < 0 || spec.requireSuccessJson && !response.success || response.reset;\n        }, onUploadOrChunkComplete = function(id, xhr) {\n            var response;\n            log(\"xhr - server response received for \" + id);\n            log(\"responseText = \" + xhr.responseText);\n            response = parseResponse(true, xhr);\n            return {\n                success: !isErrorUploadResponse(xhr, response),\n                response: response\n            };\n        }, parseResponse = function(upload, xhr) {\n            var response = {};\n            try {\n                log(qq.format(\"Received response status {} with body: {}\", xhr.status, xhr.responseText));\n                response = qq.parseJson(xhr.responseText);\n            } catch (error) {\n                upload && spec.requireSuccessJson && log(\"Error when attempting to parse xhr response text (\" + error.message + \")\", \"error\");\n            }\n            return response;\n        }, sendChunksCompleteRequest = function(id) {\n            var promise = new qq.Promise();\n            allChunksDoneRequester.complete(id, handler._createXhr(id), getChunksCompleteParams(id), spec.customHeaders.get(id)).then(function(xhr) {\n                promise.success(parseResponse(false, xhr), xhr);\n            }, function(xhr) {\n                promise.failure(parseResponse(false, xhr), xhr);\n            });\n            return promise;\n        }, setParamsAndGetEntityToSend = function(entityToSendParams) {\n            var fileOrBlob = entityToSendParams.fileOrBlob;\n            var id = entityToSendParams.id;\n            var xhr = entityToSendParams.xhr;\n            var xhrOverrides = entityToSendParams.xhrOverrides || {};\n            var customParams = entityToSendParams.customParams || {};\n            var defaultParams = entityToSendParams.params || {};\n            var xhrOverrideParams = xhrOverrides.params || {};\n            var params;\n            var formData = multipart ? new FormData() : null, method = xhrOverrides.method || spec.method, endpoint = xhrOverrides.endpoint || spec.endpointStore.get(id), name = getName(id), size = getSize(id);\n            if (spec.omitDefaultParams) {\n                params = qq.extend({}, customParams);\n                qq.extend(params, xhrOverrideParams);\n            } else {\n                params = qq.extend({}, customParams);\n                qq.extend(params, xhrOverrideParams);\n                qq.extend(params, defaultParams);\n                params[spec.uuidName] = getUuid(id);\n                params[spec.filenameParam] = name;\n                if (multipart) {\n                    params[spec.totalFileSizeName] = size;\n                } else if (!spec.paramsInBody) {\n                    params[spec.inputName] = name;\n                }\n            }\n            if (!spec.paramsInBody) {\n                endpoint = qq.obj2url(params, endpoint);\n            }\n            xhr.open(method, endpoint, true);\n            if (spec.cors.expected && spec.cors.sendCredentials) {\n                xhr.withCredentials = true;\n            }\n            if (multipart) {\n                if (spec.paramsInBody) {\n                    qq.obj2FormData(params, formData);\n                }\n                formData.append(spec.inputName, fileOrBlob);\n                return formData;\n            }\n            return fileOrBlob;\n        }, setUploadHeaders = function(headersOptions) {\n            var headerOverrides = headersOptions.headerOverrides;\n            var id = headersOptions.id;\n            var xhr = headersOptions.xhr;\n            if (headerOverrides) {\n                qq.each(headerOverrides, function(headerName, headerValue) {\n                    xhr.setRequestHeader(headerName, headerValue);\n                });\n            } else {\n                var extraHeaders = spec.customHeaders.get(id), fileOrBlob = handler.getFile(id);\n                xhr.setRequestHeader(\"Accept\", \"application/json\");\n                xhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n                xhr.setRequestHeader(\"Cache-Control\", \"no-cache\");\n                if (!multipart) {\n                    xhr.setRequestHeader(\"Content-Type\", \"application/octet-stream\");\n                    xhr.setRequestHeader(\"X-Mime-Type\", fileOrBlob.type);\n                }\n                qq.each(extraHeaders, function(name, val) {\n                    xhr.setRequestHeader(name, val);\n                });\n            }\n        };\n        qq.extend(this, {\n            uploadChunk: function(uploadChunkParams) {\n                var id = uploadChunkParams.id;\n                var chunkIdx = uploadChunkParams.chunkIdx;\n                var overrides = uploadChunkParams.overrides || {};\n                var resuming = uploadChunkParams.resuming;\n                var chunkData = handler._getChunkData(id, chunkIdx), xhr = handler._createXhr(id, chunkIdx), promise, toSend, customParams, params = {};\n                promise = createReadyStateChangedHandler(id, xhr);\n                handler._registerProgressHandler(id, chunkIdx, chunkData.size);\n                customParams = spec.paramsStore.get(id);\n                addChunkingSpecificParams(id, params, chunkData);\n                if (resuming) {\n                    params[spec.resume.paramNames.resuming] = true;\n                }\n                toSend = setParamsAndGetEntityToSend({\n                    fileOrBlob: chunkData.blob,\n                    id: id,\n                    customParams: customParams,\n                    params: params,\n                    xhr: xhr,\n                    xhrOverrides: overrides\n                });\n                setUploadHeaders({\n                    headerOverrides: overrides.headers,\n                    id: id,\n                    xhr: xhr\n                });\n                xhr.send(toSend);\n                return promise;\n            },\n            uploadFile: function(id) {\n                var fileOrBlob = handler.getFile(id), promise, xhr, customParams, toSend;\n                xhr = handler._createXhr(id);\n                handler._registerProgressHandler(id);\n                promise = createReadyStateChangedHandler(id, xhr);\n                customParams = spec.paramsStore.get(id);\n                toSend = setParamsAndGetEntityToSend({\n                    fileOrBlob: fileOrBlob,\n                    id: id,\n                    customParams: customParams,\n                    xhr: xhr\n                });\n                setUploadHeaders({\n                    id: id,\n                    xhr: xhr\n                });\n                xhr.send(toSend);\n                return promise;\n            }\n        });\n        qq.extend(this, new qq.XhrUploadHandler({\n            options: qq.extend({\n                namespace: \"traditional\"\n            }, spec),\n            proxy: qq.extend({\n                getEndpoint: spec.endpointStore.get\n            }, proxy)\n        }));\n        qq.override(this, function(super_) {\n            return {\n                finalizeChunks: function(id) {\n                    proxy.onFinalizing(id);\n                    if (spec.chunking.success.endpoint) {\n                        return sendChunksCompleteRequest(id);\n                    } else {\n                        return super_.finalizeChunks(id, qq.bind(parseResponse, this, true));\n                    }\n                }\n            };\n        });\n    };\n    qq.traditional.AllChunksDoneAjaxRequester = function(o) {\n        \"use strict\";\n        var requester, options = {\n            cors: {\n                allowXdr: false,\n                expected: false,\n                sendCredentials: false\n            },\n            endpoint: null,\n            log: function(str, level) {},\n            method: \"POST\"\n        }, promises = {}, endpointHandler = {\n            get: function(id) {\n                if (qq.isFunction(options.endpoint)) {\n                    return options.endpoint(id);\n                }\n                return options.endpoint;\n            }\n        };\n        qq.extend(options, o);\n        requester = qq.extend(this, new qq.AjaxRequester({\n            acceptHeader: \"application/json\",\n            contentType: options.jsonPayload ? \"application/json\" : \"application/x-www-form-urlencoded\",\n            validMethods: [ options.method ],\n            method: options.method,\n            endpointStore: endpointHandler,\n            allowXRequestedWithAndCacheControl: false,\n            cors: options.cors,\n            log: options.log,\n            onComplete: function(id, xhr, isError) {\n                var promise = promises[id];\n                delete promises[id];\n                if (isError) {\n                    promise.failure(xhr);\n                } else {\n                    promise.success(xhr);\n                }\n            }\n        }));\n        qq.extend(this, {\n            complete: function(id, xhr, params, headers) {\n                var promise = new qq.Promise();\n                options.log(\"Submitting All Chunks Done request for \" + id);\n                promises[id] = promise;\n                requester.initTransport(id).withParams(options.params(id) || params).withHeaders(options.headers(id) || headers).send(xhr);\n                return promise;\n            }\n        });\n    };\n})(window);\n//# sourceMappingURL=fine-uploader.core.js.map","var wildcard = require('wildcard');\nvar reMimePartSplit = /[\\/\\+\\.]/;\n\n/**\n  # mime-match\n\n  A simple function to checker whether a target mime type matches a mime-type\n  pattern (e.g. image/jpeg matches image/jpeg OR image/*).\n\n  ## Example Usage\n\n  <<< example.js\n\n**/\nmodule.exports = function(target, pattern) {\n  function test(pattern) {\n    var result = wildcard(pattern, target, reMimePartSplit);\n\n    // ensure that we have a valid mime type (should have two parts)\n    return result && result.length >= 2;\n  }\n\n  return pattern ? test(pattern.split(';')[0]) : test;\n};\n","// Fine Uploader 5.16.2 - MIT licensed. http://fineuploader.com\n(function(global) {\n    var qq = function(element) {\n        \"use strict\";\n        return {\n            hide: function() {\n                element.style.display = \"none\";\n                return this;\n            },\n            attach: function(type, fn) {\n                if (element.addEventListener) {\n                    element.addEventListener(type, fn, false);\n                } else if (element.attachEvent) {\n                    element.attachEvent(\"on\" + type, fn);\n                }\n                return function() {\n                    qq(element).detach(type, fn);\n                };\n            },\n            detach: function(type, fn) {\n                if (element.removeEventListener) {\n                    element.removeEventListener(type, fn, false);\n                } else if (element.attachEvent) {\n                    element.detachEvent(\"on\" + type, fn);\n                }\n                return this;\n            },\n            contains: function(descendant) {\n                if (!descendant) {\n                    return false;\n                }\n                if (element === descendant) {\n                    return true;\n                }\n                if (element.contains) {\n                    return element.contains(descendant);\n                } else {\n                    return !!(descendant.compareDocumentPosition(element) & 8);\n                }\n            },\n            insertBefore: function(elementB) {\n                elementB.parentNode.insertBefore(element, elementB);\n                return this;\n            },\n            remove: function() {\n                element.parentNode.removeChild(element);\n                return this;\n            },\n            css: function(styles) {\n                if (element.style == null) {\n                    throw new qq.Error(\"Can't apply style to node as it is not on the HTMLElement prototype chain!\");\n                }\n                if (styles.opacity != null) {\n                    if (typeof element.style.opacity !== \"string\" && typeof element.filters !== \"undefined\") {\n                        styles.filter = \"alpha(opacity=\" + Math.round(100 * styles.opacity) + \")\";\n                    }\n                }\n                qq.extend(element.style, styles);\n                return this;\n            },\n            hasClass: function(name, considerParent) {\n                var re = new RegExp(\"(^| )\" + name + \"( |$)\");\n                return re.test(element.className) || !!(considerParent && re.test(element.parentNode.className));\n            },\n            addClass: function(name) {\n                if (!qq(element).hasClass(name)) {\n                    element.className += \" \" + name;\n                }\n                return this;\n            },\n            removeClass: function(name) {\n                var re = new RegExp(\"(^| )\" + name + \"( |$)\");\n                element.className = element.className.replace(re, \" \").replace(/^\\s+|\\s+$/g, \"\");\n                return this;\n            },\n            getByClass: function(className, first) {\n                var candidates, result = [];\n                if (first && element.querySelector) {\n                    return element.querySelector(\".\" + className);\n                } else if (element.querySelectorAll) {\n                    return element.querySelectorAll(\".\" + className);\n                }\n                candidates = element.getElementsByTagName(\"*\");\n                qq.each(candidates, function(idx, val) {\n                    if (qq(val).hasClass(className)) {\n                        result.push(val);\n                    }\n                });\n                return first ? result[0] : result;\n            },\n            getFirstByClass: function(className) {\n                return qq(element).getByClass(className, true);\n            },\n            children: function() {\n                var children = [], child = element.firstChild;\n                while (child) {\n                    if (child.nodeType === 1) {\n                        children.push(child);\n                    }\n                    child = child.nextSibling;\n                }\n                return children;\n            },\n            setText: function(text) {\n                element.innerText = text;\n                element.textContent = text;\n                return this;\n            },\n            clearText: function() {\n                return qq(element).setText(\"\");\n            },\n            hasAttribute: function(attrName) {\n                var attrVal;\n                if (element.hasAttribute) {\n                    if (!element.hasAttribute(attrName)) {\n                        return false;\n                    }\n                    return /^false$/i.exec(element.getAttribute(attrName)) == null;\n                } else {\n                    attrVal = element[attrName];\n                    if (attrVal === undefined) {\n                        return false;\n                    }\n                    return /^false$/i.exec(attrVal) == null;\n                }\n            }\n        };\n    };\n    (function() {\n        \"use strict\";\n        qq.canvasToBlob = function(canvas, mime, quality) {\n            return qq.dataUriToBlob(canvas.toDataURL(mime, quality));\n        };\n        qq.dataUriToBlob = function(dataUri) {\n            var arrayBuffer, byteString, createBlob = function(data, mime) {\n                var BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder, blobBuilder = BlobBuilder && new BlobBuilder();\n                if (blobBuilder) {\n                    blobBuilder.append(data);\n                    return blobBuilder.getBlob(mime);\n                } else {\n                    return new Blob([ data ], {\n                        type: mime\n                    });\n                }\n            }, intArray, mimeString;\n            if (dataUri.split(\",\")[0].indexOf(\"base64\") >= 0) {\n                byteString = atob(dataUri.split(\",\")[1]);\n            } else {\n                byteString = decodeURI(dataUri.split(\",\")[1]);\n            }\n            mimeString = dataUri.split(\",\")[0].split(\":\")[1].split(\";\")[0];\n            arrayBuffer = new ArrayBuffer(byteString.length);\n            intArray = new Uint8Array(arrayBuffer);\n            qq.each(byteString, function(idx, character) {\n                intArray[idx] = character.charCodeAt(0);\n            });\n            return createBlob(arrayBuffer, mimeString);\n        };\n        qq.log = function(message, level) {\n            if (window.console) {\n                if (!level || level === \"info\") {\n                    window.console.log(message);\n                } else {\n                    if (window.console[level]) {\n                        window.console[level](message);\n                    } else {\n                        window.console.log(\"<\" + level + \"> \" + message);\n                    }\n                }\n            }\n        };\n        qq.isObject = function(variable) {\n            return variable && !variable.nodeType && Object.prototype.toString.call(variable) === \"[object Object]\";\n        };\n        qq.isFunction = function(variable) {\n            return typeof variable === \"function\";\n        };\n        qq.isArray = function(value) {\n            return Object.prototype.toString.call(value) === \"[object Array]\" || value && window.ArrayBuffer && value.buffer && value.buffer.constructor === ArrayBuffer;\n        };\n        qq.isItemList = function(maybeItemList) {\n            return Object.prototype.toString.call(maybeItemList) === \"[object DataTransferItemList]\";\n        };\n        qq.isNodeList = function(maybeNodeList) {\n            return Object.prototype.toString.call(maybeNodeList) === \"[object NodeList]\" || maybeNodeList.item && maybeNodeList.namedItem;\n        };\n        qq.isString = function(maybeString) {\n            return Object.prototype.toString.call(maybeString) === \"[object String]\";\n        };\n        qq.trimStr = function(string) {\n            if (String.prototype.trim) {\n                return string.trim();\n            }\n            return string.replace(/^\\s+|\\s+$/g, \"\");\n        };\n        qq.format = function(str) {\n            var args = Array.prototype.slice.call(arguments, 1), newStr = str, nextIdxToReplace = newStr.indexOf(\"{}\");\n            qq.each(args, function(idx, val) {\n                var strBefore = newStr.substring(0, nextIdxToReplace), strAfter = newStr.substring(nextIdxToReplace + 2);\n                newStr = strBefore + val + strAfter;\n                nextIdxToReplace = newStr.indexOf(\"{}\", nextIdxToReplace + val.length);\n                if (nextIdxToReplace < 0) {\n                    return false;\n                }\n            });\n            return newStr;\n        };\n        qq.isFile = function(maybeFile) {\n            return window.File && Object.prototype.toString.call(maybeFile) === \"[object File]\";\n        };\n        qq.isFileList = function(maybeFileList) {\n            return window.FileList && Object.prototype.toString.call(maybeFileList) === \"[object FileList]\";\n        };\n        qq.isFileOrInput = function(maybeFileOrInput) {\n            return qq.isFile(maybeFileOrInput) || qq.isInput(maybeFileOrInput);\n        };\n        qq.isInput = function(maybeInput, notFile) {\n            var evaluateType = function(type) {\n                var normalizedType = type.toLowerCase();\n                if (notFile) {\n                    return normalizedType !== \"file\";\n                }\n                return normalizedType === \"file\";\n            };\n            if (window.HTMLInputElement) {\n                if (Object.prototype.toString.call(maybeInput) === \"[object HTMLInputElement]\") {\n                    if (maybeInput.type && evaluateType(maybeInput.type)) {\n                        return true;\n                    }\n                }\n            }\n            if (maybeInput.tagName) {\n                if (maybeInput.tagName.toLowerCase() === \"input\") {\n                    if (maybeInput.type && evaluateType(maybeInput.type)) {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        };\n        qq.isBlob = function(maybeBlob) {\n            if (window.Blob && Object.prototype.toString.call(maybeBlob) === \"[object Blob]\") {\n                return true;\n            }\n        };\n        qq.isXhrUploadSupported = function() {\n            var input = document.createElement(\"input\");\n            input.type = \"file\";\n            return input.multiple !== undefined && typeof File !== \"undefined\" && typeof FormData !== \"undefined\" && typeof qq.createXhrInstance().upload !== \"undefined\";\n        };\n        qq.createXhrInstance = function() {\n            if (window.XMLHttpRequest) {\n                return new XMLHttpRequest();\n            }\n            try {\n                return new ActiveXObject(\"MSXML2.XMLHTTP.3.0\");\n            } catch (error) {\n                qq.log(\"Neither XHR or ActiveX are supported!\", \"error\");\n                return null;\n            }\n        };\n        qq.isFolderDropSupported = function(dataTransfer) {\n            return dataTransfer.items && dataTransfer.items.length > 0 && dataTransfer.items[0].webkitGetAsEntry;\n        };\n        qq.isFileChunkingSupported = function() {\n            return !qq.androidStock() && qq.isXhrUploadSupported() && (File.prototype.slice !== undefined || File.prototype.webkitSlice !== undefined || File.prototype.mozSlice !== undefined);\n        };\n        qq.sliceBlob = function(fileOrBlob, start, end) {\n            var slicer = fileOrBlob.slice || fileOrBlob.mozSlice || fileOrBlob.webkitSlice;\n            return slicer.call(fileOrBlob, start, end);\n        };\n        qq.arrayBufferToHex = function(buffer) {\n            var bytesAsHex = \"\", bytes = new Uint8Array(buffer);\n            qq.each(bytes, function(idx, byt) {\n                var byteAsHexStr = byt.toString(16);\n                if (byteAsHexStr.length < 2) {\n                    byteAsHexStr = \"0\" + byteAsHexStr;\n                }\n                bytesAsHex += byteAsHexStr;\n            });\n            return bytesAsHex;\n        };\n        qq.readBlobToHex = function(blob, startOffset, length) {\n            var initialBlob = qq.sliceBlob(blob, startOffset, startOffset + length), fileReader = new FileReader(), promise = new qq.Promise();\n            fileReader.onload = function() {\n                promise.success(qq.arrayBufferToHex(fileReader.result));\n            };\n            fileReader.onerror = promise.failure;\n            fileReader.readAsArrayBuffer(initialBlob);\n            return promise;\n        };\n        qq.extend = function(first, second, extendNested) {\n            qq.each(second, function(prop, val) {\n                if (extendNested && qq.isObject(val)) {\n                    if (first[prop] === undefined) {\n                        first[prop] = {};\n                    }\n                    qq.extend(first[prop], val, true);\n                } else {\n                    first[prop] = val;\n                }\n            });\n            return first;\n        };\n        qq.override = function(target, sourceFn) {\n            var super_ = {}, source = sourceFn(super_);\n            qq.each(source, function(srcPropName, srcPropVal) {\n                if (target[srcPropName] !== undefined) {\n                    super_[srcPropName] = target[srcPropName];\n                }\n                target[srcPropName] = srcPropVal;\n            });\n            return target;\n        };\n        qq.indexOf = function(arr, elt, from) {\n            if (arr.indexOf) {\n                return arr.indexOf(elt, from);\n            }\n            from = from || 0;\n            var len = arr.length;\n            if (from < 0) {\n                from += len;\n            }\n            for (;from < len; from += 1) {\n                if (arr.hasOwnProperty(from) && arr[from] === elt) {\n                    return from;\n                }\n            }\n            return -1;\n        };\n        qq.getUniqueId = function() {\n            return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function(c) {\n                var r = Math.random() * 16 | 0, v = c == \"x\" ? r : r & 3 | 8;\n                return v.toString(16);\n            });\n        };\n        qq.ie = function() {\n            return navigator.userAgent.indexOf(\"MSIE\") !== -1 || navigator.userAgent.indexOf(\"Trident\") !== -1;\n        };\n        qq.ie7 = function() {\n            return navigator.userAgent.indexOf(\"MSIE 7\") !== -1;\n        };\n        qq.ie8 = function() {\n            return navigator.userAgent.indexOf(\"MSIE 8\") !== -1;\n        };\n        qq.ie10 = function() {\n            return navigator.userAgent.indexOf(\"MSIE 10\") !== -1;\n        };\n        qq.ie11 = function() {\n            return qq.ie() && navigator.userAgent.indexOf(\"rv:11\") !== -1;\n        };\n        qq.edge = function() {\n            return navigator.userAgent.indexOf(\"Edge\") >= 0;\n        };\n        qq.safari = function() {\n            return navigator.vendor !== undefined && navigator.vendor.indexOf(\"Apple\") !== -1;\n        };\n        qq.chrome = function() {\n            return navigator.vendor !== undefined && navigator.vendor.indexOf(\"Google\") !== -1;\n        };\n        qq.opera = function() {\n            return navigator.vendor !== undefined && navigator.vendor.indexOf(\"Opera\") !== -1;\n        };\n        qq.firefox = function() {\n            return !qq.edge() && !qq.ie11() && navigator.userAgent.indexOf(\"Mozilla\") !== -1 && navigator.vendor !== undefined && navigator.vendor === \"\";\n        };\n        qq.windows = function() {\n            return navigator.platform === \"Win32\";\n        };\n        qq.android = function() {\n            return navigator.userAgent.toLowerCase().indexOf(\"android\") !== -1;\n        };\n        qq.androidStock = function() {\n            return qq.android() && navigator.userAgent.toLowerCase().indexOf(\"chrome\") < 0 && navigator.userAgent.toLowerCase().indexOf(\"firefox\") < 0;\n        };\n        qq.ios6 = function() {\n            return qq.ios() && navigator.userAgent.indexOf(\" OS 6_\") !== -1;\n        };\n        qq.ios7 = function() {\n            return qq.ios() && navigator.userAgent.indexOf(\" OS 7_\") !== -1;\n        };\n        qq.ios8 = function() {\n            return qq.ios() && navigator.userAgent.indexOf(\" OS 8_\") !== -1;\n        };\n        qq.ios800 = function() {\n            return qq.ios() && navigator.userAgent.indexOf(\" OS 8_0 \") !== -1;\n        };\n        qq.ios = function() {\n            return navigator.userAgent.indexOf(\"iPad\") !== -1 || navigator.userAgent.indexOf(\"iPod\") !== -1 || navigator.userAgent.indexOf(\"iPhone\") !== -1;\n        };\n        qq.iosChrome = function() {\n            return qq.ios() && navigator.userAgent.indexOf(\"CriOS\") !== -1;\n        };\n        qq.iosSafari = function() {\n            return qq.ios() && !qq.iosChrome() && navigator.userAgent.indexOf(\"Safari\") !== -1;\n        };\n        qq.iosSafariWebView = function() {\n            return qq.ios() && !qq.iosChrome() && !qq.iosSafari();\n        };\n        qq.preventDefault = function(e) {\n            if (e.preventDefault) {\n                e.preventDefault();\n            } else {\n                e.returnValue = false;\n            }\n        };\n        qq.toElement = function() {\n            var div = document.createElement(\"div\");\n            return function(html) {\n                div.innerHTML = html;\n                var element = div.firstChild;\n                div.removeChild(element);\n                return element;\n            };\n        }();\n        qq.each = function(iterableItem, callback) {\n            var keyOrIndex, retVal;\n            if (iterableItem) {\n                if (window.Storage && iterableItem.constructor === window.Storage) {\n                    for (keyOrIndex = 0; keyOrIndex < iterableItem.length; keyOrIndex++) {\n                        retVal = callback(iterableItem.key(keyOrIndex), iterableItem.getItem(iterableItem.key(keyOrIndex)));\n                        if (retVal === false) {\n                            break;\n                        }\n                    }\n                } else if (qq.isArray(iterableItem) || qq.isItemList(iterableItem) || qq.isNodeList(iterableItem)) {\n                    for (keyOrIndex = 0; keyOrIndex < iterableItem.length; keyOrIndex++) {\n                        retVal = callback(keyOrIndex, iterableItem[keyOrIndex]);\n                        if (retVal === false) {\n                            break;\n                        }\n                    }\n                } else if (qq.isString(iterableItem)) {\n                    for (keyOrIndex = 0; keyOrIndex < iterableItem.length; keyOrIndex++) {\n                        retVal = callback(keyOrIndex, iterableItem.charAt(keyOrIndex));\n                        if (retVal === false) {\n                            break;\n                        }\n                    }\n                } else {\n                    for (keyOrIndex in iterableItem) {\n                        if (Object.prototype.hasOwnProperty.call(iterableItem, keyOrIndex)) {\n                            retVal = callback(keyOrIndex, iterableItem[keyOrIndex]);\n                            if (retVal === false) {\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n        };\n        qq.bind = function(oldFunc, context) {\n            if (qq.isFunction(oldFunc)) {\n                var args = Array.prototype.slice.call(arguments, 2);\n                return function() {\n                    var newArgs = qq.extend([], args);\n                    if (arguments.length) {\n                        newArgs = newArgs.concat(Array.prototype.slice.call(arguments));\n                    }\n                    return oldFunc.apply(context, newArgs);\n                };\n            }\n            throw new Error(\"first parameter must be a function!\");\n        };\n        qq.obj2url = function(obj, temp, prefixDone) {\n            var uristrings = [], prefix = \"&\", add = function(nextObj, i) {\n                var nextTemp = temp ? /\\[\\]$/.test(temp) ? temp : temp + \"[\" + i + \"]\" : i;\n                if (nextTemp !== \"undefined\" && i !== \"undefined\") {\n                    uristrings.push(typeof nextObj === \"object\" ? qq.obj2url(nextObj, nextTemp, true) : Object.prototype.toString.call(nextObj) === \"[object Function]\" ? encodeURIComponent(nextTemp) + \"=\" + encodeURIComponent(nextObj()) : encodeURIComponent(nextTemp) + \"=\" + encodeURIComponent(nextObj));\n                }\n            };\n            if (!prefixDone && temp) {\n                prefix = /\\?/.test(temp) ? /\\?$/.test(temp) ? \"\" : \"&\" : \"?\";\n                uristrings.push(temp);\n                uristrings.push(qq.obj2url(obj));\n            } else if (Object.prototype.toString.call(obj) === \"[object Array]\" && typeof obj !== \"undefined\") {\n                qq.each(obj, function(idx, val) {\n                    add(val, idx);\n                });\n            } else if (typeof obj !== \"undefined\" && obj !== null && typeof obj === \"object\") {\n                qq.each(obj, function(prop, val) {\n                    add(val, prop);\n                });\n            } else {\n                uristrings.push(encodeURIComponent(temp) + \"=\" + encodeURIComponent(obj));\n            }\n            if (temp) {\n                return uristrings.join(prefix);\n            } else {\n                return uristrings.join(prefix).replace(/^&/, \"\").replace(/%20/g, \"+\");\n            }\n        };\n        qq.obj2FormData = function(obj, formData, arrayKeyName) {\n            if (!formData) {\n                formData = new FormData();\n            }\n            qq.each(obj, function(key, val) {\n                key = arrayKeyName ? arrayKeyName + \"[\" + key + \"]\" : key;\n                if (qq.isObject(val)) {\n                    qq.obj2FormData(val, formData, key);\n                } else if (qq.isFunction(val)) {\n                    formData.append(key, val());\n                } else {\n                    formData.append(key, val);\n                }\n            });\n            return formData;\n        };\n        qq.obj2Inputs = function(obj, form) {\n            var input;\n            if (!form) {\n                form = document.createElement(\"form\");\n            }\n            qq.obj2FormData(obj, {\n                append: function(key, val) {\n                    input = document.createElement(\"input\");\n                    input.setAttribute(\"name\", key);\n                    input.setAttribute(\"value\", val);\n                    form.appendChild(input);\n                }\n            });\n            return form;\n        };\n        qq.parseJson = function(json) {\n            if (window.JSON && qq.isFunction(JSON.parse)) {\n                return JSON.parse(json);\n            } else {\n                return eval(\"(\" + json + \")\");\n            }\n        };\n        qq.getExtension = function(filename) {\n            var extIdx = filename.lastIndexOf(\".\") + 1;\n            if (extIdx > 0) {\n                return filename.substr(extIdx, filename.length - extIdx);\n            }\n        };\n        qq.getFilename = function(blobOrFileInput) {\n            if (qq.isInput(blobOrFileInput)) {\n                return blobOrFileInput.value.replace(/.*(\\/|\\\\)/, \"\");\n            } else if (qq.isFile(blobOrFileInput)) {\n                if (blobOrFileInput.fileName !== null && blobOrFileInput.fileName !== undefined) {\n                    return blobOrFileInput.fileName;\n                }\n            }\n            return blobOrFileInput.name;\n        };\n        qq.DisposeSupport = function() {\n            var disposers = [];\n            return {\n                dispose: function() {\n                    var disposer;\n                    do {\n                        disposer = disposers.shift();\n                        if (disposer) {\n                            disposer();\n                        }\n                    } while (disposer);\n                },\n                attach: function() {\n                    var args = arguments;\n                    this.addDisposer(qq(args[0]).attach.apply(this, Array.prototype.slice.call(arguments, 1)));\n                },\n                addDisposer: function(disposeFunction) {\n                    disposers.push(disposeFunction);\n                }\n            };\n        };\n    })();\n    (function() {\n        \"use strict\";\n        if (typeof define === \"function\" && define.amd) {\n            define(function() {\n                return qq;\n            });\n        } else if (typeof module !== \"undefined\" && module.exports) {\n            module.exports = qq;\n        } else {\n            global.qq = qq;\n        }\n    })();\n    qq.version = \"6.0.3\";\n    qq.supportedFeatures = function() {\n        \"use strict\";\n        var supportsUploading, supportsUploadingBlobs, supportsFileDrop, supportsAjaxFileUploading, supportsFolderDrop, supportsChunking, supportsResume, supportsUploadViaPaste, supportsUploadCors, supportsDeleteFileXdr, supportsDeleteFileCorsXhr, supportsDeleteFileCors, supportsFolderSelection, supportsImagePreviews, supportsUploadProgress;\n        function testSupportsFileInputElement() {\n            var supported = true, tempInput;\n            try {\n                tempInput = document.createElement(\"input\");\n                tempInput.type = \"file\";\n                qq(tempInput).hide();\n                if (tempInput.disabled) {\n                    supported = false;\n                }\n            } catch (ex) {\n                supported = false;\n            }\n            return supported;\n        }\n        function isChrome14OrHigher() {\n            return (qq.chrome() || qq.opera()) && navigator.userAgent.match(/Chrome\\/[1][4-9]|Chrome\\/[2-9][0-9]/) !== undefined;\n        }\n        function isCrossOriginXhrSupported() {\n            if (window.XMLHttpRequest) {\n                var xhr = qq.createXhrInstance();\n                return xhr.withCredentials !== undefined;\n            }\n            return false;\n        }\n        function isXdrSupported() {\n            return window.XDomainRequest !== undefined;\n        }\n        function isCrossOriginAjaxSupported() {\n            if (isCrossOriginXhrSupported()) {\n                return true;\n            }\n            return isXdrSupported();\n        }\n        function isFolderSelectionSupported() {\n            return document.createElement(\"input\").webkitdirectory !== undefined;\n        }\n        function isLocalStorageSupported() {\n            try {\n                return !!window.localStorage && qq.isFunction(window.localStorage.setItem);\n            } catch (error) {\n                return false;\n            }\n        }\n        function isDragAndDropSupported() {\n            var span = document.createElement(\"span\");\n            return (\"draggable\" in span || \"ondragstart\" in span && \"ondrop\" in span) && !qq.android() && !qq.ios();\n        }\n        supportsUploading = testSupportsFileInputElement();\n        supportsAjaxFileUploading = supportsUploading && qq.isXhrUploadSupported();\n        supportsUploadingBlobs = supportsAjaxFileUploading && !qq.androidStock();\n        supportsFileDrop = supportsAjaxFileUploading && isDragAndDropSupported();\n        supportsFolderDrop = supportsFileDrop && function() {\n            var input = document.createElement(\"input\");\n            input.type = \"file\";\n            return !!(\"webkitdirectory\" in (input || document.querySelectorAll(\"input[type=file]\")[0]));\n        }();\n        supportsChunking = supportsAjaxFileUploading && qq.isFileChunkingSupported();\n        supportsResume = supportsAjaxFileUploading && supportsChunking && isLocalStorageSupported();\n        supportsUploadViaPaste = supportsAjaxFileUploading && isChrome14OrHigher();\n        supportsUploadCors = supportsUploading && (window.postMessage !== undefined || supportsAjaxFileUploading);\n        supportsDeleteFileCorsXhr = isCrossOriginXhrSupported();\n        supportsDeleteFileXdr = isXdrSupported();\n        supportsDeleteFileCors = isCrossOriginAjaxSupported();\n        supportsFolderSelection = isFolderSelectionSupported();\n        supportsImagePreviews = supportsAjaxFileUploading && window.FileReader !== undefined;\n        supportsUploadProgress = function() {\n            if (supportsAjaxFileUploading) {\n                return !qq.androidStock() && !qq.iosChrome();\n            }\n            return false;\n        }();\n        return {\n            ajaxUploading: supportsAjaxFileUploading,\n            blobUploading: supportsUploadingBlobs,\n            canDetermineSize: supportsAjaxFileUploading,\n            chunking: supportsChunking,\n            deleteFileCors: supportsDeleteFileCors,\n            deleteFileCorsXdr: supportsDeleteFileXdr,\n            deleteFileCorsXhr: supportsDeleteFileCorsXhr,\n            dialogElement: !!window.HTMLDialogElement,\n            fileDrop: supportsFileDrop,\n            folderDrop: supportsFolderDrop,\n            folderSelection: supportsFolderSelection,\n            imagePreviews: supportsImagePreviews,\n            imageValidation: supportsImagePreviews,\n            itemSizeValidation: supportsAjaxFileUploading,\n            pause: supportsChunking,\n            progressBar: supportsUploadProgress,\n            resume: supportsResume,\n            scaling: supportsImagePreviews && supportsUploadingBlobs,\n            tiffPreviews: qq.safari(),\n            unlimitedScaledImageSize: !qq.ios(),\n            uploading: supportsUploading,\n            uploadCors: supportsUploadCors,\n            uploadCustomHeaders: supportsAjaxFileUploading,\n            uploadNonMultipart: supportsAjaxFileUploading,\n            uploadViaPaste: supportsUploadViaPaste\n        };\n    }();\n    qq.isGenericPromise = function(maybePromise) {\n        \"use strict\";\n        return !!(maybePromise && maybePromise.then && qq.isFunction(maybePromise.then));\n    };\n    qq.Promise = function() {\n        \"use strict\";\n        var successArgs, failureArgs, successCallbacks = [], failureCallbacks = [], doneCallbacks = [], state = 0;\n        qq.extend(this, {\n            then: function(onSuccess, onFailure) {\n                if (state === 0) {\n                    if (onSuccess) {\n                        successCallbacks.push(onSuccess);\n                    }\n                    if (onFailure) {\n                        failureCallbacks.push(onFailure);\n                    }\n                } else if (state === -1) {\n                    onFailure && onFailure.apply(null, failureArgs);\n                } else if (onSuccess) {\n                    onSuccess.apply(null, successArgs);\n                }\n                return this;\n            },\n            done: function(callback) {\n                if (state === 0) {\n                    doneCallbacks.push(callback);\n                } else {\n                    callback.apply(null, failureArgs === undefined ? successArgs : failureArgs);\n                }\n                return this;\n            },\n            success: function() {\n                state = 1;\n                successArgs = arguments;\n                if (successCallbacks.length) {\n                    qq.each(successCallbacks, function(idx, callback) {\n                        callback.apply(null, successArgs);\n                    });\n                }\n                if (doneCallbacks.length) {\n                    qq.each(doneCallbacks, function(idx, callback) {\n                        callback.apply(null, successArgs);\n                    });\n                }\n                return this;\n            },\n            failure: function() {\n                state = -1;\n                failureArgs = arguments;\n                if (failureCallbacks.length) {\n                    qq.each(failureCallbacks, function(idx, callback) {\n                        callback.apply(null, failureArgs);\n                    });\n                }\n                if (doneCallbacks.length) {\n                    qq.each(doneCallbacks, function(idx, callback) {\n                        callback.apply(null, failureArgs);\n                    });\n                }\n                return this;\n            }\n        });\n    };\n    qq.DragAndDrop = function(o) {\n        \"use strict\";\n        var options, HIDE_ZONES_EVENT_NAME = \"qq-hidezones\", HIDE_BEFORE_ENTER_ATTR = \"qq-hide-dropzone\", uploadDropZones = [], droppedFiles = [], disposeSupport = new qq.DisposeSupport();\n        options = {\n            dropZoneElements: [],\n            allowMultipleItems: true,\n            classes: {\n                dropActive: null\n            },\n            callbacks: new qq.DragAndDrop.callbacks()\n        };\n        qq.extend(options, o, true);\n        function uploadDroppedFiles(files, uploadDropZone) {\n            var filesAsArray = Array.prototype.slice.call(files);\n            options.callbacks.dropLog(\"Grabbed \" + files.length + \" dropped files.\");\n            uploadDropZone.dropDisabled(false);\n            options.callbacks.processingDroppedFilesComplete(filesAsArray, uploadDropZone.getElement());\n        }\n        function traverseFileTree(entry) {\n            var parseEntryPromise = new qq.Promise();\n            if (entry.isFile) {\n                entry.file(function(file) {\n                    file.qqPath = extractDirectoryPath(entry);\n                    droppedFiles.push(file);\n                    parseEntryPromise.success();\n                }, function(fileError) {\n                    options.callbacks.dropLog(\"Problem parsing '\" + entry.fullPath + \"'.  FileError code \" + fileError.code + \".\", \"error\");\n                    parseEntryPromise.failure();\n                });\n            } else if (entry.isDirectory) {\n                getFilesInDirectory(entry).then(function allEntriesRead(entries) {\n                    var entriesLeft = entries.length;\n                    qq.each(entries, function(idx, entry) {\n                        traverseFileTree(entry).done(function() {\n                            entriesLeft -= 1;\n                            if (entriesLeft === 0) {\n                                parseEntryPromise.success();\n                            }\n                        });\n                    });\n                    if (!entries.length) {\n                        parseEntryPromise.success();\n                    }\n                }, function readFailure(fileError) {\n                    options.callbacks.dropLog(\"Problem parsing '\" + entry.fullPath + \"'.  FileError code \" + fileError.code + \".\", \"error\");\n                    parseEntryPromise.failure();\n                });\n            }\n            return parseEntryPromise;\n        }\n        function extractDirectoryPath(entry) {\n            var name = entry.name, fullPath = entry.fullPath, indexOfNameInFullPath = fullPath.lastIndexOf(name);\n            fullPath = fullPath.substr(0, indexOfNameInFullPath);\n            if (fullPath.charAt(0) === \"/\") {\n                fullPath = fullPath.substr(1);\n            }\n            return fullPath;\n        }\n        function getFilesInDirectory(entry, reader, accumEntries, existingPromise) {\n            var promise = existingPromise || new qq.Promise(), dirReader = reader || entry.createReader();\n            dirReader.readEntries(function readSuccess(entries) {\n                var newEntries = accumEntries ? accumEntries.concat(entries) : entries;\n                if (entries.length) {\n                    setTimeout(function() {\n                        getFilesInDirectory(entry, dirReader, newEntries, promise);\n                    }, 0);\n                } else {\n                    promise.success(newEntries);\n                }\n            }, promise.failure);\n            return promise;\n        }\n        function handleDataTransfer(dataTransfer, uploadDropZone) {\n            var pendingFolderPromises = [], handleDataTransferPromise = new qq.Promise();\n            options.callbacks.processingDroppedFiles();\n            uploadDropZone.dropDisabled(true);\n            if (dataTransfer.files.length > 1 && !options.allowMultipleItems) {\n                options.callbacks.processingDroppedFilesComplete([]);\n                options.callbacks.dropError(\"tooManyFilesError\", \"\");\n                uploadDropZone.dropDisabled(false);\n                handleDataTransferPromise.failure();\n            } else {\n                droppedFiles = [];\n                if (qq.isFolderDropSupported(dataTransfer)) {\n                    qq.each(dataTransfer.items, function(idx, item) {\n                        var entry = item.webkitGetAsEntry();\n                        if (entry) {\n                            if (entry.isFile) {\n                                droppedFiles.push(item.getAsFile());\n                            } else {\n                                pendingFolderPromises.push(traverseFileTree(entry).done(function() {\n                                    pendingFolderPromises.pop();\n                                    if (pendingFolderPromises.length === 0) {\n                                        handleDataTransferPromise.success();\n                                    }\n                                }));\n                            }\n                        }\n                    });\n                } else {\n                    droppedFiles = dataTransfer.files;\n                }\n                if (pendingFolderPromises.length === 0) {\n                    handleDataTransferPromise.success();\n                }\n            }\n            return handleDataTransferPromise;\n        }\n        function setupDropzone(dropArea) {\n            var dropZone = new qq.UploadDropZone({\n                HIDE_ZONES_EVENT_NAME: HIDE_ZONES_EVENT_NAME,\n                element: dropArea,\n                onEnter: function(e) {\n                    qq(dropArea).addClass(options.classes.dropActive);\n                    options.callbacks.dragEnter();\n                    e.stopPropagation();\n                },\n                onLeaveNotDescendants: function(e) {\n                    qq(dropArea).removeClass(options.classes.dropActive);\n                    options.callbacks.dragLeave();\n                },\n                onDrop: function(e) {\n                    handleDataTransfer(e.dataTransfer, dropZone).then(function() {\n                        uploadDroppedFiles(droppedFiles, dropZone);\n                    }, function() {\n                        options.callbacks.dropLog(\"Drop event DataTransfer parsing failed.  No files will be uploaded.\", \"error\");\n                    });\n                }\n            });\n            disposeSupport.addDisposer(function() {\n                dropZone.dispose();\n            });\n            qq(dropArea).hasAttribute(HIDE_BEFORE_ENTER_ATTR) && qq(dropArea).hide();\n            uploadDropZones.push(dropZone);\n            return dropZone;\n        }\n        function isFileDrag(dragEvent) {\n            var fileDrag;\n            qq.each(dragEvent.dataTransfer.types, function(key, val) {\n                if (val === \"Files\") {\n                    fileDrag = true;\n                    return false;\n                }\n            });\n            return fileDrag;\n        }\n        function leavingDocumentOut(e) {\n            if (qq.safari()) {\n                return e.x < 0 || e.y < 0;\n            }\n            return e.x === 0 && e.y === 0;\n        }\n        function setupDragDrop() {\n            var dropZones = options.dropZoneElements, maybeHideDropZones = function() {\n                setTimeout(function() {\n                    qq.each(dropZones, function(idx, dropZone) {\n                        qq(dropZone).hasAttribute(HIDE_BEFORE_ENTER_ATTR) && qq(dropZone).hide();\n                        qq(dropZone).removeClass(options.classes.dropActive);\n                    });\n                }, 10);\n            };\n            qq.each(dropZones, function(idx, dropZone) {\n                var uploadDropZone = setupDropzone(dropZone);\n                if (dropZones.length && qq.supportedFeatures.fileDrop) {\n                    disposeSupport.attach(document, \"dragenter\", function(e) {\n                        if (!uploadDropZone.dropDisabled() && isFileDrag(e)) {\n                            qq.each(dropZones, function(idx, dropZone) {\n                                if (dropZone instanceof HTMLElement && qq(dropZone).hasAttribute(HIDE_BEFORE_ENTER_ATTR)) {\n                                    qq(dropZone).css({\n                                        display: \"block\"\n                                    });\n                                }\n                            });\n                        }\n                    });\n                }\n            });\n            disposeSupport.attach(document, \"dragleave\", function(e) {\n                if (leavingDocumentOut(e)) {\n                    maybeHideDropZones();\n                }\n            });\n            disposeSupport.attach(qq(document).children()[0], \"mouseenter\", function(e) {\n                maybeHideDropZones();\n            });\n            disposeSupport.attach(document, \"drop\", function(e) {\n                if (isFileDrag(e)) {\n                    e.preventDefault();\n                    maybeHideDropZones();\n                }\n            });\n            disposeSupport.attach(document, HIDE_ZONES_EVENT_NAME, maybeHideDropZones);\n        }\n        setupDragDrop();\n        qq.extend(this, {\n            setupExtraDropzone: function(element) {\n                options.dropZoneElements.push(element);\n                setupDropzone(element);\n            },\n            removeDropzone: function(element) {\n                var i, dzs = options.dropZoneElements;\n                for (i in dzs) {\n                    if (dzs[i] === element) {\n                        return dzs.splice(i, 1);\n                    }\n                }\n            },\n            dispose: function() {\n                disposeSupport.dispose();\n                qq.each(uploadDropZones, function(idx, dropZone) {\n                    dropZone.dispose();\n                });\n            }\n        });\n        this._testing = {};\n        this._testing.extractDirectoryPath = extractDirectoryPath;\n    };\n    qq.DragAndDrop.callbacks = function() {\n        \"use strict\";\n        return {\n            dragEnter: function() {},\n            dragLeave: function() {},\n            processingDroppedFiles: function() {},\n            processingDroppedFilesComplete: function(files, targetEl) {},\n            dropError: function(code, errorSpecifics) {\n                qq.log(\"Drag & drop error code '\" + code + \" with these specifics: '\" + errorSpecifics + \"'\", \"error\");\n            },\n            dropLog: function(message, level) {\n                qq.log(message, level);\n            }\n        };\n    };\n    qq.UploadDropZone = function(o) {\n        \"use strict\";\n        var disposeSupport = new qq.DisposeSupport(), options, element, preventDrop, dropOutsideDisabled;\n        options = {\n            element: null,\n            onEnter: function(e) {},\n            onLeave: function(e) {},\n            onLeaveNotDescendants: function(e) {},\n            onDrop: function(e) {}\n        };\n        qq.extend(options, o);\n        element = options.element;\n        function dragoverShouldBeCanceled() {\n            return qq.safari() || qq.firefox() && qq.windows();\n        }\n        function disableDropOutside(e) {\n            if (!dropOutsideDisabled) {\n                if (dragoverShouldBeCanceled) {\n                    disposeSupport.attach(document, \"dragover\", function(e) {\n                        e.preventDefault();\n                    });\n                } else {\n                    disposeSupport.attach(document, \"dragover\", function(e) {\n                        if (e.dataTransfer) {\n                            e.dataTransfer.dropEffect = \"none\";\n                            e.preventDefault();\n                        }\n                    });\n                }\n                dropOutsideDisabled = true;\n            }\n        }\n        function isValidFileDrag(e) {\n            if (!qq.supportedFeatures.fileDrop) {\n                return false;\n            }\n            var effectTest, dt = e.dataTransfer, isSafari = qq.safari();\n            effectTest = qq.ie() && qq.supportedFeatures.fileDrop ? true : dt.effectAllowed !== \"none\";\n            return dt && effectTest && (dt.files && dt.files.length || !isSafari && dt.types.contains && dt.types.contains(\"Files\") || dt.types.includes && dt.types.includes(\"Files\"));\n        }\n        function isOrSetDropDisabled(isDisabled) {\n            if (isDisabled !== undefined) {\n                preventDrop = isDisabled;\n            }\n            return preventDrop;\n        }\n        function triggerHidezonesEvent() {\n            var hideZonesEvent;\n            function triggerUsingOldApi() {\n                hideZonesEvent = document.createEvent(\"Event\");\n                hideZonesEvent.initEvent(options.HIDE_ZONES_EVENT_NAME, true, true);\n            }\n            if (window.CustomEvent) {\n                try {\n                    hideZonesEvent = new CustomEvent(options.HIDE_ZONES_EVENT_NAME);\n                } catch (err) {\n                    triggerUsingOldApi();\n                }\n            } else {\n                triggerUsingOldApi();\n            }\n            document.dispatchEvent(hideZonesEvent);\n        }\n        function attachEvents() {\n            disposeSupport.attach(element, \"dragover\", function(e) {\n                if (!isValidFileDrag(e)) {\n                    return;\n                }\n                var effect = qq.ie() && qq.supportedFeatures.fileDrop ? null : e.dataTransfer.effectAllowed;\n                if (effect === \"move\" || effect === \"linkMove\") {\n                    e.dataTransfer.dropEffect = \"move\";\n                } else {\n                    e.dataTransfer.dropEffect = \"copy\";\n                }\n                e.stopPropagation();\n                e.preventDefault();\n            });\n            disposeSupport.attach(element, \"dragenter\", function(e) {\n                if (!isOrSetDropDisabled()) {\n                    if (!isValidFileDrag(e)) {\n                        return;\n                    }\n                    options.onEnter(e);\n                }\n            });\n            disposeSupport.attach(element, \"dragleave\", function(e) {\n                if (!isValidFileDrag(e)) {\n                    return;\n                }\n                options.onLeave(e);\n                var relatedTarget = document.elementFromPoint(e.clientX, e.clientY);\n                if (qq(this).contains(relatedTarget)) {\n                    return;\n                }\n                options.onLeaveNotDescendants(e);\n            });\n            disposeSupport.attach(element, \"drop\", function(e) {\n                if (!isOrSetDropDisabled()) {\n                    if (!isValidFileDrag(e)) {\n                        return;\n                    }\n                    e.preventDefault();\n                    e.stopPropagation();\n                    options.onDrop(e);\n                    triggerHidezonesEvent();\n                }\n            });\n        }\n        disableDropOutside();\n        attachEvents();\n        qq.extend(this, {\n            dropDisabled: function(isDisabled) {\n                return isOrSetDropDisabled(isDisabled);\n            },\n            dispose: function() {\n                disposeSupport.dispose();\n            },\n            getElement: function() {\n                return element;\n            }\n        });\n        this._testing = {};\n        this._testing.isValidFileDrag = isValidFileDrag;\n    };\n})(window);\n//# sourceMappingURL=dnd.js.map","/* jshint node: true */\n'use strict';\n\n/**\n  # wildcard\n\n  Very simple wildcard matching, which is designed to provide the same\n  functionality that is found in the\n  [eve](https://github.com/adobe-webplatform/eve) eventing library.\n\n  ## Usage\n\n  It works with strings:\n\n  <<< examples/strings.js\n\n  Arrays:\n\n  <<< examples/arrays.js\n\n  Objects (matching against keys):\n\n  <<< examples/objects.js\n\n  While the library works in Node, if you are are looking for file-based\n  wildcard matching then you should have a look at:\n\n  <https://github.com/isaacs/node-glob>\n**/\n\nfunction WildcardMatcher(text, separator) {\n  this.text = text = text || '';\n  this.hasWild = ~text.indexOf('*');\n  this.separator = separator;\n  this.parts = text.split(separator);\n}\n\nWildcardMatcher.prototype.match = function(input) {\n  var matches = true;\n  var parts = this.parts;\n  var ii;\n  var partsCount = parts.length;\n  var testParts;\n\n  if (typeof input == 'string' || input instanceof String) {\n    if (!this.hasWild && this.text != input) {\n      matches = false;\n    } else {\n      testParts = (input || '').split(this.separator);\n      for (ii = 0; matches && ii < partsCount; ii++) {\n        if (parts[ii] === '*')  {\n          continue;\n        } else if (ii < testParts.length) {\n          matches = parts[ii] === testParts[ii];\n        } else {\n          matches = false;\n        }\n      }\n\n      // If matches, then return the component parts\n      matches = matches && testParts;\n    }\n  }\n  else if (typeof input.splice == 'function') {\n    matches = [];\n\n    for (ii = input.length; ii--; ) {\n      if (this.match(input[ii])) {\n        matches[matches.length] = input[ii];\n      }\n    }\n  }\n  else if (typeof input == 'object') {\n    matches = {};\n\n    for (var key in input) {\n      if (this.match(key)) {\n        matches[key] = input[key];\n      }\n    }\n  }\n\n  return matches;\n};\n\nmodule.exports = function(text, test, separator) {\n  var matcher = new WildcardMatcher(text, separator || /[\\/\\.]/);\n  if (typeof test != 'undefined') {\n    return matcher.match(test);\n  }\n\n  return matcher;\n};\n","var map = {\n\t\"./7z.svg\": 9,\n\t\"./ai.svg\": 10,\n\t\"./archive.svg\": 11,\n\t\"./audio.svg\": 12,\n\t\"./avi.svg\": 13,\n\t\"./csv.svg\": 14,\n\t\"./doc.svg\": 15,\n\t\"./html.svg\": 16,\n\t\"./iso.svg\": 17,\n\t\"./json.svg\": 18,\n\t\"./mp3.svg\": 19,\n\t\"./mp4.svg\": 20,\n\t\"./pdf.svg\": 21,\n\t\"./ppt.svg\": 22,\n\t\"./psd.svg\": 23,\n\t\"./rar.svg\": 24,\n\t\"./rtf.svg\": 25,\n\t\"./svg.svg\": 26,\n\t\"./tar.svg\": 27,\n\t\"./txt.svg\": 28,\n\t\"./unknown.svg\": 29,\n\t\"./video.svg\": 30,\n\t\"./xls.svg\": 31,\n\t\"./xml.svg\": 32,\n\t\"./zip.svg\": 33\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 8;","module.exports = __webpack_public_path__ + \"image/7z.svg\";","module.exports = __webpack_public_path__ + \"image/ai.svg\";","module.exports = __webpack_public_path__ + \"image/archive.svg\";","module.exports = __webpack_public_path__ + \"image/audio.svg\";","module.exports = __webpack_public_path__ + \"image/avi.svg\";","module.exports = __webpack_public_path__ + \"image/csv.svg\";","module.exports = __webpack_public_path__ + \"image/doc.svg\";","module.exports = __webpack_public_path__ + \"image/html.svg\";","module.exports = __webpack_public_path__ + \"image/iso.svg\";","module.exports = __webpack_public_path__ + \"image/json.svg\";","module.exports = __webpack_public_path__ + \"image/mp3.svg\";","module.exports = __webpack_public_path__ + \"image/mp4.svg\";","module.exports = __webpack_public_path__ + \"image/pdf.svg\";","module.exports = __webpack_public_path__ + \"image/ppt.svg\";","module.exports = __webpack_public_path__ + \"image/psd.svg\";","module.exports = __webpack_public_path__ + \"image/rar.svg\";","module.exports = __webpack_public_path__ + \"image/rtf.svg\";","module.exports = __webpack_public_path__ + \"image/svg.svg\";","module.exports = __webpack_public_path__ + \"image/tar.svg\";","module.exports = __webpack_public_path__ + \"image/txt.svg\";","module.exports = __webpack_public_path__ + \"image/unknown.svg\";","module.exports = __webpack_public_path__ + \"image/video.svg\";","module.exports = __webpack_public_path__ + \"image/xls.svg\";","module.exports = __webpack_public_path__ + \"image/xml.svg\";","module.exports = __webpack_public_path__ + \"image/zip.svg\";","import {FineUploaderBasic, isFile} from \"./fine-uploader/fine-uploader.core\";\nimport {DragAndDrop} from \"./fine-uploader/dnd\";\nimport match from 'mime-match';\n\n// PaperAdmin API\nconst EventEmitter = window.paperAdmin.EventEmitter;\n\n\n/**\n *       onSubmit()\n * @constructor\n */\nfunction ValidationError() {\n    Error.apply(this, arguments) ;\n    this.name = \"ValidationError\";\n    if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, ValidationError);\n    } else {\n        this.stack = (new Error()).stack;\n    }\n}\n\nValidationError.prototype = Object.create(Error.prototype);\n\n\n/**\n * -   Fine Uploader.\n * @param element\n * @param options\n * @constructor\n */\nfunction Uploader(element, options) {\n    this._opts = Object.assign({\n        url: '',\n        multiple: false,\n        maxConnections: 1,\n        button: null,\n        dropzones: null,\n        extraData: null,\n        validation: {},\n        filters: []\n    }, options);\n\n    this.element = element;\n    this.uploader = this._makeUploader();\n}\n\nUploader.prototype = Object.create(EventEmitter.prototype);\n\nUploader.prototype.getParams = function() {\n    if (typeof this._opts.extraData === 'function') {\n        return Object.assign(getPaperParams(this.element), this._opts.extraData.call(this));\n    } else if (typeof this._opts.extraData === 'object') {\n        return Object.assign(getPaperParams(this.element), this._opts.extraData);\n    } else {\n        return getPaperParams(this.element);\n    }\n};\n\nUploader.prototype._makeUploader = function() {\n    const _this = this;\n\n    // ,     multiple=false\n    let is_loading = false;\n\n    let uploader = new FineUploaderBasic({\n        button: this._opts.button,\n        multiple: this._opts.multiple,\n        maxConnections: this._opts.maxConnections,\n        request: {\n            endpoint: this._opts.url,\n            params: this.getParams()\n        },\n        chunking: {\n            enabled: true,\n            partSize: 2 * 1024 * 1024,\n            concurrent: {\n                enabled: false\n            }\n        },\n        text: {\n            fileInputTitle: ''\n        },\n        validation: {\n            stopOnFirstInvalidFile: false,\n            sizeLimit: _this._opts.validation.sizeLimit || 0,\n            acceptFiles: _this._opts.validation.acceptFiles || null,\n            allowedExtensions: _this._opts.validation.allowedExtensions || []\n        },\n        messages: {\n            typeError: \"`{file}` has an invalid extension. Valid extension(s): {extensions}.\",\n            sizeError: \"`{file}` is too large, maximum file size is {sizeLimit}.\",\n        },\n        callbacks: {\n            onSubmit: function(id) {\n                const uploader = this;\n                const file = uploader.getFile(id);\n\n                if (is_loading && !_this._opts.multiple) {\n                    return false\n                } else {\n                    is_loading = true;\n                }\n\n                //     \n                if (_this._opts.filters && _this._opts.filters.length) {\n                    for (let index=0; index<_this._opts.filters.length; index++) {\n                        const filter = _this._opts.filters[index];\n                        try {\n                            filter.call(uploader, id, file);\n                        } catch (error) {\n                            _this.trigger('error', [id, error.message]);\n                            return false;\n                        }\n                    }\n                }\n\n                const validationOptions = _this._opts.validation;\n                if (isFile(file)) {\n                    // check mimetypes\n                    const allowedMimeTypes = validationOptions.acceptFiles;\n                    if (allowedMimeTypes && allowedMimeTypes.length) {\n                        let allowed = false;\n                        if (Array.isArray(allowedMimeTypes)) {\n                            allowed = allowedMimeTypes.some(function(template) {\n                                return match(file.type, template);\n                            });\n                        } else if (typeof allowedMimeTypes === 'string') {\n                            allowed = match(file.type, allowedMimeTypes);\n                        }\n\n                        if (!allowed) {\n                            const reason = `\\`${file.name}\\` has an invalid mimetype '${file.type}'`;\n                            _this.trigger('error', [id, reason]);\n                            return false;\n                        }\n                    }\n\n                    // check image size\n                    if (validationOptions.image) {\n                        return new Promise(function(resolve, reject) {\n                            const image = new Image();\n                            const url = window.URL && window.URL.createObjectURL ? window.URL : window.webkitURL && window.webkitURL.createObjectURL ? window.webkitURL : null;\n                            if (url) {\n                                image.onerror = function() {\n                                    reject(\"Cannot determine dimensions for an image. May be too large.\");\n                                };\n                                image.onload = function() {\n                                    resolve({\n                                        width: this.width,\n                                        height: this.height\n                                    });\n                                };\n                                image.src = url.createObjectURL(file);\n                            } else {\n                                reject(\"No createObjectURL function available to generate image URL!\");\n                            }\n                        }).then(function(size) {\n                            if (validationOptions.minImageWidth && (size.width < validationOptions.minImageWidth)) {\n                                const reason = `\\`${file.name}\\` is not wide enough. Minimum width is ${validationOptions.minImageWidth}px`;\n                                _this.trigger('error', [id, reason]);\n                                throw new Error(reason);\n                            }\n                            if (validationOptions.minImageHeight && (size.height < validationOptions.minImageHeight)) {\n                                const reason = `\\`${file.name}\\` is not tall enough. Minimum height is ${validationOptions.minImageHeight}px`;\n                                _this.trigger('error', [id, reason]);\n                                throw new Error(reason);\n                            }\n                            if (validationOptions.maxImageWidth && (size.width > validationOptions.maxImageWidth)) {\n                                const reason = `\\`${file.name}\\` is too wide. Maximum width is ${validationOptions.maxImageWidth}px`;\n                                _this.trigger('error', [id, reason]);\n                                throw new Error(reason);\n                            }\n                            if (validationOptions.maxImageHeight && (size.height > validationOptions.maxImageHeight)) {\n                                const reason = `\\`${file.name}\\` is too tall. Maximum height is ${validationOptions.maxImageHeight}px`;\n                                _this.trigger('error', [id, reason]);\n                                throw new Error(reason);\n                            }\n                        });\n                    }\n                }\n\n                try {\n                    _this.trigger('submit', [id]);\n                } catch (e) {\n                    if (e.name === 'ValidationError') {\n                        return false;\n                    } else {\n                        throw e;\n                    }\n                }\n            },\n            onSubmitted: function(id) {\n                _this.trigger('submitted', [id]);\n            },\n            onUpload: function(id) {\n                _this.trigger('upload', [id]);\n            },\n            onProgress: function(id, name, uploadedBytes, totalBytes) {\n                const percentage = Math.ceil(100 * (uploadedBytes / totalBytes));\n                _this.trigger('progress', [id, percentage]);\n            },\n            onCancel: function(id) {\n                _this.trigger('cancel', [id]);\n            },\n            onComplete: function(id, name, response) {\n                if (response.success) {\n                    _this.trigger('complete', [id, response]);\n                }\n            },\n            onAllComplete: function(succeeded, failed) {\n                is_loading = false;\n                _this.trigger('all_complete', [succeeded, failed]);\n            },\n            onError: function(id, name, reason, xhr) {\n                let response, messages;\n                try {\n                    response = JSON.parse(xhr.responseText);\n                } catch (error) {\n\n                }\n\n                if (response) {\n                    messages = response.errors || response.error || reason;\n                } else {\n                    messages = reason;\n                }\n\n                _this.trigger('error', [id, messages]);\n            }\n        }\n    });\n\n    if (this._opts.dropzones && this._opts.dropzones.length) {\n        new DragAndDrop({\n            dropZoneElements: this._opts.dropzones,\n            allowMultipleItems: this._opts.multiple,\n            classes: {\n                dropActive: 'dropzone-highlighted'\n            },\n            callbacks: {\n                processingDroppedFilesComplete: function(files) {\n                    uploader.addFiles(files);\n                }\n            }\n        });\n    }\n\n    return uploader;\n};\n\n\nfunction getPaperParams(element) {\n    const params = {};\n    const dataset = element.dataset;\n    Object.keys(dataset).forEach(function(name) {\n        if (/^paper(?:[^a-z0-9]|$)/.test(name)) {\n            params[name] = dataset[name];\n        }\n    });\n    return params;\n}\n\n\nexport {Uploader, ValidationError, getPaperParams};\n","// PaperAdmin API\nconst bootbox = window.paperAdmin.bootbox;\n\nlet _errors = [];\n\n\nfunction formatErrors(errors) {\n    if (Array.isArray(errors)) {\n        if (errors.length === 1) {\n            return errors[0]\n        } else {\n            let output = [\n                `Please correct the following errors:`,\n                `<ul class=\"px-4 mb-0\">`,\n            ];\n            for (let i=0, l=errors.length; i<l; i++) {\n                output.push(`<li>${errors[i]}</li>`);\n            }\n            output.push(`</ul>`);\n            output = output.join('\\n');\n            return output\n        }\n    }\n    return errors\n}\n\n\n/**\n *   .\n *\n * @param {String|String[]} error\n */\nfunction showError(error) {\n    console.debug(`Show error: ${error}`);\n    setTimeout(function() {\n        bootbox.alert({\n            title: 'Error',\n            message: formatErrors(error)\n        });\n    });\n}\n\n/**\n *       .\n * @param {String|String[]} error\n */\nfunction collectError(error) {\n    console.debug(`Collect error: ${error}`);\n    if (typeof error === 'string') {\n        _errors.push(error);\n    } else if (Array.isArray(error)) {\n        _errors = _errors.concat(error);\n    }\n}\n\n/**\n *   \n */\nfunction showCollectedErrors() {\n    if (!_errors || !_errors.length) {\n        return\n    }\n\n    setTimeout(function() {\n        if (!_errors || !_errors.length) {\n            return\n        }\n\n        bootbox.alert({\n            title: 'Error',\n            message: formatErrors(_errors)\n        });\n\n        _errors = [];\n    });\n}\n\nexport {\n    showError,\n    collectError,\n    showCollectedErrors\n};\n","/* global gettext */\n\nimport deepmerge from \"deepmerge\";\nimport {Uploader, getPaperParams} from \"./_uploader\";\nimport {showError} from \"./_utils\";\n\n// PaperAdmin API\nconst EventEmitter = window.paperAdmin.EventEmitter;\nconst bootbox = window.paperAdmin.bootbox;\nconst preloader = window.paperAdmin.preloader;\nconst formUtils = window.paperAdmin.formUtils;\n\n/**\n * @fires upload:submit\n * @fires upload:submitted\n * @fires upload:upload\n * @fires upload:created\n * @fires upload:deleted\n * @fires upload:complete\n * @fires upload:cancel\n * @param element\n * @param options\n * @constructor\n */\nfunction BaseWidget(element, options) {\n    /**\n     * @type object\n     */\n    this._opts = deepmerge({\n        input: '',\n        uploadButton: '',\n        cancelButton: '',\n        changeButton: '',\n        deleteButton: '',\n\n        link: '',\n\n        urls: {\n            upload: '',\n            change: '',\n            delete: ''\n        }\n    }, options || {});\n\n    this.element = element;\n\n    this.input = this.element.querySelector(this._opts.input);\n    if (!this.input) {\n        throw new Error(`Not found element \"${this._opts.input}\"`);\n    }\n\n    this.uploadButton = this.element.querySelector(this._opts.uploadButton);\n    if (!this.uploadButton) {\n        throw new Error(`Not found element \"${this._opts.uploadButton}\"`);\n    }\n\n    this.cancelButton = this.element.querySelector(this._opts.cancelButton);\n    if (!this.cancelButton) {\n        throw new Error(`Not found element \"${this._opts.cancelButton}\"`);\n    }\n\n    this.changeButton = this.element.querySelector(this._opts.changeButton);\n    if (!this.changeButton) {\n        throw new Error(`Not found element \"${this._opts.changeButton}\"`);\n    }\n\n    this.deleteButton = this.element.querySelector(this._opts.deleteButton);\n    if (!this.deleteButton) {\n        throw new Error(`Not found element \"${this._opts.deleteButton}\"`);\n    }\n\n    // \n    this.loading = false;\n    this.empty = isNaN(this.instanceId);\n\n    this.uploader = this.initUploader();\n    this.addListeners();\n}\n\nBaseWidget.prototype = Object.create(EventEmitter.prototype);\n\nObject.defineProperty(BaseWidget.prototype, 'instanceId', {\n    get: function() {\n        return parseInt(this.input.value);\n    },\n    set: function(value) {\n        this.input.value = parseInt(value) || '';\n    }\n});\n\nObject.defineProperty(BaseWidget.prototype, 'empty', {\n    get: function() {\n        return Boolean(this._empty);\n    },\n    set: function(value) {\n        const newValue = Boolean(value);\n        if (newValue === Boolean(this._empty)) {\n            return\n        }\n        if (newValue) {\n            this.element.classList.add('empty');\n        } else {\n            this.element.classList.remove('empty');\n        }\n        this._empty = newValue;\n    }\n});\n\nObject.defineProperty(BaseWidget.prototype, 'loading', {\n    get: function() {\n        return Boolean(this._loading);\n    },\n    set: function(value) {\n        const newValue = Boolean(value);\n        if (newValue === Boolean(this._loading)) {\n            return\n        }\n        if (newValue) {\n            this.element.classList.add('loading');\n        } else {\n            this.element.classList.remove('loading');\n            this.element.classList.remove('processing');\n        }\n        this._loading = newValue;\n    }\n});\n\n/**\n *   .\n */\nBaseWidget.prototype.initUploader = function() {\n    const _this = this;\n    return new Uploader(this.element, {\n        url: this._opts.urls.upload,\n        button: this.uploadButton,\n        dropzones: this.element.querySelectorAll('.dropzone-overlay'),\n        validation: JSON.parse(this.element.dataset.validation),\n    }).on('submitted', function(id) {\n        _this.trigger('upload:submitted', [id]);\n    }).on('upload', function(id) {\n        _this.loading = true;\n\n        const progressBar = _this.element.querySelector('.progress-bar');\n        progressBar && (progressBar.style.width = '');\n        _this.trigger('upload:upload', [id]);\n    }).on('progress', function(id, percentage) {\n        const progressBar = _this.element.querySelector('.progress-bar');\n        progressBar && (progressBar.style.width = percentage + '%');\n\n        if (percentage >= 100) {\n            _this.element.classList.add('processing');\n        }\n    }).on('complete', function(id, response) {\n        _this.empty = false;\n        _this.instanceId = response.instance_id;\n        _this.trigger('upload:created');\n\n        const fileName = _this.element.querySelector('.file-name');\n        fileName && (fileName.textContent = response.name);\n\n        const fileInfo = _this.element.querySelector('.file-info');\n        fileInfo && (fileInfo.textContent = response.file_info);\n\n        const previewLink = _this.element.querySelector(_this._opts.link);\n        previewLink && (previewLink.href = response.url);\n\n        _this.trigger('upload:complete');\n    }).on('cancel', function(id) {\n        _this.trigger('upload:cancel', [id]);\n    }).on('error', function(id, messages) {\n        showError(messages);\n    }).on('all_complete', function() {\n        _this.loading = false;\n    });\n};\n\n/**\n *    .\n * @param $dialog\n * @private\n */\nBaseWidget.prototype._change = function($dialog) {\n    if (isNaN(this.instanceId)) {\n        return\n    }\n\n    const _this = this;\n    const $form = $dialog.find('form');\n    Promise.all([\n        preloader.show(),\n        fetch($form.prop('action'), {\n            method: 'POST',\n            credentials: 'same-origin',\n            body: new FormData($form.get(0))\n        })\n    ]).then(function(values) {\n        const response = values[1];\n        if (!response.ok) {\n            const error = new Error(`${response.status} ${response.statusText}`);\n            error.response = response;\n            throw error;\n        }\n        return response.json();\n    }).then(function(response) {\n        if (response.errors && response.errors.length) {\n            const error = new Error('Invalid request');\n            error.response = response;\n            throw error\n        }\n\n        preloader.hide();\n        formUtils.cleanFormErrors($form.get(0));\n        if (response.form_errors) {\n            formUtils.addFormErrorsFromJSON($form.get(0), response.form_errors);\n        } else {\n            $dialog.modal('hide');\n\n            const fileName = _this.element.querySelector('.file-name');\n            fileName && (fileName.textContent = response.name);\n\n            const fileInfo = _this.element.querySelector('.file-info');\n            fileInfo && (fileInfo.textContent = response.file_info);\n\n            const previewLink = _this.element.querySelector(_this._opts.link);\n            previewLink && (previewLink.href = response.url);\n        }\n    }).catch(function(error) {\n        preloader.hide();\n        if ((typeof error === 'object') && error.response && error.response.errors) {\n            showError(error.response.errors);\n        } else if (error instanceof Error) {\n            showError(error.message);\n        } else {\n            showError(error);\n        }\n    });\n};\n\n/**\n *  .\n * @private\n */\nBaseWidget.prototype._delete = function() {\n    if (isNaN(this.instanceId)) {\n        return\n    }\n\n    const data = new FormData();\n    const params = getPaperParams(this.element);\n    Object.keys(params).forEach(function(name) {\n        data.append(name, params[name]);\n    });\n    data.append('instance_id', this.instanceId.toString());\n\n    const _this = this;\n    Promise.all([\n        preloader.show(),\n        fetch(this._opts.urls.delete, {\n            method: 'POST',\n            credentials: 'same-origin',\n            body: data\n        })\n    ]).then(function(values) {\n        const response = values[1];\n        if (!response.ok) {\n            const error = new Error(`${response.status} ${response.statusText}`);\n            error.response = response;\n            throw error;\n        }\n        return response.json();\n    }).then(function(response) {\n        if (response.errors && response.errors.length) {\n            const error = new Error('Invalid request');\n            error.response = response;\n            throw error\n        }\n\n        preloader.hide();\n        _this.empty = true;\n        _this.instanceId = '';\n\n        const fileName = _this.element.querySelector('.file-name');\n        fileName && (fileName.textContent = '');\n\n        const fileInfo = _this.element.querySelector('.file-info');\n        fileInfo && (fileInfo.textContent = '');\n\n        _this.trigger('upload:deleted');\n    }).catch(function(error) {\n        preloader.hide();\n        if ((typeof error === 'object') && error.response && error.response.errors) {\n            showError(error.response.errors);\n        } else if (error instanceof Error) {\n            showError(error.message);\n        } else {\n            showError(error);\n        }\n    });\n};\n\nBaseWidget.prototype.addListeners = function() {\n    const _this = this;\n\n    //  \n    this.cancelButton.addEventListener('click', function(event) {\n        event.preventDefault();\n        _this.loading = false;\n        _this.uploader.uploader.cancelAll();\n    });\n\n    //  \n    this.deleteButton.addEventListener('click', function(event) {\n        event.preventDefault();\n\n        bootbox.dialog({\n            size: 'small',\n            title: gettext('Confirmation'),\n            message: gettext('Are you sure you want to <b>DELETE</b> this file?'),\n            onEscape: true,\n            buttons: {\n                cancel: {\n                    label: gettext('Cancel'),\n                    className: 'btn-outline-info'\n                },\n                confirm: {\n                    label: gettext('Delete'),\n                    className: 'btn-danger',\n                    callback: function() {\n                        _this._delete();\n                    }\n                }\n            }\n        });\n    });\n\n    //  \n    this.changeButton.addEventListener('click', function(event) {\n        event.preventDefault();\n\n        const data = new FormData();\n        const params = getPaperParams(_this.element);\n        Object.keys(params).forEach(function(name) {\n            data.append(name, params[name]);\n        });\n        data.append('instance_id', _this.instanceId.toString());\n        const queryString = new URLSearchParams(data).toString();\n\n        Promise.all([\n            preloader.show(),\n            fetch(`${_this._opts.urls.change}?${queryString}`, {\n                credentials: 'same-origin',\n            })\n        ]).then(function(values) {\n            const response = values[1];\n            if (!response.ok) {\n                const error = new Error(`${response.status} ${response.statusText}`);\n                error.response = response;\n                throw error;\n            }\n\n            return response.json();\n        }).then(function(response) {\n            if (response.errors && response.errors.length) {\n                const error = new Error('Invalid request');\n                error.response = response;\n                throw error\n            }\n\n            preloader.hide();\n            const $dialog = bootbox.dialog({\n                title: gettext('Edit file'),\n                message: response.form,\n                onEscape: true,\n                buttons: {\n                    cancel: {\n                        label: gettext('Cancel'),\n                        className: 'btn-outline-info'\n                    },\n                    ok: {\n                        label: gettext('Save'),\n                        className: 'btn-success',\n                        callback: function() {\n                            _this._change(this);\n                            return false;\n                        }\n                    }\n                }\n            });\n\n            const $form = $dialog.find('form');\n            $form.on('submit', function() {\n                _this._change($dialog);\n                return false;\n            });\n        }).catch(function(error) {\n            preloader.hide();\n            if ((typeof error === 'object') && error.response && error.response.errors) {\n                showError(error.response.errors);\n            } else if (error instanceof Error) {\n                showError(error.message);\n            } else {\n                showError(error);\n            }\n        });\n    });\n};\n\n\nexport {BaseWidget};\n","import {BaseWidget} from \"./base_widget\";\n\n// PaperAdmin API\nconst whenDomReady = window.paperAdmin.whenDomReady;\nconst emitters = window.paperAdmin.emitters;\n\n\n// CSS\nimport \"../css/file_widget.scss\";\n\n\nfunction initWidget(element) {\n    if (element.closest('.empty-form')) {\n        return\n    }\n\n    new BaseWidget(element, {\n        input: '.file-uploader__input',\n        uploadButton: '.file-uploader__upload-button',\n        cancelButton: '.file-uploader__cancel-button',\n        changeButton: '.file-uploader__change-button',\n        deleteButton: '.file-uploader__delete-button',\n        link: '.file-uploader__link',\n        urls: {\n            upload: element.dataset.uploadUrl,\n            change: element.dataset.changeUrl,\n            delete: element.dataset.deleteUrl,\n        }\n    });\n}\n\n\nfunction initWidgets(root = document.body) {\n    let file_selector = '.file-uploader';\n    root.matches(file_selector) && initWidget(root);\n    root.querySelectorAll(file_selector).forEach(initWidget);\n}\n\n\nwhenDomReady(initWidgets);\nemitters.dom.on('mutate', initWidgets);\n","import {BaseWidget} from \"./base_widget\";\n\n// PaperAdmin API\nconst whenDomReady = window.paperAdmin.whenDomReady;\nconst emitters = window.paperAdmin.emitters;\n\n// CSS\nimport \"../css/image_widget.scss\";\n\n\nfunction initWidget(element) {\n    if (element.closest('.empty-form')) {\n        return\n    }\n\n    new BaseWidget(element, {\n        input: '.image-uploader__input',\n        uploadButton: '.image-uploader__upload-button',\n        cancelButton: '.image-uploader__cancel-button',\n        changeButton: '.image-uploader__change-button',\n        deleteButton: '.image-uploader__delete-button',\n        link: '.image-uploader__link',\n        urls: {\n            upload: element.dataset.uploadUrl,\n            change: element.dataset.changeUrl,\n            delete: element.dataset.deleteUrl,\n        }\n    });\n}\n\n\nfunction initWidgets(root = document.body) {\n    let file_selector = '.image-uploader';\n    root.matches(file_selector) && initWidget(root);\n    root.querySelectorAll(file_selector).forEach(initWidget);\n}\n\n\nwhenDomReady(initWidgets);\nemitters.dom.on('mutate', initWidgets);\n","/* global gettext */\n\nimport deepmerge from \"deepmerge\";\nimport {Uploader, ValidationError, getPaperParams} from \"./_uploader\";\nimport {showError, collectError, showCollectedErrors} from \"./_utils\";\n\n// PaperAdmin API\nconst EventEmitter = window.paperAdmin.EventEmitter;\nconst whenDomReady = window.paperAdmin.whenDomReady;\nconst Sortable = window.paperAdmin.Sortable;\nconst bootbox = window.paperAdmin.bootbox;\nconst emitters = window.paperAdmin.emitters;\nconst preloader = window.paperAdmin.preloader;\nconst formUtils = window.paperAdmin.formUtils;\n\n// CSS\nimport \"../css/collection_widget.scss\";\n\n\n/**\n * @param element\n * @param options\n * @fires collection:created\n * @fires collection:deleted\n * @fires collection:submit_item\n * @fires collection:upload_item\n * @fires collection:cancel_item\n * @fires collection:complete_item\n * @constructor\n */\nfunction Collection(element, options) {\n    /**\n     * @type Object\n     */\n    this._opts = deepmerge({\n        input: '.collection__input',\n        itemContainer: '.collection__items',\n        item: '.collection__item',\n        createButton: '.collection__create-button',\n        uploadButton: '.collection__upload-button',\n        deleteButton: '.collection__delete-button',\n        preloaderItem: '.collection__item--preloader',\n        preloaderTemplate: '.collection__item-preloader',\n\n        itemPreview: '.collection__item-preview',\n        itemLink: '.collection__item-link',\n        itemCheckbox: '.collection__item-checkbox',\n        itemName: '.collection__item-name',\n        changeItemButton: '.collection__item-change-button',\n        cancelItemButton: '.collection__item-cancel-button',\n        deleteItemButton: '.collection__item-delete-button',\n        itemSelectorTemplate: '.collection__{}-item-template',\n\n        collectionEmptyState: 'collection--empty',\n        itemCheckedState: 'collection__item--checked',\n        itemRemovingState: 'collection__item--removing',\n\n        urls: {\n            createCollection: '',\n            deleteCollection: '',\n            uploadItem: '',\n            changeItem: '',\n            deleteItem: '',\n            sortItems: ''\n        }\n    }, options || {});\n\n    this.element = element;\n\n    this.input = this.element.querySelector(this._opts.input);\n    if (!this.input) {\n        throw new Error(`Not found element \"${this._opts.input}\"`);\n    }\n\n    this.itemContainer = this.element.querySelector(this._opts.itemContainer);\n    if (!this.itemContainer) {\n        throw new Error(`Not found element \"${this._opts.itemContainer}\"`);\n    }\n\n    this.createButton = this.element.querySelector(this._opts.createButton);\n    if (!this.createButton) {\n        throw new Error(`Not found element \"${this._opts.createButton}\"`);\n    }\n\n    this.uploadButton = this.element.querySelector(this._opts.uploadButton);\n    if (!this.uploadButton) {\n        throw new Error(`Not found element \"${this._opts.uploadButton}\"`);\n    }\n\n    this.deleteButton = this.element.querySelector(this._opts.deleteButton);\n    if (!this.deleteButton) {\n        throw new Error(`Not found element \"${this._opts.deleteButton}\"`);\n    }\n\n    this.init();\n}\n\nCollection.prototype = Object.create(EventEmitter.prototype);\n\nObject.defineProperty(Collection.prototype, 'collectionId', {\n    get: function() {\n        return parseInt(this.input.value);\n    },\n    set: function(value) {\n        const newValue = parseInt(value);\n        if (isNaN(newValue)) {\n            //  \n            this.input.value = '';\n            this.createButton.disabled = false;\n            this.uploadButton.disabled = true;\n            this.deleteButton.disabled = true;\n            this.element.classList.add(this._opts.collectionEmptyState);\n\n            const uploadInput = this.uploadButton.querySelector('input[type=\"file\"]');\n            uploadInput && (uploadInput.disabled = true);\n        } else {\n            //  \n            this.input.value = newValue;\n            this.createButton.disabled = true;\n            this.uploadButton.disabled = false;\n            this.deleteButton.disabled = false;\n            this.element.classList.remove(this._opts.collectionEmptyState);\n\n            const uploadInput = this.uploadButton.querySelector('input[type=\"file\"]');\n            uploadInput && (uploadInput.disabled = false);\n        }\n    }\n});\n\n/**\n *  \n */\nCollection.prototype.init = function() {\n    this.uploader = this.initUploader();\n    this.sortable = this.initSortable();\n    this.collectionId = this.input.value;\n    this.addListeners();\n};\n\n/**\n *   .\n */\nCollection.prototype.initUploader = function() {\n    const _this = this;\n    return new Uploader(this.element, {\n        url: this._opts.urls.uploadItem,\n        multiple: true,\n        maxConnections: 4,\n        button: this.uploadButton,\n        dropzones: this.element.querySelectorAll('.dropzone-overlay'),\n        validation: JSON.parse(this.element.dataset.validation),\n        extraData: {\n            collectionId: function() {\n                return _this.collectionId;\n            }\n        },\n    }).on('submit', function() {\n        if (isNaN(_this.collectionId)) {\n            throw new ValidationError();\n        }\n    }).on('submitted', function(id) {\n        const template = _this.element.querySelector(_this._opts.preloaderTemplate);\n        const clone = document.importNode(template.content, true);\n\n        const preloader = clone.querySelector(_this._opts.item);\n        preloader.dataset.queueId = id;\n        preloader.classList.add(`item-preloader-${id}`);\n\n        const file = this.uploader.getFile(id);\n        const fileName = preloader.querySelector(_this._opts.itemName);\n        if (fileName) {\n            fileName.title = file.name;\n            fileName.textContent = file.name;\n        }\n\n        _this.itemContainer.append(clone);\n\n        _this.trigger('collection:submit_item', [preloader, id]);\n    }).on('upload', function(id) {\n        const preloader = _this.itemContainer.querySelector(`.item-preloader-${id}`);\n        _this.trigger('collection:upload_item', [preloader, id]);\n    }).on('progress', function(id, percentage) {\n        const preloader = _this.itemContainer.querySelector(`.item-preloader-${id}`);\n        const progressBar = preloader.querySelector('.progress-bar');\n        progressBar && (progressBar.style.height = percentage + '%');\n\n        if (percentage >= 100) {\n            preloader.classList.add('processing');\n        }\n    }).on('complete', function(id, response) {\n        if (isNaN(_this.collectionId)) {\n            _this.collectionId = response.collectionId;\n            _this.trigger('collection:created');\n        }\n\n        const preloader = _this.itemContainer.querySelector(`.item-preloader-${id}`);\n        _this.trigger('collection:complete_item', [preloader, id]);\n\n        const itemType = response.item_type;\n        const templateSelector = _this._opts.itemSelectorTemplate.replace('{}', itemType);\n        const template = _this.element.querySelector(templateSelector);\n        if (!template) {\n            _this.trigger('error', [id, `Invalid item_type: ${itemType}`]);\n            return\n        } else {\n            const clone = document.importNode(template.content, true);\n            const item = clone.querySelector(_this._opts.item);\n            item.setAttribute('data-pk', response.id);\n            item.setAttribute('data-item-type', itemType);\n\n            const preview = clone.querySelector(_this._opts.itemPreview);\n            preview && (preview.innerHTML = response.preview);\n\n            const previewLink = clone.querySelector(_this._opts.itemLink);\n            previewLink && (previewLink.href = response.url);\n\n            const fileName = clone.querySelector(_this._opts.itemName);\n            if (fileName) {\n                fileName.title = response.name;\n                fileName.textContent = response.name;\n            }\n\n            preloader.before(clone);\n        }\n\n        preloader.remove();\n    }).on('cancel', function(id) {\n        const preloader = _this.itemContainer.querySelector(`.item-preloader-${id}`);\n        _this.trigger('collection:cancel_item', [preloader, id]);\n        if (preloader) {\n            //  \n            preloader.addEventListener('animationend', function() {\n                preloader.remove();\n            });\n            preloader.classList.add(_this._opts.itemRemovingState);\n        }\n    }).on('error', function(id, messages) {\n        collectError(messages);\n        const preloader = _this.itemContainer.querySelector(`.item-preloader-${id}`);\n        if (preloader) {\n            //  \n            preloader.addEventListener('animationend', function() {\n                preloader.remove();\n            });\n            preloader.classList.add(_this._opts.itemRemovingState);\n        }\n    }).on('all_complete', function() {\n        showCollectedErrors();\n    });\n};\n\nCollection.prototype.initSortable = function() {\n    const _this = this;\n    return Sortable.create(this.itemContainer, {\n        animation: 0,\n        draggable: this._opts.item,\n        filter: this._opts.preloaderItem,\n        handle: '.sortable-handler',\n        ghostClass: 'sortable-ghost',\n        onEnd: function() {\n            const items = Array.from(_this.itemContainer.querySelectorAll(_this._opts.item));\n            const order = items.map(function(item) {\n                if (!item.matches(_this._opts.preloaderItem)) {\n                    return item.dataset.pk;\n                }\n            }).filter(Boolean);\n\n            const data = new FormData();\n            const params = getPaperParams(_this.element);\n            Object.keys(params).forEach(function(name) {\n                data.append(name, params[name]);\n            });\n            data.append('collectionId', _this.collectionId.toString());\n            data.append('order', order.join(','));\n\n            fetch(_this._opts.urls.sortItems, {\n                method: 'POST',\n                credentials: 'same-origin',\n                body: data\n            }).then(function(response) {\n                if (!response.ok) {\n                    const error = new Error(`${response.status} ${response.statusText}`);\n                    error.response = response;\n                    throw error;\n                }\n                return response.json();\n            }).then(function(response) {\n                if (response.errors && response.errors.length) {\n                    const error = new Error('Invalid request');\n                    error.response = response;\n                    throw error\n                }\n            }).catch(function(error) {\n                if ((typeof error === 'object') && error.response && error.response.errors) {\n                    showError(error.response.errors);\n                } else if (error instanceof Error) {\n                    showError(error.message);\n                } else {\n                    showError(error);\n                }\n            })\n        },\n    });\n};\n\n/**\n *      .\n */\nCollection.prototype.cleanItems = function() {\n    while (this.itemContainer.firstChild) {\n        this.itemContainer.removeChild(this.itemContainer.firstChild);\n    }\n};\n\n/**\n *  .\n * @private\n */\nCollection.prototype._createCollection = function() {\n    if (!isNaN(this.collectionId)) {\n        return\n    }\n\n    const data = new FormData();\n    const params = getPaperParams(this.element);\n    Object.keys(params).forEach(function(name) {\n        data.append(name, params[name]);\n    });\n\n    const _this = this;\n    Promise.all([\n        preloader.show(),\n        fetch(this._opts.urls.createCollection, {\n            method: 'POST',\n            credentials: 'same-origin',\n            body: data\n        })\n    ]).then(function(values) {\n        const response = values[1];\n        if (!response.ok) {\n            const error = new Error(`${response.status} ${response.statusText}`);\n            error.response = response;\n            throw error;\n        }\n        return response.json();\n    }).then(function(response) {\n        if (response.errors && response.errors.length) {\n            const error = new Error('Invalid request');\n            error.response = response;\n            throw error\n        }\n\n        preloader.hide();\n        _this.collectionId = response.collection_id;\n        _this.trigger('collection:created');\n    }).catch(function(error) {\n        preloader.hide();\n        if ((typeof error === 'object') && error.response && error.response.errors) {\n            showError(error.response.errors);\n        } else if (error instanceof Error) {\n            showError(error.message);\n        } else {\n            showError(error);\n        }\n    });\n};\n\n/**\n *   .\n * @param item\n * @private\n */\nCollection.prototype._deleteItem = function(item) {\n    if (isNaN(this.collectionId)) {\n        return\n    }\n\n    const instance_id = parseInt(item && item.dataset.pk);\n    if (isNaN(instance_id)) {\n        return\n    }\n\n    const data = new FormData();\n    const params = getPaperParams(this.element);\n    Object.keys(params).forEach(function(name) {\n        data.append(name, params[name]);\n    });\n    data.append('collectionId', this.collectionId.toString());\n    data.append('instance_id', instance_id.toString());\n    data.append('item_type', item.dataset.itemType);\n\n    const _this = this;\n    Promise.all([\n        preloader.show(),\n        fetch(this._opts.urls.deleteItem, {\n            method: 'POST',\n            credentials: 'same-origin',\n            body: data\n        })\n    ]).then(function(values) {\n        const response = values[1];\n        if (!response.ok) {\n            const error = new Error(`${response.status} ${response.statusText}`);\n            error.response = response;\n            throw error;\n        }\n\n        return response.json();\n    }).then(function(response) {\n        if (response.errors && response.errors.length) {\n            const error = new Error('Invalid request');\n            error.response = response;\n            throw error\n        }\n\n        preloader.hide();\n\n        //  \n        item.addEventListener('animationend', function() {\n            item.remove();\n        });\n        item.classList.add(_this._opts.itemRemovingState);\n    }).catch(function(error) {\n        preloader.hide();\n        if ((typeof error === 'object') && error.response && error.response.errors) {\n            showError(error.response.errors);\n        } else if (error instanceof Error) {\n            showError(error.message);\n        } else {\n            showError(error);\n        }\n    });\n};\n\n/**\n *    .\n * @param item\n * @param $dialog\n * @private\n */\nCollection.prototype._changeItem = function(item, $dialog) {\n    if (isNaN(this.collectionId)) {\n        return\n    }\n\n    const instance_id = parseInt(item && item.dataset.pk);\n    if (isNaN(instance_id)) {\n        return\n    }\n\n    const _this = this;\n    const $form = $dialog.find('form');\n    Promise.all([\n        preloader.show(),\n        fetch($form.prop('action'), {\n            method: 'POST',\n            credentials: 'same-origin',\n            body: new FormData($form.get(0))\n        })\n    ]).then(function(values) {\n        const response = values[1];\n        if (!response.ok) {\n            const error = new Error(`${response.status} ${response.statusText}`);\n            error.response = response;\n            throw error;\n        }\n\n        return response.json();\n    }).then(function(response) {\n        if (response.errors && response.errors.length) {\n            const error = new Error('Invalid request');\n            error.response = response;\n            throw error\n        }\n\n        preloader.hide();\n        formUtils.cleanFormErrors($form.get(0));\n        if (response.form_errors) {\n            formUtils.addFormErrorsFromJSON($form.get(0), response.form_errors);\n        } else {\n            $dialog.modal('hide');\n\n            const preview = item.querySelector(_this._opts.itemPreview);\n            preview && (preview.innerHTML = response.preview);\n\n            const previewLink = item.querySelector(_this._opts.itemLink);\n            previewLink && (previewLink.href = response.url);\n\n            const fileName = item.querySelector(_this._opts.itemName);\n            if (fileName) {\n                fileName.title = response.name;\n                fileName.textContent = response.name;\n            }\n        }\n    }).catch(function(error) {\n        preloader.hide();\n        if ((typeof error === 'object') && error.response && error.response.errors) {\n            showError(error.response.errors);\n        } else if (error instanceof Error) {\n            showError(error.message);\n        } else {\n            showError(error);\n        }\n    });\n};\n\n/**\n *  .\n * @private\n */\nCollection.prototype._deleteCollection = function() {\n    if (isNaN(this.collectionId)) {\n        return\n    }\n\n    const data = new FormData();\n    const params = getPaperParams(this.element);\n    Object.keys(params).forEach(function(name) {\n        data.append(name, params[name]);\n    });\n    data.append('collectionId', this.collectionId.toString());\n\n    const _this = this;\n    Promise.all([\n        preloader.show(),\n        fetch(this._opts.urls.deleteCollection, {\n            method: 'POST',\n            credentials: 'same-origin',\n            body: data\n        })\n    ]).then(function(values) {\n        const response = values[1];\n        if (!response.ok) {\n            const error = new Error(`${response.status} ${response.statusText}`);\n            error.response = response;\n            throw error;\n        }\n        return response.json();\n    }).then(function(response) {\n        if (response.errors && response.errors.length) {\n            const error = new Error('Invalid request');\n            error.response = response;\n            throw error\n        }\n\n        preloader.hide();\n        let lastItem = null;\n        Array.from(_this.itemContainer.children).forEach(function(item) {\n            item.classList.add(_this._opts.itemRemovingState);\n            lastItem = item;\n        });\n\n        if (lastItem) {\n            lastItem.addEventListener('animationend', function() {\n                _this.cleanItems();\n                _this.collectionId = '';\n                _this.trigger('collection:deleted');\n            });\n        } else {\n            _this.cleanItems();\n            _this.collectionId = '';\n            _this.trigger('collection:deleted');\n        }\n    }).catch(function(error) {\n        preloader.hide();\n        if ((typeof error === 'object') && error.response && error.response.errors) {\n            showError(error.response.errors);\n        } else if (error instanceof Error) {\n            showError(error.message);\n        } else {\n            showError(error);\n        }\n    });\n};\n\n/**\n *   .\n * @param {HTMLElement} item\n * @param {Boolean} state\n * @private\n */\nCollection.prototype._checkItem = function(item, state=true) {\n    item.classList.toggle(this._opts.itemCheckedState, state);\n    const checkbox = item.querySelector(this._opts.itemCheckbox);\n    checkbox.checked = state;\n};\n\nCollection.prototype.addListeners = function() {\n    const _this = this;\n\n    //  \n    this.element.addEventListener('click', function(event) {\n        if (!event.target.closest(_this._opts.createButton)) {\n            return\n        }\n\n        event.preventDefault();\n        _this._createCollection();\n    });\n\n    //  \n    this.element.addEventListener('click', function(event) {\n        if (!event.target.closest(_this._opts.deleteButton)) {\n            return\n        }\n\n        event.preventDefault();\n\n        bootbox.dialog({\n            size: 'small',\n            title: gettext('Confirmation'),\n            message: gettext('Are you sure you want to <b>DELETE</b> this collection?'),\n            onEscape: true,\n            buttons: {\n                cancel: {\n                    label: gettext('Cancel'),\n                    className: 'btn-outline-info'\n                },\n                confirm: {\n                    label: gettext('Delete'),\n                    className: 'btn-danger',\n                    callback: function() {\n                        _this._deleteCollection();\n                    }\n                }\n            }\n        });\n    });\n\n    //  \n    this.element.addEventListener('click', function(event) {\n        if (!event.target.closest(_this._opts.changeItemButton)) {\n            return\n        }\n\n        event.preventDefault();\n\n        const item = event.target.closest(_this._opts.item);\n        const instance_id = parseInt(item && item.dataset.pk);\n        if (isNaN(instance_id)) {\n            return\n        }\n\n        const data = new FormData();\n        const params = getPaperParams(_this.element);\n        Object.keys(params).forEach(function(name) {\n            data.append(name, params[name]);\n        });\n        data.append('collectionId', _this.collectionId.toString());\n        data.append('instance_id', instance_id.toString());\n        data.append('item_type', item.dataset.itemType);\n        const queryString = new URLSearchParams(data).toString();\n\n        Promise.all([\n            preloader.show(),\n            fetch(`${_this._opts.urls.changeItem}?${queryString}`, {\n                credentials: 'same-origin',\n            })\n        ]).then(function(values) {\n            const response = values[1];\n            if (!response.ok) {\n                const error = new Error(`${response.status} ${response.statusText}`);\n                error.response = response;\n                throw error;\n            }\n\n            return response.json();\n        }).then(function(response) {\n            if (response.errors && response.errors.length) {\n                const error = new Error('Invalid request');\n                error.response = response;\n                throw error\n            }\n\n            preloader.hide();\n            const $dialog = bootbox.dialog({\n                title: gettext('Edit file'),\n                message: response.form,\n                onEscape: true,\n                buttons: {\n                    cancel: {\n                        label: gettext('Cancel'),\n                        className: 'btn-outline-info'\n                    },\n                    ok: {\n                        label: gettext('Save'),\n                        className: 'btn-success',\n                        callback: function() {\n                            _this._changeItem(item, this);\n                            return false;\n                        }\n                    }\n                }\n            });\n\n            const $form = $dialog.find('form');\n            $form.on('submit', function() {\n                _this._changeItem(item, $dialog);\n                return false;\n            });\n        }).catch(function(error) {\n            preloader.hide();\n            if ((typeof error === 'object') && error.response && error.response.errors) {\n                showError(error.response.errors);\n            } else if (error instanceof Error) {\n                showError(error.message);\n            } else {\n                showError(error);\n            }\n        });\n    });\n\n    //  \n    this.element.addEventListener('click', function(event) {\n        if (!event.target.closest(_this._opts.cancelItemButton)) {\n            return\n        }\n\n        event.preventDefault();\n        const item = event.target.closest(_this._opts.item);\n        const queueId = parseInt(item.dataset.queueId);\n        _this.uploader.uploader.cancel(queueId);\n    });\n\n    //  \n    this.element.addEventListener('click', function(event) {\n        if (!event.target.closest(_this._opts.deleteItemButton)) {\n            return\n        }\n\n        event.preventDefault();\n\n        bootbox.dialog({\n            size: 'small',\n            title: gettext('Confirmation'),\n            message: gettext('Are you sure you want to <b>DELETE</b> this file?'),\n            onEscape: true,\n            buttons: {\n                cancel: {\n                    label: gettext('Cancel'),\n                    className: 'btn-outline-info'\n                },\n                confirm: {\n                    label: gettext('Delete'),\n                    className: 'btn-danger',\n                    callback: function() {\n                        const item = event.target.closest(_this._opts.item);\n                        _this._deleteItem(item);\n                    }\n                }\n            }\n        });\n    });\n\n    //   \n    let lastChecked = null;\n    this.element.addEventListener('click', function(event) {\n        const item = event.target.closest(_this._opts.item);\n        if (!item) {\n            return\n        }\n\n        let target_state;\n        let checkbox = event.target.closest(_this._opts.itemCheckbox);\n        if (!checkbox) {\n            //     ,      ,\n            //     Ctrl ( Shift   )\n            if (!event.ctrlKey && !event.shiftKey) {\n                return\n            }\n\n            checkbox = item.querySelector(_this._opts.itemCheckbox);\n            if (!checkbox) {\n                return\n            }\n            target_state = !checkbox.checked;\n        } else {\n            //        \n            target_state = checkbox.checked;\n        }\n\n        if (lastChecked && event.shiftKey && (lastChecked !== item)) {\n            const items = Array.from(_this.itemContainer.querySelectorAll(_this._opts.item));\n            const lastIndex = items.indexOf(lastChecked);\n            const targetIndex = items.indexOf(item);\n            const startIndex = Math.min(lastIndex, targetIndex);\n            const endIndex = Math.max(lastIndex, targetIndex);\n            const item_slice = items.slice(startIndex, endIndex + 1);\n            item_slice.forEach(function(item) {\n                _this._checkItem(item, target_state)\n            });\n        } else {\n            _this._checkItem(item, target_state);\n        }\n\n        lastChecked = item;\n    });\n\n    //      Delete\n    this.element.addEventListener('keyup', function(event) {\n        if (event.code === 'Delete') {\n            const items = Array.from(_this.itemContainer.querySelectorAll(_this._opts.item));\n            const checkedItems = items.filter(function(item) {\n                const checkbox = item.querySelector(_this._opts.itemCheckbox);\n                return checkbox.checked;\n            });\n\n            if (checkedItems.length) {\n                bootbox.dialog({\n                    size: 'small',\n                    title: gettext('Confirmation'),\n                    message: gettext(`Are you sure you want to <b>DELETE</b> the selected <b>${checkedItems.length}</b> file(s)?`),\n                    onEscape: true,\n                    buttons: {\n                        cancel: {\n                            label: gettext('Cancel'),\n                            className: 'btn-outline-info'\n                        },\n                        confirm: {\n                            label: gettext('Delete'),\n                            className: 'btn-danger',\n                            callback: function() {\n                                checkedItems.forEach(function(item) {\n                                    _this._deleteItem(item);\n                                });\n                            }\n                        }\n                    }\n                });\n            }\n        }\n    });\n\n    //    \n    this.element.addEventListener('dblclick', function(event) {\n        const item = event.target.closest(_this._opts.item);\n        if (!item) {\n            return\n        }\n\n        const itemLink = item.querySelector(_this._opts.itemLink);\n        if (itemLink) {\n            itemLink.dispatchEvent(new MouseEvent('click', {\n                bubbles: true,\n                cancelable: true\n            }));\n        }\n    });\n};\n\n\nfunction initWidget(element) {\n    if (element.closest('.empty-form')) {\n        return\n    }\n\n    new Collection(element, {\n        urls: {\n            createCollection: element.dataset.createCollectionUrl,\n            deleteCollection: element.dataset.deleteCollectionUrl,\n            uploadItem: element.dataset.uploadItemUrl,\n            changeItem: element.dataset.changeItemUrl,\n            deleteItem: element.dataset.deleteItemUrl,\n            sortItems: element.dataset.sortItemsUrl\n        }\n    });\n}\n\n\nfunction initWidgets(root = document.body) {\n    let file_selector = '.collection';\n    root.matches(file_selector) && initWidget(root);\n    root.querySelectorAll(file_selector).forEach(initWidget);\n}\n\n\nwhenDomReady(initWidgets);\nemitters.dom.on('mutate', initWidgets);\n","import \"./file_widget\";\nimport \"./image_widget\";\nimport \"./collection_widget\";\n\n// Images\nfunction importAll(r) {\n    return r.keys().map(r);\n}\nimportAll(require.context('../img/files/', false, /\\.svg$/));\n"],"sourceRoot":""}