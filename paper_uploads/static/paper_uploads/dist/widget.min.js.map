{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/deepmerge/dist/cjs.js","webpack:///./node_modules/fine-uploader/lib/traditional.js","webpack:///./node_modules/fine-uploader/fine-uploader/fine-uploader.js","webpack:///./paper_uploads/static/paper_uploads/src/img/files sync nonrecursive \\.svg$","webpack:///./paper_uploads/static/paper_uploads/src/img/files/7z.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/ai.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/audio.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/avi.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/csv.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/doc.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/flac.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/json.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/mp3.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/mp4.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/pdf.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/ppt.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/psd.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/rar.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/rtf.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/svg.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/tar.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/txt.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/unknown.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/video.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/wav.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/wma.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/xls.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/xml.svg","webpack:///./paper_uploads/static/paper_uploads/src/img/files/zip.svg","webpack:///./paper_uploads/static/paper_uploads/src/js/_uploader.js","webpack:///./paper_uploads/static/paper_uploads/src/js/file_widget.js","webpack:///./paper_uploads/static/paper_uploads/src/js/image_widget.js","webpack:///./paper_uploads/static/paper_uploads/src/js/gallery_widget.js","webpack:///./paper_uploads/static/paper_uploads/src/js/widget.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","isMergeableObject","isNonNullObject","stringValue","toString","$$typeof","REACT_ELEMENT_TYPE","isReactElement","isSpecial","for","cloneUnlessOtherwiseSpecified","options","clone","deepmerge","val","Array","isArray","defaultArrayMerge","target","source","concat","map","element","getKeys","keys","getOwnPropertySymbols","filter","symbol","propertyIsEnumerable","getEnumerableOwnPropertySymbols","mergeObject","destination","forEach","customMerge","getMergeFunction","arrayMerge","sourceIsArray","all","array","Error","reduce","prev","next","deepmerge_1","global","qq","hide","style","display","this","attach","type","fn","addEventListener","attachEvent","detach","removeEventListener","detachEvent","contains","descendant","compareDocumentPosition","insertBefore","elementB","parentNode","remove","removeChild","css","styles","opacity","filters","Math","round","extend","hasClass","considerParent","re","RegExp","test","className","addClass","removeClass","replace","getByClass","first","candidates","result","querySelector","querySelectorAll","getElementsByTagName","each","idx","push","getFirstByClass","children","child","firstChild","nodeType","nextSibling","setText","text","innerText","textContent","clearText","hasAttribute","attrName","attrVal","exec","getAttribute","undefined","ExifRestorer","div","canvasToBlob","canvas","mime","quality","dataUriToBlob","toDataURL","dataUri","arrayBuffer","byteString","intArray","mimeString","data","BlobBuilder","blobBuilder","split","indexOf","atob","decodeURI","ArrayBuffer","length","Uint8Array","character","charCodeAt","window","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","append","getBlob","Blob","log","message","level","console","isObject","variable","isFunction","buffer","constructor","isItemList","maybeItemList","isNodeList","maybeNodeList","item","namedItem","isString","maybeString","trimStr","string","String","trim","format","str","args","slice","arguments","newStr","nextIdxToReplace","strBefore","substring","strAfter","isFile","maybeFile","File","isFileList","maybeFileList","FileList","isFileOrInput","maybeFileOrInput","isInput","maybeInput","notFile","evaluateType","normalizedType","toLowerCase","HTMLInputElement","tagName","isBlob","maybeBlob","isXhrUploadSupported","input","document","createElement","multiple","FormData","createXhrInstance","upload","XMLHttpRequest","ActiveXObject","error","isFolderDropSupported","dataTransfer","items","webkitGetAsEntry","isFileChunkingSupported","androidStock","webkitSlice","mozSlice","sliceBlob","fileOrBlob","start","end","arrayBufferToHex","bytesAsHex","bytes","byt","byteAsHexStr","readBlobToHex","blob","startOffset","initialBlob","fileReader","FileReader","promise","Promise","onload","success","onerror","failure","readAsArrayBuffer","second","extendNested","prop","override","sourceFn","super_","srcPropName","srcPropVal","arr","elt","from","len","getUniqueId","random","ie","navigator","userAgent","ie7","ie8","ie10","ie11","edge","safari","vendor","chrome","opera","firefox","windows","platform","android","ios6","ios","ios7","ios8","ios800","iosChrome","iosSafari","iosSafariWebView","preventDefault","e","returnValue","toElement","html","innerHTML","iterableItem","callback","keyOrIndex","Storage","getItem","charAt","oldFunc","context","newArgs","apply","obj2url","obj","temp","prefixDone","uristrings","prefix","add","nextObj","nextTemp","encodeURIComponent","join","obj2FormData","formData","arrayKeyName","obj2Inputs","form","setAttribute","appendChild","parseJson","json","JSON","parse","eval","getExtension","filename","extIdx","lastIndexOf","substr","getFilename","blobOrFileInput","fileName","DisposeSupport","disposers","dispose","disposer","shift","addDisposer","disposeFunction","version","supportedFeatures","supportsUploading","supportsUploadingBlobs","supportsFileDrop","supportsAjaxFileUploading","supportsFolderDrop","supportsChunking","supportsResume","supportsUploadViaPaste","supportsUploadCors","supportsDeleteFileXdr","supportsDeleteFileCorsXhr","supportsDeleteFileCors","supportsFolderSelection","supportsImagePreviews","supportsUploadProgress","span","isCrossOriginXhrSupported","withCredentials","isXdrSupported","XDomainRequest","tempInput","supported","disabled","ex","testSupportsFileInputElement","localStorage","setItem","isLocalStorageSupported","match","postMessage","webkitdirectory","ajaxUploading","blobUploading","canDetermineSize","chunking","deleteFileCors","deleteFileCorsXdr","deleteFileCorsXhr","dialogElement","HTMLDialogElement","fileDrop","folderDrop","folderSelection","imagePreviews","imageValidation","itemSizeValidation","pause","progressBar","resume","scaling","tiffPreviews","unlimitedScaledImageSize","uploading","uploadCors","uploadCustomHeaders","uploadNonMultipart","uploadViaPaste","isGenericPromise","maybePromise","then","successArgs","failureArgs","successCallbacks","failureCallbacks","doneCallbacks","state","onSuccess","onFailure","done","BlobProxy","referenceBlob","onCreate","UploadButton","buttonId","self","disposeSupport","acceptFiles","focusClass","folders","hoverClass","ios8BrowserCrashWorkaround","onChange","title","createInput","BUTTON_ID_ATTR_NAME","setMultiple","position","right","top","fontFamily","fontSize","margin","padding","cursor","height","overflow","direction","getInput","getButtonId","isMultiple","optInput","removeAttribute","setAcceptFiles","reset","UploadData","uploaderProxy","byUuid","byStatus","byProxyGroupId","byBatchId","getDataByIds","idOrIds","entries","id","addFile","spec","status","SUBMITTING","originalName","uuid","size","file","batchId","proxyGroupId","onBeforeStatusChange","onStatusChange","retrieve","optionalFilter","uuids","getDataByUuids","statusResults","statuses","index","statusEnum","statusResultIndexes","dataIndex","removeFileRef","record","setStatus","newStatus","oldStatus","byStatusOldStatusIndex","splice","uuidChanged","newUuid","oldUuid","updateName","newName","updateSize","newSize","setParentId","targetId","parentId","getIdsInProxyGroup","getIdsInBatch","SUBMITTED","REJECTED","QUEUED","CANCELED","PAUSED","UPLOADING","UPLOAD_FINALIZING","UPLOAD_RETRYING","UPLOAD_SUCCESSFUL","UPLOAD_FAILED","DELETE_FAILED","DELETING","DELETED","basePublicApi","addBlobs","blobDataOrArray","params","endpoint","addFiles","addInitialFiles","cannedFileList","cannedFile","_addCannedFile","_maybeHandleIos8SafariWorkaround","_storedIds","_currentBatchId","processBlob","_handleNewFile","_options","blobs","defaultName","verifiedFiles","processBlobData","blobData","processCanvas","processCanvasData","canvasData","normalizedQuality","processFileOrInput","fileOrInput","files","fileContainer","_prepareItemsForUpload","cancel","uploadData","_uploadData","getName","_handler","cancelAll","storedIdsCopy","storedFileId","clearStoredFiles","continueUpload","enabled","_uploadFile","deleteFile","_onSubmitDelete","doesExist","fileOrBlobId","isValid","drawThumbnail","fileId","imgOrCanvas","maxSize","fromServer","customResizeFunction","fileOrUrl","promiseToReturn","_imageGenerator","_thumbnailUrls","scale","getFile","container","generate","modifiedContainer","reason","getButton","_getButton","_buttonIdsForFileIds","getEndpoint","_endpointStore","uploadDataRecord","getInProgress","getParentId","uploadDataEntry","getUploads","getResumableFilesData","getSize","getNetUploads","_netUploaded","getRemainingAllowedItems","allowedItems","_currentItemLimit","_netUploadedOrQueued","getUuid","isResumable","hasResumeRecord","debug","pauseUpload","expunge","_autoRetries","_retryTimeouts","_preventRetries","_buttons","button","_paramsStore","_pasteHandler","session","refreshOnReset","_refreshSessionData","_succeededSinceLastAllComplete","_failedSinceLastAllComplete","_totalProgress","_customResumeDataStore","retry","_manualRetry","scaleImage","specs","Scaler","setCustomHeaders","headers","_customHeadersStore","set","setCustomResumeData","setDeleteFileCustomHeaders","_deleteFileCustomHeadersStore","setDeleteFileEndpoint","_deleteFileEndpointStore","setDeleteFileParams","_deleteFileParamsStore","setEndpoint","setForm","elementOrId","_updateFormSupportAndParams","setItemLimit","newItemLimit","setName","setParams","setUuid","_onDeleteComplete","errorMessage","uploadStoredFiles","_itemError","_uploadStoredFiles","basePrivateApi","sessionData","deleteFileEndpoint","deleteFileParams","thumbnailUrl","_annotateWithButtonId","associatedInput","qqButtonId","_getButtonId","_batchError","callbacks","onError","_createDeleteHandler","DeleteFileAjaxRequester","method","toUpperCase","maxConnections","uuidParamName","request","uuidName","customHeaders","paramsStore","endpointStore","cors","onDelete","_onDelete","onDeleteComplete","xhrOrXdr","isError","_createPasteHandler","PasteSupport","targetElement","paste","pasteReceived","_handleCheckedCallback","onPasteReceived","_handlePasteSuccess","identifier","_createStore","initialValue","_readOnlyValues_","store","catchall","perIdReadOnlyValues","readOnlyValues","copy","orig","includeReadOnlyValues","existing","values","addReadOnly","_createUploadDataTracker","_onUploadStatusChange","_maybeAllComplete","setTimeout","_createUploadButton","accept","validation","allowedExtensions","classes","buttonFocus","buttonHover","workarounds","ios8BrowserCrash","iosEmptyVideos","_isAllowedExtension","inputName","_onInputChange","fileInputTitle","_disposeSupport","_createUploadHandler","additionalOptions","namespace","lastOnProgress","preventRetryParam","preventRetryResponseProperty","onProgress","loaded","total","_onProgress","onComplete","xhr","retVal","_onComplete","onCancel","cancelFinalizationEffort","_onCancel","onUploadPrep","_onUploadPrep","onUpload","_onUpload","onUploadResult","onUploadChunk","chunkData","_onUploadChunk","onUploadChunkResult","partIndex","onUploadChunkSuccess","_onUploadChunkSuccess","onResume","customResumeData","onAutoRetry","responseJSON","_onAutoRetry","onUuidChanged","setSize","_setSize","getDataByUuid","isQueued","isInProgress","getCustomResumeData","_getCustomResumeData","UploadHandlerController","_fileOrBlobRejected","_formatSize","sizeSymbols","max","toFixed","_generateExtraButtonSpecs","_extraButtonSpecs","extraButtons","extraButtonOptionEntry","extraButtonSpec","_initExtraButton","extraButtonsSpec","_defaultButtonId","buttonOrFileInputOrFile","inputs","fileInput","fileBlobOrInput","_getNotFinished","_getValidationBase","_getValidationDescriptor","fileWrapper","_getValidationDescriptors","fileWrappers","fileDescriptors","_handleCameraAccess","camera","optionRoot","details","callbackRetVal","successParam","newFileWrapperList","actualFile","handler","_customNewFileHandler","_handleNewFileGeneric","addFileToHandler","_trackButton","fileList","extSuppliedName","extension","_handleDeleteSuccess","_handleDeleteFailed","_initFormSupportAndParams","_formSupport","FormSupport","attachedToForm","getFormInputsAsObject","autoUpload","newAutoUpload","newEndpoint","_isDeletePossible","expected","allowXdr","allowed","valid","allowedExt","extRegex","code","maybeNameOrNames","extensionsForMessage","placeholderMatch","messages","names","validationBase","replacement","allowedExtension","formatFileName","sizeLimit","minSizeLimit","placeholder","_onBeforeManualRetry","notFinished","_onAllComplete","ios8SafariUploads","alert","unsupportedBrowserIos8Safari","_maybeParseAndSendUploadError","response","errorReason","defaultResponseError","_maybeProcessNextItemAfterOnValidateCallback","validItem","stopOnFirstInvalidFile","validationDescriptor","onValidate","_onValidateCallbackSuccess","_onValidateCallbackFailure","successful","failed","onAllComplete","_shouldAutoRetry","retryWaitPeriod","autoAttemptDelay","_onBeforeAutoRetry","itemLimit","onManualRetry","clearTimeout","storedItemIndex","fileIndex","onIndividualProgress","_onSubmit","_onSubmitCallbackSuccess","_onSubmitted","onSubmitted","_storeForLater","onSuccessCallback","additionalMandatedParams","adjustedOnSuccessCallback","onSubmitDelete","_deleteHandler","sendDelete","_onTotalProgress","onTotalProgress","enableAuto","_onValidateBatchCallbackFailure","_onValidateBatchCallbackSuccess","validationDescriptors","proposedNetFilesUploadedOrQueued","tooManyItemsError","nextIndex","_validateFileOrBlobData","_upload","onValidateBatch","_preventLeaveInProgress","event","onLeave","Session","_session","addFileRecord","refresh","_sessionRequestComplete","onSessionRequestComplete","onNewSize","maxAutoAttempts","formElementOrId","onSubmit","idToUpload","stillSubmitting","validityChecker","allowEmpty","ImageValidation","validate","image","errorCode","_wrapCallbacks","safeCallback","errorMsg","exception","callbackName","callbackFunc","FineUploaderBasic","disableCancelForFormUploads","warnBeforeUnload","filenameParam","forceMultipart","omitDefaultParams","paramsInBody","requireSuccessJson","totalFileSizeName","maxHeight","maxWidth","minHeight","minWidth","maybeXhr","maybeXhrOrXdr","attemptNumber","fileOrBlobData","typeError","sizeError","minSizeError","emptyError","noFilesError","maxHeightImageError","maxWidthImageError","minHeightImageError","minWidthImageError","retryFailTooManyItems","concurrent","mandatory","paramNames","partByteOffset","chunkSize","totalFileSize","totalParts","partSize","jsonPayload","resetOnStatus","recordsExpireIn","resuming","customKeys","fileOrBlobName","sendCredentials","interceptSubmit","customResizer","sendOriginal","orient","defaultType","defaultQuality","failureText","includeExif","sizes","ImageGenerator","_scaler","handleNewFile","TotalProgress","entry","AjaxRequester","shouldParamsBeInQueryString","queue","requestData","acceptHeader","validMethods","contentType","mandatedParams","allowXRequestedWithAndCacheControl","successfulResponseCodes","DELETE","PATCH","POST","PUT","GET","onSend","isXdr","getXhrOrXdr","suppliedXhr","ontimeout","onprogress","getCorsAjaxTransport","dequeue","sendRequest","xdrError","responseCode","optXhr","url","onDemandParams","additionalParams","getParams","payload","additionalQueryParams","addToPath","createUrl","getXdrLoadHandler","getXdrErrorHandler","onreadystatechange","readyState","getXhrReadyStateChangeHandler","lengthComputable","registerForUploadProgress","open","onDemandHeaders","additionalHeaders","allHeaders","setRequestHeader","containsNonSimple","header","setHeaders","send","stringify","initTransport","path","cacheBuster","withPath","appendToPath","withParams","withQueryParams","_additionalQueryParams_","withHeaders","withPayload","thePayload","withCacheBuster","qqtimestamp","Date","getTime","prepareToSend","canceled","UploadHandler","proxy","fileState","fileItem","getThirdPartyFileId","_getFileState","_setThirdPartyFileId","thirdPartyFileId","_wasCanceled","preventRetryResponse","controller","chunkingPossible","concurrentChunkingPossible","chunked","chunkIdx","_getChunkData","attemptingResume","chunkProgress","_getChunkDataForCallback","finalize","finalizeChunks","normaizedResponse","normalizeResponse","_maybeDeletePersistedChunkData","cleanup","normalizedResponse","handleFailure","clearCachedChunk","inProgressIdx","responseToReport","inProgressChunksArray","inProgress","remaining","unshift","ignoreFailure","_getXhrs","ckid","ckXhr","abort","_cancelled","moveInProgressToRemaining","connectionManager","free","hasMoreParts","nextPart","nextIdx","_getTotalChunks","reevaluateChunking","sendNext","inProgressChunks","available","requestOverrides","uploadChunkData","overrides","uploadChunk","inProgressChunkIdx","_maybePersistChunkedState","clearXhr","_open","_openChunks","_waiting","openChunkEntriesCount","openChunksCount","openChunkIndexes","dontAllowNext","nextId","allowNext","waitingIndex","connectionsIndex","getProxyOrBlob","getWaitingOrConnected","waitingOrConnected","chunks","parseInt","isUsingConnection","pop","openChunksEntry","simple","uploadFile","maybeNewUuid","_clearXhrs","getProxy","initHandler","handlerType","traditional","handlerModuleSubtype","onFinalizing","_removeExpiredChunkingRecords","isDeferredEligibleForUpload","maybeDefer","generatedBlob","updateBlob","maybeSendDeferredFiles","errorResponse","idsInGroup","uploadedThisId","idInGroup","now","originalResponse","_shouldChunkThisFile","blobToUpload","cancelRetVal","isProxied","_getLocalStorageId","isAttemptingResume","WindowReceiveMessage","callbackWrapperDetachers","receiveMessage","stopReceivingMessages","detacher","FormUploadHandler","formHandlerInstanceId","onloadCallbacks","detachLoadEvents","postMessageCallbackTimers","isCors","corsMessageReceiver","getFileIdForIframeName","iframeName","iframe","getElementById","_getIframeName","expungeFile","_attachLoadEvent","responseDescriptor","onloadCallback","_parseJsonResponse","_detachLoadEvent","registerPostMessageCallback","contentDocument","body","_createIframe","initIframeForUpload","_initFormForUpload","targetName","innerHtmlOrMessage","XhrUploadHandler","getChunkSize","chunkFiles","resumeEnabled","xhrId","ajaxRequester","_getAjaxRequester","blobOrProxy","_initTempState","_maybePrepareForResume","cachedChunks","tempState","xhrs","ajaxRequesters","responseParser","lastChunkIdx","_getXhr","resumableFilesData","_iterateResumeRecords","notResumable","optInProgress","optRemaining","chunkingState","reverse","paused","totalChunks","parts","newBlob","chunkId","_createXhr","optChunkIdx","_registerXhr","chunkIndex","fileSize","startBytes","endBytes","part","count","startByte","endByte","localStorageId","_getMimeType","_getPersistableData","ceil","_markNotResumable","removeItem","persistedData","lastUpdated","_registerProgressHandler","progressCalculator","totalSuccessfullyLoadedForFile","loadedForRequest","totalForRequest","estActualChunkLoaded","totalLoadedForFile","chunkLoaded","optAjaxRequester","xhrsId","expirationDays","expirationDate","setDate","getDate","requester","_method","renderImageToCanvas","img","doSquash","modifiedDimensions","iw","naturalWidth","ih","naturalHeight","width","ctx","getContext","save","resize","resizeInfo","imageHeight","imageWidth","orientation","sourceCanvas","sourceCanvasContext","targetCanvas","targetHeight","targetWidth","transformCoordinate","drawImage","qqImageRendered","renderImageToCanvasWithCustomResizer","origHeight","origWidth","newHeight","sqrt","newWidth","maybeCalculateDownsampledDimensions","getImageData","detectSubsampling","tmpCtx","sx","dx","tmpCanvas","vertSquashRatio","ratio","sy","ey","py","detectVerticalSquash","dw","dh","dy","clearRect","restore","translate","rotate","PI","MegaPixImage","srcImage","errorCallback","Image","URL","createObjectURL","webkitURL","src","listeners","imageLoadListeners","render","opt","oldTargetSrc","imgWidth","imgHeight","optionsKey","optionsValue","renderImageToDataURL","onrender","isImg","el","isCanvas","determineMimeOfFileName","nameWithPath","pathSegments","isCrossOrigin","targetProtocol","targetHostname","targetPort","targetAnchor","href","protocol","port","hostname","location","registerThumbnailRenderedListener","registered","registerImgLoadListeners","registerCanvasDrawImageListener","drawOnCanvasOrImgFromUrl","canvasOrImg","draw","tempImg","tempImgRender","crossOrigin","drawOnImgFromUrlWithCssScaling","drawFromUrl","fileBlobOrUrl","drawPreview","Identify","megapixErrorHandler","isPreviewable","dummyExif","exif","Exif","mpImg","Orientation","failureMsg","_testing","TAG_IDS","TAG_INFO","274","parseLittleEndian","hex","pow","getApp1Offset","seekToApp1","offset","theOffset","thePromise","segmentLength","parser","onParseFailure","app1Offset","app1Start","littleEndian","getDirEntryCount","dirEntryCount","dirEntries","getIfd","ifdHex","getDirEntries","tagValues","tagsToFind","vals","tagValHex","tagValLength","idHex","tagsToFindIdx","getTagValues","previewable","isPreviewableSync","PREVIEWABLE_MIME_TYPES","questionableBytes","identifiable","magicBytesEntries","magicBytesArrayEntry","fileMime","isRecognizedImage","limits","sizeDetermination","validationEffort","atLeastOne","limit","hasNonZeroLimits","dimensions","failingLimit","limitName","limitValue","limitMatcher","dimensionPropName","actualValue","getFailingLimit","handleFileItems","fileItems","someItemsIgnored","isJsonResponseValid","err","refreshEffort","requesterOptions","SessionAjaxRequester","queryServer","responseText","includeOriginal","failedToScaleText","_getSortedSizes","getFileRecords","originalFileUuid","originalFileName","originalBlobOrBlobData","records","originalBlob","sizeRecord","outputType","_determineOutputType","requestedType","refType","_getName","_generateScaledImage","failedText","api","param","scaledIds","originalId","blobSize","scaledId","qqparentuuid","qqparentsize","scalingEffort","scalingOptions","scaler","referenceType","scaledVersionProperties","startOfExt","versionType","scaledName","scaledExt","nameAppendage","sort","a","b","sourceFile","imageGenerator","scaledImageDataUri","signalSuccess","_insertExifHeader","scaledImageDataUriWithExif","originalImage","reader","insertionEffort","originalImageDataUri","readAsDataURL","_dataUriToBlob","_createBlob","chr1","chr2","enc1","enc2","enc3","output","chr3","enc4","isNaN","KEY_STR","origFileBase64","resizedFileBase64","rawImage","decode64","segments","slice2Segments","exifManipulation","encode64","exifArray","getExifArray","newImageArray","insertExif","seg","x","imageData","buf","separatePoint","mae","ato","rawImageArray","head","endPoint","perFileProgress","totalLoaded","totalSize","lastLoadedSent","lastTotalSent","callbackProxy","onNew","updateTotalProgress","newLoaded","newTotal","oldLoaded","oldTotal","retryable","none","failedId","noRetryableFiles","detachPasteHandler","clipboardData","isImage","getAsFile","startUpload","formEl","validateForm","nativeSubmit","checkValidity","_form2Obj","determineNewEndpoint","submit","maybeUploadOnSubmit","determineFormEl","ignoreValue","checked","elements","select","selected","selectValue","createForm","responseFromMessage","doc","innerHtml","contentWindow","nodeValue","getIframeContentJson","multipart","allChunksDoneRequester","AllChunksDoneAjaxRequester","createReadyStateChangedHandler","onUploadOrChunkComplete","isErrorUploadResponse","parseResponse","sendChunksCompleteRequest","complete","getChunksCompleteParams","setParamsAndGetEntityToSend","entityToSendParams","xhrOverrides","customParams","defaultParams","xhrOverrideParams","setUploadHeaders","headersOptions","headerOverrides","headerName","headerValue","extraHeaders","uploadChunkParams","toSend","addChunkingSpecificParams","promises","endpointHandler","DragAndDrop","dropZones","maybeHideDropZones","HIDE_ZONES_EVENT_NAME","HIDE_BEFORE_ENTER_ATTR","uploadDropZones","droppedFiles","traverseFileTree","parseEntryPromise","qqPath","extractDirectoryPath","fileError","dropLog","fullPath","isDirectory","getFilesInDirectory","accumEntries","existingPromise","dirReader","createReader","readEntries","newEntries","entriesLeft","indexOfNameInFullPath","setupDropzone","dropArea","dropZone","UploadDropZone","onEnter","dropActive","stopPropagation","onLeaveNotDescendants","onDrop","uploadDropZone","pendingFolderPromises","handleDataTransferPromise","processingDroppedFiles","dropDisabled","allowMultipleItems","processingDroppedFilesComplete","dropError","filesAsArray","getElement","uploadDroppedFiles","isFileDrag","dragEvent","fileDrag","types","dropZoneElements","HTMLElement","y","leavingDocumentOut","setupExtraDropzone","removeDropzone","dzs","targetEl","errorSpecifics","preventDrop","dropOutsideDisabled","dragoverShouldBeCanceled","isValidFileDrag","effectTest","dt","isSafari","effectAllowed","includes","isOrSetDropDisabled","isDisabled","dropEffect","effect","relatedTarget","elementFromPoint","clientX","clientY","hideZonesEvent","triggerUsingOldApi","createEvent","initEvent","CustomEvent","dispatchEvent","triggerHidezonesEvent","uiPublicApi","_parent","_templating","addCacheToDom","clearFiles","addExtraDropzone","_dnd","removeExtraDropzone","getItemByFileId","isHiddenForever","getFileContainer","_setupDragAndDrop","_totalFilesInBatch","_filesInBatchAddedToUi","_setupClickAndEditEventHandlers","formattedFilename","updateFilename","uploadPaused","continued","uploadContinued","getId","fileContainerOrChildEl","getFileId","getDropTarget","qqDropTarget","uiPrivateApi","_removeFileItem","removeFile","_fileButtonsClickHandler","FileButtonsClickHandler","_bindFileButtonsClickEvent","_focusinEventSupported","_isEditFilenameEnabled","_filenameClickHandler","_bindFilenameClickEvent","_filenameInputFocusInHandler","_bindFilenameInputFocusInEvent","_filenameInputFocusHandler","_bindFilenameInputFocusEvent","dragAndDrop","extraDropzones","templating","defaultDropZone","getDropZone","showDropProcessing","hideDropProcessing","errorData","lvl","onDeleteFile","onRetry","onPause","onContinue","onGetName","isEditFilenamePossible","FilenameClickHandler","FilenameInputFocusHandler","_filenameEditHandler","onGetUploadStatus","onSetName","onEditingStatusChange","isEditing","qqInput","getEditInput","qqFileContainer","hideFilename","hideEditIcon","showFilename","showEditIcon","markFilenameEditable","hideRetry","setStatusText","_classes","retrying","hidePause","FilenameInputFocusInHandler","hideSpinner","resetTotalProgress","reportDirectoryPaths","qqpath","_addToList","addHandler","updateProgress","hideCancel","hideProgress","waitingForResponse","_displayFileSize","parentRetVal","completeUpload","_markFileAsSuccessful","fail","showCancel","isRetryPossible","showRetry","_controlFailureTextDisplay","newResult","showDeleteButton","_maybeUpdateThumbnail","showSpinner","allowPause","retryNumForDisplay","maxAuto","retryNote","_showCancelLink","showAutoRetryNote","autoRetryNote","resetProgress","_onSubmitDeleteSuccess","forceConfirm","_showDeleteConfirm","_sendDeleteRequest","deletingFailedText","hideDeleteButton","deletingStatusText","confirmMessage","deleteRequestArgs","showConfirm","canned","prependData","prependIndex","dontDisplay","hideScaled","prependFiles","disableCancel","_handledProxyGroup","_clearList","addFileToCache","updateThumbnail","thumbnails","generatePreview","fileSizeOnSubmit","loadedSize","sizeForDisplay","_formatProgress","uploadedSize","formatProgress","responseProperty","failureReason","failedUploadTextDisplay","failUpload","enableTooltip","_showTooltip","showMessage","_setupPastePrompt","namePromptMessage","defaultVal","showPrompt","placeholders","waitUntilResponse","FineUploader","listElement","template","editable","tooManyFilesError","unsupportedBrowser","promptForName","maxCount","notAvailablePath","waitingPath","timeBetweenThumbs","hasDialog","showDialog","confirm","defaultValue","prompt","Templating","templateIdOrEl","containerEl","fileContainerEl","maxThumbs","waitUntilUpdate","thumbnailNotAvailable","waitingForThumbnail","renderFailure","isEditElementsExist","isRetryElementExist","templateDom","showThumbnails","serverScale","fileBatch","content","createDocumentFragment","isCancelDisabled","generatedThumbnails","thumbnailQueueMonitorRunning","thumbGenerationQueue","thumbnailMaxSize","selectorClasses","alertDialog","dialogCancelButton","confirmDialog","dialogMessage","dialogOkButton","promptDialog","uploader","drop","list","progressBarContainer","totalProgressBarContainer","totalProgressBar","spinner","continueButton","deleteButton","statusText","editFilenameInput","editNameIcon","dropText","dropProcessing","dropProcessingSpinner","thumbnail","previewGeneration","cachedThumbnailNotAvailableImg","cachedWaitingForThumbnailImg","displayWaitingImg","waitingImgPlacement","maybeScalePlaceholderViaCss","show","generateNextQueuedPreview","queuedThumbRequest","update","processUpdateQueuedPreviewRequest","processNewQueuedPreviewRequest","getCancel","getTemplateEl","getContinue","getDialog","getDelete","getDropProcessing","getEditIcon","getPause","getProgress","getRetry","getSpinner","cssClass","getThumbnail","maybeSetDisplayNotAvailableImg","previewing","notAvailableImgPlacement","optFileOrBlob","relatedThumbnailId","qqThumbnailId","useCachedPreview","generateNewPreview","showWaitingImg","setProgressBarWidth","percent","bar","progressBarSelector","targetThumbnailId","cachedThumbnailId","targetThumbnail","cachedThumbnail","scriptEl","scriptHtml","fileListNode","tempTemplateEl","fileListEl","defaultButton","dropTextEl","uploaderEl","cloneNode","fileTemplate","parseAndGetTemplate","notAvailableUrl","waitingUrl","updatedImg","cacheThumbnailPlaceholders","hideTotalProgress","cantRenderEl","prependInfo","hideForever","batch","thumb","fileEl","fileNameEl","parentEl","beforeEl","prependFile","waitingImg","currentNode","getFileList","filenameEl","isFileName","icon","isEditIcon","isEditInput","isCancel","allowContinueButton","isPause","isContinueButton","isDeleteButton","isRetry","textEl","dialog","messageEl","inputEl","cancelBtn","okBtn","closeHandler","cancelClickHandler","okClickHandler","close","showModal","UiEventHandler","protectedApi","eventType","attachTo","onHandled","srcElement","getFileIdFromItem","qqFileId","getDisposeSupport","buttonHandlers","buttonType","firstLetterCapButtonType","inheritedInternalApi","handleFilenameEdit","FilenameEditHandler","handleNameUpdate","newFilenameInputEl","origExtension","origName","getOriginalExtension","focusInput","filenameSansExt","focus","registerInputBlurHandler","keyCode","which","registerInputEnterKeyHandler","webpackContext","req","webpackContextResolve","resolve","EventEmitter","paperAdmin","Uploader","_opts","assign","dropzones","extraData","_makeUploader","getPaperParams","dataset","_this","is_loading","trigger","uploadedBytes","totalBytes","percentage","succeeded","whenDomReady","bootbox","emitters","preloader","formUtils","FileWidget","uploadButton","changeButton","link","urls","change","delete","loading","empty","instanceId","initUploader","addListeners","initWidget","closest","uploadUrl","changeUrl","deleteUrl","on","initWidgets","root","matches","Boolean","_empty","newValue","classList","_loading","instance_id","fileInfo","file_info","previewLink","_change","$dialog","$form","find","fetch","credentials","ok","cleanFormErrors","form_errors","addFormErrorsFromJSON","modal","catch","_delete","gettext","onEscape","buttons","label","queryString","URLSearchParams","dom","ImageWidget","Sortable","Gallery","itemContainer","preloaderItem","preloaderTemplate","itemPreview","itemLink","itemCheckbox","itemName","changeItemButton","deleteItemButton","itemSelectorTemplate","itemCoverClass","deleteGallery","uploadItem","changeItem","deleteItem","sortItems","init","allowedMimeTypes","allowedMimetypes","galleryId","sortable","initSortable","gallery_id","importNode","queueId","itemType","item_type","templateSelector","preview","before","currentCover","cover","newCover","animation","draggable","handle","ghostClass","onEnd","order","pk","cleanItems","_deleteItem","_changeItem","_deleteGallery","_checkItem","toggle","lastChecked","target_state","checkbox","ctrlKey","shiftKey","lastIndex","targetIndex","startIndex","min","endIndex","checkedItems","_errors","_errorTimer","alertMessage","deleteGalleryUrl","uploadItemUrl","changeItemUrl","deleteItemUrl","sortItemsUrl","require"],"mappings":"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","file":"widget.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/static/paper_uploads/dist/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 32);\n","'use strict';\n\nvar isMergeableObject = function isMergeableObject(value) {\n\treturn isNonNullObject(value)\n\t\t&& !isSpecial(value)\n};\n\nfunction isNonNullObject(value) {\n\treturn !!value && typeof value === 'object'\n}\n\nfunction isSpecial(value) {\n\tvar stringValue = Object.prototype.toString.call(value);\n\n\treturn stringValue === '[object RegExp]'\n\t\t|| stringValue === '[object Date]'\n\t\t|| isReactElement(value)\n}\n\n// see https://github.com/facebook/react/blob/b5ac963fb791d1298e7f396236383bc955f916c1/src/isomorphic/classic/element/ReactElement.js#L21-L25\nvar canUseSymbol = typeof Symbol === 'function' && Symbol.for;\nvar REACT_ELEMENT_TYPE = canUseSymbol ? Symbol.for('react.element') : 0xeac7;\n\nfunction isReactElement(value) {\n\treturn value.$$typeof === REACT_ELEMENT_TYPE\n}\n\nfunction emptyTarget(val) {\n\treturn Array.isArray(val) ? [] : {}\n}\n\nfunction cloneUnlessOtherwiseSpecified(value, options) {\n\treturn (options.clone !== false && options.isMergeableObject(value))\n\t\t? deepmerge(emptyTarget(value), value, options)\n\t\t: value\n}\n\nfunction defaultArrayMerge(target, source, options) {\n\treturn target.concat(source).map(function(element) {\n\t\treturn cloneUnlessOtherwiseSpecified(element, options)\n\t})\n}\n\nfunction getMergeFunction(key, options) {\n\tif (!options.customMerge) {\n\t\treturn deepmerge\n\t}\n\tvar customMerge = options.customMerge(key);\n\treturn typeof customMerge === 'function' ? customMerge : deepmerge\n}\n\nfunction getEnumerableOwnPropertySymbols(target) {\n\treturn Object.getOwnPropertySymbols\n\t\t? Object.getOwnPropertySymbols(target).filter(function(symbol) {\n\t\t\treturn target.propertyIsEnumerable(symbol)\n\t\t})\n\t\t: []\n}\n\nfunction getKeys(target) {\n\treturn Object.keys(target).concat(getEnumerableOwnPropertySymbols(target))\n}\n\nfunction mergeObject(target, source, options) {\n\tvar destination = {};\n\tif (options.isMergeableObject(target)) {\n\t\tgetKeys(target).forEach(function(key) {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(target[key], options);\n\t\t});\n\t}\n\tgetKeys(source).forEach(function(key) {\n\t\tif (!options.isMergeableObject(source[key]) || !target[key]) {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(source[key], options);\n\t\t} else {\n\t\t\tdestination[key] = getMergeFunction(key, options)(target[key], source[key], options);\n\t\t}\n\t});\n\treturn destination\n}\n\nfunction deepmerge(target, source, options) {\n\toptions = options || {};\n\toptions.arrayMerge = options.arrayMerge || defaultArrayMerge;\n\toptions.isMergeableObject = options.isMergeableObject || isMergeableObject;\n\n\tvar sourceIsArray = Array.isArray(source);\n\tvar targetIsArray = Array.isArray(target);\n\tvar sourceAndTargetTypesMatch = sourceIsArray === targetIsArray;\n\n\tif (!sourceAndTargetTypesMatch) {\n\t\treturn cloneUnlessOtherwiseSpecified(source, options)\n\t} else if (sourceIsArray) {\n\t\treturn options.arrayMerge(target, source, options)\n\t} else {\n\t\treturn mergeObject(target, source, options)\n\t}\n}\n\ndeepmerge.all = function deepmergeAll(array, options) {\n\tif (!Array.isArray(array)) {\n\t\tthrow new Error('first argument should be an array')\n\t}\n\n\treturn array.reduce(function(prev, next) {\n\t\treturn deepmerge(prev, next, options)\n\t}, {})\n};\n\nvar deepmerge_1 = deepmerge;\n\nmodule.exports = deepmerge_1;\n","\"use strict\";\n\nmodule.exports = require(\"../fine-uploader/fine-uploader\");\n","// Fine Uploader 5.16.2 - MIT licensed. http://fineuploader.com\n(function(global) {\n    var qq = function(element) {\n        \"use strict\";\n        return {\n            hide: function() {\n                element.style.display = \"none\";\n                return this;\n            },\n            attach: function(type, fn) {\n                if (element.addEventListener) {\n                    element.addEventListener(type, fn, false);\n                } else if (element.attachEvent) {\n                    element.attachEvent(\"on\" + type, fn);\n                }\n                return function() {\n                    qq(element).detach(type, fn);\n                };\n            },\n            detach: function(type, fn) {\n                if (element.removeEventListener) {\n                    element.removeEventListener(type, fn, false);\n                } else if (element.attachEvent) {\n                    element.detachEvent(\"on\" + type, fn);\n                }\n                return this;\n            },\n            contains: function(descendant) {\n                if (!descendant) {\n                    return false;\n                }\n                if (element === descendant) {\n                    return true;\n                }\n                if (element.contains) {\n                    return element.contains(descendant);\n                } else {\n                    return !!(descendant.compareDocumentPosition(element) & 8);\n                }\n            },\n            insertBefore: function(elementB) {\n                elementB.parentNode.insertBefore(element, elementB);\n                return this;\n            },\n            remove: function() {\n                element.parentNode.removeChild(element);\n                return this;\n            },\n            css: function(styles) {\n                if (element.style == null) {\n                    throw new qq.Error(\"Can't apply style to node as it is not on the HTMLElement prototype chain!\");\n                }\n                if (styles.opacity != null) {\n                    if (typeof element.style.opacity !== \"string\" && typeof element.filters !== \"undefined\") {\n                        styles.filter = \"alpha(opacity=\" + Math.round(100 * styles.opacity) + \")\";\n                    }\n                }\n                qq.extend(element.style, styles);\n                return this;\n            },\n            hasClass: function(name, considerParent) {\n                var re = new RegExp(\"(^| )\" + name + \"( |$)\");\n                return re.test(element.className) || !!(considerParent && re.test(element.parentNode.className));\n            },\n            addClass: function(name) {\n                if (!qq(element).hasClass(name)) {\n                    element.className += \" \" + name;\n                }\n                return this;\n            },\n            removeClass: function(name) {\n                var re = new RegExp(\"(^| )\" + name + \"( |$)\");\n                element.className = element.className.replace(re, \" \").replace(/^\\s+|\\s+$/g, \"\");\n                return this;\n            },\n            getByClass: function(className, first) {\n                var candidates, result = [];\n                if (first && element.querySelector) {\n                    return element.querySelector(\".\" + className);\n                } else if (element.querySelectorAll) {\n                    return element.querySelectorAll(\".\" + className);\n                }\n                candidates = element.getElementsByTagName(\"*\");\n                qq.each(candidates, function(idx, val) {\n                    if (qq(val).hasClass(className)) {\n                        result.push(val);\n                    }\n                });\n                return first ? result[0] : result;\n            },\n            getFirstByClass: function(className) {\n                return qq(element).getByClass(className, true);\n            },\n            children: function() {\n                var children = [], child = element.firstChild;\n                while (child) {\n                    if (child.nodeType === 1) {\n                        children.push(child);\n                    }\n                    child = child.nextSibling;\n                }\n                return children;\n            },\n            setText: function(text) {\n                element.innerText = text;\n                element.textContent = text;\n                return this;\n            },\n            clearText: function() {\n                return qq(element).setText(\"\");\n            },\n            hasAttribute: function(attrName) {\n                var attrVal;\n                if (element.hasAttribute) {\n                    if (!element.hasAttribute(attrName)) {\n                        return false;\n                    }\n                    return /^false$/i.exec(element.getAttribute(attrName)) == null;\n                } else {\n                    attrVal = element[attrName];\n                    if (attrVal === undefined) {\n                        return false;\n                    }\n                    return /^false$/i.exec(attrVal) == null;\n                }\n            }\n        };\n    };\n    (function() {\n        \"use strict\";\n        qq.canvasToBlob = function(canvas, mime, quality) {\n            return qq.dataUriToBlob(canvas.toDataURL(mime, quality));\n        };\n        qq.dataUriToBlob = function(dataUri) {\n            var arrayBuffer, byteString, createBlob = function(data, mime) {\n                var BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder, blobBuilder = BlobBuilder && new BlobBuilder();\n                if (blobBuilder) {\n                    blobBuilder.append(data);\n                    return blobBuilder.getBlob(mime);\n                } else {\n                    return new Blob([ data ], {\n                        type: mime\n                    });\n                }\n            }, intArray, mimeString;\n            if (dataUri.split(\",\")[0].indexOf(\"base64\") >= 0) {\n                byteString = atob(dataUri.split(\",\")[1]);\n            } else {\n                byteString = decodeURI(dataUri.split(\",\")[1]);\n            }\n            mimeString = dataUri.split(\",\")[0].split(\":\")[1].split(\";\")[0];\n            arrayBuffer = new ArrayBuffer(byteString.length);\n            intArray = new Uint8Array(arrayBuffer);\n            qq.each(byteString, function(idx, character) {\n                intArray[idx] = character.charCodeAt(0);\n            });\n            return createBlob(arrayBuffer, mimeString);\n        };\n        qq.log = function(message, level) {\n            if (window.console) {\n                if (!level || level === \"info\") {\n                    window.console.log(message);\n                } else {\n                    if (window.console[level]) {\n                        window.console[level](message);\n                    } else {\n                        window.console.log(\"<\" + level + \"> \" + message);\n                    }\n                }\n            }\n        };\n        qq.isObject = function(variable) {\n            return variable && !variable.nodeType && Object.prototype.toString.call(variable) === \"[object Object]\";\n        };\n        qq.isFunction = function(variable) {\n            return typeof variable === \"function\";\n        };\n        qq.isArray = function(value) {\n            return Object.prototype.toString.call(value) === \"[object Array]\" || value && window.ArrayBuffer && value.buffer && value.buffer.constructor === ArrayBuffer;\n        };\n        qq.isItemList = function(maybeItemList) {\n            return Object.prototype.toString.call(maybeItemList) === \"[object DataTransferItemList]\";\n        };\n        qq.isNodeList = function(maybeNodeList) {\n            return Object.prototype.toString.call(maybeNodeList) === \"[object NodeList]\" || maybeNodeList.item && maybeNodeList.namedItem;\n        };\n        qq.isString = function(maybeString) {\n            return Object.prototype.toString.call(maybeString) === \"[object String]\";\n        };\n        qq.trimStr = function(string) {\n            if (String.prototype.trim) {\n                return string.trim();\n            }\n            return string.replace(/^\\s+|\\s+$/g, \"\");\n        };\n        qq.format = function(str) {\n            var args = Array.prototype.slice.call(arguments, 1), newStr = str, nextIdxToReplace = newStr.indexOf(\"{}\");\n            qq.each(args, function(idx, val) {\n                var strBefore = newStr.substring(0, nextIdxToReplace), strAfter = newStr.substring(nextIdxToReplace + 2);\n                newStr = strBefore + val + strAfter;\n                nextIdxToReplace = newStr.indexOf(\"{}\", nextIdxToReplace + val.length);\n                if (nextIdxToReplace < 0) {\n                    return false;\n                }\n            });\n            return newStr;\n        };\n        qq.isFile = function(maybeFile) {\n            return window.File && Object.prototype.toString.call(maybeFile) === \"[object File]\";\n        };\n        qq.isFileList = function(maybeFileList) {\n            return window.FileList && Object.prototype.toString.call(maybeFileList) === \"[object FileList]\";\n        };\n        qq.isFileOrInput = function(maybeFileOrInput) {\n            return qq.isFile(maybeFileOrInput) || qq.isInput(maybeFileOrInput);\n        };\n        qq.isInput = function(maybeInput, notFile) {\n            var evaluateType = function(type) {\n                var normalizedType = type.toLowerCase();\n                if (notFile) {\n                    return normalizedType !== \"file\";\n                }\n                return normalizedType === \"file\";\n            };\n            if (window.HTMLInputElement) {\n                if (Object.prototype.toString.call(maybeInput) === \"[object HTMLInputElement]\") {\n                    if (maybeInput.type && evaluateType(maybeInput.type)) {\n                        return true;\n                    }\n                }\n            }\n            if (maybeInput.tagName) {\n                if (maybeInput.tagName.toLowerCase() === \"input\") {\n                    if (maybeInput.type && evaluateType(maybeInput.type)) {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        };\n        qq.isBlob = function(maybeBlob) {\n            if (window.Blob && Object.prototype.toString.call(maybeBlob) === \"[object Blob]\") {\n                return true;\n            }\n        };\n        qq.isXhrUploadSupported = function() {\n            var input = document.createElement(\"input\");\n            input.type = \"file\";\n            return input.multiple !== undefined && typeof File !== \"undefined\" && typeof FormData !== \"undefined\" && typeof qq.createXhrInstance().upload !== \"undefined\";\n        };\n        qq.createXhrInstance = function() {\n            if (window.XMLHttpRequest) {\n                return new XMLHttpRequest();\n            }\n            try {\n                return new ActiveXObject(\"MSXML2.XMLHTTP.3.0\");\n            } catch (error) {\n                qq.log(\"Neither XHR or ActiveX are supported!\", \"error\");\n                return null;\n            }\n        };\n        qq.isFolderDropSupported = function(dataTransfer) {\n            return dataTransfer.items && dataTransfer.items.length > 0 && dataTransfer.items[0].webkitGetAsEntry;\n        };\n        qq.isFileChunkingSupported = function() {\n            return !qq.androidStock() && qq.isXhrUploadSupported() && (File.prototype.slice !== undefined || File.prototype.webkitSlice !== undefined || File.prototype.mozSlice !== undefined);\n        };\n        qq.sliceBlob = function(fileOrBlob, start, end) {\n            var slicer = fileOrBlob.slice || fileOrBlob.mozSlice || fileOrBlob.webkitSlice;\n            return slicer.call(fileOrBlob, start, end);\n        };\n        qq.arrayBufferToHex = function(buffer) {\n            var bytesAsHex = \"\", bytes = new Uint8Array(buffer);\n            qq.each(bytes, function(idx, byt) {\n                var byteAsHexStr = byt.toString(16);\n                if (byteAsHexStr.length < 2) {\n                    byteAsHexStr = \"0\" + byteAsHexStr;\n                }\n                bytesAsHex += byteAsHexStr;\n            });\n            return bytesAsHex;\n        };\n        qq.readBlobToHex = function(blob, startOffset, length) {\n            var initialBlob = qq.sliceBlob(blob, startOffset, startOffset + length), fileReader = new FileReader(), promise = new qq.Promise();\n            fileReader.onload = function() {\n                promise.success(qq.arrayBufferToHex(fileReader.result));\n            };\n            fileReader.onerror = promise.failure;\n            fileReader.readAsArrayBuffer(initialBlob);\n            return promise;\n        };\n        qq.extend = function(first, second, extendNested) {\n            qq.each(second, function(prop, val) {\n                if (extendNested && qq.isObject(val)) {\n                    if (first[prop] === undefined) {\n                        first[prop] = {};\n                    }\n                    qq.extend(first[prop], val, true);\n                } else {\n                    first[prop] = val;\n                }\n            });\n            return first;\n        };\n        qq.override = function(target, sourceFn) {\n            var super_ = {}, source = sourceFn(super_);\n            qq.each(source, function(srcPropName, srcPropVal) {\n                if (target[srcPropName] !== undefined) {\n                    super_[srcPropName] = target[srcPropName];\n                }\n                target[srcPropName] = srcPropVal;\n            });\n            return target;\n        };\n        qq.indexOf = function(arr, elt, from) {\n            if (arr.indexOf) {\n                return arr.indexOf(elt, from);\n            }\n            from = from || 0;\n            var len = arr.length;\n            if (from < 0) {\n                from += len;\n            }\n            for (;from < len; from += 1) {\n                if (arr.hasOwnProperty(from) && arr[from] === elt) {\n                    return from;\n                }\n            }\n            return -1;\n        };\n        qq.getUniqueId = function() {\n            return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function(c) {\n                var r = Math.random() * 16 | 0, v = c == \"x\" ? r : r & 3 | 8;\n                return v.toString(16);\n            });\n        };\n        qq.ie = function() {\n            return navigator.userAgent.indexOf(\"MSIE\") !== -1 || navigator.userAgent.indexOf(\"Trident\") !== -1;\n        };\n        qq.ie7 = function() {\n            return navigator.userAgent.indexOf(\"MSIE 7\") !== -1;\n        };\n        qq.ie8 = function() {\n            return navigator.userAgent.indexOf(\"MSIE 8\") !== -1;\n        };\n        qq.ie10 = function() {\n            return navigator.userAgent.indexOf(\"MSIE 10\") !== -1;\n        };\n        qq.ie11 = function() {\n            return qq.ie() && navigator.userAgent.indexOf(\"rv:11\") !== -1;\n        };\n        qq.edge = function() {\n            return navigator.userAgent.indexOf(\"Edge\") >= 0;\n        };\n        qq.safari = function() {\n            return navigator.vendor !== undefined && navigator.vendor.indexOf(\"Apple\") !== -1;\n        };\n        qq.chrome = function() {\n            return navigator.vendor !== undefined && navigator.vendor.indexOf(\"Google\") !== -1;\n        };\n        qq.opera = function() {\n            return navigator.vendor !== undefined && navigator.vendor.indexOf(\"Opera\") !== -1;\n        };\n        qq.firefox = function() {\n            return !qq.edge() && !qq.ie11() && navigator.userAgent.indexOf(\"Mozilla\") !== -1 && navigator.vendor !== undefined && navigator.vendor === \"\";\n        };\n        qq.windows = function() {\n            return navigator.platform === \"Win32\";\n        };\n        qq.android = function() {\n            return navigator.userAgent.toLowerCase().indexOf(\"android\") !== -1;\n        };\n        qq.androidStock = function() {\n            return qq.android() && navigator.userAgent.toLowerCase().indexOf(\"chrome\") < 0;\n        };\n        qq.ios6 = function() {\n            return qq.ios() && navigator.userAgent.indexOf(\" OS 6_\") !== -1;\n        };\n        qq.ios7 = function() {\n            return qq.ios() && navigator.userAgent.indexOf(\" OS 7_\") !== -1;\n        };\n        qq.ios8 = function() {\n            return qq.ios() && navigator.userAgent.indexOf(\" OS 8_\") !== -1;\n        };\n        qq.ios800 = function() {\n            return qq.ios() && navigator.userAgent.indexOf(\" OS 8_0 \") !== -1;\n        };\n        qq.ios = function() {\n            return navigator.userAgent.indexOf(\"iPad\") !== -1 || navigator.userAgent.indexOf(\"iPod\") !== -1 || navigator.userAgent.indexOf(\"iPhone\") !== -1;\n        };\n        qq.iosChrome = function() {\n            return qq.ios() && navigator.userAgent.indexOf(\"CriOS\") !== -1;\n        };\n        qq.iosSafari = function() {\n            return qq.ios() && !qq.iosChrome() && navigator.userAgent.indexOf(\"Safari\") !== -1;\n        };\n        qq.iosSafariWebView = function() {\n            return qq.ios() && !qq.iosChrome() && !qq.iosSafari();\n        };\n        qq.preventDefault = function(e) {\n            if (e.preventDefault) {\n                e.preventDefault();\n            } else {\n                e.returnValue = false;\n            }\n        };\n        qq.toElement = function() {\n            var div = document.createElement(\"div\");\n            return function(html) {\n                div.innerHTML = html;\n                var element = div.firstChild;\n                div.removeChild(element);\n                return element;\n            };\n        }();\n        qq.each = function(iterableItem, callback) {\n            var keyOrIndex, retVal;\n            if (iterableItem) {\n                if (window.Storage && iterableItem.constructor === window.Storage) {\n                    for (keyOrIndex = 0; keyOrIndex < iterableItem.length; keyOrIndex++) {\n                        retVal = callback(iterableItem.key(keyOrIndex), iterableItem.getItem(iterableItem.key(keyOrIndex)));\n                        if (retVal === false) {\n                            break;\n                        }\n                    }\n                } else if (qq.isArray(iterableItem) || qq.isItemList(iterableItem) || qq.isNodeList(iterableItem)) {\n                    for (keyOrIndex = 0; keyOrIndex < iterableItem.length; keyOrIndex++) {\n                        retVal = callback(keyOrIndex, iterableItem[keyOrIndex]);\n                        if (retVal === false) {\n                            break;\n                        }\n                    }\n                } else if (qq.isString(iterableItem)) {\n                    for (keyOrIndex = 0; keyOrIndex < iterableItem.length; keyOrIndex++) {\n                        retVal = callback(keyOrIndex, iterableItem.charAt(keyOrIndex));\n                        if (retVal === false) {\n                            break;\n                        }\n                    }\n                } else {\n                    for (keyOrIndex in iterableItem) {\n                        if (Object.prototype.hasOwnProperty.call(iterableItem, keyOrIndex)) {\n                            retVal = callback(keyOrIndex, iterableItem[keyOrIndex]);\n                            if (retVal === false) {\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n        };\n        qq.bind = function(oldFunc, context) {\n            if (qq.isFunction(oldFunc)) {\n                var args = Array.prototype.slice.call(arguments, 2);\n                return function() {\n                    var newArgs = qq.extend([], args);\n                    if (arguments.length) {\n                        newArgs = newArgs.concat(Array.prototype.slice.call(arguments));\n                    }\n                    return oldFunc.apply(context, newArgs);\n                };\n            }\n            throw new Error(\"first parameter must be a function!\");\n        };\n        qq.obj2url = function(obj, temp, prefixDone) {\n            var uristrings = [], prefix = \"&\", add = function(nextObj, i) {\n                var nextTemp = temp ? /\\[\\]$/.test(temp) ? temp : temp + \"[\" + i + \"]\" : i;\n                if (nextTemp !== \"undefined\" && i !== \"undefined\") {\n                    uristrings.push(typeof nextObj === \"object\" ? qq.obj2url(nextObj, nextTemp, true) : Object.prototype.toString.call(nextObj) === \"[object Function]\" ? encodeURIComponent(nextTemp) + \"=\" + encodeURIComponent(nextObj()) : encodeURIComponent(nextTemp) + \"=\" + encodeURIComponent(nextObj));\n                }\n            };\n            if (!prefixDone && temp) {\n                prefix = /\\?/.test(temp) ? /\\?$/.test(temp) ? \"\" : \"&\" : \"?\";\n                uristrings.push(temp);\n                uristrings.push(qq.obj2url(obj));\n            } else if (Object.prototype.toString.call(obj) === \"[object Array]\" && typeof obj !== \"undefined\") {\n                qq.each(obj, function(idx, val) {\n                    add(val, idx);\n                });\n            } else if (typeof obj !== \"undefined\" && obj !== null && typeof obj === \"object\") {\n                qq.each(obj, function(prop, val) {\n                    add(val, prop);\n                });\n            } else {\n                uristrings.push(encodeURIComponent(temp) + \"=\" + encodeURIComponent(obj));\n            }\n            if (temp) {\n                return uristrings.join(prefix);\n            } else {\n                return uristrings.join(prefix).replace(/^&/, \"\").replace(/%20/g, \"+\");\n            }\n        };\n        qq.obj2FormData = function(obj, formData, arrayKeyName) {\n            if (!formData) {\n                formData = new FormData();\n            }\n            qq.each(obj, function(key, val) {\n                key = arrayKeyName ? arrayKeyName + \"[\" + key + \"]\" : key;\n                if (qq.isObject(val)) {\n                    qq.obj2FormData(val, formData, key);\n                } else if (qq.isFunction(val)) {\n                    formData.append(key, val());\n                } else {\n                    formData.append(key, val);\n                }\n            });\n            return formData;\n        };\n        qq.obj2Inputs = function(obj, form) {\n            var input;\n            if (!form) {\n                form = document.createElement(\"form\");\n            }\n            qq.obj2FormData(obj, {\n                append: function(key, val) {\n                    input = document.createElement(\"input\");\n                    input.setAttribute(\"name\", key);\n                    input.setAttribute(\"value\", val);\n                    form.appendChild(input);\n                }\n            });\n            return form;\n        };\n        qq.parseJson = function(json) {\n            if (window.JSON && qq.isFunction(JSON.parse)) {\n                return JSON.parse(json);\n            } else {\n                return eval(\"(\" + json + \")\");\n            }\n        };\n        qq.getExtension = function(filename) {\n            var extIdx = filename.lastIndexOf(\".\") + 1;\n            if (extIdx > 0) {\n                return filename.substr(extIdx, filename.length - extIdx);\n            }\n        };\n        qq.getFilename = function(blobOrFileInput) {\n            if (qq.isInput(blobOrFileInput)) {\n                return blobOrFileInput.value.replace(/.*(\\/|\\\\)/, \"\");\n            } else if (qq.isFile(blobOrFileInput)) {\n                if (blobOrFileInput.fileName !== null && blobOrFileInput.fileName !== undefined) {\n                    return blobOrFileInput.fileName;\n                }\n            }\n            return blobOrFileInput.name;\n        };\n        qq.DisposeSupport = function() {\n            var disposers = [];\n            return {\n                dispose: function() {\n                    var disposer;\n                    do {\n                        disposer = disposers.shift();\n                        if (disposer) {\n                            disposer();\n                        }\n                    } while (disposer);\n                },\n                attach: function() {\n                    var args = arguments;\n                    this.addDisposer(qq(args[0]).attach.apply(this, Array.prototype.slice.call(arguments, 1)));\n                },\n                addDisposer: function(disposeFunction) {\n                    disposers.push(disposeFunction);\n                }\n            };\n        };\n    })();\n    (function() {\n        \"use strict\";\n        if (typeof define === \"function\" && define.amd) {\n            define(function() {\n                return qq;\n            });\n        } else if (typeof module !== \"undefined\" && module.exports) {\n            module.exports = qq;\n        } else {\n            global.qq = qq;\n        }\n    })();\n    (function() {\n        \"use strict\";\n        qq.Error = function(message) {\n            this.message = \"[Fine Uploader \" + qq.version + \"] \" + message;\n        };\n        qq.Error.prototype = new Error();\n    })();\n    qq.version = \"5.16.2\";\n    qq.supportedFeatures = function() {\n        \"use strict\";\n        var supportsUploading, supportsUploadingBlobs, supportsFileDrop, supportsAjaxFileUploading, supportsFolderDrop, supportsChunking, supportsResume, supportsUploadViaPaste, supportsUploadCors, supportsDeleteFileXdr, supportsDeleteFileCorsXhr, supportsDeleteFileCors, supportsFolderSelection, supportsImagePreviews, supportsUploadProgress;\n        function testSupportsFileInputElement() {\n            var supported = true, tempInput;\n            try {\n                tempInput = document.createElement(\"input\");\n                tempInput.type = \"file\";\n                qq(tempInput).hide();\n                if (tempInput.disabled) {\n                    supported = false;\n                }\n            } catch (ex) {\n                supported = false;\n            }\n            return supported;\n        }\n        function isChrome14OrHigher() {\n            return (qq.chrome() || qq.opera()) && navigator.userAgent.match(/Chrome\\/[1][4-9]|Chrome\\/[2-9][0-9]/) !== undefined;\n        }\n        function isCrossOriginXhrSupported() {\n            if (window.XMLHttpRequest) {\n                var xhr = qq.createXhrInstance();\n                return xhr.withCredentials !== undefined;\n            }\n            return false;\n        }\n        function isXdrSupported() {\n            return window.XDomainRequest !== undefined;\n        }\n        function isCrossOriginAjaxSupported() {\n            if (isCrossOriginXhrSupported()) {\n                return true;\n            }\n            return isXdrSupported();\n        }\n        function isFolderSelectionSupported() {\n            return document.createElement(\"input\").webkitdirectory !== undefined;\n        }\n        function isLocalStorageSupported() {\n            try {\n                return !!window.localStorage && qq.isFunction(window.localStorage.setItem);\n            } catch (error) {\n                return false;\n            }\n        }\n        function isDragAndDropSupported() {\n            var span = document.createElement(\"span\");\n            return (\"draggable\" in span || \"ondragstart\" in span && \"ondrop\" in span) && !qq.android() && !qq.ios();\n        }\n        supportsUploading = testSupportsFileInputElement();\n        supportsAjaxFileUploading = supportsUploading && qq.isXhrUploadSupported();\n        supportsUploadingBlobs = supportsAjaxFileUploading && !qq.androidStock();\n        supportsFileDrop = supportsAjaxFileUploading && isDragAndDropSupported();\n        supportsFolderDrop = supportsFileDrop && function() {\n            var input = document.createElement(\"input\");\n            input.type = \"file\";\n            return !!(\"webkitdirectory\" in (input || document.querySelectorAll(\"input[type=file]\")[0]));\n        }();\n        supportsChunking = supportsAjaxFileUploading && qq.isFileChunkingSupported();\n        supportsResume = supportsAjaxFileUploading && supportsChunking && isLocalStorageSupported();\n        supportsUploadViaPaste = supportsAjaxFileUploading && isChrome14OrHigher();\n        supportsUploadCors = supportsUploading && (window.postMessage !== undefined || supportsAjaxFileUploading);\n        supportsDeleteFileCorsXhr = isCrossOriginXhrSupported();\n        supportsDeleteFileXdr = isXdrSupported();\n        supportsDeleteFileCors = isCrossOriginAjaxSupported();\n        supportsFolderSelection = isFolderSelectionSupported();\n        supportsImagePreviews = supportsAjaxFileUploading && window.FileReader !== undefined;\n        supportsUploadProgress = function() {\n            if (supportsAjaxFileUploading) {\n                return !qq.androidStock() && !qq.iosChrome();\n            }\n            return false;\n        }();\n        return {\n            ajaxUploading: supportsAjaxFileUploading,\n            blobUploading: supportsUploadingBlobs,\n            canDetermineSize: supportsAjaxFileUploading,\n            chunking: supportsChunking,\n            deleteFileCors: supportsDeleteFileCors,\n            deleteFileCorsXdr: supportsDeleteFileXdr,\n            deleteFileCorsXhr: supportsDeleteFileCorsXhr,\n            dialogElement: !!window.HTMLDialogElement,\n            fileDrop: supportsFileDrop,\n            folderDrop: supportsFolderDrop,\n            folderSelection: supportsFolderSelection,\n            imagePreviews: supportsImagePreviews,\n            imageValidation: supportsImagePreviews,\n            itemSizeValidation: supportsAjaxFileUploading,\n            pause: supportsChunking,\n            progressBar: supportsUploadProgress,\n            resume: supportsResume,\n            scaling: supportsImagePreviews && supportsUploadingBlobs,\n            tiffPreviews: qq.safari(),\n            unlimitedScaledImageSize: !qq.ios(),\n            uploading: supportsUploading,\n            uploadCors: supportsUploadCors,\n            uploadCustomHeaders: supportsAjaxFileUploading,\n            uploadNonMultipart: supportsAjaxFileUploading,\n            uploadViaPaste: supportsUploadViaPaste\n        };\n    }();\n    qq.isGenericPromise = function(maybePromise) {\n        \"use strict\";\n        return !!(maybePromise && maybePromise.then && qq.isFunction(maybePromise.then));\n    };\n    qq.Promise = function() {\n        \"use strict\";\n        var successArgs, failureArgs, successCallbacks = [], failureCallbacks = [], doneCallbacks = [], state = 0;\n        qq.extend(this, {\n            then: function(onSuccess, onFailure) {\n                if (state === 0) {\n                    if (onSuccess) {\n                        successCallbacks.push(onSuccess);\n                    }\n                    if (onFailure) {\n                        failureCallbacks.push(onFailure);\n                    }\n                } else if (state === -1) {\n                    onFailure && onFailure.apply(null, failureArgs);\n                } else if (onSuccess) {\n                    onSuccess.apply(null, successArgs);\n                }\n                return this;\n            },\n            done: function(callback) {\n                if (state === 0) {\n                    doneCallbacks.push(callback);\n                } else {\n                    callback.apply(null, failureArgs === undefined ? successArgs : failureArgs);\n                }\n                return this;\n            },\n            success: function() {\n                state = 1;\n                successArgs = arguments;\n                if (successCallbacks.length) {\n                    qq.each(successCallbacks, function(idx, callback) {\n                        callback.apply(null, successArgs);\n                    });\n                }\n                if (doneCallbacks.length) {\n                    qq.each(doneCallbacks, function(idx, callback) {\n                        callback.apply(null, successArgs);\n                    });\n                }\n                return this;\n            },\n            failure: function() {\n                state = -1;\n                failureArgs = arguments;\n                if (failureCallbacks.length) {\n                    qq.each(failureCallbacks, function(idx, callback) {\n                        callback.apply(null, failureArgs);\n                    });\n                }\n                if (doneCallbacks.length) {\n                    qq.each(doneCallbacks, function(idx, callback) {\n                        callback.apply(null, failureArgs);\n                    });\n                }\n                return this;\n            }\n        });\n    };\n    qq.BlobProxy = function(referenceBlob, onCreate) {\n        \"use strict\";\n        qq.extend(this, {\n            referenceBlob: referenceBlob,\n            create: function() {\n                return onCreate(referenceBlob);\n            }\n        });\n    };\n    qq.UploadButton = function(o) {\n        \"use strict\";\n        var self = this, disposeSupport = new qq.DisposeSupport(), options = {\n            acceptFiles: null,\n            element: null,\n            focusClass: \"qq-upload-button-focus\",\n            folders: false,\n            hoverClass: \"qq-upload-button-hover\",\n            ios8BrowserCrashWorkaround: false,\n            multiple: false,\n            name: \"qqfile\",\n            onChange: function(input) {},\n            title: null\n        }, input, buttonId;\n        qq.extend(options, o);\n        buttonId = qq.getUniqueId();\n        function createInput() {\n            var input = document.createElement(\"input\");\n            input.setAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME, buttonId);\n            input.setAttribute(\"title\", options.title);\n            self.setMultiple(options.multiple, input);\n            if (options.folders && qq.supportedFeatures.folderSelection) {\n                input.setAttribute(\"webkitdirectory\", \"\");\n            }\n            if (options.acceptFiles) {\n                input.setAttribute(\"accept\", options.acceptFiles);\n            }\n            input.setAttribute(\"type\", \"file\");\n            input.setAttribute(\"name\", options.name);\n            qq(input).css({\n                position: \"absolute\",\n                right: 0,\n                top: 0,\n                fontFamily: \"Arial\",\n                fontSize: qq.ie() && !qq.ie8() ? \"3500px\" : \"118px\",\n                margin: 0,\n                padding: 0,\n                cursor: \"pointer\",\n                opacity: 0\n            });\n            !qq.ie7() && qq(input).css({\n                height: \"100%\"\n            });\n            options.element.appendChild(input);\n            disposeSupport.attach(input, \"change\", function() {\n                options.onChange(input);\n            });\n            disposeSupport.attach(input, \"mouseover\", function() {\n                qq(options.element).addClass(options.hoverClass);\n            });\n            disposeSupport.attach(input, \"mouseout\", function() {\n                qq(options.element).removeClass(options.hoverClass);\n            });\n            disposeSupport.attach(input, \"focus\", function() {\n                qq(options.element).addClass(options.focusClass);\n            });\n            disposeSupport.attach(input, \"blur\", function() {\n                qq(options.element).removeClass(options.focusClass);\n            });\n            return input;\n        }\n        qq(options.element).css({\n            position: \"relative\",\n            overflow: \"hidden\",\n            direction: \"ltr\"\n        });\n        qq.extend(this, {\n            getInput: function() {\n                return input;\n            },\n            getButtonId: function() {\n                return buttonId;\n            },\n            setMultiple: function(isMultiple, optInput) {\n                var input = optInput || this.getInput();\n                if (options.ios8BrowserCrashWorkaround && qq.ios8() && (qq.iosChrome() || qq.iosSafariWebView())) {\n                    input.setAttribute(\"multiple\", \"\");\n                } else {\n                    if (isMultiple) {\n                        input.setAttribute(\"multiple\", \"\");\n                    } else {\n                        input.removeAttribute(\"multiple\");\n                    }\n                }\n            },\n            setAcceptFiles: function(acceptFiles) {\n                if (acceptFiles !== options.acceptFiles) {\n                    input.setAttribute(\"accept\", acceptFiles);\n                }\n            },\n            reset: function() {\n                if (input.parentNode) {\n                    qq(input).remove();\n                }\n                qq(options.element).removeClass(options.focusClass);\n                input = null;\n                input = createInput();\n            }\n        });\n        input = createInput();\n    };\n    qq.UploadButton.BUTTON_ID_ATTR_NAME = \"qq-button-id\";\n    qq.UploadData = function(uploaderProxy) {\n        \"use strict\";\n        var data = [], byUuid = {}, byStatus = {}, byProxyGroupId = {}, byBatchId = {};\n        function getDataByIds(idOrIds) {\n            if (qq.isArray(idOrIds)) {\n                var entries = [];\n                qq.each(idOrIds, function(idx, id) {\n                    entries.push(data[id]);\n                });\n                return entries;\n            }\n            return data[idOrIds];\n        }\n        function getDataByUuids(uuids) {\n            if (qq.isArray(uuids)) {\n                var entries = [];\n                qq.each(uuids, function(idx, uuid) {\n                    entries.push(data[byUuid[uuid]]);\n                });\n                return entries;\n            }\n            return data[byUuid[uuids]];\n        }\n        function getDataByStatus(status) {\n            var statusResults = [], statuses = [].concat(status);\n            qq.each(statuses, function(index, statusEnum) {\n                var statusResultIndexes = byStatus[statusEnum];\n                if (statusResultIndexes !== undefined) {\n                    qq.each(statusResultIndexes, function(i, dataIndex) {\n                        statusResults.push(data[dataIndex]);\n                    });\n                }\n            });\n            return statusResults;\n        }\n        qq.extend(this, {\n            addFile: function(spec) {\n                var status = spec.status || qq.status.SUBMITTING, id = data.push({\n                    name: spec.name,\n                    originalName: spec.name,\n                    uuid: spec.uuid,\n                    size: spec.size == null ? -1 : spec.size,\n                    status: status,\n                    file: spec.file\n                }) - 1;\n                if (spec.batchId) {\n                    data[id].batchId = spec.batchId;\n                    if (byBatchId[spec.batchId] === undefined) {\n                        byBatchId[spec.batchId] = [];\n                    }\n                    byBatchId[spec.batchId].push(id);\n                }\n                if (spec.proxyGroupId) {\n                    data[id].proxyGroupId = spec.proxyGroupId;\n                    if (byProxyGroupId[spec.proxyGroupId] === undefined) {\n                        byProxyGroupId[spec.proxyGroupId] = [];\n                    }\n                    byProxyGroupId[spec.proxyGroupId].push(id);\n                }\n                data[id].id = id;\n                byUuid[spec.uuid] = id;\n                if (byStatus[status] === undefined) {\n                    byStatus[status] = [];\n                }\n                byStatus[status].push(id);\n                spec.onBeforeStatusChange && spec.onBeforeStatusChange(id);\n                uploaderProxy.onStatusChange(id, null, status);\n                return id;\n            },\n            retrieve: function(optionalFilter) {\n                if (qq.isObject(optionalFilter) && data.length) {\n                    if (optionalFilter.id !== undefined) {\n                        return getDataByIds(optionalFilter.id);\n                    } else if (optionalFilter.uuid !== undefined) {\n                        return getDataByUuids(optionalFilter.uuid);\n                    } else if (optionalFilter.status) {\n                        return getDataByStatus(optionalFilter.status);\n                    }\n                } else {\n                    return qq.extend([], data, true);\n                }\n            },\n            removeFileRef: function(id) {\n                var record = getDataByIds(id);\n                if (record) {\n                    delete record.file;\n                }\n            },\n            reset: function() {\n                data = [];\n                byUuid = {};\n                byStatus = {};\n                byBatchId = {};\n            },\n            setStatus: function(id, newStatus) {\n                var oldStatus = data[id].status, byStatusOldStatusIndex = qq.indexOf(byStatus[oldStatus], id);\n                byStatus[oldStatus].splice(byStatusOldStatusIndex, 1);\n                data[id].status = newStatus;\n                if (byStatus[newStatus] === undefined) {\n                    byStatus[newStatus] = [];\n                }\n                byStatus[newStatus].push(id);\n                uploaderProxy.onStatusChange(id, oldStatus, newStatus);\n            },\n            uuidChanged: function(id, newUuid) {\n                var oldUuid = data[id].uuid;\n                data[id].uuid = newUuid;\n                byUuid[newUuid] = id;\n                delete byUuid[oldUuid];\n            },\n            updateName: function(id, newName) {\n                data[id].name = newName;\n            },\n            updateSize: function(id, newSize) {\n                data[id].size = newSize;\n            },\n            setParentId: function(targetId, parentId) {\n                data[targetId].parentId = parentId;\n            },\n            getIdsInProxyGroup: function(id) {\n                var proxyGroupId = data[id].proxyGroupId;\n                if (proxyGroupId) {\n                    return byProxyGroupId[proxyGroupId];\n                }\n                return [];\n            },\n            getIdsInBatch: function(id) {\n                var batchId = data[id].batchId;\n                return byBatchId[batchId];\n            }\n        });\n    };\n    qq.status = {\n        SUBMITTING: \"submitting\",\n        SUBMITTED: \"submitted\",\n        REJECTED: \"rejected\",\n        QUEUED: \"queued\",\n        CANCELED: \"canceled\",\n        PAUSED: \"paused\",\n        UPLOADING: \"uploading\",\n        UPLOAD_FINALIZING: \"upload finalizing\",\n        UPLOAD_RETRYING: \"retrying upload\",\n        UPLOAD_SUCCESSFUL: \"upload successful\",\n        UPLOAD_FAILED: \"upload failed\",\n        DELETE_FAILED: \"delete failed\",\n        DELETING: \"deleting\",\n        DELETED: \"deleted\"\n    };\n    (function() {\n        \"use strict\";\n        qq.basePublicApi = {\n            addBlobs: function(blobDataOrArray, params, endpoint) {\n                this.addFiles(blobDataOrArray, params, endpoint);\n            },\n            addInitialFiles: function(cannedFileList) {\n                var self = this;\n                qq.each(cannedFileList, function(index, cannedFile) {\n                    self._addCannedFile(cannedFile);\n                });\n            },\n            addFiles: function(data, params, endpoint) {\n                this._maybeHandleIos8SafariWorkaround();\n                var batchId = this._storedIds.length === 0 ? qq.getUniqueId() : this._currentBatchId, processBlob = qq.bind(function(blob) {\n                    this._handleNewFile({\n                        blob: blob,\n                        name: this._options.blobs.defaultName\n                    }, batchId, verifiedFiles);\n                }, this), processBlobData = qq.bind(function(blobData) {\n                    this._handleNewFile(blobData, batchId, verifiedFiles);\n                }, this), processCanvas = qq.bind(function(canvas) {\n                    var blob = qq.canvasToBlob(canvas);\n                    this._handleNewFile({\n                        blob: blob,\n                        name: this._options.blobs.defaultName + \".png\"\n                    }, batchId, verifiedFiles);\n                }, this), processCanvasData = qq.bind(function(canvasData) {\n                    var normalizedQuality = canvasData.quality && canvasData.quality / 100, blob = qq.canvasToBlob(canvasData.canvas, canvasData.type, normalizedQuality);\n                    this._handleNewFile({\n                        blob: blob,\n                        name: canvasData.name\n                    }, batchId, verifiedFiles);\n                }, this), processFileOrInput = qq.bind(function(fileOrInput) {\n                    if (qq.isInput(fileOrInput) && qq.supportedFeatures.ajaxUploading) {\n                        var files = Array.prototype.slice.call(fileOrInput.files), self = this;\n                        qq.each(files, function(idx, file) {\n                            self._handleNewFile(file, batchId, verifiedFiles);\n                        });\n                    } else {\n                        this._handleNewFile(fileOrInput, batchId, verifiedFiles);\n                    }\n                }, this), normalizeData = function() {\n                    if (qq.isFileList(data)) {\n                        data = Array.prototype.slice.call(data);\n                    }\n                    data = [].concat(data);\n                }, self = this, verifiedFiles = [];\n                this._currentBatchId = batchId;\n                if (data) {\n                    normalizeData();\n                    qq.each(data, function(idx, fileContainer) {\n                        if (qq.isFileOrInput(fileContainer)) {\n                            processFileOrInput(fileContainer);\n                        } else if (qq.isBlob(fileContainer)) {\n                            processBlob(fileContainer);\n                        } else if (qq.isObject(fileContainer)) {\n                            if (fileContainer.blob && fileContainer.name) {\n                                processBlobData(fileContainer);\n                            } else if (fileContainer.canvas && fileContainer.name) {\n                                processCanvasData(fileContainer);\n                            }\n                        } else if (fileContainer.tagName && fileContainer.tagName.toLowerCase() === \"canvas\") {\n                            processCanvas(fileContainer);\n                        } else {\n                            self.log(fileContainer + \" is not a valid file container!  Ignoring!\", \"warn\");\n                        }\n                    });\n                    this.log(\"Received \" + verifiedFiles.length + \" files.\");\n                    this._prepareItemsForUpload(verifiedFiles, params, endpoint);\n                }\n            },\n            cancel: function(id) {\n                var uploadData = this._uploadData.retrieve({\n                    id: id\n                });\n                if (uploadData && uploadData.status === qq.status.UPLOAD_FINALIZING) {\n                    this.log(qq.format(\"Ignoring cancel for file ID {} ({}).  Finalizing upload.\", id, this.getName(id)), \"error\");\n                } else {\n                    this._handler.cancel(id);\n                }\n            },\n            cancelAll: function() {\n                var storedIdsCopy = [], self = this;\n                qq.extend(storedIdsCopy, this._storedIds);\n                qq.each(storedIdsCopy, function(idx, storedFileId) {\n                    self.cancel(storedFileId);\n                });\n                this._handler.cancelAll();\n            },\n            clearStoredFiles: function() {\n                this._storedIds = [];\n            },\n            continueUpload: function(id) {\n                var uploadData = this._uploadData.retrieve({\n                    id: id\n                });\n                if (!qq.supportedFeatures.pause || !this._options.chunking.enabled) {\n                    return false;\n                }\n                if (uploadData.status === qq.status.PAUSED) {\n                    this.log(qq.format(\"Paused file ID {} ({}) will be continued.  Not paused.\", id, this.getName(id)));\n                    this._uploadFile(id);\n                    return true;\n                } else {\n                    this.log(qq.format(\"Ignoring continue for file ID {} ({}).  Not paused.\", id, this.getName(id)), \"error\");\n                }\n                return false;\n            },\n            deleteFile: function(id) {\n                return this._onSubmitDelete(id);\n            },\n            doesExist: function(fileOrBlobId) {\n                return this._handler.isValid(fileOrBlobId);\n            },\n            drawThumbnail: function(fileId, imgOrCanvas, maxSize, fromServer, customResizeFunction) {\n                var promiseToReturn = new qq.Promise(), fileOrUrl, options;\n                if (this._imageGenerator) {\n                    fileOrUrl = this._thumbnailUrls[fileId];\n                    options = {\n                        customResizeFunction: customResizeFunction,\n                        maxSize: maxSize > 0 ? maxSize : null,\n                        scale: maxSize > 0\n                    };\n                    if (!fromServer && qq.supportedFeatures.imagePreviews) {\n                        fileOrUrl = this.getFile(fileId);\n                    }\n                    if (fileOrUrl == null) {\n                        promiseToReturn.failure({\n                            container: imgOrCanvas,\n                            error: \"File or URL not found.\"\n                        });\n                    } else {\n                        this._imageGenerator.generate(fileOrUrl, imgOrCanvas, options).then(function success(modifiedContainer) {\n                            promiseToReturn.success(modifiedContainer);\n                        }, function failure(container, reason) {\n                            promiseToReturn.failure({\n                                container: container,\n                                error: reason || \"Problem generating thumbnail\"\n                            });\n                        });\n                    }\n                } else {\n                    promiseToReturn.failure({\n                        container: imgOrCanvas,\n                        error: \"Missing image generator module\"\n                    });\n                }\n                return promiseToReturn;\n            },\n            getButton: function(fileId) {\n                return this._getButton(this._buttonIdsForFileIds[fileId]);\n            },\n            getEndpoint: function(fileId) {\n                return this._endpointStore.get(fileId);\n            },\n            getFile: function(fileOrBlobId) {\n                var file = this._handler.getFile(fileOrBlobId);\n                var uploadDataRecord;\n                if (!file) {\n                    uploadDataRecord = this._uploadData.retrieve({\n                        id: fileOrBlobId\n                    });\n                    if (uploadDataRecord) {\n                        file = uploadDataRecord.file;\n                    }\n                }\n                return file || null;\n            },\n            getInProgress: function() {\n                return this._uploadData.retrieve({\n                    status: [ qq.status.UPLOADING, qq.status.UPLOAD_RETRYING, qq.status.QUEUED ]\n                }).length;\n            },\n            getName: function(id) {\n                return this._uploadData.retrieve({\n                    id: id\n                }).name;\n            },\n            getParentId: function(id) {\n                var uploadDataEntry = this.getUploads({\n                    id: id\n                }), parentId = null;\n                if (uploadDataEntry) {\n                    if (uploadDataEntry.parentId !== undefined) {\n                        parentId = uploadDataEntry.parentId;\n                    }\n                }\n                return parentId;\n            },\n            getResumableFilesData: function() {\n                return this._handler.getResumableFilesData();\n            },\n            getSize: function(id) {\n                return this._uploadData.retrieve({\n                    id: id\n                }).size;\n            },\n            getNetUploads: function() {\n                return this._netUploaded;\n            },\n            getRemainingAllowedItems: function() {\n                var allowedItems = this._currentItemLimit;\n                if (allowedItems > 0) {\n                    return allowedItems - this._netUploadedOrQueued;\n                }\n                return null;\n            },\n            getUploads: function(optionalFilter) {\n                return this._uploadData.retrieve(optionalFilter);\n            },\n            getUuid: function(id) {\n                return this._uploadData.retrieve({\n                    id: id\n                }).uuid;\n            },\n            isResumable: function(id) {\n                return this._handler.hasResumeRecord(id);\n            },\n            log: function(str, level) {\n                if (this._options.debug && (!level || level === \"info\")) {\n                    qq.log(\"[Fine Uploader \" + qq.version + \"] \" + str);\n                } else if (level && level !== \"info\") {\n                    qq.log(\"[Fine Uploader \" + qq.version + \"] \" + str, level);\n                }\n            },\n            pauseUpload: function(id) {\n                var uploadData = this._uploadData.retrieve({\n                    id: id\n                });\n                if (!qq.supportedFeatures.pause || !this._options.chunking.enabled) {\n                    return false;\n                }\n                if (qq.indexOf([ qq.status.UPLOADING, qq.status.UPLOAD_RETRYING ], uploadData.status) >= 0) {\n                    if (this._handler.pause(id)) {\n                        this._uploadData.setStatus(id, qq.status.PAUSED);\n                        return true;\n                    } else {\n                        this.log(qq.format(\"Unable to pause file ID {} ({}).\", id, this.getName(id)), \"error\");\n                    }\n                } else {\n                    this.log(qq.format(\"Ignoring pause for file ID {} ({}).  Not in progress.\", id, this.getName(id)), \"error\");\n                }\n                return false;\n            },\n            removeFileRef: function(id) {\n                this._handler.expunge(id);\n                this._uploadData.removeFileRef(id);\n            },\n            reset: function() {\n                this.log(\"Resetting uploader...\");\n                this._handler.reset();\n                this._storedIds = [];\n                this._autoRetries = [];\n                this._retryTimeouts = [];\n                this._preventRetries = [];\n                this._thumbnailUrls = [];\n                qq.each(this._buttons, function(idx, button) {\n                    button.reset();\n                });\n                this._paramsStore.reset();\n                this._endpointStore.reset();\n                this._netUploadedOrQueued = 0;\n                this._netUploaded = 0;\n                this._uploadData.reset();\n                this._buttonIdsForFileIds = [];\n                this._pasteHandler && this._pasteHandler.reset();\n                this._options.session.refreshOnReset && this._refreshSessionData();\n                this._succeededSinceLastAllComplete = [];\n                this._failedSinceLastAllComplete = [];\n                this._totalProgress && this._totalProgress.reset();\n                this._customResumeDataStore.reset();\n            },\n            retry: function(id) {\n                return this._manualRetry(id);\n            },\n            scaleImage: function(id, specs) {\n                var self = this;\n                return qq.Scaler.prototype.scaleImage(id, specs, {\n                    log: qq.bind(self.log, self),\n                    getFile: qq.bind(self.getFile, self),\n                    uploadData: self._uploadData\n                });\n            },\n            setCustomHeaders: function(headers, id) {\n                this._customHeadersStore.set(headers, id);\n            },\n            setCustomResumeData: function(id, data) {\n                this._customResumeDataStore.set(data, id);\n            },\n            setDeleteFileCustomHeaders: function(headers, id) {\n                this._deleteFileCustomHeadersStore.set(headers, id);\n            },\n            setDeleteFileEndpoint: function(endpoint, id) {\n                this._deleteFileEndpointStore.set(endpoint, id);\n            },\n            setDeleteFileParams: function(params, id) {\n                this._deleteFileParamsStore.set(params, id);\n            },\n            setEndpoint: function(endpoint, id) {\n                this._endpointStore.set(endpoint, id);\n            },\n            setForm: function(elementOrId) {\n                this._updateFormSupportAndParams(elementOrId);\n            },\n            setItemLimit: function(newItemLimit) {\n                this._currentItemLimit = newItemLimit;\n            },\n            setName: function(id, newName) {\n                this._uploadData.updateName(id, newName);\n            },\n            setParams: function(params, id) {\n                this._paramsStore.set(params, id);\n            },\n            setUuid: function(id, newUuid) {\n                return this._uploadData.uuidChanged(id, newUuid);\n            },\n            setStatus: function(id, newStatus) {\n                var fileRecord = this.getUploads({\n                    id: id\n                });\n                if (!fileRecord) {\n                    throw new qq.Error(id + \" is not a valid file ID.\");\n                }\n                switch (newStatus) {\n                  case qq.status.DELETED:\n                    this._onDeleteComplete(id, null, false);\n                    break;\n\n                  case qq.status.DELETE_FAILED:\n                    this._onDeleteComplete(id, null, true);\n                    break;\n\n                  default:\n                    var errorMessage = \"Method setStatus called on '\" + name + \"' not implemented yet for \" + newStatus;\n                    this.log(errorMessage);\n                    throw new qq.Error(errorMessage);\n                }\n            },\n            uploadStoredFiles: function() {\n                if (this._storedIds.length === 0) {\n                    this._itemError(\"noFilesError\");\n                } else {\n                    this._uploadStoredFiles();\n                }\n            }\n        };\n        qq.basePrivateApi = {\n            _addCannedFile: function(sessionData) {\n                var self = this;\n                return this._uploadData.addFile({\n                    uuid: sessionData.uuid,\n                    name: sessionData.name,\n                    size: sessionData.size,\n                    status: qq.status.UPLOAD_SUCCESSFUL,\n                    onBeforeStatusChange: function(id) {\n                        sessionData.deleteFileEndpoint && self.setDeleteFileEndpoint(sessionData.deleteFileEndpoint, id);\n                        sessionData.deleteFileParams && self.setDeleteFileParams(sessionData.deleteFileParams, id);\n                        if (sessionData.thumbnailUrl) {\n                            self._thumbnailUrls[id] = sessionData.thumbnailUrl;\n                        }\n                        self._netUploaded++;\n                        self._netUploadedOrQueued++;\n                    }\n                });\n            },\n            _annotateWithButtonId: function(file, associatedInput) {\n                if (qq.isFile(file)) {\n                    file.qqButtonId = this._getButtonId(associatedInput);\n                }\n            },\n            _batchError: function(message) {\n                this._options.callbacks.onError(null, null, message, undefined);\n            },\n            _createDeleteHandler: function() {\n                var self = this;\n                return new qq.DeleteFileAjaxRequester({\n                    method: this._options.deleteFile.method.toUpperCase(),\n                    maxConnections: this._options.maxConnections,\n                    uuidParamName: this._options.request.uuidName,\n                    customHeaders: this._deleteFileCustomHeadersStore,\n                    paramsStore: this._deleteFileParamsStore,\n                    endpointStore: this._deleteFileEndpointStore,\n                    cors: this._options.cors,\n                    log: qq.bind(self.log, self),\n                    onDelete: function(id) {\n                        self._onDelete(id);\n                        self._options.callbacks.onDelete(id);\n                    },\n                    onDeleteComplete: function(id, xhrOrXdr, isError) {\n                        self._onDeleteComplete(id, xhrOrXdr, isError);\n                        self._options.callbacks.onDeleteComplete(id, xhrOrXdr, isError);\n                    }\n                });\n            },\n            _createPasteHandler: function() {\n                var self = this;\n                return new qq.PasteSupport({\n                    targetElement: this._options.paste.targetElement,\n                    callbacks: {\n                        log: qq.bind(self.log, self),\n                        pasteReceived: function(blob) {\n                            self._handleCheckedCallback({\n                                name: \"onPasteReceived\",\n                                callback: qq.bind(self._options.callbacks.onPasteReceived, self, blob),\n                                onSuccess: qq.bind(self._handlePasteSuccess, self, blob),\n                                identifier: \"pasted image\"\n                            });\n                        }\n                    }\n                });\n            },\n            _createStore: function(initialValue, _readOnlyValues_) {\n                var store = {}, catchall = initialValue, perIdReadOnlyValues = {}, readOnlyValues = _readOnlyValues_, copy = function(orig) {\n                    if (qq.isObject(orig)) {\n                        return qq.extend({}, orig);\n                    }\n                    return orig;\n                }, getReadOnlyValues = function() {\n                    if (qq.isFunction(readOnlyValues)) {\n                        return readOnlyValues();\n                    }\n                    return readOnlyValues;\n                }, includeReadOnlyValues = function(id, existing) {\n                    if (readOnlyValues && qq.isObject(existing)) {\n                        qq.extend(existing, getReadOnlyValues());\n                    }\n                    if (perIdReadOnlyValues[id]) {\n                        qq.extend(existing, perIdReadOnlyValues[id]);\n                    }\n                };\n                return {\n                    set: function(val, id) {\n                        if (id == null) {\n                            store = {};\n                            catchall = copy(val);\n                        } else {\n                            store[id] = copy(val);\n                        }\n                    },\n                    get: function(id) {\n                        var values;\n                        if (id != null && store[id]) {\n                            values = store[id];\n                        } else {\n                            values = copy(catchall);\n                        }\n                        includeReadOnlyValues(id, values);\n                        return copy(values);\n                    },\n                    addReadOnly: function(id, values) {\n                        if (qq.isObject(store)) {\n                            if (id === null) {\n                                if (qq.isFunction(values)) {\n                                    readOnlyValues = values;\n                                } else {\n                                    readOnlyValues = readOnlyValues || {};\n                                    qq.extend(readOnlyValues, values);\n                                }\n                            } else {\n                                perIdReadOnlyValues[id] = perIdReadOnlyValues[id] || {};\n                                qq.extend(perIdReadOnlyValues[id], values);\n                            }\n                        }\n                    },\n                    remove: function(fileId) {\n                        return delete store[fileId];\n                    },\n                    reset: function() {\n                        store = {};\n                        perIdReadOnlyValues = {};\n                        catchall = initialValue;\n                    }\n                };\n            },\n            _createUploadDataTracker: function() {\n                var self = this;\n                return new qq.UploadData({\n                    getName: function(id) {\n                        return self.getName(id);\n                    },\n                    getUuid: function(id) {\n                        return self.getUuid(id);\n                    },\n                    getSize: function(id) {\n                        return self.getSize(id);\n                    },\n                    onStatusChange: function(id, oldStatus, newStatus) {\n                        self._onUploadStatusChange(id, oldStatus, newStatus);\n                        self._options.callbacks.onStatusChange(id, oldStatus, newStatus);\n                        self._maybeAllComplete(id, newStatus);\n                        if (self._totalProgress) {\n                            setTimeout(function() {\n                                self._totalProgress.onStatusChange(id, oldStatus, newStatus);\n                            }, 0);\n                        }\n                    }\n                });\n            },\n            _createUploadButton: function(spec) {\n                var self = this, acceptFiles = spec.accept || this._options.validation.acceptFiles, allowedExtensions = spec.allowedExtensions || this._options.validation.allowedExtensions, button;\n                function allowMultiple() {\n                    if (qq.supportedFeatures.ajaxUploading) {\n                        if (self._options.workarounds.iosEmptyVideos && qq.ios() && !qq.ios6() && self._isAllowedExtension(allowedExtensions, \".mov\")) {\n                            return false;\n                        }\n                        if (spec.multiple === undefined) {\n                            return self._options.multiple;\n                        }\n                        return spec.multiple;\n                    }\n                    return false;\n                }\n                button = new qq.UploadButton({\n                    acceptFiles: acceptFiles,\n                    element: spec.element,\n                    focusClass: this._options.classes.buttonFocus,\n                    folders: spec.folders,\n                    hoverClass: this._options.classes.buttonHover,\n                    ios8BrowserCrashWorkaround: this._options.workarounds.ios8BrowserCrash,\n                    multiple: allowMultiple(),\n                    name: this._options.request.inputName,\n                    onChange: function(input) {\n                        self._onInputChange(input);\n                    },\n                    title: spec.title == null ? this._options.text.fileInputTitle : spec.title\n                });\n                this._disposeSupport.addDisposer(function() {\n                    button.dispose();\n                });\n                self._buttons.push(button);\n                return button;\n            },\n            _createUploadHandler: function(additionalOptions, namespace) {\n                var self = this, lastOnProgress = {}, options = {\n                    debug: this._options.debug,\n                    maxConnections: this._options.maxConnections,\n                    cors: this._options.cors,\n                    paramsStore: this._paramsStore,\n                    endpointStore: this._endpointStore,\n                    chunking: this._options.chunking,\n                    resume: this._options.resume,\n                    blobs: this._options.blobs,\n                    log: qq.bind(self.log, self),\n                    preventRetryParam: this._options.retry.preventRetryResponseProperty,\n                    onProgress: function(id, name, loaded, total) {\n                        if (loaded < 0 || total < 0) {\n                            return;\n                        }\n                        if (lastOnProgress[id]) {\n                            if (lastOnProgress[id].loaded !== loaded || lastOnProgress[id].total !== total) {\n                                self._onProgress(id, name, loaded, total);\n                                self._options.callbacks.onProgress(id, name, loaded, total);\n                            }\n                        } else {\n                            self._onProgress(id, name, loaded, total);\n                            self._options.callbacks.onProgress(id, name, loaded, total);\n                        }\n                        lastOnProgress[id] = {\n                            loaded: loaded,\n                            total: total\n                        };\n                    },\n                    onComplete: function(id, name, result, xhr) {\n                        delete lastOnProgress[id];\n                        var status = self.getUploads({\n                            id: id\n                        }).status, retVal;\n                        if (status === qq.status.UPLOAD_SUCCESSFUL || status === qq.status.UPLOAD_FAILED) {\n                            return;\n                        }\n                        retVal = self._onComplete(id, name, result, xhr);\n                        if (retVal instanceof qq.Promise) {\n                            retVal.done(function() {\n                                self._options.callbacks.onComplete(id, name, result, xhr);\n                            });\n                        } else {\n                            self._options.callbacks.onComplete(id, name, result, xhr);\n                        }\n                    },\n                    onCancel: function(id, name, cancelFinalizationEffort) {\n                        var promise = new qq.Promise();\n                        self._handleCheckedCallback({\n                            name: \"onCancel\",\n                            callback: qq.bind(self._options.callbacks.onCancel, self, id, name),\n                            onFailure: promise.failure,\n                            onSuccess: function() {\n                                cancelFinalizationEffort.then(function() {\n                                    self._onCancel(id, name);\n                                });\n                                promise.success();\n                            },\n                            identifier: id\n                        });\n                        return promise;\n                    },\n                    onUploadPrep: qq.bind(this._onUploadPrep, this),\n                    onUpload: function(id, name) {\n                        self._onUpload(id, name);\n                        var onUploadResult = self._options.callbacks.onUpload(id, name);\n                        if (qq.isGenericPromise(onUploadResult)) {\n                            self.log(qq.format(\"onUpload for {} returned a Promise - waiting for resolution.\", id));\n                            return onUploadResult;\n                        }\n                        return new qq.Promise().success();\n                    },\n                    onUploadChunk: function(id, name, chunkData) {\n                        self._onUploadChunk(id, chunkData);\n                        var onUploadChunkResult = self._options.callbacks.onUploadChunk(id, name, chunkData);\n                        if (qq.isGenericPromise(onUploadChunkResult)) {\n                            self.log(qq.format(\"onUploadChunk for {}.{} returned a Promise - waiting for resolution.\", id, chunkData.partIndex));\n                            return onUploadChunkResult;\n                        }\n                        return new qq.Promise().success();\n                    },\n                    onUploadChunkSuccess: function(id, chunkData, result, xhr) {\n                        self._onUploadChunkSuccess(id, chunkData);\n                        self._options.callbacks.onUploadChunkSuccess.apply(self, arguments);\n                    },\n                    onResume: function(id, name, chunkData, customResumeData) {\n                        return self._options.callbacks.onResume(id, name, chunkData, customResumeData);\n                    },\n                    onAutoRetry: function(id, name, responseJSON, xhr) {\n                        return self._onAutoRetry.apply(self, arguments);\n                    },\n                    onUuidChanged: function(id, newUuid) {\n                        self.log(\"Server requested UUID change from '\" + self.getUuid(id) + \"' to '\" + newUuid + \"'\");\n                        self.setUuid(id, newUuid);\n                    },\n                    getName: qq.bind(self.getName, self),\n                    getUuid: qq.bind(self.getUuid, self),\n                    getSize: qq.bind(self.getSize, self),\n                    setSize: qq.bind(self._setSize, self),\n                    getDataByUuid: function(uuid) {\n                        return self.getUploads({\n                            uuid: uuid\n                        });\n                    },\n                    isQueued: function(id) {\n                        var status = self.getUploads({\n                            id: id\n                        }).status;\n                        return status === qq.status.QUEUED || status === qq.status.SUBMITTED || status === qq.status.UPLOAD_RETRYING || status === qq.status.PAUSED;\n                    },\n                    getIdsInProxyGroup: self._uploadData.getIdsInProxyGroup,\n                    getIdsInBatch: self._uploadData.getIdsInBatch,\n                    isInProgress: function(id) {\n                        return self.getUploads({\n                            id: id\n                        }).status === qq.status.UPLOADING;\n                    },\n                    getCustomResumeData: qq.bind(self._getCustomResumeData, self),\n                    setStatus: function(id, status) {\n                        self._uploadData.setStatus(id, status);\n                    }\n                };\n                qq.each(this._options.request, function(prop, val) {\n                    options[prop] = val;\n                });\n                options.customHeaders = this._customHeadersStore;\n                if (additionalOptions) {\n                    qq.each(additionalOptions, function(key, val) {\n                        options[key] = val;\n                    });\n                }\n                return new qq.UploadHandlerController(options, namespace);\n            },\n            _fileOrBlobRejected: function(id) {\n                this._netUploadedOrQueued--;\n                this._uploadData.setStatus(id, qq.status.REJECTED);\n            },\n            _formatSize: function(bytes) {\n                if (bytes === 0) {\n                    return bytes + this._options.text.sizeSymbols[0];\n                }\n                var i = -1;\n                do {\n                    bytes = bytes / 1e3;\n                    i++;\n                } while (bytes > 999);\n                return Math.max(bytes, .1).toFixed(1) + this._options.text.sizeSymbols[i];\n            },\n            _generateExtraButtonSpecs: function() {\n                var self = this;\n                this._extraButtonSpecs = {};\n                qq.each(this._options.extraButtons, function(idx, extraButtonOptionEntry) {\n                    var multiple = extraButtonOptionEntry.multiple, validation = qq.extend({}, self._options.validation, true), extraButtonSpec = qq.extend({}, extraButtonOptionEntry);\n                    if (multiple === undefined) {\n                        multiple = self._options.multiple;\n                    }\n                    if (extraButtonSpec.validation) {\n                        qq.extend(validation, extraButtonOptionEntry.validation, true);\n                    }\n                    qq.extend(extraButtonSpec, {\n                        multiple: multiple,\n                        validation: validation\n                    }, true);\n                    self._initExtraButton(extraButtonSpec);\n                });\n            },\n            _getButton: function(buttonId) {\n                var extraButtonsSpec = this._extraButtonSpecs[buttonId];\n                if (extraButtonsSpec) {\n                    return extraButtonsSpec.element;\n                } else if (buttonId === this._defaultButtonId) {\n                    return this._options.button;\n                }\n            },\n            _getButtonId: function(buttonOrFileInputOrFile) {\n                var inputs, fileInput, fileBlobOrInput = buttonOrFileInputOrFile;\n                if (fileBlobOrInput instanceof qq.BlobProxy) {\n                    fileBlobOrInput = fileBlobOrInput.referenceBlob;\n                }\n                if (fileBlobOrInput && !qq.isBlob(fileBlobOrInput)) {\n                    if (qq.isFile(fileBlobOrInput)) {\n                        return fileBlobOrInput.qqButtonId;\n                    } else if (fileBlobOrInput.tagName.toLowerCase() === \"input\" && fileBlobOrInput.type.toLowerCase() === \"file\") {\n                        return fileBlobOrInput.getAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME);\n                    }\n                    inputs = fileBlobOrInput.getElementsByTagName(\"input\");\n                    qq.each(inputs, function(idx, input) {\n                        if (input.getAttribute(\"type\") === \"file\") {\n                            fileInput = input;\n                            return false;\n                        }\n                    });\n                    if (fileInput) {\n                        return fileInput.getAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME);\n                    }\n                }\n            },\n            _getCustomResumeData: function(fileId) {\n                return this._customResumeDataStore.get(fileId);\n            },\n            _getNotFinished: function() {\n                return this._uploadData.retrieve({\n                    status: [ qq.status.UPLOADING, qq.status.UPLOAD_RETRYING, qq.status.QUEUED, qq.status.SUBMITTING, qq.status.SUBMITTED, qq.status.PAUSED ]\n                }).length;\n            },\n            _getValidationBase: function(buttonId) {\n                var extraButtonSpec = this._extraButtonSpecs[buttonId];\n                return extraButtonSpec ? extraButtonSpec.validation : this._options.validation;\n            },\n            _getValidationDescriptor: function(fileWrapper) {\n                if (fileWrapper.file instanceof qq.BlobProxy) {\n                    return {\n                        name: qq.getFilename(fileWrapper.file.referenceBlob),\n                        size: fileWrapper.file.referenceBlob.size\n                    };\n                }\n                return {\n                    name: this.getUploads({\n                        id: fileWrapper.id\n                    }).name,\n                    size: this.getUploads({\n                        id: fileWrapper.id\n                    }).size\n                };\n            },\n            _getValidationDescriptors: function(fileWrappers) {\n                var self = this, fileDescriptors = [];\n                qq.each(fileWrappers, function(idx, fileWrapper) {\n                    fileDescriptors.push(self._getValidationDescriptor(fileWrapper));\n                });\n                return fileDescriptors;\n            },\n            _handleCameraAccess: function() {\n                if (this._options.camera.ios && qq.ios()) {\n                    var acceptIosCamera = \"image/*;capture=camera\", button = this._options.camera.button, buttonId = button ? this._getButtonId(button) : this._defaultButtonId, optionRoot = this._options;\n                    if (buttonId && buttonId !== this._defaultButtonId) {\n                        optionRoot = this._extraButtonSpecs[buttonId];\n                    }\n                    optionRoot.multiple = false;\n                    if (optionRoot.validation.acceptFiles === null) {\n                        optionRoot.validation.acceptFiles = acceptIosCamera;\n                    } else {\n                        optionRoot.validation.acceptFiles += \",\" + acceptIosCamera;\n                    }\n                    qq.each(this._buttons, function(idx, button) {\n                        if (button.getButtonId() === buttonId) {\n                            button.setMultiple(optionRoot.multiple);\n                            button.setAcceptFiles(optionRoot.acceptFiles);\n                            return false;\n                        }\n                    });\n                }\n            },\n            _handleCheckedCallback: function(details) {\n                var self = this, callbackRetVal = details.callback();\n                if (qq.isGenericPromise(callbackRetVal)) {\n                    this.log(details.name + \" - waiting for \" + details.name + \" promise to be fulfilled for \" + details.identifier);\n                    return callbackRetVal.then(function(successParam) {\n                        self.log(details.name + \" promise success for \" + details.identifier);\n                        details.onSuccess(successParam);\n                    }, function() {\n                        if (details.onFailure) {\n                            self.log(details.name + \" promise failure for \" + details.identifier);\n                            details.onFailure();\n                        } else {\n                            self.log(details.name + \" promise failure for \" + details.identifier);\n                        }\n                    });\n                }\n                if (callbackRetVal !== false) {\n                    details.onSuccess(callbackRetVal);\n                } else {\n                    if (details.onFailure) {\n                        this.log(details.name + \" - return value was 'false' for \" + details.identifier + \".  Invoking failure callback.\");\n                        details.onFailure();\n                    } else {\n                        this.log(details.name + \" - return value was 'false' for \" + details.identifier + \".  Will not proceed.\");\n                    }\n                }\n                return callbackRetVal;\n            },\n            _handleNewFile: function(file, batchId, newFileWrapperList) {\n                var self = this, uuid = qq.getUniqueId(), size = -1, name = qq.getFilename(file), actualFile = file.blob || file, handler = this._customNewFileHandler ? this._customNewFileHandler : qq.bind(self._handleNewFileGeneric, self);\n                if (!qq.isInput(actualFile) && actualFile.size >= 0) {\n                    size = actualFile.size;\n                }\n                handler(actualFile, name, uuid, size, newFileWrapperList, batchId, this._options.request.uuidName, {\n                    uploadData: self._uploadData,\n                    paramsStore: self._paramsStore,\n                    addFileToHandler: function(id, file) {\n                        self._handler.add(id, file);\n                        self._netUploadedOrQueued++;\n                        self._trackButton(id);\n                    }\n                });\n            },\n            _handleNewFileGeneric: function(file, name, uuid, size, fileList, batchId) {\n                var id = this._uploadData.addFile({\n                    uuid: uuid,\n                    name: name,\n                    size: size,\n                    batchId: batchId,\n                    file: file\n                });\n                this._handler.add(id, file);\n                this._trackButton(id);\n                this._netUploadedOrQueued++;\n                fileList.push({\n                    id: id,\n                    file: file\n                });\n            },\n            _handlePasteSuccess: function(blob, extSuppliedName) {\n                var extension = blob.type.split(\"/\")[1], name = extSuppliedName;\n                if (name == null) {\n                    name = this._options.paste.defaultName;\n                }\n                name += \".\" + extension;\n                this.addFiles({\n                    name: name,\n                    blob: blob\n                });\n            },\n            _handleDeleteSuccess: function(id) {\n                if (this.getUploads({\n                    id: id\n                }).status !== qq.status.DELETED) {\n                    var name = this.getName(id);\n                    this._netUploadedOrQueued--;\n                    this._netUploaded--;\n                    this._handler.expunge(id);\n                    this._uploadData.setStatus(id, qq.status.DELETED);\n                    this.log(\"Delete request for '\" + name + \"' has succeeded.\");\n                }\n            },\n            _handleDeleteFailed: function(id, xhrOrXdr) {\n                var name = this.getName(id);\n                this._uploadData.setStatus(id, qq.status.DELETE_FAILED);\n                this.log(\"Delete request for '\" + name + \"' has failed.\", \"error\");\n                if (!xhrOrXdr || xhrOrXdr.withCredentials === undefined) {\n                    this._options.callbacks.onError(id, name, \"Delete request failed\", xhrOrXdr);\n                } else {\n                    this._options.callbacks.onError(id, name, \"Delete request failed with response code \" + xhrOrXdr.status, xhrOrXdr);\n                }\n            },\n            _initExtraButton: function(spec) {\n                var button = this._createUploadButton({\n                    accept: spec.validation.acceptFiles,\n                    allowedExtensions: spec.validation.allowedExtensions,\n                    element: spec.element,\n                    folders: spec.folders,\n                    multiple: spec.multiple,\n                    title: spec.fileInputTitle\n                });\n                this._extraButtonSpecs[button.getButtonId()] = spec;\n            },\n            _initFormSupportAndParams: function() {\n                this._formSupport = qq.FormSupport && new qq.FormSupport(this._options.form, qq.bind(this.uploadStoredFiles, this), qq.bind(this.log, this));\n                if (this._formSupport && this._formSupport.attachedToForm) {\n                    this._paramsStore = this._createStore(this._options.request.params, this._formSupport.getFormInputsAsObject);\n                    this._options.autoUpload = this._formSupport.newAutoUpload;\n                    if (this._formSupport.newEndpoint) {\n                        this._options.request.endpoint = this._formSupport.newEndpoint;\n                    }\n                } else {\n                    this._paramsStore = this._createStore(this._options.request.params);\n                }\n            },\n            _isDeletePossible: function() {\n                if (!qq.DeleteFileAjaxRequester || !this._options.deleteFile.enabled) {\n                    return false;\n                }\n                if (this._options.cors.expected) {\n                    if (qq.supportedFeatures.deleteFileCorsXhr) {\n                        return true;\n                    }\n                    if (qq.supportedFeatures.deleteFileCorsXdr && this._options.cors.allowXdr) {\n                        return true;\n                    }\n                    return false;\n                }\n                return true;\n            },\n            _isAllowedExtension: function(allowed, fileName) {\n                var valid = false;\n                if (!allowed.length) {\n                    return true;\n                }\n                qq.each(allowed, function(idx, allowedExt) {\n                    if (qq.isString(allowedExt)) {\n                        var extRegex = new RegExp(\"\\\\.\" + allowedExt + \"$\", \"i\");\n                        if (fileName.match(extRegex) != null) {\n                            valid = true;\n                            return false;\n                        }\n                    }\n                });\n                return valid;\n            },\n            _itemError: function(code, maybeNameOrNames, item) {\n                var message = this._options.messages[code], allowedExtensions = [], names = [].concat(maybeNameOrNames), name = names[0], buttonId = this._getButtonId(item), validationBase = this._getValidationBase(buttonId), extensionsForMessage, placeholderMatch;\n                function r(name, replacement) {\n                    message = message.replace(name, replacement);\n                }\n                qq.each(validationBase.allowedExtensions, function(idx, allowedExtension) {\n                    if (qq.isString(allowedExtension)) {\n                        allowedExtensions.push(allowedExtension);\n                    }\n                });\n                extensionsForMessage = allowedExtensions.join(\", \").toLowerCase();\n                r(\"{file}\", this._options.formatFileName(name));\n                r(\"{extensions}\", extensionsForMessage);\n                r(\"{sizeLimit}\", this._formatSize(validationBase.sizeLimit));\n                r(\"{minSizeLimit}\", this._formatSize(validationBase.minSizeLimit));\n                placeholderMatch = message.match(/(\\{\\w+\\})/g);\n                if (placeholderMatch !== null) {\n                    qq.each(placeholderMatch, function(idx, placeholder) {\n                        r(placeholder, names[idx]);\n                    });\n                }\n                this._options.callbacks.onError(null, name, message, undefined);\n                return message;\n            },\n            _manualRetry: function(id, callback) {\n                if (this._onBeforeManualRetry(id)) {\n                    this._netUploadedOrQueued++;\n                    this._uploadData.setStatus(id, qq.status.UPLOAD_RETRYING);\n                    if (callback) {\n                        callback(id);\n                    } else {\n                        this._handler.retry(id);\n                    }\n                    return true;\n                }\n            },\n            _maybeAllComplete: function(id, status) {\n                var self = this, notFinished = this._getNotFinished();\n                if (status === qq.status.UPLOAD_SUCCESSFUL) {\n                    this._succeededSinceLastAllComplete.push(id);\n                } else if (status === qq.status.UPLOAD_FAILED) {\n                    this._failedSinceLastAllComplete.push(id);\n                }\n                if (notFinished === 0 && (this._succeededSinceLastAllComplete.length || this._failedSinceLastAllComplete.length)) {\n                    setTimeout(function() {\n                        self._onAllComplete(self._succeededSinceLastAllComplete, self._failedSinceLastAllComplete);\n                    }, 0);\n                }\n            },\n            _maybeHandleIos8SafariWorkaround: function() {\n                var self = this;\n                if (this._options.workarounds.ios8SafariUploads && qq.ios800() && qq.iosSafari()) {\n                    setTimeout(function() {\n                        window.alert(self._options.messages.unsupportedBrowserIos8Safari);\n                    }, 0);\n                    throw new qq.Error(this._options.messages.unsupportedBrowserIos8Safari);\n                }\n            },\n            _maybeParseAndSendUploadError: function(id, name, response, xhr) {\n                if (!response.success) {\n                    if (xhr && xhr.status !== 200 && !response.error) {\n                        this._options.callbacks.onError(id, name, \"XHR returned response code \" + xhr.status, xhr);\n                    } else {\n                        var errorReason = response.error ? response.error : this._options.text.defaultResponseError;\n                        this._options.callbacks.onError(id, name, errorReason, xhr);\n                    }\n                }\n            },\n            _maybeProcessNextItemAfterOnValidateCallback: function(validItem, items, index, params, endpoint) {\n                var self = this;\n                if (items.length > index) {\n                    if (validItem || !this._options.validation.stopOnFirstInvalidFile) {\n                        setTimeout(function() {\n                            var validationDescriptor = self._getValidationDescriptor(items[index]), buttonId = self._getButtonId(items[index].file), button = self._getButton(buttonId);\n                            self._handleCheckedCallback({\n                                name: \"onValidate\",\n                                callback: qq.bind(self._options.callbacks.onValidate, self, validationDescriptor, button),\n                                onSuccess: qq.bind(self._onValidateCallbackSuccess, self, items, index, params, endpoint),\n                                onFailure: qq.bind(self._onValidateCallbackFailure, self, items, index, params, endpoint),\n                                identifier: \"Item '\" + validationDescriptor.name + \"', size: \" + validationDescriptor.size\n                            });\n                        }, 0);\n                    } else if (!validItem) {\n                        for (;index < items.length; index++) {\n                            self._fileOrBlobRejected(items[index].id);\n                        }\n                    }\n                }\n            },\n            _onAllComplete: function(successful, failed) {\n                this._totalProgress && this._totalProgress.onAllComplete(successful, failed, this._preventRetries);\n                this._options.callbacks.onAllComplete(qq.extend([], successful), qq.extend([], failed));\n                this._succeededSinceLastAllComplete = [];\n                this._failedSinceLastAllComplete = [];\n            },\n            _onAutoRetry: function(id, name, responseJSON, xhr, callback) {\n                var self = this;\n                self._preventRetries[id] = responseJSON[self._options.retry.preventRetryResponseProperty];\n                if (self._shouldAutoRetry(id)) {\n                    var retryWaitPeriod = self._options.retry.autoAttemptDelay * 1e3;\n                    self._maybeParseAndSendUploadError.apply(self, arguments);\n                    self._options.callbacks.onAutoRetry(id, name, self._autoRetries[id]);\n                    self._onBeforeAutoRetry(id, name);\n                    self._uploadData.setStatus(id, qq.status.UPLOAD_RETRYING);\n                    self._retryTimeouts[id] = setTimeout(function() {\n                        self.log(\"Starting retry for \" + name + \"...\");\n                        if (callback) {\n                            callback(id);\n                        } else {\n                            self._handler.retry(id);\n                        }\n                    }, retryWaitPeriod);\n                    return true;\n                }\n            },\n            _onBeforeAutoRetry: function(id, name) {\n                this.log(\"Waiting \" + this._options.retry.autoAttemptDelay + \" seconds before retrying \" + name + \"...\");\n            },\n            _onBeforeManualRetry: function(id) {\n                var itemLimit = this._currentItemLimit, fileName;\n                if (this._preventRetries[id]) {\n                    this.log(\"Retries are forbidden for id \" + id, \"warn\");\n                    return false;\n                } else if (this._handler.isValid(id)) {\n                    fileName = this.getName(id);\n                    if (this._options.callbacks.onManualRetry(id, fileName) === false) {\n                        return false;\n                    }\n                    if (itemLimit > 0 && this._netUploadedOrQueued + 1 > itemLimit) {\n                        this._itemError(\"retryFailTooManyItems\");\n                        return false;\n                    }\n                    this.log(\"Retrying upload for '\" + fileName + \"' (id: \" + id + \")...\");\n                    return true;\n                } else {\n                    this.log(\"'\" + id + \"' is not a valid file ID\", \"error\");\n                    return false;\n                }\n            },\n            _onCancel: function(id, name) {\n                this._netUploadedOrQueued--;\n                clearTimeout(this._retryTimeouts[id]);\n                var storedItemIndex = qq.indexOf(this._storedIds, id);\n                if (!this._options.autoUpload && storedItemIndex >= 0) {\n                    this._storedIds.splice(storedItemIndex, 1);\n                }\n                this._uploadData.setStatus(id, qq.status.CANCELED);\n            },\n            _onComplete: function(id, name, result, xhr) {\n                if (!result.success) {\n                    this._netUploadedOrQueued--;\n                    this._uploadData.setStatus(id, qq.status.UPLOAD_FAILED);\n                    if (result[this._options.retry.preventRetryResponseProperty] === true) {\n                        this._preventRetries[id] = true;\n                    }\n                } else {\n                    if (result.thumbnailUrl) {\n                        this._thumbnailUrls[id] = result.thumbnailUrl;\n                    }\n                    this._netUploaded++;\n                    this._uploadData.setStatus(id, qq.status.UPLOAD_SUCCESSFUL);\n                }\n                this._maybeParseAndSendUploadError(id, name, result, xhr);\n                return result.success ? true : false;\n            },\n            _onDelete: function(id) {\n                this._uploadData.setStatus(id, qq.status.DELETING);\n            },\n            _onDeleteComplete: function(id, xhrOrXdr, isError) {\n                var name = this.getName(id);\n                if (isError) {\n                    this._handleDeleteFailed(id, xhrOrXdr);\n                } else {\n                    this._handleDeleteSuccess(id);\n                }\n            },\n            _onInputChange: function(input) {\n                var fileIndex;\n                if (qq.supportedFeatures.ajaxUploading) {\n                    for (fileIndex = 0; fileIndex < input.files.length; fileIndex++) {\n                        this._annotateWithButtonId(input.files[fileIndex], input);\n                    }\n                    this.addFiles(input.files);\n                } else if (input.value.length > 0) {\n                    this.addFiles(input);\n                }\n                qq.each(this._buttons, function(idx, button) {\n                    button.reset();\n                });\n            },\n            _onProgress: function(id, name, loaded, total) {\n                this._totalProgress && this._totalProgress.onIndividualProgress(id, loaded, total);\n            },\n            _onSubmit: function(id, name) {},\n            _onSubmitCallbackSuccess: function(id, name) {\n                this._onSubmit.apply(this, arguments);\n                this._uploadData.setStatus(id, qq.status.SUBMITTED);\n                this._onSubmitted.apply(this, arguments);\n                if (this._options.autoUpload) {\n                    this._options.callbacks.onSubmitted.apply(this, arguments);\n                    this._uploadFile(id);\n                } else {\n                    this._storeForLater(id);\n                    this._options.callbacks.onSubmitted.apply(this, arguments);\n                }\n            },\n            _onSubmitDelete: function(id, onSuccessCallback, additionalMandatedParams) {\n                var uuid = this.getUuid(id), adjustedOnSuccessCallback;\n                if (onSuccessCallback) {\n                    adjustedOnSuccessCallback = qq.bind(onSuccessCallback, this, id, uuid, additionalMandatedParams);\n                }\n                if (this._isDeletePossible()) {\n                    this._handleCheckedCallback({\n                        name: \"onSubmitDelete\",\n                        callback: qq.bind(this._options.callbacks.onSubmitDelete, this, id),\n                        onSuccess: adjustedOnSuccessCallback || qq.bind(this._deleteHandler.sendDelete, this, id, uuid, additionalMandatedParams),\n                        identifier: id\n                    });\n                    return true;\n                } else {\n                    this.log(\"Delete request ignored for ID \" + id + \", delete feature is disabled or request not possible \" + \"due to CORS on a user agent that does not support pre-flighting.\", \"warn\");\n                    return false;\n                }\n            },\n            _onSubmitted: function(id) {},\n            _onTotalProgress: function(loaded, total) {\n                this._options.callbacks.onTotalProgress(loaded, total);\n            },\n            _onUploadPrep: function(id) {},\n            _onUpload: function(id, name) {\n                this._uploadData.setStatus(id, qq.status.UPLOADING);\n            },\n            _onUploadChunk: function(id, chunkData) {},\n            _onUploadChunkSuccess: function(id, chunkData) {\n                if (!this._preventRetries[id] && this._options.retry.enableAuto) {\n                    this._autoRetries[id] = 0;\n                }\n            },\n            _onUploadStatusChange: function(id, oldStatus, newStatus) {\n                if (newStatus === qq.status.PAUSED) {\n                    clearTimeout(this._retryTimeouts[id]);\n                }\n            },\n            _onValidateBatchCallbackFailure: function(fileWrappers) {\n                var self = this;\n                qq.each(fileWrappers, function(idx, fileWrapper) {\n                    self._fileOrBlobRejected(fileWrapper.id);\n                });\n            },\n            _onValidateBatchCallbackSuccess: function(validationDescriptors, items, params, endpoint, button) {\n                var errorMessage, itemLimit = this._currentItemLimit, proposedNetFilesUploadedOrQueued = this._netUploadedOrQueued;\n                if (itemLimit === 0 || proposedNetFilesUploadedOrQueued <= itemLimit) {\n                    if (items.length > 0) {\n                        this._handleCheckedCallback({\n                            name: \"onValidate\",\n                            callback: qq.bind(this._options.callbacks.onValidate, this, validationDescriptors[0], button),\n                            onSuccess: qq.bind(this._onValidateCallbackSuccess, this, items, 0, params, endpoint),\n                            onFailure: qq.bind(this._onValidateCallbackFailure, this, items, 0, params, endpoint),\n                            identifier: \"Item '\" + items[0].file.name + \"', size: \" + items[0].file.size\n                        });\n                    } else {\n                        this._itemError(\"noFilesError\");\n                    }\n                } else {\n                    this._onValidateBatchCallbackFailure(items);\n                    errorMessage = this._options.messages.tooManyItemsError.replace(/\\{netItems\\}/g, proposedNetFilesUploadedOrQueued).replace(/\\{itemLimit\\}/g, itemLimit);\n                    this._batchError(errorMessage);\n                }\n            },\n            _onValidateCallbackFailure: function(items, index, params, endpoint) {\n                var nextIndex = index + 1;\n                this._fileOrBlobRejected(items[index].id, items[index].file.name);\n                this._maybeProcessNextItemAfterOnValidateCallback(false, items, nextIndex, params, endpoint);\n            },\n            _onValidateCallbackSuccess: function(items, index, params, endpoint) {\n                var self = this, nextIndex = index + 1, validationDescriptor = this._getValidationDescriptor(items[index]);\n                this._validateFileOrBlobData(items[index], validationDescriptor).then(function() {\n                    self._upload(items[index].id, params, endpoint);\n                    self._maybeProcessNextItemAfterOnValidateCallback(true, items, nextIndex, params, endpoint);\n                }, function() {\n                    self._maybeProcessNextItemAfterOnValidateCallback(false, items, nextIndex, params, endpoint);\n                });\n            },\n            _prepareItemsForUpload: function(items, params, endpoint) {\n                if (items.length === 0) {\n                    this._itemError(\"noFilesError\");\n                    return;\n                }\n                var validationDescriptors = this._getValidationDescriptors(items), buttonId = this._getButtonId(items[0].file), button = this._getButton(buttonId);\n                this._handleCheckedCallback({\n                    name: \"onValidateBatch\",\n                    callback: qq.bind(this._options.callbacks.onValidateBatch, this, validationDescriptors, button),\n                    onSuccess: qq.bind(this._onValidateBatchCallbackSuccess, this, validationDescriptors, items, params, endpoint, button),\n                    onFailure: qq.bind(this._onValidateBatchCallbackFailure, this, items),\n                    identifier: \"batch validation\"\n                });\n            },\n            _preventLeaveInProgress: function() {\n                var self = this;\n                this._disposeSupport.attach(window, \"beforeunload\", function(e) {\n                    if (self.getInProgress()) {\n                        e = e || window.event;\n                        e.returnValue = self._options.messages.onLeave;\n                        return self._options.messages.onLeave;\n                    }\n                });\n            },\n            _refreshSessionData: function() {\n                var self = this, options = this._options.session;\n                if (qq.Session && this._options.session.endpoint != null) {\n                    if (!this._session) {\n                        qq.extend(options, {\n                            cors: this._options.cors\n                        });\n                        options.log = qq.bind(this.log, this);\n                        options.addFileRecord = qq.bind(this._addCannedFile, this);\n                        this._session = new qq.Session(options);\n                    }\n                    setTimeout(function() {\n                        self._session.refresh().then(function(response, xhrOrXdr) {\n                            self._sessionRequestComplete();\n                            self._options.callbacks.onSessionRequestComplete(response, true, xhrOrXdr);\n                        }, function(response, xhrOrXdr) {\n                            self._options.callbacks.onSessionRequestComplete(response, false, xhrOrXdr);\n                        });\n                    }, 0);\n                }\n            },\n            _sessionRequestComplete: function() {},\n            _setSize: function(id, newSize) {\n                this._uploadData.updateSize(id, newSize);\n                this._totalProgress && this._totalProgress.onNewSize(id);\n            },\n            _shouldAutoRetry: function(id) {\n                var uploadData = this._uploadData.retrieve({\n                    id: id\n                });\n                if (!this._preventRetries[id] && this._options.retry.enableAuto && uploadData.status !== qq.status.PAUSED) {\n                    if (this._autoRetries[id] === undefined) {\n                        this._autoRetries[id] = 0;\n                    }\n                    if (this._autoRetries[id] < this._options.retry.maxAutoAttempts) {\n                        this._autoRetries[id] += 1;\n                        return true;\n                    }\n                }\n                return false;\n            },\n            _storeForLater: function(id) {\n                this._storedIds.push(id);\n            },\n            _trackButton: function(id) {\n                var buttonId;\n                if (qq.supportedFeatures.ajaxUploading) {\n                    buttonId = this._handler.getFile(id).qqButtonId;\n                } else {\n                    buttonId = this._getButtonId(this._handler.getInput(id));\n                }\n                if (buttonId) {\n                    this._buttonIdsForFileIds[id] = buttonId;\n                }\n            },\n            _updateFormSupportAndParams: function(formElementOrId) {\n                this._options.form.element = formElementOrId;\n                this._formSupport = qq.FormSupport && new qq.FormSupport(this._options.form, qq.bind(this.uploadStoredFiles, this), qq.bind(this.log, this));\n                if (this._formSupport && this._formSupport.attachedToForm) {\n                    this._paramsStore.addReadOnly(null, this._formSupport.getFormInputsAsObject);\n                    this._options.autoUpload = this._formSupport.newAutoUpload;\n                    if (this._formSupport.newEndpoint) {\n                        this.setEndpoint(this._formSupport.newEndpoint);\n                    }\n                }\n            },\n            _upload: function(id, params, endpoint) {\n                var name = this.getName(id);\n                if (params) {\n                    this.setParams(params, id);\n                }\n                if (endpoint) {\n                    this.setEndpoint(endpoint, id);\n                }\n                this._handleCheckedCallback({\n                    name: \"onSubmit\",\n                    callback: qq.bind(this._options.callbacks.onSubmit, this, id, name),\n                    onSuccess: qq.bind(this._onSubmitCallbackSuccess, this, id, name),\n                    onFailure: qq.bind(this._fileOrBlobRejected, this, id, name),\n                    identifier: id\n                });\n            },\n            _uploadFile: function(id) {\n                if (!this._handler.upload(id)) {\n                    this._uploadData.setStatus(id, qq.status.QUEUED);\n                }\n            },\n            _uploadStoredFiles: function() {\n                var idToUpload, stillSubmitting, self = this;\n                while (this._storedIds.length) {\n                    idToUpload = this._storedIds.shift();\n                    this._uploadFile(idToUpload);\n                }\n                stillSubmitting = this.getUploads({\n                    status: qq.status.SUBMITTING\n                }).length;\n                if (stillSubmitting) {\n                    qq.log(\"Still waiting for \" + stillSubmitting + \" files to clear submit queue. Will re-parse stored IDs array shortly.\");\n                    setTimeout(function() {\n                        self._uploadStoredFiles();\n                    }, 1e3);\n                }\n            },\n            _validateFileOrBlobData: function(fileWrapper, validationDescriptor) {\n                var self = this, file = function() {\n                    if (fileWrapper.file instanceof qq.BlobProxy) {\n                        return fileWrapper.file.referenceBlob;\n                    }\n                    return fileWrapper.file;\n                }(), name = validationDescriptor.name, size = validationDescriptor.size, buttonId = this._getButtonId(fileWrapper.file), validationBase = this._getValidationBase(buttonId), validityChecker = new qq.Promise();\n                validityChecker.then(function() {}, function() {\n                    self._fileOrBlobRejected(fileWrapper.id, name);\n                });\n                if (qq.isFileOrInput(file) && !this._isAllowedExtension(validationBase.allowedExtensions, name)) {\n                    this._itemError(\"typeError\", name, file);\n                    return validityChecker.failure();\n                }\n                if (!this._options.validation.allowEmpty && size === 0) {\n                    this._itemError(\"emptyError\", name, file);\n                    return validityChecker.failure();\n                }\n                if (size > 0 && validationBase.sizeLimit && size > validationBase.sizeLimit) {\n                    this._itemError(\"sizeError\", name, file);\n                    return validityChecker.failure();\n                }\n                if (size > 0 && size < validationBase.minSizeLimit) {\n                    this._itemError(\"minSizeError\", name, file);\n                    return validityChecker.failure();\n                }\n                if (qq.ImageValidation && qq.supportedFeatures.imagePreviews && qq.isFile(file)) {\n                    new qq.ImageValidation(file, qq.bind(self.log, self)).validate(validationBase.image).then(validityChecker.success, function(errorCode) {\n                        self._itemError(errorCode + \"ImageError\", name, file);\n                        validityChecker.failure();\n                    });\n                } else {\n                    validityChecker.success();\n                }\n                return validityChecker;\n            },\n            _wrapCallbacks: function() {\n                var self, safeCallback, prop;\n                self = this;\n                safeCallback = function(name, callback, args) {\n                    var errorMsg;\n                    try {\n                        return callback.apply(self, args);\n                    } catch (exception) {\n                        errorMsg = exception.message || exception.toString();\n                        self.log(\"Caught exception in '\" + name + \"' callback - \" + errorMsg, \"error\");\n                    }\n                };\n                for (prop in this._options.callbacks) {\n                    (function() {\n                        var callbackName, callbackFunc;\n                        callbackName = prop;\n                        callbackFunc = self._options.callbacks[callbackName];\n                        self._options.callbacks[callbackName] = function() {\n                            return safeCallback(callbackName, callbackFunc, arguments);\n                        };\n                    })();\n                }\n            }\n        };\n    })();\n    (function() {\n        \"use strict\";\n        qq.FineUploaderBasic = function(o) {\n            var self = this;\n            this._options = {\n                debug: false,\n                button: null,\n                multiple: true,\n                maxConnections: 3,\n                disableCancelForFormUploads: false,\n                autoUpload: true,\n                warnBeforeUnload: true,\n                request: {\n                    customHeaders: {},\n                    endpoint: \"/server/upload\",\n                    filenameParam: \"qqfilename\",\n                    forceMultipart: true,\n                    inputName: \"qqfile\",\n                    method: \"POST\",\n                    omitDefaultParams: false,\n                    params: {},\n                    paramsInBody: true,\n                    requireSuccessJson: true,\n                    totalFileSizeName: \"qqtotalfilesize\",\n                    uuidName: \"qquuid\"\n                },\n                validation: {\n                    allowedExtensions: [],\n                    sizeLimit: 0,\n                    minSizeLimit: 0,\n                    itemLimit: 0,\n                    stopOnFirstInvalidFile: true,\n                    acceptFiles: null,\n                    image: {\n                        maxHeight: 0,\n                        maxWidth: 0,\n                        minHeight: 0,\n                        minWidth: 0\n                    },\n                    allowEmpty: false\n                },\n                callbacks: {\n                    onSubmit: function(id, name) {},\n                    onSubmitted: function(id, name) {},\n                    onComplete: function(id, name, responseJSON, maybeXhr) {},\n                    onAllComplete: function(successful, failed) {},\n                    onCancel: function(id, name) {},\n                    onUpload: function(id, name) {},\n                    onUploadChunk: function(id, name, chunkData) {},\n                    onUploadChunkSuccess: function(id, chunkData, responseJSON, xhr) {},\n                    onResume: function(id, fileName, chunkData, customResumeData) {},\n                    onProgress: function(id, name, loaded, total) {},\n                    onTotalProgress: function(loaded, total) {},\n                    onError: function(id, name, reason, maybeXhrOrXdr) {},\n                    onAutoRetry: function(id, name, attemptNumber) {},\n                    onManualRetry: function(id, name) {},\n                    onValidateBatch: function(fileOrBlobData) {},\n                    onValidate: function(fileOrBlobData) {},\n                    onSubmitDelete: function(id) {},\n                    onDelete: function(id) {},\n                    onDeleteComplete: function(id, xhrOrXdr, isError) {},\n                    onPasteReceived: function(blob) {},\n                    onStatusChange: function(id, oldStatus, newStatus) {},\n                    onSessionRequestComplete: function(response, success, xhrOrXdr) {}\n                },\n                messages: {\n                    typeError: \"{file} has an invalid extension. Valid extension(s): {extensions}.\",\n                    sizeError: \"{file} is too large, maximum file size is {sizeLimit}.\",\n                    minSizeError: \"{file} is too small, minimum file size is {minSizeLimit}.\",\n                    emptyError: \"{file} is empty, please select files again without it.\",\n                    noFilesError: \"No files to upload.\",\n                    tooManyItemsError: \"Too many items ({netItems}) would be uploaded.  Item limit is {itemLimit}.\",\n                    maxHeightImageError: \"Image is too tall.\",\n                    maxWidthImageError: \"Image is too wide.\",\n                    minHeightImageError: \"Image is not tall enough.\",\n                    minWidthImageError: \"Image is not wide enough.\",\n                    retryFailTooManyItems: \"Retry failed - you have reached your file limit.\",\n                    onLeave: \"The files are being uploaded, if you leave now the upload will be canceled.\",\n                    unsupportedBrowserIos8Safari: \"Unrecoverable error - this browser does not permit file uploading of any kind due to serious bugs in iOS8 Safari.  Please use iOS8 Chrome until Apple fixes these issues.\"\n                },\n                retry: {\n                    enableAuto: false,\n                    maxAutoAttempts: 3,\n                    autoAttemptDelay: 5,\n                    preventRetryResponseProperty: \"preventRetry\"\n                },\n                classes: {\n                    buttonHover: \"qq-upload-button-hover\",\n                    buttonFocus: \"qq-upload-button-focus\"\n                },\n                chunking: {\n                    enabled: false,\n                    concurrent: {\n                        enabled: false\n                    },\n                    mandatory: false,\n                    paramNames: {\n                        partIndex: \"qqpartindex\",\n                        partByteOffset: \"qqpartbyteoffset\",\n                        chunkSize: \"qqchunksize\",\n                        totalFileSize: \"qqtotalfilesize\",\n                        totalParts: \"qqtotalparts\"\n                    },\n                    partSize: function(id) {\n                        return 2e6;\n                    },\n                    success: {\n                        endpoint: null,\n                        headers: function(id) {\n                            return null;\n                        },\n                        jsonPayload: false,\n                        method: \"POST\",\n                        params: function(id) {\n                            return null;\n                        },\n                        resetOnStatus: []\n                    }\n                },\n                resume: {\n                    enabled: false,\n                    recordsExpireIn: 7,\n                    paramNames: {\n                        resuming: \"qqresume\"\n                    },\n                    customKeys: function(fileId) {\n                        return [];\n                    }\n                },\n                formatFileName: function(fileOrBlobName) {\n                    return fileOrBlobName;\n                },\n                text: {\n                    defaultResponseError: \"Upload failure reason unknown\",\n                    fileInputTitle: \"file input\",\n                    sizeSymbols: [ \"kB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\" ]\n                },\n                deleteFile: {\n                    enabled: false,\n                    method: \"DELETE\",\n                    endpoint: \"/server/upload\",\n                    customHeaders: {},\n                    params: {}\n                },\n                cors: {\n                    expected: false,\n                    sendCredentials: false,\n                    allowXdr: false\n                },\n                blobs: {\n                    defaultName: \"misc_data\"\n                },\n                paste: {\n                    targetElement: null,\n                    defaultName: \"pasted_image\"\n                },\n                camera: {\n                    ios: false,\n                    button: null\n                },\n                extraButtons: [],\n                session: {\n                    endpoint: null,\n                    params: {},\n                    customHeaders: {},\n                    refreshOnReset: true\n                },\n                form: {\n                    element: \"qq-form\",\n                    autoUpload: false,\n                    interceptSubmit: true\n                },\n                scaling: {\n                    customResizer: null,\n                    sendOriginal: true,\n                    orient: true,\n                    defaultType: null,\n                    defaultQuality: 80,\n                    failureText: \"Failed to scale\",\n                    includeExif: false,\n                    sizes: []\n                },\n                workarounds: {\n                    iosEmptyVideos: true,\n                    ios8SafariUploads: true,\n                    ios8BrowserCrash: false\n                }\n            };\n            qq.extend(this._options, o, true);\n            this._buttons = [];\n            this._extraButtonSpecs = {};\n            this._buttonIdsForFileIds = [];\n            this._wrapCallbacks();\n            this._disposeSupport = new qq.DisposeSupport();\n            this._storedIds = [];\n            this._autoRetries = [];\n            this._retryTimeouts = [];\n            this._preventRetries = [];\n            this._thumbnailUrls = [];\n            this._netUploadedOrQueued = 0;\n            this._netUploaded = 0;\n            this._uploadData = this._createUploadDataTracker();\n            this._initFormSupportAndParams();\n            this._customHeadersStore = this._createStore(this._options.request.customHeaders);\n            this._deleteFileCustomHeadersStore = this._createStore(this._options.deleteFile.customHeaders);\n            this._deleteFileParamsStore = this._createStore(this._options.deleteFile.params);\n            this._endpointStore = this._createStore(this._options.request.endpoint);\n            this._deleteFileEndpointStore = this._createStore(this._options.deleteFile.endpoint);\n            this._handler = this._createUploadHandler();\n            this._deleteHandler = qq.DeleteFileAjaxRequester && this._createDeleteHandler();\n            if (this._options.button) {\n                this._defaultButtonId = this._createUploadButton({\n                    element: this._options.button,\n                    title: this._options.text.fileInputTitle\n                }).getButtonId();\n            }\n            this._generateExtraButtonSpecs();\n            this._handleCameraAccess();\n            if (this._options.paste.targetElement) {\n                if (qq.PasteSupport) {\n                    this._pasteHandler = this._createPasteHandler();\n                } else {\n                    this.log(\"Paste support module not found\", \"error\");\n                }\n            }\n            this._options.warnBeforeUnload && this._preventLeaveInProgress();\n            this._imageGenerator = qq.ImageGenerator && new qq.ImageGenerator(qq.bind(this.log, this));\n            this._refreshSessionData();\n            this._succeededSinceLastAllComplete = [];\n            this._failedSinceLastAllComplete = [];\n            this._scaler = qq.Scaler && new qq.Scaler(this._options.scaling, qq.bind(this.log, this)) || {};\n            if (this._scaler.enabled) {\n                this._customNewFileHandler = qq.bind(this._scaler.handleNewFile, this._scaler);\n            }\n            if (qq.TotalProgress && qq.supportedFeatures.progressBar) {\n                this._totalProgress = new qq.TotalProgress(qq.bind(this._onTotalProgress, this), function(id) {\n                    var entry = self._uploadData.retrieve({\n                        id: id\n                    });\n                    return entry && entry.size || 0;\n                });\n            }\n            this._currentItemLimit = this._options.validation.itemLimit;\n            this._customResumeDataStore = this._createStore();\n        };\n        qq.FineUploaderBasic.prototype = qq.basePublicApi;\n        qq.extend(qq.FineUploaderBasic.prototype, qq.basePrivateApi);\n    })();\n    qq.AjaxRequester = function(o) {\n        \"use strict\";\n        var log, shouldParamsBeInQueryString, queue = [], requestData = {}, options = {\n            acceptHeader: null,\n            validMethods: [ \"PATCH\", \"POST\", \"PUT\" ],\n            method: \"POST\",\n            contentType: \"application/x-www-form-urlencoded\",\n            maxConnections: 3,\n            customHeaders: {},\n            endpointStore: {},\n            paramsStore: {},\n            mandatedParams: {},\n            allowXRequestedWithAndCacheControl: true,\n            successfulResponseCodes: {\n                DELETE: [ 200, 202, 204 ],\n                PATCH: [ 200, 201, 202, 203, 204 ],\n                POST: [ 200, 201, 202, 203, 204 ],\n                PUT: [ 200, 201, 202, 203, 204 ],\n                GET: [ 200 ]\n            },\n            cors: {\n                expected: false,\n                sendCredentials: false\n            },\n            log: function(str, level) {},\n            onSend: function(id) {},\n            onComplete: function(id, xhrOrXdr, isError) {},\n            onProgress: null\n        };\n        qq.extend(options, o);\n        log = options.log;\n        if (qq.indexOf(options.validMethods, options.method) < 0) {\n            throw new Error(\"'\" + options.method + \"' is not a supported method for this type of request!\");\n        }\n        function isSimpleMethod() {\n            return qq.indexOf([ \"GET\", \"POST\", \"HEAD\" ], options.method) >= 0;\n        }\n        function containsNonSimpleHeaders(headers) {\n            var containsNonSimple = false;\n            qq.each(containsNonSimple, function(idx, header) {\n                if (qq.indexOf([ \"Accept\", \"Accept-Language\", \"Content-Language\", \"Content-Type\" ], header) < 0) {\n                    containsNonSimple = true;\n                    return false;\n                }\n            });\n            return containsNonSimple;\n        }\n        function isXdr(xhr) {\n            return options.cors.expected && xhr.withCredentials === undefined;\n        }\n        function getCorsAjaxTransport() {\n            var xhrOrXdr;\n            if (window.XMLHttpRequest || window.ActiveXObject) {\n                xhrOrXdr = qq.createXhrInstance();\n                if (xhrOrXdr.withCredentials === undefined) {\n                    xhrOrXdr = new XDomainRequest();\n                    xhrOrXdr.onload = function() {};\n                    xhrOrXdr.onerror = function() {};\n                    xhrOrXdr.ontimeout = function() {};\n                    xhrOrXdr.onprogress = function() {};\n                }\n            }\n            return xhrOrXdr;\n        }\n        function getXhrOrXdr(id, suppliedXhr) {\n            var xhrOrXdr = requestData[id] && requestData[id].xhr;\n            if (!xhrOrXdr) {\n                if (suppliedXhr) {\n                    xhrOrXdr = suppliedXhr;\n                } else {\n                    if (options.cors.expected) {\n                        xhrOrXdr = getCorsAjaxTransport();\n                    } else {\n                        xhrOrXdr = qq.createXhrInstance();\n                    }\n                }\n                requestData[id].xhr = xhrOrXdr;\n            }\n            return xhrOrXdr;\n        }\n        function dequeue(id) {\n            var i = qq.indexOf(queue, id), max = options.maxConnections, nextId;\n            delete requestData[id];\n            queue.splice(i, 1);\n            if (queue.length >= max && i < max) {\n                nextId = queue[max - 1];\n                sendRequest(nextId);\n            }\n        }\n        function onComplete(id, xdrError) {\n            var xhr = getXhrOrXdr(id), method = options.method, isError = xdrError === true;\n            dequeue(id);\n            if (isError) {\n                log(method + \" request for \" + id + \" has failed\", \"error\");\n            } else if (!isXdr(xhr) && !isResponseSuccessful(xhr.status)) {\n                isError = true;\n                log(method + \" request for \" + id + \" has failed - response code \" + xhr.status, \"error\");\n            }\n            options.onComplete(id, xhr, isError);\n        }\n        function getParams(id) {\n            var onDemandParams = requestData[id].additionalParams, mandatedParams = options.mandatedParams, params;\n            if (options.paramsStore.get) {\n                params = options.paramsStore.get(id);\n            }\n            if (onDemandParams) {\n                qq.each(onDemandParams, function(name, val) {\n                    params = params || {};\n                    params[name] = val;\n                });\n            }\n            if (mandatedParams) {\n                qq.each(mandatedParams, function(name, val) {\n                    params = params || {};\n                    params[name] = val;\n                });\n            }\n            return params;\n        }\n        function sendRequest(id, optXhr) {\n            var xhr = getXhrOrXdr(id, optXhr), method = options.method, params = getParams(id), payload = requestData[id].payload, url;\n            options.onSend(id);\n            url = createUrl(id, params, requestData[id].additionalQueryParams);\n            if (isXdr(xhr)) {\n                xhr.onload = getXdrLoadHandler(id);\n                xhr.onerror = getXdrErrorHandler(id);\n            } else {\n                xhr.onreadystatechange = getXhrReadyStateChangeHandler(id);\n            }\n            registerForUploadProgress(id);\n            xhr.open(method, url, true);\n            if (options.cors.expected && options.cors.sendCredentials && !isXdr(xhr)) {\n                xhr.withCredentials = true;\n            }\n            setHeaders(id);\n            log(\"Sending \" + method + \" request for \" + id);\n            if (payload) {\n                xhr.send(payload);\n            } else if (shouldParamsBeInQueryString || !params) {\n                xhr.send();\n            } else if (params && options.contentType && options.contentType.toLowerCase().indexOf(\"application/x-www-form-urlencoded\") >= 0) {\n                xhr.send(qq.obj2url(params, \"\"));\n            } else if (params && options.contentType && options.contentType.toLowerCase().indexOf(\"application/json\") >= 0) {\n                xhr.send(JSON.stringify(params));\n            } else {\n                xhr.send(params);\n            }\n            return xhr;\n        }\n        function createUrl(id, params, additionalQueryParams) {\n            var endpoint = options.endpointStore.get(id), addToPath = requestData[id].addToPath;\n            if (addToPath != undefined) {\n                endpoint += \"/\" + addToPath;\n            }\n            if (shouldParamsBeInQueryString && params) {\n                endpoint = qq.obj2url(params, endpoint);\n            }\n            if (additionalQueryParams) {\n                endpoint = qq.obj2url(additionalQueryParams, endpoint);\n            }\n            return endpoint;\n        }\n        function getXhrReadyStateChangeHandler(id) {\n            return function() {\n                if (getXhrOrXdr(id).readyState === 4) {\n                    onComplete(id);\n                }\n            };\n        }\n        function registerForUploadProgress(id) {\n            var onProgress = options.onProgress;\n            if (onProgress) {\n                getXhrOrXdr(id).upload.onprogress = function(e) {\n                    if (e.lengthComputable) {\n                        onProgress(id, e.loaded, e.total);\n                    }\n                };\n            }\n        }\n        function getXdrLoadHandler(id) {\n            return function() {\n                onComplete(id);\n            };\n        }\n        function getXdrErrorHandler(id) {\n            return function() {\n                onComplete(id, true);\n            };\n        }\n        function setHeaders(id) {\n            var xhr = getXhrOrXdr(id), customHeaders = options.customHeaders, onDemandHeaders = requestData[id].additionalHeaders || {}, method = options.method, allHeaders = {};\n            if (!isXdr(xhr)) {\n                options.acceptHeader && xhr.setRequestHeader(\"Accept\", options.acceptHeader);\n                if (options.allowXRequestedWithAndCacheControl) {\n                    if (!options.cors.expected || (!isSimpleMethod() || containsNonSimpleHeaders(customHeaders))) {\n                        xhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n                        xhr.setRequestHeader(\"Cache-Control\", \"no-cache\");\n                    }\n                }\n                if (options.contentType && (method === \"POST\" || method === \"PUT\")) {\n                    xhr.setRequestHeader(\"Content-Type\", options.contentType);\n                }\n                qq.extend(allHeaders, qq.isFunction(customHeaders) ? customHeaders(id) : customHeaders);\n                qq.extend(allHeaders, onDemandHeaders);\n                qq.each(allHeaders, function(name, val) {\n                    xhr.setRequestHeader(name, val);\n                });\n            }\n        }\n        function isResponseSuccessful(responseCode) {\n            return qq.indexOf(options.successfulResponseCodes[options.method], responseCode) >= 0;\n        }\n        function prepareToSend(id, optXhr, addToPath, additionalParams, additionalQueryParams, additionalHeaders, payload) {\n            requestData[id] = {\n                addToPath: addToPath,\n                additionalParams: additionalParams,\n                additionalQueryParams: additionalQueryParams,\n                additionalHeaders: additionalHeaders,\n                payload: payload\n            };\n            var len = queue.push(id);\n            if (len <= options.maxConnections) {\n                return sendRequest(id, optXhr);\n            }\n        }\n        shouldParamsBeInQueryString = options.method === \"GET\" || options.method === \"DELETE\";\n        qq.extend(this, {\n            initTransport: function(id) {\n                var path, params, headers, payload, cacheBuster, additionalQueryParams;\n                return {\n                    withPath: function(appendToPath) {\n                        path = appendToPath;\n                        return this;\n                    },\n                    withParams: function(additionalParams) {\n                        params = additionalParams;\n                        return this;\n                    },\n                    withQueryParams: function(_additionalQueryParams_) {\n                        additionalQueryParams = _additionalQueryParams_;\n                        return this;\n                    },\n                    withHeaders: function(additionalHeaders) {\n                        headers = additionalHeaders;\n                        return this;\n                    },\n                    withPayload: function(thePayload) {\n                        payload = thePayload;\n                        return this;\n                    },\n                    withCacheBuster: function() {\n                        cacheBuster = true;\n                        return this;\n                    },\n                    send: function(optXhr) {\n                        if (cacheBuster && qq.indexOf([ \"GET\", \"DELETE\" ], options.method) >= 0) {\n                            params.qqtimestamp = new Date().getTime();\n                        }\n                        return prepareToSend(id, optXhr, path, params, additionalQueryParams, headers, payload);\n                    }\n                };\n            },\n            canceled: function(id) {\n                dequeue(id);\n            }\n        });\n    };\n    qq.UploadHandler = function(spec) {\n        \"use strict\";\n        var proxy = spec.proxy, fileState = {}, onCancel = proxy.onCancel, getName = proxy.getName;\n        qq.extend(this, {\n            add: function(id, fileItem) {\n                fileState[id] = fileItem;\n                fileState[id].temp = {};\n            },\n            cancel: function(id) {\n                var self = this, cancelFinalizationEffort = new qq.Promise(), onCancelRetVal = onCancel(id, getName(id), cancelFinalizationEffort);\n                onCancelRetVal.then(function() {\n                    if (self.isValid(id)) {\n                        fileState[id].canceled = true;\n                        self.expunge(id);\n                    }\n                    cancelFinalizationEffort.success();\n                });\n            },\n            expunge: function(id) {\n                delete fileState[id];\n            },\n            getThirdPartyFileId: function(id) {\n                return fileState[id].key;\n            },\n            isValid: function(id) {\n                return fileState[id] !== undefined;\n            },\n            reset: function() {\n                fileState = {};\n            },\n            _getFileState: function(id) {\n                return fileState[id];\n            },\n            _setThirdPartyFileId: function(id, thirdPartyFileId) {\n                fileState[id].key = thirdPartyFileId;\n            },\n            _wasCanceled: function(id) {\n                return !!fileState[id].canceled;\n            }\n        });\n    };\n    qq.UploadHandlerController = function(o, namespace) {\n        \"use strict\";\n        var controller = this, chunkingPossible = false, concurrentChunkingPossible = false, chunking, preventRetryResponse, log, handler, options = {\n            paramsStore: {},\n            maxConnections: 3,\n            chunking: {\n                enabled: false,\n                multiple: {\n                    enabled: false\n                }\n            },\n            log: function(str, level) {},\n            onProgress: function(id, fileName, loaded, total) {},\n            onComplete: function(id, fileName, response, xhr) {},\n            onCancel: function(id, fileName) {},\n            onUploadPrep: function(id) {},\n            onUpload: function(id, fileName) {},\n            onUploadChunk: function(id, fileName, chunkData) {},\n            onUploadChunkSuccess: function(id, chunkData, response, xhr) {},\n            onAutoRetry: function(id, fileName, response, xhr) {},\n            onResume: function(id, fileName, chunkData, customResumeData) {},\n            onUuidChanged: function(id, newUuid) {},\n            getName: function(id) {},\n            setSize: function(id, newSize) {},\n            isQueued: function(id) {},\n            getIdsInProxyGroup: function(id) {},\n            getIdsInBatch: function(id) {},\n            isInProgress: function(id) {}\n        }, chunked = {\n            done: function(id, chunkIdx, response, xhr) {\n                var chunkData = handler._getChunkData(id, chunkIdx);\n                handler._getFileState(id).attemptingResume = false;\n                delete handler._getFileState(id).temp.chunkProgress[chunkIdx];\n                handler._getFileState(id).loaded += chunkData.size;\n                options.onUploadChunkSuccess(id, handler._getChunkDataForCallback(chunkData), response, xhr);\n            },\n            finalize: function(id) {\n                var size = options.getSize(id), name = options.getName(id);\n                log(\"All chunks have been uploaded for \" + id + \" - finalizing....\");\n                handler.finalizeChunks(id).then(function(response, xhr) {\n                    log(\"Finalize successful for \" + id);\n                    var normaizedResponse = upload.normalizeResponse(response, true);\n                    options.onProgress(id, name, size, size);\n                    handler._maybeDeletePersistedChunkData(id);\n                    upload.cleanup(id, normaizedResponse, xhr);\n                }, function(response, xhr) {\n                    var normalizedResponse = upload.normalizeResponse(response, false);\n                    log(\"Problem finalizing chunks for file ID \" + id + \" - \" + normalizedResponse.error, \"error\");\n                    if (normalizedResponse.reset || xhr && options.chunking.success.resetOnStatus.indexOf(xhr.status) >= 0) {\n                        chunked.reset(id);\n                    }\n                    if (!options.onAutoRetry(id, name, normalizedResponse, xhr)) {\n                        upload.cleanup(id, normalizedResponse, xhr);\n                    }\n                });\n            },\n            handleFailure: function(chunkIdx, id, response, xhr) {\n                var name = options.getName(id);\n                log(\"Chunked upload request failed for \" + id + \", chunk \" + chunkIdx);\n                handler.clearCachedChunk(id, chunkIdx);\n                var responseToReport = upload.normalizeResponse(response, false), inProgressIdx;\n                if (responseToReport.reset) {\n                    chunked.reset(id);\n                } else {\n                    var inProgressChunksArray = handler._getFileState(id).chunking.inProgress;\n                    inProgressIdx = inProgressChunksArray ? qq.indexOf(inProgressChunksArray, chunkIdx) : -1;\n                    if (inProgressIdx >= 0) {\n                        handler._getFileState(id).chunking.inProgress.splice(inProgressIdx, 1);\n                        handler._getFileState(id).chunking.remaining.unshift(chunkIdx);\n                    }\n                }\n                if (!handler._getFileState(id).temp.ignoreFailure) {\n                    if (concurrentChunkingPossible) {\n                        handler._getFileState(id).temp.ignoreFailure = true;\n                        log(qq.format(\"Going to attempt to abort these chunks: {}. These are currently in-progress: {}.\", JSON.stringify(Object.keys(handler._getXhrs(id))), JSON.stringify(handler._getFileState(id).chunking.inProgress)));\n                        qq.each(handler._getXhrs(id), function(ckid, ckXhr) {\n                            log(qq.format(\"Attempting to abort file {}.{}. XHR readyState {}. \", id, ckid, ckXhr.readyState));\n                            ckXhr.abort();\n                            ckXhr._cancelled = true;\n                        });\n                        handler.moveInProgressToRemaining(id);\n                        connectionManager.free(id, true);\n                    }\n                    if (!options.onAutoRetry(id, name, responseToReport, xhr)) {\n                        upload.cleanup(id, responseToReport, xhr);\n                    }\n                }\n            },\n            hasMoreParts: function(id) {\n                return !!handler._getFileState(id).chunking.remaining.length;\n            },\n            nextPart: function(id) {\n                var nextIdx = handler._getFileState(id).chunking.remaining.shift();\n                if (nextIdx >= handler._getTotalChunks(id)) {\n                    nextIdx = null;\n                }\n                return nextIdx;\n            },\n            reset: function(id) {\n                log(\"Server or callback has ordered chunking effort to be restarted on next attempt for item ID \" + id, \"error\");\n                handler._maybeDeletePersistedChunkData(id);\n                handler.reevaluateChunking(id);\n                handler._getFileState(id).loaded = 0;\n                handler._getFileState(id).attemptingResume = false;\n            },\n            sendNext: function(id) {\n                var size = options.getSize(id), name = options.getName(id), chunkIdx = chunked.nextPart(id), chunkData = handler._getChunkData(id, chunkIdx), fileState = handler._getFileState(id), resuming = fileState.attemptingResume, inProgressChunks = fileState.chunking.inProgress || [];\n                if (fileState.loaded == null) {\n                    fileState.loaded = 0;\n                }\n                if (resuming && options.onResume(id, name, chunkData, fileState.customResumeData) === false) {\n                    chunked.reset(id);\n                    chunkIdx = chunked.nextPart(id);\n                    chunkData = handler._getChunkData(id, chunkIdx);\n                    resuming = false;\n                }\n                if (chunkIdx == null && inProgressChunks.length === 0) {\n                    chunked.finalize(id);\n                } else {\n                    inProgressChunks.push(chunkIdx);\n                    handler._getFileState(id).chunking.inProgress = inProgressChunks;\n                    if (concurrentChunkingPossible) {\n                        connectionManager.open(id, chunkIdx);\n                    }\n                    if (concurrentChunkingPossible && connectionManager.available() && handler._getFileState(id).chunking.remaining.length) {\n                        chunked.sendNext(id);\n                    }\n                    if (chunkData.blob.size === 0) {\n                        log(qq.format(\"Chunk {} for file {} will not be uploaded, zero sized chunk.\", chunkIdx, id), \"error\");\n                        chunked.handleFailure(chunkIdx, id, \"File is no longer available\", null);\n                    }\n                    var onUploadChunkPromise = options.onUploadChunk(id, name, handler._getChunkDataForCallback(chunkData));\n                    onUploadChunkPromise.then(function(requestOverrides) {\n                        if (!options.isInProgress(id)) {\n                            log(qq.format(\"Not sending chunked upload request for item {}.{} - no longer in progress.\", id, chunkIdx));\n                        } else {\n                            log(qq.format(\"Sending chunked upload request for item {}.{}, bytes {}-{} of {}.\", id, chunkIdx, chunkData.start + 1, chunkData.end, size));\n                            var uploadChunkData = {\n                                chunkIdx: chunkIdx,\n                                id: id,\n                                overrides: requestOverrides,\n                                resuming: resuming\n                            };\n                            handler.uploadChunk(uploadChunkData).then(function success(response, xhr) {\n                                log(\"Chunked upload request succeeded for \" + id + \", chunk \" + chunkIdx);\n                                handler.clearCachedChunk(id, chunkIdx);\n                                var inProgressChunks = handler._getFileState(id).chunking.inProgress || [], responseToReport = upload.normalizeResponse(response, true), inProgressChunkIdx = qq.indexOf(inProgressChunks, chunkIdx);\n                                log(qq.format(\"Chunk {} for file {} uploaded successfully.\", chunkIdx, id));\n                                chunked.done(id, chunkIdx, responseToReport, xhr);\n                                if (inProgressChunkIdx >= 0) {\n                                    inProgressChunks.splice(inProgressChunkIdx, 1);\n                                }\n                                handler._maybePersistChunkedState(id);\n                                if (!chunked.hasMoreParts(id) && inProgressChunks.length === 0) {\n                                    chunked.finalize(id);\n                                } else if (chunked.hasMoreParts(id)) {\n                                    chunked.sendNext(id);\n                                } else {\n                                    log(qq.format(\"File ID {} has no more chunks to send and these chunk indexes are still marked as in-progress: {}\", id, JSON.stringify(inProgressChunks)));\n                                }\n                            }, function failure(response, xhr) {\n                                chunked.handleFailure(chunkIdx, id, response, xhr);\n                            }).done(function() {\n                                handler.clearXhr(id, chunkIdx);\n                            });\n                        }\n                    }, function(error) {\n                        chunked.handleFailure(chunkIdx, id, error, null);\n                    });\n                }\n            }\n        }, connectionManager = {\n            _open: [],\n            _openChunks: {},\n            _waiting: [],\n            available: function() {\n                var max = options.maxConnections, openChunkEntriesCount = 0, openChunksCount = 0;\n                qq.each(connectionManager._openChunks, function(fileId, openChunkIndexes) {\n                    openChunkEntriesCount++;\n                    openChunksCount += openChunkIndexes.length;\n                });\n                return max - (connectionManager._open.length - openChunkEntriesCount + openChunksCount);\n            },\n            free: function(id, dontAllowNext) {\n                var allowNext = !dontAllowNext, waitingIndex = qq.indexOf(connectionManager._waiting, id), connectionsIndex = qq.indexOf(connectionManager._open, id), nextId;\n                delete connectionManager._openChunks[id];\n                if (upload.getProxyOrBlob(id) instanceof qq.BlobProxy) {\n                    log(\"Generated blob upload has ended for \" + id + \", disposing generated blob.\");\n                    delete handler._getFileState(id).file;\n                }\n                if (waitingIndex >= 0) {\n                    connectionManager._waiting.splice(waitingIndex, 1);\n                } else if (allowNext && connectionsIndex >= 0) {\n                    connectionManager._open.splice(connectionsIndex, 1);\n                    nextId = connectionManager._waiting.shift();\n                    if (nextId >= 0) {\n                        connectionManager._open.push(nextId);\n                        upload.start(nextId);\n                    }\n                }\n            },\n            getWaitingOrConnected: function() {\n                var waitingOrConnected = [];\n                qq.each(connectionManager._openChunks, function(fileId, chunks) {\n                    if (chunks && chunks.length) {\n                        waitingOrConnected.push(parseInt(fileId));\n                    }\n                });\n                qq.each(connectionManager._open, function(idx, fileId) {\n                    if (!connectionManager._openChunks[fileId]) {\n                        waitingOrConnected.push(parseInt(fileId));\n                    }\n                });\n                waitingOrConnected = waitingOrConnected.concat(connectionManager._waiting);\n                return waitingOrConnected;\n            },\n            isUsingConnection: function(id) {\n                return qq.indexOf(connectionManager._open, id) >= 0;\n            },\n            open: function(id, chunkIdx) {\n                if (chunkIdx == null) {\n                    connectionManager._waiting.push(id);\n                }\n                if (connectionManager.available()) {\n                    if (chunkIdx == null) {\n                        connectionManager._waiting.pop();\n                        connectionManager._open.push(id);\n                    } else {\n                        (function() {\n                            var openChunksEntry = connectionManager._openChunks[id] || [];\n                            openChunksEntry.push(chunkIdx);\n                            connectionManager._openChunks[id] = openChunksEntry;\n                        })();\n                    }\n                    return true;\n                }\n                return false;\n            },\n            reset: function() {\n                connectionManager._waiting = [];\n                connectionManager._open = [];\n            }\n        }, simple = {\n            send: function(id, name) {\n                var fileState = handler._getFileState(id);\n                if (!fileState) {\n                    log(\"Ignoring send request as this upload may have been cancelled, File ID \" + id, \"warn\");\n                    return;\n                }\n                fileState.loaded = 0;\n                log(\"Sending simple upload request for \" + id);\n                handler.uploadFile(id).then(function(response, optXhr) {\n                    log(\"Simple upload request succeeded for \" + id);\n                    var responseToReport = upload.normalizeResponse(response, true), size = options.getSize(id);\n                    options.onProgress(id, name, size, size);\n                    upload.maybeNewUuid(id, responseToReport);\n                    upload.cleanup(id, responseToReport, optXhr);\n                }, function(response, optXhr) {\n                    log(\"Simple upload request failed for \" + id);\n                    var responseToReport = upload.normalizeResponse(response, false);\n                    if (!options.onAutoRetry(id, name, responseToReport, optXhr)) {\n                        upload.cleanup(id, responseToReport, optXhr);\n                    }\n                });\n            }\n        }, upload = {\n            cancel: function(id) {\n                log(\"Cancelling \" + id);\n                options.paramsStore.remove(id);\n                connectionManager.free(id);\n            },\n            cleanup: function(id, response, optXhr) {\n                var name = options.getName(id);\n                options.onComplete(id, name, response, optXhr);\n                if (handler._getFileState(id)) {\n                    handler._clearXhrs && handler._clearXhrs(id);\n                }\n                connectionManager.free(id);\n            },\n            getProxyOrBlob: function(id) {\n                return handler.getProxy && handler.getProxy(id) || handler.getFile && handler.getFile(id);\n            },\n            initHandler: function() {\n                var handlerType = namespace ? qq[namespace] : qq.traditional, handlerModuleSubtype = qq.supportedFeatures.ajaxUploading ? \"Xhr\" : \"Form\";\n                handler = new handlerType[handlerModuleSubtype + \"UploadHandler\"](options, {\n                    getCustomResumeData: options.getCustomResumeData,\n                    getDataByUuid: options.getDataByUuid,\n                    getName: options.getName,\n                    getSize: options.getSize,\n                    getUuid: options.getUuid,\n                    log: log,\n                    onCancel: options.onCancel,\n                    onProgress: options.onProgress,\n                    onUuidChanged: options.onUuidChanged,\n                    onFinalizing: function(id) {\n                        options.setStatus(id, qq.status.UPLOAD_FINALIZING);\n                    }\n                });\n                if (handler._removeExpiredChunkingRecords) {\n                    handler._removeExpiredChunkingRecords();\n                }\n            },\n            isDeferredEligibleForUpload: function(id) {\n                return options.isQueued(id);\n            },\n            maybeDefer: function(id, blob) {\n                if (blob && !handler.getFile(id) && blob instanceof qq.BlobProxy) {\n                    options.onUploadPrep(id);\n                    log(\"Attempting to generate a blob on-demand for \" + id);\n                    blob.create().then(function(generatedBlob) {\n                        log(\"Generated an on-demand blob for \" + id);\n                        handler.updateBlob(id, generatedBlob);\n                        options.setSize(id, generatedBlob.size);\n                        handler.reevaluateChunking(id);\n                        upload.maybeSendDeferredFiles(id);\n                    }, function(errorMessage) {\n                        var errorResponse = {};\n                        if (errorMessage) {\n                            errorResponse.error = errorMessage;\n                        }\n                        log(qq.format(\"Failed to generate blob for ID {}.  Error message: {}.\", id, errorMessage), \"error\");\n                        options.onComplete(id, options.getName(id), qq.extend(errorResponse, preventRetryResponse), null);\n                        upload.maybeSendDeferredFiles(id);\n                        connectionManager.free(id);\n                    });\n                } else {\n                    return upload.maybeSendDeferredFiles(id);\n                }\n                return false;\n            },\n            maybeSendDeferredFiles: function(id) {\n                var idsInGroup = options.getIdsInProxyGroup(id), uploadedThisId = false;\n                if (idsInGroup && idsInGroup.length) {\n                    log(\"Maybe ready to upload proxy group file \" + id);\n                    qq.each(idsInGroup, function(idx, idInGroup) {\n                        if (upload.isDeferredEligibleForUpload(idInGroup) && !!handler.getFile(idInGroup)) {\n                            uploadedThisId = idInGroup === id;\n                            upload.now(idInGroup);\n                        } else if (upload.isDeferredEligibleForUpload(idInGroup)) {\n                            return false;\n                        }\n                    });\n                } else {\n                    uploadedThisId = true;\n                    upload.now(id);\n                }\n                return uploadedThisId;\n            },\n            maybeNewUuid: function(id, response) {\n                if (response.newUuid !== undefined) {\n                    options.onUuidChanged(id, response.newUuid);\n                }\n            },\n            normalizeResponse: function(originalResponse, successful) {\n                var response = originalResponse;\n                if (!qq.isObject(originalResponse)) {\n                    response = {};\n                    if (qq.isString(originalResponse) && !successful) {\n                        response.error = originalResponse;\n                    }\n                }\n                response.success = successful;\n                return response;\n            },\n            now: function(id) {\n                var name = options.getName(id);\n                if (!controller.isValid(id)) {\n                    throw new qq.Error(id + \" is not a valid file ID to upload!\");\n                }\n                options.onUpload(id, name).then(function(response) {\n                    if (response && response.pause) {\n                        options.setStatus(id, qq.status.PAUSED);\n                        handler.pause(id);\n                        connectionManager.free(id);\n                    } else {\n                        if (chunkingPossible && handler._shouldChunkThisFile(id)) {\n                            chunked.sendNext(id);\n                        } else {\n                            simple.send(id, name);\n                        }\n                    }\n                }, function(error) {\n                    error = error || {};\n                    log(id + \" upload start aborted due to rejected onUpload Promise - details: \" + error, \"error\");\n                    if (!options.onAutoRetry(id, name, error.responseJSON || {})) {\n                        var response = upload.normalizeResponse(error.responseJSON, false);\n                        upload.cleanup(id, response);\n                    }\n                });\n            },\n            start: function(id) {\n                var blobToUpload = upload.getProxyOrBlob(id);\n                if (blobToUpload) {\n                    return upload.maybeDefer(id, blobToUpload);\n                } else {\n                    upload.now(id);\n                    return true;\n                }\n            }\n        };\n        qq.extend(this, {\n            add: function(id, file) {\n                handler.add.apply(this, arguments);\n            },\n            upload: function(id) {\n                if (connectionManager.open(id)) {\n                    return upload.start(id);\n                }\n                return false;\n            },\n            retry: function(id) {\n                if (concurrentChunkingPossible) {\n                    handler._getFileState(id).temp.ignoreFailure = false;\n                }\n                if (connectionManager.isUsingConnection(id)) {\n                    return upload.start(id);\n                } else {\n                    return controller.upload(id);\n                }\n            },\n            cancel: function(id) {\n                var cancelRetVal = handler.cancel(id);\n                if (qq.isGenericPromise(cancelRetVal)) {\n                    cancelRetVal.then(function() {\n                        upload.cancel(id);\n                    });\n                } else if (cancelRetVal !== false) {\n                    upload.cancel(id);\n                }\n            },\n            cancelAll: function() {\n                var waitingOrConnected = connectionManager.getWaitingOrConnected(), i;\n                if (waitingOrConnected.length) {\n                    for (i = waitingOrConnected.length - 1; i >= 0; i--) {\n                        controller.cancel(waitingOrConnected[i]);\n                    }\n                }\n                connectionManager.reset();\n            },\n            getFile: function(id) {\n                if (handler.getProxy && handler.getProxy(id)) {\n                    return handler.getProxy(id).referenceBlob;\n                }\n                return handler.getFile && handler.getFile(id);\n            },\n            isProxied: function(id) {\n                return !!(handler.getProxy && handler.getProxy(id));\n            },\n            getInput: function(id) {\n                if (handler.getInput) {\n                    return handler.getInput(id);\n                }\n            },\n            reset: function() {\n                log(\"Resetting upload handler\");\n                controller.cancelAll();\n                connectionManager.reset();\n                handler.reset();\n            },\n            expunge: function(id) {\n                if (controller.isValid(id)) {\n                    return handler.expunge(id);\n                }\n            },\n            isValid: function(id) {\n                return handler.isValid(id);\n            },\n            hasResumeRecord: function(id) {\n                var key = handler.isValid(id) && handler._getLocalStorageId && handler._getLocalStorageId(id);\n                if (key) {\n                    return !!localStorage.getItem(key);\n                }\n                return false;\n            },\n            getResumableFilesData: function() {\n                if (handler.getResumableFilesData) {\n                    return handler.getResumableFilesData();\n                }\n                return [];\n            },\n            getThirdPartyFileId: function(id) {\n                if (controller.isValid(id)) {\n                    return handler.getThirdPartyFileId(id);\n                }\n            },\n            pause: function(id) {\n                if (controller.isResumable(id) && handler.pause && controller.isValid(id) && handler.pause(id)) {\n                    connectionManager.free(id);\n                    handler.moveInProgressToRemaining(id);\n                    return true;\n                }\n                return false;\n            },\n            isAttemptingResume: function(id) {\n                return !!handler.isAttemptingResume && handler.isAttemptingResume(id);\n            },\n            isResumable: function(id) {\n                return !!handler.isResumable && handler.isResumable(id);\n            }\n        });\n        qq.extend(options, o);\n        log = options.log;\n        chunkingPossible = options.chunking.enabled && qq.supportedFeatures.chunking;\n        concurrentChunkingPossible = chunkingPossible && options.chunking.concurrent.enabled;\n        preventRetryResponse = function() {\n            var response = {};\n            response[options.preventRetryParam] = true;\n            return response;\n        }();\n        upload.initHandler();\n    };\n    qq.WindowReceiveMessage = function(o) {\n        \"use strict\";\n        var options = {\n            log: function(message, level) {}\n        }, callbackWrapperDetachers = {};\n        qq.extend(options, o);\n        qq.extend(this, {\n            receiveMessage: function(id, callback) {\n                var onMessageCallbackWrapper = function(event) {\n                    callback(event.data);\n                };\n                if (window.postMessage) {\n                    callbackWrapperDetachers[id] = qq(window).attach(\"message\", onMessageCallbackWrapper);\n                } else {\n                    log(\"iframe message passing not supported in this browser!\", \"error\");\n                }\n            },\n            stopReceivingMessages: function(id) {\n                if (window.postMessage) {\n                    var detacher = callbackWrapperDetachers[id];\n                    if (detacher) {\n                        detacher();\n                    }\n                }\n            }\n        });\n    };\n    qq.FormUploadHandler = function(spec) {\n        \"use strict\";\n        var options = spec.options, handler = this, proxy = spec.proxy, formHandlerInstanceId = qq.getUniqueId(), onloadCallbacks = {}, detachLoadEvents = {}, postMessageCallbackTimers = {}, isCors = options.isCors, inputName = options.inputName, getUuid = proxy.getUuid, log = proxy.log, corsMessageReceiver = new qq.WindowReceiveMessage({\n            log: log\n        });\n        function expungeFile(id) {\n            delete detachLoadEvents[id];\n            if (isCors) {\n                clearTimeout(postMessageCallbackTimers[id]);\n                delete postMessageCallbackTimers[id];\n                corsMessageReceiver.stopReceivingMessages(id);\n            }\n            var iframe = document.getElementById(handler._getIframeName(id));\n            if (iframe) {\n                iframe.setAttribute(\"src\", \"javascript:false;\");\n                qq(iframe).remove();\n            }\n        }\n        function getFileIdForIframeName(iframeName) {\n            return iframeName.split(\"_\")[0];\n        }\n        function initIframeForUpload(name) {\n            var iframe = qq.toElement(\"<iframe src='javascript:false;' name='\" + name + \"' />\");\n            iframe.setAttribute(\"id\", name);\n            iframe.style.display = \"none\";\n            document.body.appendChild(iframe);\n            return iframe;\n        }\n        function registerPostMessageCallback(iframe, callback) {\n            var iframeName = iframe.id, fileId = getFileIdForIframeName(iframeName), uuid = getUuid(fileId);\n            onloadCallbacks[uuid] = callback;\n            detachLoadEvents[fileId] = qq(iframe).attach(\"load\", function() {\n                if (handler.getInput(fileId)) {\n                    log(\"Received iframe load event for CORS upload request (iframe name \" + iframeName + \")\");\n                    postMessageCallbackTimers[iframeName] = setTimeout(function() {\n                        var errorMessage = \"No valid message received from loaded iframe for iframe name \" + iframeName;\n                        log(errorMessage, \"error\");\n                        callback({\n                            error: errorMessage\n                        });\n                    }, 1e3);\n                }\n            });\n            corsMessageReceiver.receiveMessage(iframeName, function(message) {\n                log(\"Received the following window message: '\" + message + \"'\");\n                var fileId = getFileIdForIframeName(iframeName), response = handler._parseJsonResponse(message), uuid = response.uuid, onloadCallback;\n                if (uuid && onloadCallbacks[uuid]) {\n                    log(\"Handling response for iframe name \" + iframeName);\n                    clearTimeout(postMessageCallbackTimers[iframeName]);\n                    delete postMessageCallbackTimers[iframeName];\n                    handler._detachLoadEvent(iframeName);\n                    onloadCallback = onloadCallbacks[uuid];\n                    delete onloadCallbacks[uuid];\n                    corsMessageReceiver.stopReceivingMessages(iframeName);\n                    onloadCallback(response);\n                } else if (!uuid) {\n                    log(\"'\" + message + \"' does not contain a UUID - ignoring.\");\n                }\n            });\n        }\n        qq.extend(this, new qq.UploadHandler(spec));\n        qq.override(this, function(super_) {\n            return {\n                add: function(id, fileInput) {\n                    super_.add(id, {\n                        input: fileInput\n                    });\n                    fileInput.setAttribute(\"name\", inputName);\n                    if (fileInput.parentNode) {\n                        qq(fileInput).remove();\n                    }\n                },\n                expunge: function(id) {\n                    expungeFile(id);\n                    super_.expunge(id);\n                },\n                isValid: function(id) {\n                    return super_.isValid(id) && handler._getFileState(id).input !== undefined;\n                }\n            };\n        });\n        qq.extend(this, {\n            getInput: function(id) {\n                return handler._getFileState(id).input;\n            },\n            _attachLoadEvent: function(iframe, callback) {\n                var responseDescriptor;\n                if (isCors) {\n                    registerPostMessageCallback(iframe, callback);\n                } else {\n                    detachLoadEvents[iframe.id] = qq(iframe).attach(\"load\", function() {\n                        log(\"Received response for \" + iframe.id);\n                        if (!iframe.parentNode) {\n                            return;\n                        }\n                        try {\n                            if (iframe.contentDocument && iframe.contentDocument.body && iframe.contentDocument.body.innerHTML == \"false\") {\n                                return;\n                            }\n                        } catch (error) {\n                            log(\"Error when attempting to access iframe during handling of upload response (\" + error.message + \")\", \"error\");\n                            responseDescriptor = {\n                                success: false\n                            };\n                        }\n                        callback(responseDescriptor);\n                    });\n                }\n            },\n            _createIframe: function(id) {\n                var iframeName = handler._getIframeName(id);\n                return initIframeForUpload(iframeName);\n            },\n            _detachLoadEvent: function(id) {\n                if (detachLoadEvents[id] !== undefined) {\n                    detachLoadEvents[id]();\n                    delete detachLoadEvents[id];\n                }\n            },\n            _getIframeName: function(fileId) {\n                return fileId + \"_\" + formHandlerInstanceId;\n            },\n            _initFormForUpload: function(spec) {\n                var method = spec.method, endpoint = spec.endpoint, params = spec.params, paramsInBody = spec.paramsInBody, targetName = spec.targetName, form = qq.toElement(\"<form method='\" + method + \"' enctype='multipart/form-data'></form>\"), url = endpoint;\n                if (paramsInBody) {\n                    qq.obj2Inputs(params, form);\n                } else {\n                    url = qq.obj2url(params, endpoint);\n                }\n                form.setAttribute(\"action\", url);\n                form.setAttribute(\"target\", targetName);\n                form.style.display = \"none\";\n                document.body.appendChild(form);\n                return form;\n            },\n            _parseJsonResponse: function(innerHtmlOrMessage) {\n                var response = {};\n                try {\n                    response = qq.parseJson(innerHtmlOrMessage);\n                } catch (error) {\n                    log(\"Error when attempting to parse iframe upload response (\" + error.message + \")\", \"error\");\n                }\n                return response;\n            }\n        });\n    };\n    qq.XhrUploadHandler = function(spec) {\n        \"use strict\";\n        var handler = this, namespace = spec.options.namespace, proxy = spec.proxy, chunking = spec.options.chunking, getChunkSize = function(id) {\n            var fileState = handler._getFileState(id);\n            if (fileState.chunkSize) {\n                return fileState.chunkSize;\n            } else {\n                var chunkSize = chunking.partSize;\n                if (qq.isFunction(chunkSize)) {\n                    chunkSize = chunkSize(id, getSize(id));\n                }\n                fileState.chunkSize = chunkSize;\n                return chunkSize;\n            }\n        }, resume = spec.options.resume, chunkFiles = chunking && spec.options.chunking.enabled && qq.supportedFeatures.chunking, resumeEnabled = resume && spec.options.resume.enabled && chunkFiles && qq.supportedFeatures.resume, getName = proxy.getName, getSize = proxy.getSize, getUuid = proxy.getUuid, getEndpoint = proxy.getEndpoint, getDataByUuid = proxy.getDataByUuid, onUuidChanged = proxy.onUuidChanged, onProgress = proxy.onProgress, log = proxy.log, getCustomResumeData = proxy.getCustomResumeData;\n        function abort(id) {\n            qq.each(handler._getXhrs(id), function(xhrId, xhr) {\n                var ajaxRequester = handler._getAjaxRequester(id, xhrId);\n                xhr.onreadystatechange = null;\n                xhr.upload.onprogress = null;\n                xhr.abort();\n                ajaxRequester && ajaxRequester.canceled && ajaxRequester.canceled(id);\n            });\n        }\n        qq.extend(this, new qq.UploadHandler(spec));\n        qq.override(this, function(super_) {\n            return {\n                add: function(id, blobOrProxy) {\n                    if (qq.isFile(blobOrProxy) || qq.isBlob(blobOrProxy)) {\n                        super_.add(id, {\n                            file: blobOrProxy\n                        });\n                    } else if (blobOrProxy instanceof qq.BlobProxy) {\n                        super_.add(id, {\n                            proxy: blobOrProxy\n                        });\n                    } else {\n                        throw new Error(\"Passed obj is not a File, Blob, or proxy\");\n                    }\n                    handler._initTempState(id);\n                    resumeEnabled && handler._maybePrepareForResume(id);\n                },\n                expunge: function(id) {\n                    abort(id);\n                    handler._maybeDeletePersistedChunkData(id);\n                    handler._clearXhrs(id);\n                    super_.expunge(id);\n                }\n            };\n        });\n        qq.extend(this, {\n            clearCachedChunk: function(id, chunkIdx) {\n                var fileState = handler._getFileState(id);\n                if (fileState) {\n                    delete fileState.temp.cachedChunks[chunkIdx];\n                }\n            },\n            clearXhr: function(id, chunkIdx) {\n                var tempState = handler._getFileState(id).temp;\n                if (tempState.xhrs) {\n                    delete tempState.xhrs[chunkIdx];\n                }\n                if (tempState.ajaxRequesters) {\n                    delete tempState.ajaxRequesters[chunkIdx];\n                }\n            },\n            finalizeChunks: function(id, responseParser) {\n                var lastChunkIdx = handler._getTotalChunks(id) - 1, xhr = handler._getXhr(id, lastChunkIdx);\n                if (responseParser) {\n                    return new qq.Promise().success(responseParser(xhr), xhr);\n                }\n                return new qq.Promise().success({}, xhr);\n            },\n            getFile: function(id) {\n                return handler.isValid(id) && handler._getFileState(id).file;\n            },\n            getProxy: function(id) {\n                return handler.isValid(id) && handler._getFileState(id).proxy;\n            },\n            getResumableFilesData: function() {\n                var resumableFilesData = [];\n                handler._iterateResumeRecords(function(key, uploadData) {\n                    handler.moveInProgressToRemaining(null, uploadData.chunking.inProgress, uploadData.chunking.remaining);\n                    var data = {\n                        name: uploadData.name,\n                        remaining: uploadData.chunking.remaining,\n                        size: uploadData.size,\n                        uuid: uploadData.uuid\n                    };\n                    if (uploadData.key) {\n                        data.key = uploadData.key;\n                    }\n                    if (uploadData.customResumeData) {\n                        data.customResumeData = uploadData.customResumeData;\n                    }\n                    resumableFilesData.push(data);\n                });\n                return resumableFilesData;\n            },\n            isAttemptingResume: function(id) {\n                return handler._getFileState(id).attemptingResume;\n            },\n            isResumable: function(id) {\n                return !!chunking && handler.isValid(id) && !handler._getFileState(id).notResumable;\n            },\n            moveInProgressToRemaining: function(id, optInProgress, optRemaining) {\n                var fileState = handler._getFileState(id) || {}, chunkingState = fileState.chunking || {}, inProgress = optInProgress || chunkingState.inProgress, remaining = optRemaining || chunkingState.remaining;\n                if (inProgress) {\n                    log(qq.format(\"Moving these chunks from in-progress {}, to remaining.\", JSON.stringify(inProgress)));\n                    inProgress.reverse();\n                    qq.each(inProgress, function(idx, chunkIdx) {\n                        remaining.unshift(chunkIdx);\n                    });\n                    inProgress.length = 0;\n                }\n            },\n            pause: function(id) {\n                if (handler.isValid(id)) {\n                    log(qq.format(\"Aborting XHR upload for {} '{}' due to pause instruction.\", id, getName(id)));\n                    handler._getFileState(id).paused = true;\n                    abort(id);\n                    return true;\n                }\n            },\n            reevaluateChunking: function(id) {\n                if (chunking && handler.isValid(id)) {\n                    var state = handler._getFileState(id), totalChunks, i;\n                    delete state.chunking;\n                    state.chunking = {};\n                    totalChunks = handler._getTotalChunks(id);\n                    if (totalChunks > 1 || chunking.mandatory) {\n                        state.chunking.enabled = true;\n                        state.chunking.parts = totalChunks;\n                        state.chunking.remaining = [];\n                        for (i = 0; i < totalChunks; i++) {\n                            state.chunking.remaining.push(i);\n                        }\n                        handler._initTempState(id);\n                    } else {\n                        state.chunking.enabled = false;\n                    }\n                }\n            },\n            updateBlob: function(id, newBlob) {\n                if (handler.isValid(id)) {\n                    handler._getFileState(id).file = newBlob;\n                }\n            },\n            _clearXhrs: function(id) {\n                var tempState = handler._getFileState(id).temp;\n                qq.each(tempState.ajaxRequesters, function(chunkId) {\n                    delete tempState.ajaxRequesters[chunkId];\n                });\n                qq.each(tempState.xhrs, function(chunkId) {\n                    delete tempState.xhrs[chunkId];\n                });\n            },\n            _createXhr: function(id, optChunkIdx) {\n                return handler._registerXhr(id, optChunkIdx, qq.createXhrInstance());\n            },\n            _getAjaxRequester: function(id, optChunkIdx) {\n                var chunkIdx = optChunkIdx == null ? -1 : optChunkIdx;\n                return handler._getFileState(id).temp.ajaxRequesters[chunkIdx];\n            },\n            _getChunkData: function(id, chunkIndex) {\n                var chunkSize = getChunkSize(id), fileSize = getSize(id), fileOrBlob = handler.getFile(id), startBytes = chunkSize * chunkIndex, endBytes = startBytes + chunkSize >= fileSize ? fileSize : startBytes + chunkSize, totalChunks = handler._getTotalChunks(id), cachedChunks = this._getFileState(id).temp.cachedChunks, blob = cachedChunks[chunkIndex] || qq.sliceBlob(fileOrBlob, startBytes, endBytes);\n                cachedChunks[chunkIndex] = blob;\n                return {\n                    part: chunkIndex,\n                    start: startBytes,\n                    end: endBytes,\n                    count: totalChunks,\n                    blob: blob,\n                    size: endBytes - startBytes\n                };\n            },\n            _getChunkDataForCallback: function(chunkData) {\n                return {\n                    partIndex: chunkData.part,\n                    startByte: chunkData.start + 1,\n                    endByte: chunkData.end,\n                    totalParts: chunkData.count\n                };\n            },\n            _getLocalStorageId: function(id) {\n                var formatVersion = \"5.0\", name = getName(id), size = getSize(id), chunkSize = getChunkSize(id), endpoint = getEndpoint(id), customKeys = resume.customKeys(id), localStorageId = qq.format(\"qq{}resume{}-{}-{}-{}-{}\", namespace, formatVersion, name, size, chunkSize, endpoint);\n                customKeys.forEach(function(key) {\n                    localStorageId += \"-\" + key;\n                });\n                return localStorageId;\n            },\n            _getMimeType: function(id) {\n                return handler.getFile(id).type;\n            },\n            _getPersistableData: function(id) {\n                return handler._getFileState(id).chunking;\n            },\n            _getTotalChunks: function(id) {\n                if (chunking) {\n                    var fileSize = getSize(id), chunkSize = getChunkSize(id);\n                    return Math.ceil(fileSize / chunkSize);\n                }\n            },\n            _getXhr: function(id, optChunkIdx) {\n                var chunkIdx = optChunkIdx == null ? -1 : optChunkIdx;\n                return handler._getFileState(id).temp.xhrs[chunkIdx];\n            },\n            _getXhrs: function(id) {\n                return handler._getFileState(id).temp.xhrs;\n            },\n            _iterateResumeRecords: function(callback) {\n                if (resumeEnabled) {\n                    qq.each(localStorage, function(key, item) {\n                        if (key.indexOf(qq.format(\"qq{}resume\", namespace)) === 0) {\n                            var uploadData = JSON.parse(item);\n                            callback(key, uploadData);\n                        }\n                    });\n                }\n            },\n            _initTempState: function(id) {\n                handler._getFileState(id).temp = {\n                    ajaxRequesters: {},\n                    chunkProgress: {},\n                    xhrs: {},\n                    cachedChunks: {}\n                };\n            },\n            _markNotResumable: function(id) {\n                handler._getFileState(id).notResumable = true;\n            },\n            _maybeDeletePersistedChunkData: function(id) {\n                var localStorageId;\n                if (resumeEnabled && handler.isResumable(id)) {\n                    localStorageId = handler._getLocalStorageId(id);\n                    if (localStorageId && localStorage.getItem(localStorageId)) {\n                        localStorage.removeItem(localStorageId);\n                        return true;\n                    }\n                }\n                return false;\n            },\n            _maybePrepareForResume: function(id) {\n                var state = handler._getFileState(id), localStorageId, persistedData;\n                if (resumeEnabled && state.key === undefined) {\n                    localStorageId = handler._getLocalStorageId(id);\n                    persistedData = localStorage.getItem(localStorageId);\n                    if (persistedData) {\n                        persistedData = JSON.parse(persistedData);\n                        if (getDataByUuid(persistedData.uuid)) {\n                            handler._markNotResumable(id);\n                        } else {\n                            log(qq.format(\"Identified file with ID {} and name of {} as resumable.\", id, getName(id)));\n                            onUuidChanged(id, persistedData.uuid);\n                            state.key = persistedData.key;\n                            state.chunking = persistedData.chunking;\n                            state.loaded = persistedData.loaded;\n                            state.customResumeData = persistedData.customResumeData;\n                            state.attemptingResume = true;\n                            handler.moveInProgressToRemaining(id);\n                        }\n                    }\n                }\n            },\n            _maybePersistChunkedState: function(id) {\n                var state = handler._getFileState(id), localStorageId, persistedData;\n                if (resumeEnabled && handler.isResumable(id)) {\n                    var customResumeData = getCustomResumeData(id);\n                    localStorageId = handler._getLocalStorageId(id);\n                    persistedData = {\n                        name: getName(id),\n                        size: getSize(id),\n                        uuid: getUuid(id),\n                        key: state.key,\n                        chunking: state.chunking,\n                        loaded: state.loaded,\n                        lastUpdated: Date.now()\n                    };\n                    if (customResumeData) {\n                        persistedData.customResumeData = customResumeData;\n                    }\n                    try {\n                        localStorage.setItem(localStorageId, JSON.stringify(persistedData));\n                    } catch (error) {\n                        log(qq.format(\"Unable to save resume data for '{}' due to error: '{}'.\", id, error.toString()), \"warn\");\n                    }\n                }\n            },\n            _registerProgressHandler: function(id, chunkIdx, chunkSize) {\n                var xhr = handler._getXhr(id, chunkIdx), name = getName(id), progressCalculator = {\n                    simple: function(loaded, total) {\n                        var fileSize = getSize(id);\n                        if (loaded === total) {\n                            onProgress(id, name, fileSize, fileSize);\n                        } else {\n                            onProgress(id, name, loaded >= fileSize ? fileSize - 1 : loaded, fileSize);\n                        }\n                    },\n                    chunked: function(loaded, total) {\n                        var chunkProgress = handler._getFileState(id).temp.chunkProgress, totalSuccessfullyLoadedForFile = handler._getFileState(id).loaded, loadedForRequest = loaded, totalForRequest = total, totalFileSize = getSize(id), estActualChunkLoaded = loadedForRequest - (totalForRequest - chunkSize), totalLoadedForFile = totalSuccessfullyLoadedForFile;\n                        chunkProgress[chunkIdx] = estActualChunkLoaded;\n                        qq.each(chunkProgress, function(chunkIdx, chunkLoaded) {\n                            totalLoadedForFile += chunkLoaded;\n                        });\n                        onProgress(id, name, totalLoadedForFile, totalFileSize);\n                    }\n                };\n                xhr.upload.onprogress = function(e) {\n                    if (e.lengthComputable) {\n                        var type = chunkSize == null ? \"simple\" : \"chunked\";\n                        progressCalculator[type](e.loaded, e.total);\n                    }\n                };\n            },\n            _registerXhr: function(id, optChunkIdx, xhr, optAjaxRequester) {\n                var xhrsId = optChunkIdx == null ? -1 : optChunkIdx, tempState = handler._getFileState(id).temp;\n                tempState.xhrs = tempState.xhrs || {};\n                tempState.ajaxRequesters = tempState.ajaxRequesters || {};\n                tempState.xhrs[xhrsId] = xhr;\n                if (optAjaxRequester) {\n                    tempState.ajaxRequesters[xhrsId] = optAjaxRequester;\n                }\n                return xhr;\n            },\n            _removeExpiredChunkingRecords: function() {\n                var expirationDays = resume.recordsExpireIn;\n                handler._iterateResumeRecords(function(key, uploadData) {\n                    var expirationDate = new Date(uploadData.lastUpdated);\n                    expirationDate.setDate(expirationDate.getDate() + expirationDays);\n                    if (expirationDate.getTime() <= Date.now()) {\n                        log(\"Removing expired resume record with key \" + key);\n                        localStorage.removeItem(key);\n                    }\n                });\n            },\n            _shouldChunkThisFile: function(id) {\n                var state = handler._getFileState(id);\n                if (state) {\n                    if (!state.chunking) {\n                        handler.reevaluateChunking(id);\n                    }\n                    return state.chunking.enabled;\n                }\n            }\n        });\n    };\n    qq.DeleteFileAjaxRequester = function(o) {\n        \"use strict\";\n        var requester, options = {\n            method: \"DELETE\",\n            uuidParamName: \"qquuid\",\n            endpointStore: {},\n            maxConnections: 3,\n            customHeaders: function(id) {\n                return {};\n            },\n            paramsStore: {},\n            cors: {\n                expected: false,\n                sendCredentials: false\n            },\n            log: function(str, level) {},\n            onDelete: function(id) {},\n            onDeleteComplete: function(id, xhrOrXdr, isError) {}\n        };\n        qq.extend(options, o);\n        function getMandatedParams() {\n            if (options.method.toUpperCase() === \"POST\") {\n                return {\n                    _method: \"DELETE\"\n                };\n            }\n            return {};\n        }\n        requester = qq.extend(this, new qq.AjaxRequester({\n            acceptHeader: \"application/json\",\n            validMethods: [ \"POST\", \"DELETE\" ],\n            method: options.method,\n            endpointStore: options.endpointStore,\n            paramsStore: options.paramsStore,\n            mandatedParams: getMandatedParams(),\n            maxConnections: options.maxConnections,\n            customHeaders: function(id) {\n                return options.customHeaders.get(id);\n            },\n            log: options.log,\n            onSend: options.onDelete,\n            onComplete: options.onDeleteComplete,\n            cors: options.cors\n        }));\n        qq.extend(this, {\n            sendDelete: function(id, uuid, additionalMandatedParams) {\n                var additionalOptions = additionalMandatedParams || {};\n                options.log(\"Submitting delete file request for \" + id);\n                if (options.method === \"DELETE\") {\n                    requester.initTransport(id).withPath(uuid).withParams(additionalOptions).send();\n                } else {\n                    additionalOptions[options.uuidParamName] = uuid;\n                    requester.initTransport(id).withParams(additionalOptions).send();\n                }\n            }\n        });\n    };\n    (function() {\n        function detectSubsampling(img) {\n            var iw = img.naturalWidth, ih = img.naturalHeight, canvas = document.createElement(\"canvas\"), ctx;\n            if (iw * ih > 1024 * 1024) {\n                canvas.width = canvas.height = 1;\n                ctx = canvas.getContext(\"2d\");\n                ctx.drawImage(img, -iw + 1, 0);\n                return ctx.getImageData(0, 0, 1, 1).data[3] === 0;\n            } else {\n                return false;\n            }\n        }\n        function detectVerticalSquash(img, iw, ih) {\n            var canvas = document.createElement(\"canvas\"), sy = 0, ey = ih, py = ih, ctx, data, alpha, ratio;\n            canvas.width = 1;\n            canvas.height = ih;\n            ctx = canvas.getContext(\"2d\");\n            ctx.drawImage(img, 0, 0);\n            data = ctx.getImageData(0, 0, 1, ih).data;\n            while (py > sy) {\n                alpha = data[(py - 1) * 4 + 3];\n                if (alpha === 0) {\n                    ey = py;\n                } else {\n                    sy = py;\n                }\n                py = ey + sy >> 1;\n            }\n            ratio = py / ih;\n            return ratio === 0 ? 1 : ratio;\n        }\n        function renderImageToDataURL(img, blob, options, doSquash) {\n            var canvas = document.createElement(\"canvas\"), mime = options.mime || \"image/jpeg\", promise = new qq.Promise();\n            renderImageToCanvas(img, blob, canvas, options, doSquash).then(function() {\n                promise.success(canvas.toDataURL(mime, options.quality || .8));\n            });\n            return promise;\n        }\n        function maybeCalculateDownsampledDimensions(spec) {\n            var maxPixels = 5241e3;\n            if (!qq.ios()) {\n                throw new qq.Error(\"Downsampled dimensions can only be reliably calculated for iOS!\");\n            }\n            if (spec.origHeight * spec.origWidth > maxPixels) {\n                return {\n                    newHeight: Math.round(Math.sqrt(maxPixels * (spec.origHeight / spec.origWidth))),\n                    newWidth: Math.round(Math.sqrt(maxPixels * (spec.origWidth / spec.origHeight)))\n                };\n            }\n        }\n        function renderImageToCanvas(img, blob, canvas, options, doSquash) {\n            var iw = img.naturalWidth, ih = img.naturalHeight, width = options.width, height = options.height, ctx = canvas.getContext(\"2d\"), promise = new qq.Promise(), modifiedDimensions;\n            ctx.save();\n            if (options.resize) {\n                return renderImageToCanvasWithCustomResizer({\n                    blob: blob,\n                    canvas: canvas,\n                    image: img,\n                    imageHeight: ih,\n                    imageWidth: iw,\n                    orientation: options.orientation,\n                    resize: options.resize,\n                    targetHeight: height,\n                    targetWidth: width\n                });\n            }\n            if (!qq.supportedFeatures.unlimitedScaledImageSize) {\n                modifiedDimensions = maybeCalculateDownsampledDimensions({\n                    origWidth: width,\n                    origHeight: height\n                });\n                if (modifiedDimensions) {\n                    qq.log(qq.format(\"Had to reduce dimensions due to device limitations from {}w / {}h to {}w / {}h\", width, height, modifiedDimensions.newWidth, modifiedDimensions.newHeight), \"warn\");\n                    width = modifiedDimensions.newWidth;\n                    height = modifiedDimensions.newHeight;\n                }\n            }\n            transformCoordinate(canvas, width, height, options.orientation);\n            if (qq.ios()) {\n                (function() {\n                    if (detectSubsampling(img)) {\n                        iw /= 2;\n                        ih /= 2;\n                    }\n                    var d = 1024, tmpCanvas = document.createElement(\"canvas\"), vertSquashRatio = doSquash ? detectVerticalSquash(img, iw, ih) : 1, dw = Math.ceil(d * width / iw), dh = Math.ceil(d * height / ih / vertSquashRatio), sy = 0, dy = 0, tmpCtx, sx, dx;\n                    tmpCanvas.width = tmpCanvas.height = d;\n                    tmpCtx = tmpCanvas.getContext(\"2d\");\n                    while (sy < ih) {\n                        sx = 0;\n                        dx = 0;\n                        while (sx < iw) {\n                            tmpCtx.clearRect(0, 0, d, d);\n                            tmpCtx.drawImage(img, -sx, -sy);\n                            ctx.drawImage(tmpCanvas, 0, 0, d, d, dx, dy, dw, dh);\n                            sx += d;\n                            dx += dw;\n                        }\n                        sy += d;\n                        dy += dh;\n                    }\n                    ctx.restore();\n                    tmpCanvas = tmpCtx = null;\n                })();\n            } else {\n                ctx.drawImage(img, 0, 0, width, height);\n            }\n            canvas.qqImageRendered && canvas.qqImageRendered();\n            promise.success();\n            return promise;\n        }\n        function renderImageToCanvasWithCustomResizer(resizeInfo) {\n            var blob = resizeInfo.blob, image = resizeInfo.image, imageHeight = resizeInfo.imageHeight, imageWidth = resizeInfo.imageWidth, orientation = resizeInfo.orientation, promise = new qq.Promise(), resize = resizeInfo.resize, sourceCanvas = document.createElement(\"canvas\"), sourceCanvasContext = sourceCanvas.getContext(\"2d\"), targetCanvas = resizeInfo.canvas, targetHeight = resizeInfo.targetHeight, targetWidth = resizeInfo.targetWidth;\n            transformCoordinate(sourceCanvas, imageWidth, imageHeight, orientation);\n            targetCanvas.height = targetHeight;\n            targetCanvas.width = targetWidth;\n            sourceCanvasContext.drawImage(image, 0, 0);\n            resize({\n                blob: blob,\n                height: targetHeight,\n                image: image,\n                sourceCanvas: sourceCanvas,\n                targetCanvas: targetCanvas,\n                width: targetWidth\n            }).then(function success() {\n                targetCanvas.qqImageRendered && targetCanvas.qqImageRendered();\n                promise.success();\n            }, promise.failure);\n            return promise;\n        }\n        function transformCoordinate(canvas, width, height, orientation) {\n            switch (orientation) {\n              case 5:\n              case 6:\n              case 7:\n              case 8:\n                canvas.width = height;\n                canvas.height = width;\n                break;\n\n              default:\n                canvas.width = width;\n                canvas.height = height;\n            }\n            var ctx = canvas.getContext(\"2d\");\n            switch (orientation) {\n              case 2:\n                ctx.translate(width, 0);\n                ctx.scale(-1, 1);\n                break;\n\n              case 3:\n                ctx.translate(width, height);\n                ctx.rotate(Math.PI);\n                break;\n\n              case 4:\n                ctx.translate(0, height);\n                ctx.scale(1, -1);\n                break;\n\n              case 5:\n                ctx.rotate(.5 * Math.PI);\n                ctx.scale(1, -1);\n                break;\n\n              case 6:\n                ctx.rotate(.5 * Math.PI);\n                ctx.translate(0, -height);\n                break;\n\n              case 7:\n                ctx.rotate(.5 * Math.PI);\n                ctx.translate(width, -height);\n                ctx.scale(-1, 1);\n                break;\n\n              case 8:\n                ctx.rotate(-.5 * Math.PI);\n                ctx.translate(-width, 0);\n                break;\n\n              default:\n                break;\n            }\n        }\n        function MegaPixImage(srcImage, errorCallback) {\n            var self = this;\n            if (window.Blob && srcImage instanceof Blob) {\n                (function() {\n                    var img = new Image(), URL = window.URL && window.URL.createObjectURL ? window.URL : window.webkitURL && window.webkitURL.createObjectURL ? window.webkitURL : null;\n                    if (!URL) {\n                        throw Error(\"No createObjectURL function found to create blob url\");\n                    }\n                    img.src = URL.createObjectURL(srcImage);\n                    self.blob = srcImage;\n                    srcImage = img;\n                })();\n            }\n            if (!srcImage.naturalWidth && !srcImage.naturalHeight) {\n                srcImage.onload = function() {\n                    var listeners = self.imageLoadListeners;\n                    if (listeners) {\n                        self.imageLoadListeners = null;\n                        setTimeout(function() {\n                            for (var i = 0, len = listeners.length; i < len; i++) {\n                                listeners[i]();\n                            }\n                        }, 0);\n                    }\n                };\n                srcImage.onerror = errorCallback;\n                this.imageLoadListeners = [];\n            }\n            this.srcImage = srcImage;\n        }\n        MegaPixImage.prototype.render = function(target, options) {\n            options = options || {};\n            var self = this, imgWidth = this.srcImage.naturalWidth, imgHeight = this.srcImage.naturalHeight, width = options.width, height = options.height, maxWidth = options.maxWidth, maxHeight = options.maxHeight, doSquash = !this.blob || this.blob.type === \"image/jpeg\", tagName = target.tagName.toLowerCase(), opt;\n            if (this.imageLoadListeners) {\n                this.imageLoadListeners.push(function() {\n                    self.render(target, options);\n                });\n                return;\n            }\n            if (width && !height) {\n                height = imgHeight * width / imgWidth << 0;\n            } else if (height && !width) {\n                width = imgWidth * height / imgHeight << 0;\n            } else {\n                width = imgWidth;\n                height = imgHeight;\n            }\n            if (maxWidth && width > maxWidth) {\n                width = maxWidth;\n                height = imgHeight * width / imgWidth << 0;\n            }\n            if (maxHeight && height > maxHeight) {\n                height = maxHeight;\n                width = imgWidth * height / imgHeight << 0;\n            }\n            opt = {\n                width: width,\n                height: height\n            }, qq.each(options, function(optionsKey, optionsValue) {\n                opt[optionsKey] = optionsValue;\n            });\n            if (tagName === \"img\") {\n                (function() {\n                    var oldTargetSrc = target.src;\n                    renderImageToDataURL(self.srcImage, self.blob, opt, doSquash).then(function(dataUri) {\n                        target.src = dataUri;\n                        oldTargetSrc === target.src && target.onload();\n                    });\n                })();\n            } else if (tagName === \"canvas\") {\n                renderImageToCanvas(this.srcImage, this.blob, target, opt, doSquash);\n            }\n            if (typeof this.onrender === \"function\") {\n                this.onrender(target);\n            }\n        };\n        qq.MegaPixImage = MegaPixImage;\n    })();\n    qq.ImageGenerator = function(log) {\n        \"use strict\";\n        function isImg(el) {\n            return el.tagName.toLowerCase() === \"img\";\n        }\n        function isCanvas(el) {\n            return el.tagName.toLowerCase() === \"canvas\";\n        }\n        function isImgCorsSupported() {\n            return new Image().crossOrigin !== undefined;\n        }\n        function isCanvasSupported() {\n            var canvas = document.createElement(\"canvas\");\n            return canvas.getContext && canvas.getContext(\"2d\");\n        }\n        function determineMimeOfFileName(nameWithPath) {\n            var pathSegments = nameWithPath.split(\"/\"), name = pathSegments[pathSegments.length - 1].split(\"?\")[0], extension = qq.getExtension(name);\n            extension = extension && extension.toLowerCase();\n            switch (extension) {\n              case \"jpeg\":\n              case \"jpg\":\n                return \"image/jpeg\";\n\n              case \"png\":\n                return \"image/png\";\n\n              case \"bmp\":\n                return \"image/bmp\";\n\n              case \"gif\":\n                return \"image/gif\";\n\n              case \"tiff\":\n              case \"tif\":\n                return \"image/tiff\";\n            }\n        }\n        function isCrossOrigin(url) {\n            var targetAnchor = document.createElement(\"a\"), targetProtocol, targetHostname, targetPort;\n            targetAnchor.href = url;\n            targetProtocol = targetAnchor.protocol;\n            targetPort = targetAnchor.port;\n            targetHostname = targetAnchor.hostname;\n            if (targetProtocol.toLowerCase() !== window.location.protocol.toLowerCase()) {\n                return true;\n            }\n            if (targetHostname.toLowerCase() !== window.location.hostname.toLowerCase()) {\n                return true;\n            }\n            if (targetPort !== window.location.port && !qq.ie()) {\n                return true;\n            }\n            return false;\n        }\n        function registerImgLoadListeners(img, promise) {\n            img.onload = function() {\n                img.onload = null;\n                img.onerror = null;\n                promise.success(img);\n            };\n            img.onerror = function() {\n                img.onload = null;\n                img.onerror = null;\n                log(\"Problem drawing thumbnail!\", \"error\");\n                promise.failure(img, \"Problem drawing thumbnail!\");\n            };\n        }\n        function registerCanvasDrawImageListener(canvas, promise) {\n            canvas.qqImageRendered = function() {\n                promise.success(canvas);\n            };\n        }\n        function registerThumbnailRenderedListener(imgOrCanvas, promise) {\n            var registered = isImg(imgOrCanvas) || isCanvas(imgOrCanvas);\n            if (isImg(imgOrCanvas)) {\n                registerImgLoadListeners(imgOrCanvas, promise);\n            } else if (isCanvas(imgOrCanvas)) {\n                registerCanvasDrawImageListener(imgOrCanvas, promise);\n            } else {\n                promise.failure(imgOrCanvas);\n                log(qq.format(\"Element container of type {} is not supported!\", imgOrCanvas.tagName), \"error\");\n            }\n            return registered;\n        }\n        function draw(fileOrBlob, container, options) {\n            var drawPreview = new qq.Promise(), identifier = new qq.Identify(fileOrBlob, log), maxSize = options.maxSize, orient = options.orient == null ? true : options.orient, megapixErrorHandler = function() {\n                container.onerror = null;\n                container.onload = null;\n                log(\"Could not render preview, file may be too large!\", \"error\");\n                drawPreview.failure(container, \"Browser cannot render image!\");\n            };\n            identifier.isPreviewable().then(function(mime) {\n                var dummyExif = {\n                    parse: function() {\n                        return new qq.Promise().success();\n                    }\n                }, exif = orient ? new qq.Exif(fileOrBlob, log) : dummyExif, mpImg = new qq.MegaPixImage(fileOrBlob, megapixErrorHandler);\n                if (registerThumbnailRenderedListener(container, drawPreview)) {\n                    exif.parse().then(function(exif) {\n                        var orientation = exif && exif.Orientation;\n                        mpImg.render(container, {\n                            maxWidth: maxSize,\n                            maxHeight: maxSize,\n                            orientation: orientation,\n                            mime: mime,\n                            resize: options.customResizeFunction\n                        });\n                    }, function(failureMsg) {\n                        log(qq.format(\"EXIF data could not be parsed ({}).  Assuming orientation = 1.\", failureMsg));\n                        mpImg.render(container, {\n                            maxWidth: maxSize,\n                            maxHeight: maxSize,\n                            mime: mime,\n                            resize: options.customResizeFunction\n                        });\n                    });\n                }\n            }, function() {\n                log(\"Not previewable\");\n                drawPreview.failure(container, \"Not previewable\");\n            });\n            return drawPreview;\n        }\n        function drawOnCanvasOrImgFromUrl(url, canvasOrImg, draw, maxSize, customResizeFunction) {\n            var tempImg = new Image(), tempImgRender = new qq.Promise();\n            registerThumbnailRenderedListener(tempImg, tempImgRender);\n            if (isCrossOrigin(url)) {\n                tempImg.crossOrigin = \"anonymous\";\n            }\n            tempImg.src = url;\n            tempImgRender.then(function rendered() {\n                registerThumbnailRenderedListener(canvasOrImg, draw);\n                var mpImg = new qq.MegaPixImage(tempImg);\n                mpImg.render(canvasOrImg, {\n                    maxWidth: maxSize,\n                    maxHeight: maxSize,\n                    mime: determineMimeOfFileName(url),\n                    resize: customResizeFunction\n                });\n            }, draw.failure);\n        }\n        function drawOnImgFromUrlWithCssScaling(url, img, draw, maxSize) {\n            registerThumbnailRenderedListener(img, draw);\n            qq(img).css({\n                maxWidth: maxSize + \"px\",\n                maxHeight: maxSize + \"px\"\n            });\n            img.src = url;\n        }\n        function drawFromUrl(url, container, options) {\n            var draw = new qq.Promise(), scale = options.scale, maxSize = scale ? options.maxSize : null;\n            if (scale && isImg(container)) {\n                if (isCanvasSupported()) {\n                    if (isCrossOrigin(url) && !isImgCorsSupported()) {\n                        drawOnImgFromUrlWithCssScaling(url, container, draw, maxSize);\n                    } else {\n                        drawOnCanvasOrImgFromUrl(url, container, draw, maxSize);\n                    }\n                } else {\n                    drawOnImgFromUrlWithCssScaling(url, container, draw, maxSize);\n                }\n            } else if (isCanvas(container)) {\n                drawOnCanvasOrImgFromUrl(url, container, draw, maxSize);\n            } else if (registerThumbnailRenderedListener(container, draw)) {\n                container.src = url;\n            }\n            return draw;\n        }\n        qq.extend(this, {\n            generate: function(fileBlobOrUrl, container, options) {\n                if (qq.isString(fileBlobOrUrl)) {\n                    log(\"Attempting to update thumbnail based on server response.\");\n                    return drawFromUrl(fileBlobOrUrl, container, options || {});\n                } else {\n                    log(\"Attempting to draw client-side image preview.\");\n                    return draw(fileBlobOrUrl, container, options || {});\n                }\n            }\n        });\n        this._testing = {};\n        this._testing.isImg = isImg;\n        this._testing.isCanvas = isCanvas;\n        this._testing.isCrossOrigin = isCrossOrigin;\n        this._testing.determineMimeOfFileName = determineMimeOfFileName;\n    };\n    qq.Exif = function(fileOrBlob, log) {\n        \"use strict\";\n        var TAG_IDS = [ 274 ], TAG_INFO = {\n            274: {\n                name: \"Orientation\",\n                bytes: 2\n            }\n        };\n        function parseLittleEndian(hex) {\n            var result = 0, pow = 0;\n            while (hex.length > 0) {\n                result += parseInt(hex.substring(0, 2), 16) * Math.pow(2, pow);\n                hex = hex.substring(2, hex.length);\n                pow += 8;\n            }\n            return result;\n        }\n        function seekToApp1(offset, promise) {\n            var theOffset = offset, thePromise = promise;\n            if (theOffset === undefined) {\n                theOffset = 2;\n                thePromise = new qq.Promise();\n            }\n            qq.readBlobToHex(fileOrBlob, theOffset, 4).then(function(hex) {\n                var match = /^ffe([0-9])/.exec(hex), segmentLength;\n                if (match) {\n                    if (match[1] !== \"1\") {\n                        segmentLength = parseInt(hex.slice(4, 8), 16);\n                        seekToApp1(theOffset + segmentLength + 2, thePromise);\n                    } else {\n                        thePromise.success(theOffset);\n                    }\n                } else {\n                    thePromise.failure(\"No EXIF header to be found!\");\n                }\n            });\n            return thePromise;\n        }\n        function getApp1Offset() {\n            var promise = new qq.Promise();\n            qq.readBlobToHex(fileOrBlob, 0, 6).then(function(hex) {\n                if (hex.indexOf(\"ffd8\") !== 0) {\n                    promise.failure(\"Not a valid JPEG!\");\n                } else {\n                    seekToApp1().then(function(offset) {\n                        promise.success(offset);\n                    }, function(error) {\n                        promise.failure(error);\n                    });\n                }\n            });\n            return promise;\n        }\n        function isLittleEndian(app1Start) {\n            var promise = new qq.Promise();\n            qq.readBlobToHex(fileOrBlob, app1Start + 10, 2).then(function(hex) {\n                promise.success(hex === \"4949\");\n            });\n            return promise;\n        }\n        function getDirEntryCount(app1Start, littleEndian) {\n            var promise = new qq.Promise();\n            qq.readBlobToHex(fileOrBlob, app1Start + 18, 2).then(function(hex) {\n                if (littleEndian) {\n                    return promise.success(parseLittleEndian(hex));\n                } else {\n                    promise.success(parseInt(hex, 16));\n                }\n            });\n            return promise;\n        }\n        function getIfd(app1Start, dirEntries) {\n            var offset = app1Start + 20, bytes = dirEntries * 12;\n            return qq.readBlobToHex(fileOrBlob, offset, bytes);\n        }\n        function getDirEntries(ifdHex) {\n            var entries = [], offset = 0;\n            while (offset + 24 <= ifdHex.length) {\n                entries.push(ifdHex.slice(offset, offset + 24));\n                offset += 24;\n            }\n            return entries;\n        }\n        function getTagValues(littleEndian, dirEntries) {\n            var TAG_VAL_OFFSET = 16, tagsToFind = qq.extend([], TAG_IDS), vals = {};\n            qq.each(dirEntries, function(idx, entry) {\n                var idHex = entry.slice(0, 4), id = littleEndian ? parseLittleEndian(idHex) : parseInt(idHex, 16), tagsToFindIdx = tagsToFind.indexOf(id), tagValHex, tagName, tagValLength;\n                if (tagsToFindIdx >= 0) {\n                    tagName = TAG_INFO[id].name;\n                    tagValLength = TAG_INFO[id].bytes;\n                    tagValHex = entry.slice(TAG_VAL_OFFSET, TAG_VAL_OFFSET + tagValLength * 2);\n                    vals[tagName] = littleEndian ? parseLittleEndian(tagValHex) : parseInt(tagValHex, 16);\n                    tagsToFind.splice(tagsToFindIdx, 1);\n                }\n                if (tagsToFind.length === 0) {\n                    return false;\n                }\n            });\n            return vals;\n        }\n        qq.extend(this, {\n            parse: function() {\n                var parser = new qq.Promise(), onParseFailure = function(message) {\n                    log(qq.format(\"EXIF header parse failed: '{}' \", message));\n                    parser.failure(message);\n                };\n                getApp1Offset().then(function(app1Offset) {\n                    log(qq.format(\"Moving forward with EXIF header parsing for '{}'\", fileOrBlob.name === undefined ? \"blob\" : fileOrBlob.name));\n                    isLittleEndian(app1Offset).then(function(littleEndian) {\n                        log(qq.format(\"EXIF Byte order is {} endian\", littleEndian ? \"little\" : \"big\"));\n                        getDirEntryCount(app1Offset, littleEndian).then(function(dirEntryCount) {\n                            log(qq.format(\"Found {} APP1 directory entries\", dirEntryCount));\n                            getIfd(app1Offset, dirEntryCount).then(function(ifdHex) {\n                                var dirEntries = getDirEntries(ifdHex), tagValues = getTagValues(littleEndian, dirEntries);\n                                log(\"Successfully parsed some EXIF tags\");\n                                parser.success(tagValues);\n                            }, onParseFailure);\n                        }, onParseFailure);\n                    }, onParseFailure);\n                }, onParseFailure);\n                return parser;\n            }\n        });\n        this._testing = {};\n        this._testing.parseLittleEndian = parseLittleEndian;\n    };\n    qq.Identify = function(fileOrBlob, log) {\n        \"use strict\";\n        function isIdentifiable(magicBytes, questionableBytes) {\n            var identifiable = false, magicBytesEntries = [].concat(magicBytes);\n            qq.each(magicBytesEntries, function(idx, magicBytesArrayEntry) {\n                if (questionableBytes.indexOf(magicBytesArrayEntry) === 0) {\n                    identifiable = true;\n                    return false;\n                }\n            });\n            return identifiable;\n        }\n        qq.extend(this, {\n            isPreviewable: function() {\n                var self = this, identifier = new qq.Promise(), previewable = false, name = fileOrBlob.name === undefined ? \"blob\" : fileOrBlob.name;\n                log(qq.format(\"Attempting to determine if {} can be rendered in this browser\", name));\n                log(\"First pass: check type attribute of blob object.\");\n                if (this.isPreviewableSync()) {\n                    log(\"Second pass: check for magic bytes in file header.\");\n                    qq.readBlobToHex(fileOrBlob, 0, 4).then(function(hex) {\n                        qq.each(self.PREVIEWABLE_MIME_TYPES, function(mime, bytes) {\n                            if (isIdentifiable(bytes, hex)) {\n                                if (mime !== \"image/tiff\" || qq.supportedFeatures.tiffPreviews) {\n                                    previewable = true;\n                                    identifier.success(mime);\n                                }\n                                return false;\n                            }\n                        });\n                        log(qq.format(\"'{}' is {} able to be rendered in this browser\", name, previewable ? \"\" : \"NOT\"));\n                        if (!previewable) {\n                            identifier.failure();\n                        }\n                    }, function() {\n                        log(\"Error reading file w/ name '\" + name + \"'.  Not able to be rendered in this browser.\");\n                        identifier.failure();\n                    });\n                } else {\n                    identifier.failure();\n                }\n                return identifier;\n            },\n            isPreviewableSync: function() {\n                var fileMime = fileOrBlob.type, isRecognizedImage = qq.indexOf(Object.keys(this.PREVIEWABLE_MIME_TYPES), fileMime) >= 0, previewable = false, name = fileOrBlob.name === undefined ? \"blob\" : fileOrBlob.name;\n                if (isRecognizedImage) {\n                    if (fileMime === \"image/tiff\") {\n                        previewable = qq.supportedFeatures.tiffPreviews;\n                    } else {\n                        previewable = true;\n                    }\n                }\n                !previewable && log(name + \" is not previewable in this browser per the blob's type attr\");\n                return previewable;\n            }\n        });\n    };\n    qq.Identify.prototype.PREVIEWABLE_MIME_TYPES = {\n        \"image/jpeg\": \"ffd8ff\",\n        \"image/gif\": \"474946\",\n        \"image/png\": \"89504e\",\n        \"image/bmp\": \"424d\",\n        \"image/tiff\": [ \"49492a00\", \"4d4d002a\" ]\n    };\n    qq.ImageValidation = function(blob, log) {\n        \"use strict\";\n        function hasNonZeroLimits(limits) {\n            var atLeastOne = false;\n            qq.each(limits, function(limit, value) {\n                if (value > 0) {\n                    atLeastOne = true;\n                    return false;\n                }\n            });\n            return atLeastOne;\n        }\n        function getWidthHeight() {\n            var sizeDetermination = new qq.Promise();\n            new qq.Identify(blob, log).isPreviewable().then(function() {\n                var image = new Image(), url = window.URL && window.URL.createObjectURL ? window.URL : window.webkitURL && window.webkitURL.createObjectURL ? window.webkitURL : null;\n                if (url) {\n                    image.onerror = function() {\n                        log(\"Cannot determine dimensions for image.  May be too large.\", \"error\");\n                        sizeDetermination.failure();\n                    };\n                    image.onload = function() {\n                        sizeDetermination.success({\n                            width: this.width,\n                            height: this.height\n                        });\n                    };\n                    image.src = url.createObjectURL(blob);\n                } else {\n                    log(\"No createObjectURL function available to generate image URL!\", \"error\");\n                    sizeDetermination.failure();\n                }\n            }, sizeDetermination.failure);\n            return sizeDetermination;\n        }\n        function getFailingLimit(limits, dimensions) {\n            var failingLimit;\n            qq.each(limits, function(limitName, limitValue) {\n                if (limitValue > 0) {\n                    var limitMatcher = /(max|min)(Width|Height)/.exec(limitName), dimensionPropName = limitMatcher[2].charAt(0).toLowerCase() + limitMatcher[2].slice(1), actualValue = dimensions[dimensionPropName];\n                    switch (limitMatcher[1]) {\n                      case \"min\":\n                        if (actualValue < limitValue) {\n                            failingLimit = limitName;\n                            return false;\n                        }\n                        break;\n\n                      case \"max\":\n                        if (actualValue > limitValue) {\n                            failingLimit = limitName;\n                            return false;\n                        }\n                        break;\n                    }\n                }\n            });\n            return failingLimit;\n        }\n        this.validate = function(limits) {\n            var validationEffort = new qq.Promise();\n            log(\"Attempting to validate image.\");\n            if (hasNonZeroLimits(limits)) {\n                getWidthHeight().then(function(dimensions) {\n                    var failingLimit = getFailingLimit(limits, dimensions);\n                    if (failingLimit) {\n                        validationEffort.failure(failingLimit);\n                    } else {\n                        validationEffort.success();\n                    }\n                }, validationEffort.success);\n            } else {\n                validationEffort.success();\n            }\n            return validationEffort;\n        };\n    };\n    qq.Session = function(spec) {\n        \"use strict\";\n        var options = {\n            endpoint: null,\n            params: {},\n            customHeaders: {},\n            cors: {},\n            addFileRecord: function(sessionData) {},\n            log: function(message, level) {}\n        };\n        qq.extend(options, spec, true);\n        function isJsonResponseValid(response) {\n            if (qq.isArray(response)) {\n                return true;\n            }\n            options.log(\"Session response is not an array.\", \"error\");\n        }\n        function handleFileItems(fileItems, success, xhrOrXdr, promise) {\n            var someItemsIgnored = false;\n            success = success && isJsonResponseValid(fileItems);\n            if (success) {\n                qq.each(fileItems, function(idx, fileItem) {\n                    if (fileItem.uuid == null) {\n                        someItemsIgnored = true;\n                        options.log(qq.format(\"Session response item {} did not include a valid UUID - ignoring.\", idx), \"error\");\n                    } else if (fileItem.name == null) {\n                        someItemsIgnored = true;\n                        options.log(qq.format(\"Session response item {} did not include a valid name - ignoring.\", idx), \"error\");\n                    } else {\n                        try {\n                            options.addFileRecord(fileItem);\n                            return true;\n                        } catch (err) {\n                            someItemsIgnored = true;\n                            options.log(err.message, \"error\");\n                        }\n                    }\n                    return false;\n                });\n            }\n            promise[success && !someItemsIgnored ? \"success\" : \"failure\"](fileItems, xhrOrXdr);\n        }\n        this.refresh = function() {\n            var refreshEffort = new qq.Promise(), refreshCompleteCallback = function(response, success, xhrOrXdr) {\n                handleFileItems(response, success, xhrOrXdr, refreshEffort);\n            }, requesterOptions = qq.extend({}, options), requester = new qq.SessionAjaxRequester(qq.extend(requesterOptions, {\n                onComplete: refreshCompleteCallback\n            }));\n            requester.queryServer();\n            return refreshEffort;\n        };\n    };\n    qq.SessionAjaxRequester = function(spec) {\n        \"use strict\";\n        var requester, options = {\n            endpoint: null,\n            customHeaders: {},\n            params: {},\n            cors: {\n                expected: false,\n                sendCredentials: false\n            },\n            onComplete: function(response, success, xhrOrXdr) {},\n            log: function(str, level) {}\n        };\n        qq.extend(options, spec);\n        function onComplete(id, xhrOrXdr, isError) {\n            var response = null;\n            if (xhrOrXdr.responseText != null) {\n                try {\n                    response = qq.parseJson(xhrOrXdr.responseText);\n                } catch (err) {\n                    options.log(\"Problem parsing session response: \" + err.message, \"error\");\n                    isError = true;\n                }\n            }\n            options.onComplete(response, !isError, xhrOrXdr);\n        }\n        requester = qq.extend(this, new qq.AjaxRequester({\n            acceptHeader: \"application/json\",\n            validMethods: [ \"GET\" ],\n            method: \"GET\",\n            endpointStore: {\n                get: function() {\n                    return options.endpoint;\n                }\n            },\n            customHeaders: options.customHeaders,\n            log: options.log,\n            onComplete: onComplete,\n            cors: options.cors\n        }));\n        qq.extend(this, {\n            queryServer: function() {\n                var params = qq.extend({}, options.params);\n                options.log(\"Session query request.\");\n                requester.initTransport(\"sessionRefresh\").withParams(params).withCacheBuster().send();\n            }\n        });\n    };\n    qq.Scaler = function(spec, log) {\n        \"use strict\";\n        var self = this, customResizeFunction = spec.customResizer, includeOriginal = spec.sendOriginal, orient = spec.orient, defaultType = spec.defaultType, defaultQuality = spec.defaultQuality / 100, failedToScaleText = spec.failureText, includeExif = spec.includeExif, sizes = this._getSortedSizes(spec.sizes);\n        qq.extend(this, {\n            enabled: qq.supportedFeatures.scaling && sizes.length > 0,\n            getFileRecords: function(originalFileUuid, originalFileName, originalBlobOrBlobData) {\n                var self = this, records = [], originalBlob = originalBlobOrBlobData.blob ? originalBlobOrBlobData.blob : originalBlobOrBlobData, identifier = new qq.Identify(originalBlob, log);\n                if (identifier.isPreviewableSync()) {\n                    qq.each(sizes, function(idx, sizeRecord) {\n                        var outputType = self._determineOutputType({\n                            defaultType: defaultType,\n                            requestedType: sizeRecord.type,\n                            refType: originalBlob.type\n                        });\n                        records.push({\n                            uuid: qq.getUniqueId(),\n                            name: self._getName(originalFileName, {\n                                name: sizeRecord.name,\n                                type: outputType,\n                                refType: originalBlob.type\n                            }),\n                            blob: new qq.BlobProxy(originalBlob, qq.bind(self._generateScaledImage, self, {\n                                customResizeFunction: customResizeFunction,\n                                maxSize: sizeRecord.maxSize,\n                                orient: orient,\n                                type: outputType,\n                                quality: defaultQuality,\n                                failedText: failedToScaleText,\n                                includeExif: includeExif,\n                                log: log\n                            }))\n                        });\n                    });\n                    records.push({\n                        uuid: originalFileUuid,\n                        name: originalFileName,\n                        size: originalBlob.size,\n                        blob: includeOriginal ? originalBlob : null\n                    });\n                } else {\n                    records.push({\n                        uuid: originalFileUuid,\n                        name: originalFileName,\n                        size: originalBlob.size,\n                        blob: originalBlob\n                    });\n                }\n                return records;\n            },\n            handleNewFile: function(file, name, uuid, size, fileList, batchId, uuidParamName, api) {\n                var self = this, buttonId = file.qqButtonId || file.blob && file.blob.qqButtonId, scaledIds = [], originalId = null, addFileToHandler = api.addFileToHandler, uploadData = api.uploadData, paramsStore = api.paramsStore, proxyGroupId = qq.getUniqueId();\n                qq.each(self.getFileRecords(uuid, name, file), function(idx, record) {\n                    var blobSize = record.size, id;\n                    if (record.blob instanceof qq.BlobProxy) {\n                        blobSize = -1;\n                    }\n                    id = uploadData.addFile({\n                        uuid: record.uuid,\n                        name: record.name,\n                        size: blobSize,\n                        batchId: batchId,\n                        proxyGroupId: proxyGroupId\n                    });\n                    if (record.blob instanceof qq.BlobProxy) {\n                        scaledIds.push(id);\n                    } else {\n                        originalId = id;\n                    }\n                    if (record.blob) {\n                        addFileToHandler(id, record.blob);\n                        fileList.push({\n                            id: id,\n                            file: record.blob\n                        });\n                    } else {\n                        uploadData.setStatus(id, qq.status.REJECTED);\n                    }\n                });\n                if (originalId !== null) {\n                    qq.each(scaledIds, function(idx, scaledId) {\n                        var params = {\n                            qqparentuuid: uploadData.retrieve({\n                                id: originalId\n                            }).uuid,\n                            qqparentsize: uploadData.retrieve({\n                                id: originalId\n                            }).size\n                        };\n                        params[uuidParamName] = uploadData.retrieve({\n                            id: scaledId\n                        }).uuid;\n                        uploadData.setParentId(scaledId, originalId);\n                        paramsStore.addReadOnly(scaledId, params);\n                    });\n                    if (scaledIds.length) {\n                        (function() {\n                            var param = {};\n                            param[uuidParamName] = uploadData.retrieve({\n                                id: originalId\n                            }).uuid;\n                            paramsStore.addReadOnly(originalId, param);\n                        })();\n                    }\n                }\n            }\n        });\n    };\n    qq.extend(qq.Scaler.prototype, {\n        scaleImage: function(id, specs, api) {\n            \"use strict\";\n            if (!qq.supportedFeatures.scaling) {\n                throw new qq.Error(\"Scaling is not supported in this browser!\");\n            }\n            var scalingEffort = new qq.Promise(), log = api.log, file = api.getFile(id), uploadData = api.uploadData.retrieve({\n                id: id\n            }), name = uploadData && uploadData.name, uuid = uploadData && uploadData.uuid, scalingOptions = {\n                customResizer: specs.customResizer,\n                sendOriginal: false,\n                orient: specs.orient,\n                defaultType: specs.type || null,\n                defaultQuality: specs.quality,\n                failedToScaleText: \"Unable to scale\",\n                sizes: [ {\n                    name: \"\",\n                    maxSize: specs.maxSize\n                } ]\n            }, scaler = new qq.Scaler(scalingOptions, log);\n            if (!qq.Scaler || !qq.supportedFeatures.imagePreviews || !file) {\n                scalingEffort.failure();\n                log(\"Could not generate requested scaled image for \" + id + \".  \" + \"Scaling is either not possible in this browser, or the file could not be located.\", \"error\");\n            } else {\n                qq.bind(function() {\n                    var record = scaler.getFileRecords(uuid, name, file)[0];\n                    if (record && record.blob instanceof qq.BlobProxy) {\n                        record.blob.create().then(scalingEffort.success, scalingEffort.failure);\n                    } else {\n                        log(id + \" is not a scalable image!\", \"error\");\n                        scalingEffort.failure();\n                    }\n                }, this)();\n            }\n            return scalingEffort;\n        },\n        _determineOutputType: function(spec) {\n            \"use strict\";\n            var requestedType = spec.requestedType, defaultType = spec.defaultType, referenceType = spec.refType;\n            if (!defaultType && !requestedType) {\n                if (referenceType !== \"image/jpeg\") {\n                    return \"image/png\";\n                }\n                return referenceType;\n            }\n            if (!requestedType) {\n                return defaultType;\n            }\n            if (qq.indexOf(Object.keys(qq.Identify.prototype.PREVIEWABLE_MIME_TYPES), requestedType) >= 0) {\n                if (requestedType === \"image/tiff\") {\n                    return qq.supportedFeatures.tiffPreviews ? requestedType : defaultType;\n                }\n                return requestedType;\n            }\n            return defaultType;\n        },\n        _getName: function(originalName, scaledVersionProperties) {\n            \"use strict\";\n            var startOfExt = originalName.lastIndexOf(\".\"), versionType = scaledVersionProperties.type || \"image/png\", referenceType = scaledVersionProperties.refType, scaledName = \"\", scaledExt = qq.getExtension(originalName), nameAppendage = \"\";\n            if (scaledVersionProperties.name && scaledVersionProperties.name.trim().length) {\n                nameAppendage = \" (\" + scaledVersionProperties.name + \")\";\n            }\n            if (startOfExt >= 0) {\n                scaledName = originalName.substr(0, startOfExt);\n                if (referenceType !== versionType) {\n                    scaledExt = versionType.split(\"/\")[1];\n                }\n                scaledName += nameAppendage + \".\" + scaledExt;\n            } else {\n                scaledName = originalName + nameAppendage;\n            }\n            return scaledName;\n        },\n        _getSortedSizes: function(sizes) {\n            \"use strict\";\n            sizes = qq.extend([], sizes);\n            return sizes.sort(function(a, b) {\n                if (a.maxSize > b.maxSize) {\n                    return 1;\n                }\n                if (a.maxSize < b.maxSize) {\n                    return -1;\n                }\n                return 0;\n            });\n        },\n        _generateScaledImage: function(spec, sourceFile) {\n            \"use strict\";\n            var self = this, customResizeFunction = spec.customResizeFunction, log = spec.log, maxSize = spec.maxSize, orient = spec.orient, type = spec.type, quality = spec.quality, failedText = spec.failedText, includeExif = spec.includeExif && sourceFile.type === \"image/jpeg\" && type === \"image/jpeg\", scalingEffort = new qq.Promise(), imageGenerator = new qq.ImageGenerator(log), canvas = document.createElement(\"canvas\");\n            log(\"Attempting to generate scaled version for \" + sourceFile.name);\n            imageGenerator.generate(sourceFile, canvas, {\n                maxSize: maxSize,\n                orient: orient,\n                customResizeFunction: customResizeFunction\n            }).then(function() {\n                var scaledImageDataUri = canvas.toDataURL(type, quality), signalSuccess = function() {\n                    log(\"Success generating scaled version for \" + sourceFile.name);\n                    var blob = qq.dataUriToBlob(scaledImageDataUri);\n                    scalingEffort.success(blob);\n                };\n                if (includeExif) {\n                    self._insertExifHeader(sourceFile, scaledImageDataUri, log).then(function(scaledImageDataUriWithExif) {\n                        scaledImageDataUri = scaledImageDataUriWithExif;\n                        signalSuccess();\n                    }, function() {\n                        log(\"Problem inserting EXIF header into scaled image.  Using scaled image w/out EXIF data.\", \"error\");\n                        signalSuccess();\n                    });\n                } else {\n                    signalSuccess();\n                }\n            }, function() {\n                log(\"Failed attempt to generate scaled version for \" + sourceFile.name, \"error\");\n                scalingEffort.failure(failedText);\n            });\n            return scalingEffort;\n        },\n        _insertExifHeader: function(originalImage, scaledImageDataUri, log) {\n            \"use strict\";\n            var reader = new FileReader(), insertionEffort = new qq.Promise(), originalImageDataUri = \"\";\n            reader.onload = function() {\n                originalImageDataUri = reader.result;\n                insertionEffort.success(qq.ExifRestorer.restore(originalImageDataUri, scaledImageDataUri));\n            };\n            reader.onerror = function() {\n                log(\"Problem reading \" + originalImage.name + \" during attempt to transfer EXIF data to scaled version.\", \"error\");\n                insertionEffort.failure();\n            };\n            reader.readAsDataURL(originalImage);\n            return insertionEffort;\n        },\n        _dataUriToBlob: function(dataUri) {\n            \"use strict\";\n            var byteString, mimeString, arrayBuffer, intArray;\n            if (dataUri.split(\",\")[0].indexOf(\"base64\") >= 0) {\n                byteString = atob(dataUri.split(\",\")[1]);\n            } else {\n                byteString = decodeURI(dataUri.split(\",\")[1]);\n            }\n            mimeString = dataUri.split(\",\")[0].split(\":\")[1].split(\";\")[0];\n            arrayBuffer = new ArrayBuffer(byteString.length);\n            intArray = new Uint8Array(arrayBuffer);\n            qq.each(byteString, function(idx, character) {\n                intArray[idx] = character.charCodeAt(0);\n            });\n            return this._createBlob(arrayBuffer, mimeString);\n        },\n        _createBlob: function(data, mime) {\n            \"use strict\";\n            var BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder, blobBuilder = BlobBuilder && new BlobBuilder();\n            if (blobBuilder) {\n                blobBuilder.append(data);\n                return blobBuilder.getBlob(mime);\n            } else {\n                return new Blob([ data ], {\n                    type: mime\n                });\n            }\n        }\n    });\n    qq.ExifRestorer = function() {\n        var ExifRestorer = {};\n        ExifRestorer.KEY_STR = \"ABCDEFGHIJKLMNOP\" + \"QRSTUVWXYZabcdef\" + \"ghijklmnopqrstuv\" + \"wxyz0123456789+/\" + \"=\";\n        ExifRestorer.encode64 = function(input) {\n            var output = \"\", chr1, chr2, chr3 = \"\", enc1, enc2, enc3, enc4 = \"\", i = 0;\n            do {\n                chr1 = input[i++];\n                chr2 = input[i++];\n                chr3 = input[i++];\n                enc1 = chr1 >> 2;\n                enc2 = (chr1 & 3) << 4 | chr2 >> 4;\n                enc3 = (chr2 & 15) << 2 | chr3 >> 6;\n                enc4 = chr3 & 63;\n                if (isNaN(chr2)) {\n                    enc3 = enc4 = 64;\n                } else if (isNaN(chr3)) {\n                    enc4 = 64;\n                }\n                output = output + this.KEY_STR.charAt(enc1) + this.KEY_STR.charAt(enc2) + this.KEY_STR.charAt(enc3) + this.KEY_STR.charAt(enc4);\n                chr1 = chr2 = chr3 = \"\";\n                enc1 = enc2 = enc3 = enc4 = \"\";\n            } while (i < input.length);\n            return output;\n        };\n        ExifRestorer.restore = function(origFileBase64, resizedFileBase64) {\n            var expectedBase64Header = \"data:image/jpeg;base64,\";\n            if (!origFileBase64.match(expectedBase64Header)) {\n                return resizedFileBase64;\n            }\n            var rawImage = this.decode64(origFileBase64.replace(expectedBase64Header, \"\"));\n            var segments = this.slice2Segments(rawImage);\n            var image = this.exifManipulation(resizedFileBase64, segments);\n            return expectedBase64Header + this.encode64(image);\n        };\n        ExifRestorer.exifManipulation = function(resizedFileBase64, segments) {\n            var exifArray = this.getExifArray(segments), newImageArray = this.insertExif(resizedFileBase64, exifArray), aBuffer = new Uint8Array(newImageArray);\n            return aBuffer;\n        };\n        ExifRestorer.getExifArray = function(segments) {\n            var seg;\n            for (var x = 0; x < segments.length; x++) {\n                seg = segments[x];\n                if (seg[0] == 255 & seg[1] == 225) {\n                    return seg;\n                }\n            }\n            return [];\n        };\n        ExifRestorer.insertExif = function(resizedFileBase64, exifArray) {\n            var imageData = resizedFileBase64.replace(\"data:image/jpeg;base64,\", \"\"), buf = this.decode64(imageData), separatePoint = buf.indexOf(255, 3), mae = buf.slice(0, separatePoint), ato = buf.slice(separatePoint), array = mae;\n            array = array.concat(exifArray);\n            array = array.concat(ato);\n            return array;\n        };\n        ExifRestorer.slice2Segments = function(rawImageArray) {\n            var head = 0, segments = [];\n            while (1) {\n                if (rawImageArray[head] == 255 & rawImageArray[head + 1] == 218) {\n                    break;\n                }\n                if (rawImageArray[head] == 255 & rawImageArray[head + 1] == 216) {\n                    head += 2;\n                } else {\n                    var length = rawImageArray[head + 2] * 256 + rawImageArray[head + 3], endPoint = head + length + 2, seg = rawImageArray.slice(head, endPoint);\n                    segments.push(seg);\n                    head = endPoint;\n                }\n                if (head > rawImageArray.length) {\n                    break;\n                }\n            }\n            return segments;\n        };\n        ExifRestorer.decode64 = function(input) {\n            var output = \"\", chr1, chr2, chr3 = \"\", enc1, enc2, enc3, enc4 = \"\", i = 0, buf = [];\n            var base64test = /[^A-Za-z0-9\\+\\/\\=]/g;\n            if (base64test.exec(input)) {\n                throw new Error(\"There were invalid base64 characters in the input text.  \" + \"Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\");\n            }\n            input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n            do {\n                enc1 = this.KEY_STR.indexOf(input.charAt(i++));\n                enc2 = this.KEY_STR.indexOf(input.charAt(i++));\n                enc3 = this.KEY_STR.indexOf(input.charAt(i++));\n                enc4 = this.KEY_STR.indexOf(input.charAt(i++));\n                chr1 = enc1 << 2 | enc2 >> 4;\n                chr2 = (enc2 & 15) << 4 | enc3 >> 2;\n                chr3 = (enc3 & 3) << 6 | enc4;\n                buf.push(chr1);\n                if (enc3 != 64) {\n                    buf.push(chr2);\n                }\n                if (enc4 != 64) {\n                    buf.push(chr3);\n                }\n                chr1 = chr2 = chr3 = \"\";\n                enc1 = enc2 = enc3 = enc4 = \"\";\n            } while (i < input.length);\n            return buf;\n        };\n        return ExifRestorer;\n    }();\n    qq.TotalProgress = function(callback, getSize) {\n        \"use strict\";\n        var perFileProgress = {}, totalLoaded = 0, totalSize = 0, lastLoadedSent = -1, lastTotalSent = -1, callbackProxy = function(loaded, total) {\n            if (loaded !== lastLoadedSent || total !== lastTotalSent) {\n                callback(loaded, total);\n            }\n            lastLoadedSent = loaded;\n            lastTotalSent = total;\n        }, noRetryableFiles = function(failed, retryable) {\n            var none = true;\n            qq.each(failed, function(idx, failedId) {\n                if (qq.indexOf(retryable, failedId) >= 0) {\n                    none = false;\n                    return false;\n                }\n            });\n            return none;\n        }, onCancel = function(id) {\n            updateTotalProgress(id, -1, -1);\n            delete perFileProgress[id];\n        }, onAllComplete = function(successful, failed, retryable) {\n            if (failed.length === 0 || noRetryableFiles(failed, retryable)) {\n                callbackProxy(totalSize, totalSize);\n                this.reset();\n            }\n        }, onNew = function(id) {\n            var size = getSize(id);\n            if (size > 0) {\n                updateTotalProgress(id, 0, size);\n                perFileProgress[id] = {\n                    loaded: 0,\n                    total: size\n                };\n            }\n        }, updateTotalProgress = function(id, newLoaded, newTotal) {\n            var oldLoaded = perFileProgress[id] ? perFileProgress[id].loaded : 0, oldTotal = perFileProgress[id] ? perFileProgress[id].total : 0;\n            if (newLoaded === -1 && newTotal === -1) {\n                totalLoaded -= oldLoaded;\n                totalSize -= oldTotal;\n            } else {\n                if (newLoaded) {\n                    totalLoaded += newLoaded - oldLoaded;\n                }\n                if (newTotal) {\n                    totalSize += newTotal - oldTotal;\n                }\n            }\n            callbackProxy(totalLoaded, totalSize);\n        };\n        qq.extend(this, {\n            onAllComplete: onAllComplete,\n            onStatusChange: function(id, oldStatus, newStatus) {\n                if (newStatus === qq.status.CANCELED || newStatus === qq.status.REJECTED) {\n                    onCancel(id);\n                } else if (newStatus === qq.status.SUBMITTING) {\n                    onNew(id);\n                }\n            },\n            onIndividualProgress: function(id, loaded, total) {\n                updateTotalProgress(id, loaded, total);\n                perFileProgress[id] = {\n                    loaded: loaded,\n                    total: total\n                };\n            },\n            onNewSize: function(id) {\n                onNew(id);\n            },\n            reset: function() {\n                perFileProgress = {};\n                totalLoaded = 0;\n                totalSize = 0;\n            }\n        });\n    };\n    qq.PasteSupport = function(o) {\n        \"use strict\";\n        var options, detachPasteHandler;\n        options = {\n            targetElement: null,\n            callbacks: {\n                log: function(message, level) {},\n                pasteReceived: function(blob) {}\n            }\n        };\n        function isImage(item) {\n            return item.type && item.type.indexOf(\"image/\") === 0;\n        }\n        function registerPasteHandler() {\n            detachPasteHandler = qq(options.targetElement).attach(\"paste\", function(event) {\n                var clipboardData = event.clipboardData;\n                if (clipboardData) {\n                    qq.each(clipboardData.items, function(idx, item) {\n                        if (isImage(item)) {\n                            var blob = item.getAsFile();\n                            options.callbacks.pasteReceived(blob);\n                        }\n                    });\n                }\n            });\n        }\n        function unregisterPasteHandler() {\n            if (detachPasteHandler) {\n                detachPasteHandler();\n            }\n        }\n        qq.extend(options, o);\n        registerPasteHandler();\n        qq.extend(this, {\n            reset: function() {\n                unregisterPasteHandler();\n            }\n        });\n    };\n    qq.FormSupport = function(options, startUpload, log) {\n        \"use strict\";\n        var self = this, interceptSubmit = options.interceptSubmit, formEl = options.element, autoUpload = options.autoUpload;\n        qq.extend(this, {\n            newEndpoint: null,\n            newAutoUpload: autoUpload,\n            attachedToForm: false,\n            getFormInputsAsObject: function() {\n                if (formEl == null) {\n                    return null;\n                }\n                return self._form2Obj(formEl);\n            }\n        });\n        function determineNewEndpoint(formEl) {\n            if (formEl.getAttribute(\"action\")) {\n                self.newEndpoint = formEl.getAttribute(\"action\");\n            }\n        }\n        function validateForm(formEl, nativeSubmit) {\n            if (formEl.checkValidity && !formEl.checkValidity()) {\n                log(\"Form did not pass validation checks - will not upload.\", \"error\");\n                nativeSubmit();\n            } else {\n                return true;\n            }\n        }\n        function maybeUploadOnSubmit(formEl) {\n            var nativeSubmit = formEl.submit;\n            qq(formEl).attach(\"submit\", function(event) {\n                event = event || window.event;\n                if (event.preventDefault) {\n                    event.preventDefault();\n                } else {\n                    event.returnValue = false;\n                }\n                validateForm(formEl, nativeSubmit) && startUpload();\n            });\n            formEl.submit = function() {\n                validateForm(formEl, nativeSubmit) && startUpload();\n            };\n        }\n        function determineFormEl(formEl) {\n            if (formEl) {\n                if (qq.isString(formEl)) {\n                    formEl = document.getElementById(formEl);\n                }\n                if (formEl) {\n                    log(\"Attaching to form element.\");\n                    determineNewEndpoint(formEl);\n                    interceptSubmit && maybeUploadOnSubmit(formEl);\n                }\n            }\n            return formEl;\n        }\n        formEl = determineFormEl(formEl);\n        this.attachedToForm = !!formEl;\n    };\n    qq.extend(qq.FormSupport.prototype, {\n        _form2Obj: function(form) {\n            \"use strict\";\n            var obj = {}, notIrrelevantType = function(type) {\n                var irrelevantTypes = [ \"button\", \"image\", \"reset\", \"submit\" ];\n                return qq.indexOf(irrelevantTypes, type.toLowerCase()) < 0;\n            }, radioOrCheckbox = function(type) {\n                return qq.indexOf([ \"checkbox\", \"radio\" ], type.toLowerCase()) >= 0;\n            }, ignoreValue = function(el) {\n                if (radioOrCheckbox(el.type) && !el.checked) {\n                    return true;\n                }\n                return el.disabled && el.type.toLowerCase() !== \"hidden\";\n            }, selectValue = function(select) {\n                var value = null;\n                qq.each(qq(select).children(), function(idx, child) {\n                    if (child.tagName.toLowerCase() === \"option\" && child.selected) {\n                        value = child.value;\n                        return false;\n                    }\n                });\n                return value;\n            };\n            qq.each(form.elements, function(idx, el) {\n                if ((qq.isInput(el, true) || el.tagName.toLowerCase() === \"textarea\") && notIrrelevantType(el.type) && !ignoreValue(el)) {\n                    obj[el.name] = el.value;\n                } else if (el.tagName.toLowerCase() === \"select\" && !ignoreValue(el)) {\n                    var value = selectValue(el);\n                    if (value !== null) {\n                        obj[el.name] = value;\n                    }\n                }\n            });\n            return obj;\n        }\n    });\n    qq.traditional = qq.traditional || {};\n    qq.traditional.FormUploadHandler = function(options, proxy) {\n        \"use strict\";\n        var handler = this, getName = proxy.getName, getUuid = proxy.getUuid, log = proxy.log;\n        function getIframeContentJson(id, iframe) {\n            var response, doc, innerHtml;\n            try {\n                doc = iframe.contentDocument || iframe.contentWindow.document;\n                innerHtml = doc.body.innerHTML;\n                log(\"converting iframe's innerHTML to JSON\");\n                log(\"innerHTML = \" + innerHtml);\n                if (innerHtml && innerHtml.match(/^<pre/i)) {\n                    innerHtml = doc.body.firstChild.firstChild.nodeValue;\n                }\n                response = handler._parseJsonResponse(innerHtml);\n            } catch (error) {\n                log(\"Error when attempting to parse form upload response (\" + error.message + \")\", \"error\");\n                response = {\n                    success: false\n                };\n            }\n            return response;\n        }\n        function createForm(id, iframe) {\n            var params = options.paramsStore.get(id), method = options.method.toLowerCase() === \"get\" ? \"GET\" : \"POST\", endpoint = options.endpointStore.get(id), name = getName(id);\n            params[options.uuidName] = getUuid(id);\n            params[options.filenameParam] = name;\n            return handler._initFormForUpload({\n                method: method,\n                endpoint: endpoint,\n                params: params,\n                paramsInBody: options.paramsInBody,\n                targetName: iframe.name\n            });\n        }\n        this.uploadFile = function(id) {\n            var input = handler.getInput(id), iframe = handler._createIframe(id), promise = new qq.Promise(), form;\n            form = createForm(id, iframe);\n            form.appendChild(input);\n            handler._attachLoadEvent(iframe, function(responseFromMessage) {\n                log(\"iframe loaded\");\n                var response = responseFromMessage ? responseFromMessage : getIframeContentJson(id, iframe);\n                handler._detachLoadEvent(id);\n                if (!options.cors.expected) {\n                    qq(iframe).remove();\n                }\n                if (response.success) {\n                    promise.success(response);\n                } else {\n                    promise.failure(response);\n                }\n            });\n            log(\"Sending upload request for \" + id);\n            form.submit();\n            qq(form).remove();\n            return promise;\n        };\n        qq.extend(this, new qq.FormUploadHandler({\n            options: {\n                isCors: options.cors.expected,\n                inputName: options.inputName\n            },\n            proxy: {\n                onCancel: options.onCancel,\n                getName: getName,\n                getUuid: getUuid,\n                log: log\n            }\n        }));\n    };\n    qq.traditional = qq.traditional || {};\n    qq.traditional.XhrUploadHandler = function(spec, proxy) {\n        \"use strict\";\n        var handler = this, getName = proxy.getName, getSize = proxy.getSize, getUuid = proxy.getUuid, log = proxy.log, multipart = spec.forceMultipart || spec.paramsInBody, addChunkingSpecificParams = function(id, params, chunkData) {\n            var size = getSize(id), name = getName(id);\n            if (!spec.omitDefaultParams) {\n                params[spec.chunking.paramNames.partIndex] = chunkData.part;\n                params[spec.chunking.paramNames.partByteOffset] = chunkData.start;\n                params[spec.chunking.paramNames.chunkSize] = chunkData.size;\n                params[spec.chunking.paramNames.totalParts] = chunkData.count;\n                params[spec.totalFileSizeName] = size;\n            }\n            if (multipart && !spec.omitDefaultParams) {\n                params[spec.filenameParam] = name;\n            }\n        }, allChunksDoneRequester = new qq.traditional.AllChunksDoneAjaxRequester({\n            cors: spec.cors,\n            endpoint: spec.chunking.success.endpoint,\n            headers: spec.chunking.success.headers,\n            jsonPayload: spec.chunking.success.jsonPayload,\n            log: log,\n            method: spec.chunking.success.method,\n            params: spec.chunking.success.params\n        }), createReadyStateChangedHandler = function(id, xhr) {\n            var promise = new qq.Promise();\n            xhr.onreadystatechange = function() {\n                if (xhr.readyState === 4) {\n                    var result = onUploadOrChunkComplete(id, xhr);\n                    if (result.success) {\n                        promise.success(result.response, xhr);\n                    } else {\n                        promise.failure(result.response, xhr);\n                    }\n                }\n            };\n            return promise;\n        }, getChunksCompleteParams = function(id) {\n            var params = spec.paramsStore.get(id), name = getName(id), size = getSize(id);\n            params[spec.uuidName] = getUuid(id);\n            params[spec.filenameParam] = name;\n            params[spec.totalFileSizeName] = size;\n            params[spec.chunking.paramNames.totalParts] = handler._getTotalChunks(id);\n            return params;\n        }, isErrorUploadResponse = function(xhr, response) {\n            return qq.indexOf([ 200, 201, 202, 203, 204 ], xhr.status) < 0 || spec.requireSuccessJson && !response.success || response.reset;\n        }, onUploadOrChunkComplete = function(id, xhr) {\n            var response;\n            log(\"xhr - server response received for \" + id);\n            log(\"responseText = \" + xhr.responseText);\n            response = parseResponse(true, xhr);\n            return {\n                success: !isErrorUploadResponse(xhr, response),\n                response: response\n            };\n        }, parseResponse = function(upload, xhr) {\n            var response = {};\n            try {\n                log(qq.format(\"Received response status {} with body: {}\", xhr.status, xhr.responseText));\n                response = qq.parseJson(xhr.responseText);\n            } catch (error) {\n                upload && spec.requireSuccessJson && log(\"Error when attempting to parse xhr response text (\" + error.message + \")\", \"error\");\n            }\n            return response;\n        }, sendChunksCompleteRequest = function(id) {\n            var promise = new qq.Promise();\n            allChunksDoneRequester.complete(id, handler._createXhr(id), getChunksCompleteParams(id), spec.customHeaders.get(id)).then(function(xhr) {\n                promise.success(parseResponse(false, xhr), xhr);\n            }, function(xhr) {\n                promise.failure(parseResponse(false, xhr), xhr);\n            });\n            return promise;\n        }, setParamsAndGetEntityToSend = function(entityToSendParams) {\n            var fileOrBlob = entityToSendParams.fileOrBlob;\n            var id = entityToSendParams.id;\n            var xhr = entityToSendParams.xhr;\n            var xhrOverrides = entityToSendParams.xhrOverrides || {};\n            var customParams = entityToSendParams.customParams || {};\n            var defaultParams = entityToSendParams.params || {};\n            var xhrOverrideParams = xhrOverrides.params || {};\n            var params;\n            var formData = multipart ? new FormData() : null, method = xhrOverrides.method || spec.method, endpoint = xhrOverrides.endpoint || spec.endpointStore.get(id), name = getName(id), size = getSize(id);\n            if (spec.omitDefaultParams) {\n                params = qq.extend({}, customParams);\n                qq.extend(params, xhrOverrideParams);\n            } else {\n                params = qq.extend({}, customParams);\n                qq.extend(params, xhrOverrideParams);\n                qq.extend(params, defaultParams);\n                params[spec.uuidName] = getUuid(id);\n                params[spec.filenameParam] = name;\n                if (multipart) {\n                    params[spec.totalFileSizeName] = size;\n                } else if (!spec.paramsInBody) {\n                    params[spec.inputName] = name;\n                }\n            }\n            if (!spec.paramsInBody) {\n                endpoint = qq.obj2url(params, endpoint);\n            }\n            xhr.open(method, endpoint, true);\n            if (spec.cors.expected && spec.cors.sendCredentials) {\n                xhr.withCredentials = true;\n            }\n            if (multipart) {\n                if (spec.paramsInBody) {\n                    qq.obj2FormData(params, formData);\n                }\n                formData.append(spec.inputName, fileOrBlob);\n                return formData;\n            }\n            return fileOrBlob;\n        }, setUploadHeaders = function(headersOptions) {\n            var headerOverrides = headersOptions.headerOverrides;\n            var id = headersOptions.id;\n            var xhr = headersOptions.xhr;\n            if (headerOverrides) {\n                qq.each(headerOverrides, function(headerName, headerValue) {\n                    xhr.setRequestHeader(headerName, headerValue);\n                });\n            } else {\n                var extraHeaders = spec.customHeaders.get(id), fileOrBlob = handler.getFile(id);\n                xhr.setRequestHeader(\"Accept\", \"application/json\");\n                xhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n                xhr.setRequestHeader(\"Cache-Control\", \"no-cache\");\n                if (!multipart) {\n                    xhr.setRequestHeader(\"Content-Type\", \"application/octet-stream\");\n                    xhr.setRequestHeader(\"X-Mime-Type\", fileOrBlob.type);\n                }\n                qq.each(extraHeaders, function(name, val) {\n                    xhr.setRequestHeader(name, val);\n                });\n            }\n        };\n        qq.extend(this, {\n            uploadChunk: function(uploadChunkParams) {\n                var id = uploadChunkParams.id;\n                var chunkIdx = uploadChunkParams.chunkIdx;\n                var overrides = uploadChunkParams.overrides || {};\n                var resuming = uploadChunkParams.resuming;\n                var chunkData = handler._getChunkData(id, chunkIdx), xhr = handler._createXhr(id, chunkIdx), promise, toSend, customParams, params = {};\n                promise = createReadyStateChangedHandler(id, xhr);\n                handler._registerProgressHandler(id, chunkIdx, chunkData.size);\n                customParams = spec.paramsStore.get(id);\n                addChunkingSpecificParams(id, params, chunkData);\n                if (resuming) {\n                    params[spec.resume.paramNames.resuming] = true;\n                }\n                toSend = setParamsAndGetEntityToSend({\n                    fileOrBlob: chunkData.blob,\n                    id: id,\n                    customParams: customParams,\n                    params: params,\n                    xhr: xhr,\n                    xhrOverrides: overrides\n                });\n                setUploadHeaders({\n                    headerOverrides: overrides.headers,\n                    id: id,\n                    xhr: xhr\n                });\n                xhr.send(toSend);\n                return promise;\n            },\n            uploadFile: function(id) {\n                var fileOrBlob = handler.getFile(id), promise, xhr, customParams, toSend;\n                xhr = handler._createXhr(id);\n                handler._registerProgressHandler(id);\n                promise = createReadyStateChangedHandler(id, xhr);\n                customParams = spec.paramsStore.get(id);\n                toSend = setParamsAndGetEntityToSend({\n                    fileOrBlob: fileOrBlob,\n                    id: id,\n                    customParams: customParams,\n                    xhr: xhr\n                });\n                setUploadHeaders({\n                    id: id,\n                    xhr: xhr\n                });\n                xhr.send(toSend);\n                return promise;\n            }\n        });\n        qq.extend(this, new qq.XhrUploadHandler({\n            options: qq.extend({\n                namespace: \"traditional\"\n            }, spec),\n            proxy: qq.extend({\n                getEndpoint: spec.endpointStore.get\n            }, proxy)\n        }));\n        qq.override(this, function(super_) {\n            return {\n                finalizeChunks: function(id) {\n                    proxy.onFinalizing(id);\n                    if (spec.chunking.success.endpoint) {\n                        return sendChunksCompleteRequest(id);\n                    } else {\n                        return super_.finalizeChunks(id, qq.bind(parseResponse, this, true));\n                    }\n                }\n            };\n        });\n    };\n    qq.traditional.AllChunksDoneAjaxRequester = function(o) {\n        \"use strict\";\n        var requester, options = {\n            cors: {\n                allowXdr: false,\n                expected: false,\n                sendCredentials: false\n            },\n            endpoint: null,\n            log: function(str, level) {},\n            method: \"POST\"\n        }, promises = {}, endpointHandler = {\n            get: function(id) {\n                if (qq.isFunction(options.endpoint)) {\n                    return options.endpoint(id);\n                }\n                return options.endpoint;\n            }\n        };\n        qq.extend(options, o);\n        requester = qq.extend(this, new qq.AjaxRequester({\n            acceptHeader: \"application/json\",\n            contentType: options.jsonPayload ? \"application/json\" : \"application/x-www-form-urlencoded\",\n            validMethods: [ options.method ],\n            method: options.method,\n            endpointStore: endpointHandler,\n            allowXRequestedWithAndCacheControl: false,\n            cors: options.cors,\n            log: options.log,\n            onComplete: function(id, xhr, isError) {\n                var promise = promises[id];\n                delete promises[id];\n                if (isError) {\n                    promise.failure(xhr);\n                } else {\n                    promise.success(xhr);\n                }\n            }\n        }));\n        qq.extend(this, {\n            complete: function(id, xhr, params, headers) {\n                var promise = new qq.Promise();\n                options.log(\"Submitting All Chunks Done request for \" + id);\n                promises[id] = promise;\n                requester.initTransport(id).withParams(options.params(id) || params).withHeaders(options.headers(id) || headers).send(xhr);\n                return promise;\n            }\n        });\n    };\n    qq.DragAndDrop = function(o) {\n        \"use strict\";\n        var options, HIDE_ZONES_EVENT_NAME = \"qq-hidezones\", HIDE_BEFORE_ENTER_ATTR = \"qq-hide-dropzone\", uploadDropZones = [], droppedFiles = [], disposeSupport = new qq.DisposeSupport();\n        options = {\n            dropZoneElements: [],\n            allowMultipleItems: true,\n            classes: {\n                dropActive: null\n            },\n            callbacks: new qq.DragAndDrop.callbacks()\n        };\n        qq.extend(options, o, true);\n        function uploadDroppedFiles(files, uploadDropZone) {\n            var filesAsArray = Array.prototype.slice.call(files);\n            options.callbacks.dropLog(\"Grabbed \" + files.length + \" dropped files.\");\n            uploadDropZone.dropDisabled(false);\n            options.callbacks.processingDroppedFilesComplete(filesAsArray, uploadDropZone.getElement());\n        }\n        function traverseFileTree(entry) {\n            var parseEntryPromise = new qq.Promise();\n            if (entry.isFile) {\n                entry.file(function(file) {\n                    file.qqPath = extractDirectoryPath(entry);\n                    droppedFiles.push(file);\n                    parseEntryPromise.success();\n                }, function(fileError) {\n                    options.callbacks.dropLog(\"Problem parsing '\" + entry.fullPath + \"'.  FileError code \" + fileError.code + \".\", \"error\");\n                    parseEntryPromise.failure();\n                });\n            } else if (entry.isDirectory) {\n                getFilesInDirectory(entry).then(function allEntriesRead(entries) {\n                    var entriesLeft = entries.length;\n                    qq.each(entries, function(idx, entry) {\n                        traverseFileTree(entry).done(function() {\n                            entriesLeft -= 1;\n                            if (entriesLeft === 0) {\n                                parseEntryPromise.success();\n                            }\n                        });\n                    });\n                    if (!entries.length) {\n                        parseEntryPromise.success();\n                    }\n                }, function readFailure(fileError) {\n                    options.callbacks.dropLog(\"Problem parsing '\" + entry.fullPath + \"'.  FileError code \" + fileError.code + \".\", \"error\");\n                    parseEntryPromise.failure();\n                });\n            }\n            return parseEntryPromise;\n        }\n        function extractDirectoryPath(entry) {\n            var name = entry.name, fullPath = entry.fullPath, indexOfNameInFullPath = fullPath.lastIndexOf(name);\n            fullPath = fullPath.substr(0, indexOfNameInFullPath);\n            if (fullPath.charAt(0) === \"/\") {\n                fullPath = fullPath.substr(1);\n            }\n            return fullPath;\n        }\n        function getFilesInDirectory(entry, reader, accumEntries, existingPromise) {\n            var promise = existingPromise || new qq.Promise(), dirReader = reader || entry.createReader();\n            dirReader.readEntries(function readSuccess(entries) {\n                var newEntries = accumEntries ? accumEntries.concat(entries) : entries;\n                if (entries.length) {\n                    setTimeout(function() {\n                        getFilesInDirectory(entry, dirReader, newEntries, promise);\n                    }, 0);\n                } else {\n                    promise.success(newEntries);\n                }\n            }, promise.failure);\n            return promise;\n        }\n        function handleDataTransfer(dataTransfer, uploadDropZone) {\n            var pendingFolderPromises = [], handleDataTransferPromise = new qq.Promise();\n            options.callbacks.processingDroppedFiles();\n            uploadDropZone.dropDisabled(true);\n            if (dataTransfer.files.length > 1 && !options.allowMultipleItems) {\n                options.callbacks.processingDroppedFilesComplete([]);\n                options.callbacks.dropError(\"tooManyFilesError\", \"\");\n                uploadDropZone.dropDisabled(false);\n                handleDataTransferPromise.failure();\n            } else {\n                droppedFiles = [];\n                if (qq.isFolderDropSupported(dataTransfer)) {\n                    qq.each(dataTransfer.items, function(idx, item) {\n                        var entry = item.webkitGetAsEntry();\n                        if (entry) {\n                            if (entry.isFile) {\n                                droppedFiles.push(item.getAsFile());\n                            } else {\n                                pendingFolderPromises.push(traverseFileTree(entry).done(function() {\n                                    pendingFolderPromises.pop();\n                                    if (pendingFolderPromises.length === 0) {\n                                        handleDataTransferPromise.success();\n                                    }\n                                }));\n                            }\n                        }\n                    });\n                } else {\n                    droppedFiles = dataTransfer.files;\n                }\n                if (pendingFolderPromises.length === 0) {\n                    handleDataTransferPromise.success();\n                }\n            }\n            return handleDataTransferPromise;\n        }\n        function setupDropzone(dropArea) {\n            var dropZone = new qq.UploadDropZone({\n                HIDE_ZONES_EVENT_NAME: HIDE_ZONES_EVENT_NAME,\n                element: dropArea,\n                onEnter: function(e) {\n                    qq(dropArea).addClass(options.classes.dropActive);\n                    e.stopPropagation();\n                },\n                onLeaveNotDescendants: function(e) {\n                    qq(dropArea).removeClass(options.classes.dropActive);\n                },\n                onDrop: function(e) {\n                    handleDataTransfer(e.dataTransfer, dropZone).then(function() {\n                        uploadDroppedFiles(droppedFiles, dropZone);\n                    }, function() {\n                        options.callbacks.dropLog(\"Drop event DataTransfer parsing failed.  No files will be uploaded.\", \"error\");\n                    });\n                }\n            });\n            disposeSupport.addDisposer(function() {\n                dropZone.dispose();\n            });\n            qq(dropArea).hasAttribute(HIDE_BEFORE_ENTER_ATTR) && qq(dropArea).hide();\n            uploadDropZones.push(dropZone);\n            return dropZone;\n        }\n        function isFileDrag(dragEvent) {\n            var fileDrag;\n            qq.each(dragEvent.dataTransfer.types, function(key, val) {\n                if (val === \"Files\") {\n                    fileDrag = true;\n                    return false;\n                }\n            });\n            return fileDrag;\n        }\n        function leavingDocumentOut(e) {\n            if (qq.safari()) {\n                return e.x < 0 || e.y < 0;\n            }\n            return e.x === 0 && e.y === 0;\n        }\n        function setupDragDrop() {\n            var dropZones = options.dropZoneElements, maybeHideDropZones = function() {\n                setTimeout(function() {\n                    qq.each(dropZones, function(idx, dropZone) {\n                        qq(dropZone).hasAttribute(HIDE_BEFORE_ENTER_ATTR) && qq(dropZone).hide();\n                        qq(dropZone).removeClass(options.classes.dropActive);\n                    });\n                }, 10);\n            };\n            qq.each(dropZones, function(idx, dropZone) {\n                var uploadDropZone = setupDropzone(dropZone);\n                if (dropZones.length && qq.supportedFeatures.fileDrop) {\n                    disposeSupport.attach(document, \"dragenter\", function(e) {\n                        if (!uploadDropZone.dropDisabled() && isFileDrag(e)) {\n                            qq.each(dropZones, function(idx, dropZone) {\n                                if (dropZone instanceof HTMLElement && qq(dropZone).hasAttribute(HIDE_BEFORE_ENTER_ATTR)) {\n                                    qq(dropZone).css({\n                                        display: \"block\"\n                                    });\n                                }\n                            });\n                        }\n                    });\n                }\n            });\n            disposeSupport.attach(document, \"dragleave\", function(e) {\n                if (leavingDocumentOut(e)) {\n                    maybeHideDropZones();\n                }\n            });\n            disposeSupport.attach(qq(document).children()[0], \"mouseenter\", function(e) {\n                maybeHideDropZones();\n            });\n            disposeSupport.attach(document, \"drop\", function(e) {\n                if (isFileDrag(e)) {\n                    e.preventDefault();\n                    maybeHideDropZones();\n                }\n            });\n            disposeSupport.attach(document, HIDE_ZONES_EVENT_NAME, maybeHideDropZones);\n        }\n        setupDragDrop();\n        qq.extend(this, {\n            setupExtraDropzone: function(element) {\n                options.dropZoneElements.push(element);\n                setupDropzone(element);\n            },\n            removeDropzone: function(element) {\n                var i, dzs = options.dropZoneElements;\n                for (i in dzs) {\n                    if (dzs[i] === element) {\n                        return dzs.splice(i, 1);\n                    }\n                }\n            },\n            dispose: function() {\n                disposeSupport.dispose();\n                qq.each(uploadDropZones, function(idx, dropZone) {\n                    dropZone.dispose();\n                });\n            }\n        });\n        this._testing = {};\n        this._testing.extractDirectoryPath = extractDirectoryPath;\n    };\n    qq.DragAndDrop.callbacks = function() {\n        \"use strict\";\n        return {\n            processingDroppedFiles: function() {},\n            processingDroppedFilesComplete: function(files, targetEl) {},\n            dropError: function(code, errorSpecifics) {\n                qq.log(\"Drag & drop error code '\" + code + \" with these specifics: '\" + errorSpecifics + \"'\", \"error\");\n            },\n            dropLog: function(message, level) {\n                qq.log(message, level);\n            }\n        };\n    };\n    qq.UploadDropZone = function(o) {\n        \"use strict\";\n        var disposeSupport = new qq.DisposeSupport(), options, element, preventDrop, dropOutsideDisabled;\n        options = {\n            element: null,\n            onEnter: function(e) {},\n            onLeave: function(e) {},\n            onLeaveNotDescendants: function(e) {},\n            onDrop: function(e) {}\n        };\n        qq.extend(options, o);\n        element = options.element;\n        function dragoverShouldBeCanceled() {\n            return qq.safari() || qq.firefox() && qq.windows();\n        }\n        function disableDropOutside(e) {\n            if (!dropOutsideDisabled) {\n                if (dragoverShouldBeCanceled) {\n                    disposeSupport.attach(document, \"dragover\", function(e) {\n                        e.preventDefault();\n                    });\n                } else {\n                    disposeSupport.attach(document, \"dragover\", function(e) {\n                        if (e.dataTransfer) {\n                            e.dataTransfer.dropEffect = \"none\";\n                            e.preventDefault();\n                        }\n                    });\n                }\n                dropOutsideDisabled = true;\n            }\n        }\n        function isValidFileDrag(e) {\n            if (!qq.supportedFeatures.fileDrop) {\n                return false;\n            }\n            var effectTest, dt = e.dataTransfer, isSafari = qq.safari();\n            effectTest = qq.ie() && qq.supportedFeatures.fileDrop ? true : dt.effectAllowed !== \"none\";\n            return dt && effectTest && (dt.files && dt.files.length || !isSafari && dt.types.contains && dt.types.contains(\"Files\") || dt.types.includes && dt.types.includes(\"Files\"));\n        }\n        function isOrSetDropDisabled(isDisabled) {\n            if (isDisabled !== undefined) {\n                preventDrop = isDisabled;\n            }\n            return preventDrop;\n        }\n        function triggerHidezonesEvent() {\n            var hideZonesEvent;\n            function triggerUsingOldApi() {\n                hideZonesEvent = document.createEvent(\"Event\");\n                hideZonesEvent.initEvent(options.HIDE_ZONES_EVENT_NAME, true, true);\n            }\n            if (window.CustomEvent) {\n                try {\n                    hideZonesEvent = new CustomEvent(options.HIDE_ZONES_EVENT_NAME);\n                } catch (err) {\n                    triggerUsingOldApi();\n                }\n            } else {\n                triggerUsingOldApi();\n            }\n            document.dispatchEvent(hideZonesEvent);\n        }\n        function attachEvents() {\n            disposeSupport.attach(element, \"dragover\", function(e) {\n                if (!isValidFileDrag(e)) {\n                    return;\n                }\n                var effect = qq.ie() && qq.supportedFeatures.fileDrop ? null : e.dataTransfer.effectAllowed;\n                if (effect === \"move\" || effect === \"linkMove\") {\n                    e.dataTransfer.dropEffect = \"move\";\n                } else {\n                    e.dataTransfer.dropEffect = \"copy\";\n                }\n                e.stopPropagation();\n                e.preventDefault();\n            });\n            disposeSupport.attach(element, \"dragenter\", function(e) {\n                if (!isOrSetDropDisabled()) {\n                    if (!isValidFileDrag(e)) {\n                        return;\n                    }\n                    options.onEnter(e);\n                }\n            });\n            disposeSupport.attach(element, \"dragleave\", function(e) {\n                if (!isValidFileDrag(e)) {\n                    return;\n                }\n                options.onLeave(e);\n                var relatedTarget = document.elementFromPoint(e.clientX, e.clientY);\n                if (qq(this).contains(relatedTarget)) {\n                    return;\n                }\n                options.onLeaveNotDescendants(e);\n            });\n            disposeSupport.attach(element, \"drop\", function(e) {\n                if (!isOrSetDropDisabled()) {\n                    if (!isValidFileDrag(e)) {\n                        return;\n                    }\n                    e.preventDefault();\n                    e.stopPropagation();\n                    options.onDrop(e);\n                    triggerHidezonesEvent();\n                }\n            });\n        }\n        disableDropOutside();\n        attachEvents();\n        qq.extend(this, {\n            dropDisabled: function(isDisabled) {\n                return isOrSetDropDisabled(isDisabled);\n            },\n            dispose: function() {\n                disposeSupport.dispose();\n            },\n            getElement: function() {\n                return element;\n            }\n        });\n        this._testing = {};\n        this._testing.isValidFileDrag = isValidFileDrag;\n    };\n    (function() {\n        \"use strict\";\n        qq.uiPublicApi = {\n            addInitialFiles: function(cannedFileList) {\n                this._parent.prototype.addInitialFiles.apply(this, arguments);\n                this._templating.addCacheToDom();\n            },\n            clearStoredFiles: function() {\n                this._parent.prototype.clearStoredFiles.apply(this, arguments);\n                this._templating.clearFiles();\n            },\n            addExtraDropzone: function(element) {\n                this._dnd && this._dnd.setupExtraDropzone(element);\n            },\n            removeExtraDropzone: function(element) {\n                if (this._dnd) {\n                    return this._dnd.removeDropzone(element);\n                }\n            },\n            getItemByFileId: function(id) {\n                if (!this._templating.isHiddenForever(id)) {\n                    return this._templating.getFileContainer(id);\n                }\n            },\n            reset: function() {\n                this._parent.prototype.reset.apply(this, arguments);\n                this._templating.reset();\n                if (!this._options.button && this._templating.getButton()) {\n                    this._defaultButtonId = this._createUploadButton({\n                        element: this._templating.getButton(),\n                        title: this._options.text.fileInputTitle\n                    }).getButtonId();\n                }\n                if (this._dnd) {\n                    this._dnd.dispose();\n                    this._dnd = this._setupDragAndDrop();\n                }\n                this._totalFilesInBatch = 0;\n                this._filesInBatchAddedToUi = 0;\n                this._setupClickAndEditEventHandlers();\n            },\n            setName: function(id, newName) {\n                var formattedFilename = this._options.formatFileName(newName);\n                this._parent.prototype.setName.apply(this, arguments);\n                this._templating.updateFilename(id, formattedFilename);\n            },\n            pauseUpload: function(id) {\n                var paused = this._parent.prototype.pauseUpload.apply(this, arguments);\n                paused && this._templating.uploadPaused(id);\n                return paused;\n            },\n            continueUpload: function(id) {\n                var continued = this._parent.prototype.continueUpload.apply(this, arguments);\n                continued && this._templating.uploadContinued(id);\n                return continued;\n            },\n            getId: function(fileContainerOrChildEl) {\n                return this._templating.getFileId(fileContainerOrChildEl);\n            },\n            getDropTarget: function(fileId) {\n                var file = this.getFile(fileId);\n                return file.qqDropTarget;\n            }\n        };\n        qq.uiPrivateApi = {\n            _getButton: function(buttonId) {\n                var button = this._parent.prototype._getButton.apply(this, arguments);\n                if (!button) {\n                    if (buttonId === this._defaultButtonId) {\n                        button = this._templating.getButton();\n                    }\n                }\n                return button;\n            },\n            _removeFileItem: function(fileId) {\n                this._templating.removeFile(fileId);\n            },\n            _setupClickAndEditEventHandlers: function() {\n                this._fileButtonsClickHandler = qq.FileButtonsClickHandler && this._bindFileButtonsClickEvent();\n                this._focusinEventSupported = !qq.firefox();\n                if (this._isEditFilenameEnabled()) {\n                    this._filenameClickHandler = this._bindFilenameClickEvent();\n                    this._filenameInputFocusInHandler = this._bindFilenameInputFocusInEvent();\n                    this._filenameInputFocusHandler = this._bindFilenameInputFocusEvent();\n                }\n            },\n            _setupDragAndDrop: function() {\n                var self = this, dropZoneElements = this._options.dragAndDrop.extraDropzones, templating = this._templating, defaultDropZone = templating.getDropZone();\n                defaultDropZone && dropZoneElements.push(defaultDropZone);\n                return new qq.DragAndDrop({\n                    dropZoneElements: dropZoneElements,\n                    allowMultipleItems: this._options.multiple,\n                    classes: {\n                        dropActive: this._options.classes.dropActive\n                    },\n                    callbacks: {\n                        processingDroppedFiles: function() {\n                            templating.showDropProcessing();\n                        },\n                        processingDroppedFilesComplete: function(files, targetEl) {\n                            templating.hideDropProcessing();\n                            qq.each(files, function(idx, file) {\n                                file.qqDropTarget = targetEl;\n                            });\n                            if (files.length) {\n                                self.addFiles(files, null, null);\n                            }\n                        },\n                        dropError: function(code, errorData) {\n                            self._itemError(code, errorData);\n                        },\n                        dropLog: function(message, level) {\n                            self.log(message, level);\n                        }\n                    }\n                });\n            },\n            _bindFileButtonsClickEvent: function() {\n                var self = this;\n                return new qq.FileButtonsClickHandler({\n                    templating: this._templating,\n                    log: function(message, lvl) {\n                        self.log(message, lvl);\n                    },\n                    onDeleteFile: function(fileId) {\n                        self.deleteFile(fileId);\n                    },\n                    onCancel: function(fileId) {\n                        self.cancel(fileId);\n                    },\n                    onRetry: function(fileId) {\n                        self.retry(fileId);\n                    },\n                    onPause: function(fileId) {\n                        self.pauseUpload(fileId);\n                    },\n                    onContinue: function(fileId) {\n                        self.continueUpload(fileId);\n                    },\n                    onGetName: function(fileId) {\n                        return self.getName(fileId);\n                    }\n                });\n            },\n            _isEditFilenameEnabled: function() {\n                return this._templating.isEditFilenamePossible() && !this._options.autoUpload && qq.FilenameClickHandler && qq.FilenameInputFocusHandler && qq.FilenameInputFocusHandler;\n            },\n            _filenameEditHandler: function() {\n                var self = this, templating = this._templating;\n                return {\n                    templating: templating,\n                    log: function(message, lvl) {\n                        self.log(message, lvl);\n                    },\n                    onGetUploadStatus: function(fileId) {\n                        return self.getUploads({\n                            id: fileId\n                        }).status;\n                    },\n                    onGetName: function(fileId) {\n                        return self.getName(fileId);\n                    },\n                    onSetName: function(id, newName) {\n                        self.setName(id, newName);\n                    },\n                    onEditingStatusChange: function(id, isEditing) {\n                        var qqInput = qq(templating.getEditInput(id)), qqFileContainer = qq(templating.getFileContainer(id));\n                        if (isEditing) {\n                            qqInput.addClass(\"qq-editing\");\n                            templating.hideFilename(id);\n                            templating.hideEditIcon(id);\n                        } else {\n                            qqInput.removeClass(\"qq-editing\");\n                            templating.showFilename(id);\n                            templating.showEditIcon(id);\n                        }\n                        qqFileContainer.addClass(\"qq-temp\").removeClass(\"qq-temp\");\n                    }\n                };\n            },\n            _onUploadStatusChange: function(id, oldStatus, newStatus) {\n                this._parent.prototype._onUploadStatusChange.apply(this, arguments);\n                if (this._isEditFilenameEnabled()) {\n                    if (this._templating.getFileContainer(id) && newStatus !== qq.status.SUBMITTED) {\n                        this._templating.markFilenameEditable(id);\n                        this._templating.hideEditIcon(id);\n                    }\n                }\n                if (oldStatus === qq.status.UPLOAD_RETRYING && newStatus === qq.status.UPLOADING) {\n                    this._templating.hideRetry(id);\n                    this._templating.setStatusText(id);\n                    qq(this._templating.getFileContainer(id)).removeClass(this._classes.retrying);\n                } else if (newStatus === qq.status.UPLOAD_FAILED) {\n                    this._templating.hidePause(id);\n                }\n            },\n            _bindFilenameInputFocusInEvent: function() {\n                var spec = qq.extend({}, this._filenameEditHandler());\n                return new qq.FilenameInputFocusInHandler(spec);\n            },\n            _bindFilenameInputFocusEvent: function() {\n                var spec = qq.extend({}, this._filenameEditHandler());\n                return new qq.FilenameInputFocusHandler(spec);\n            },\n            _bindFilenameClickEvent: function() {\n                var spec = qq.extend({}, this._filenameEditHandler());\n                return new qq.FilenameClickHandler(spec);\n            },\n            _storeForLater: function(id) {\n                this._parent.prototype._storeForLater.apply(this, arguments);\n                this._templating.hideSpinner(id);\n            },\n            _onAllComplete: function(successful, failed) {\n                this._parent.prototype._onAllComplete.apply(this, arguments);\n                this._templating.resetTotalProgress();\n            },\n            _onSubmit: function(id, name) {\n                var file = this.getFile(id);\n                if (file && file.qqPath && this._options.dragAndDrop.reportDirectoryPaths) {\n                    this._paramsStore.addReadOnly(id, {\n                        qqpath: file.qqPath\n                    });\n                }\n                this._parent.prototype._onSubmit.apply(this, arguments);\n                this._addToList(id, name);\n            },\n            _onSubmitted: function(id) {\n                if (this._isEditFilenameEnabled()) {\n                    this._templating.markFilenameEditable(id);\n                    this._templating.showEditIcon(id);\n                    if (!this._focusinEventSupported) {\n                        this._filenameInputFocusHandler.addHandler(this._templating.getEditInput(id));\n                    }\n                }\n            },\n            _onProgress: function(id, name, loaded, total) {\n                this._parent.prototype._onProgress.apply(this, arguments);\n                this._templating.updateProgress(id, loaded, total);\n                if (total === 0 || Math.round(loaded / total * 100) === 100) {\n                    this._templating.hideCancel(id);\n                    this._templating.hidePause(id);\n                    this._templating.hideProgress(id);\n                    this._templating.setStatusText(id, this._options.text.waitingForResponse);\n                    this._displayFileSize(id);\n                } else {\n                    this._displayFileSize(id, loaded, total);\n                }\n            },\n            _onTotalProgress: function(loaded, total) {\n                this._parent.prototype._onTotalProgress.apply(this, arguments);\n                this._templating.updateTotalProgress(loaded, total);\n            },\n            _onComplete: function(id, name, result, xhr) {\n                var parentRetVal = this._parent.prototype._onComplete.apply(this, arguments), templating = this._templating, fileContainer = templating.getFileContainer(id), self = this;\n                function completeUpload(result) {\n                    if (!fileContainer) {\n                        return;\n                    }\n                    templating.setStatusText(id);\n                    qq(fileContainer).removeClass(self._classes.retrying);\n                    templating.hideProgress(id);\n                    if (self.getUploads({\n                        id: id\n                    }).status !== qq.status.UPLOAD_FAILED) {\n                        templating.hideCancel(id);\n                    }\n                    templating.hideSpinner(id);\n                    if (result.success) {\n                        self._markFileAsSuccessful(id);\n                    } else {\n                        qq(fileContainer).addClass(self._classes.fail);\n                        templating.showCancel(id);\n                        if (templating.isRetryPossible() && !self._preventRetries[id]) {\n                            qq(fileContainer).addClass(self._classes.retryable);\n                            templating.showRetry(id);\n                        }\n                        self._controlFailureTextDisplay(id, result);\n                    }\n                }\n                if (parentRetVal instanceof qq.Promise) {\n                    parentRetVal.done(function(newResult) {\n                        completeUpload(newResult);\n                    });\n                } else {\n                    completeUpload(result);\n                }\n                return parentRetVal;\n            },\n            _markFileAsSuccessful: function(id) {\n                var templating = this._templating;\n                if (this._isDeletePossible()) {\n                    templating.showDeleteButton(id);\n                }\n                qq(templating.getFileContainer(id)).addClass(this._classes.success);\n                this._maybeUpdateThumbnail(id);\n            },\n            _onUploadPrep: function(id) {\n                this._parent.prototype._onUploadPrep.apply(this, arguments);\n                this._templating.showSpinner(id);\n            },\n            _onUpload: function(id, name) {\n                var parentRetVal = this._parent.prototype._onUpload.apply(this, arguments);\n                this._templating.showSpinner(id);\n                return parentRetVal;\n            },\n            _onUploadChunk: function(id, chunkData) {\n                this._parent.prototype._onUploadChunk.apply(this, arguments);\n                if (chunkData.partIndex > 0 && this._handler.isResumable(id)) {\n                    this._templating.allowPause(id);\n                }\n            },\n            _onCancel: function(id, name) {\n                this._parent.prototype._onCancel.apply(this, arguments);\n                this._removeFileItem(id);\n                if (this._getNotFinished() === 0) {\n                    this._templating.resetTotalProgress();\n                }\n            },\n            _onBeforeAutoRetry: function(id) {\n                var retryNumForDisplay, maxAuto, retryNote;\n                this._parent.prototype._onBeforeAutoRetry.apply(this, arguments);\n                this._showCancelLink(id);\n                if (this._options.retry.showAutoRetryNote) {\n                    retryNumForDisplay = this._autoRetries[id];\n                    maxAuto = this._options.retry.maxAutoAttempts;\n                    retryNote = this._options.retry.autoRetryNote.replace(/\\{retryNum\\}/g, retryNumForDisplay);\n                    retryNote = retryNote.replace(/\\{maxAuto\\}/g, maxAuto);\n                    this._templating.setStatusText(id, retryNote);\n                    qq(this._templating.getFileContainer(id)).addClass(this._classes.retrying);\n                }\n            },\n            _onBeforeManualRetry: function(id) {\n                if (this._parent.prototype._onBeforeManualRetry.apply(this, arguments)) {\n                    this._templating.resetProgress(id);\n                    qq(this._templating.getFileContainer(id)).removeClass(this._classes.fail);\n                    this._templating.setStatusText(id);\n                    this._templating.showSpinner(id);\n                    this._showCancelLink(id);\n                    return true;\n                } else {\n                    qq(this._templating.getFileContainer(id)).addClass(this._classes.retryable);\n                    this._templating.showRetry(id);\n                    return false;\n                }\n            },\n            _onSubmitDelete: function(id) {\n                var onSuccessCallback = qq.bind(this._onSubmitDeleteSuccess, this);\n                this._parent.prototype._onSubmitDelete.call(this, id, onSuccessCallback);\n            },\n            _onSubmitDeleteSuccess: function(id, uuid, additionalMandatedParams) {\n                if (this._options.deleteFile.forceConfirm) {\n                    this._showDeleteConfirm.apply(this, arguments);\n                } else {\n                    this._sendDeleteRequest.apply(this, arguments);\n                }\n            },\n            _onDeleteComplete: function(id, xhr, isError) {\n                this._parent.prototype._onDeleteComplete.apply(this, arguments);\n                this._templating.hideSpinner(id);\n                if (isError) {\n                    this._templating.setStatusText(id, this._options.deleteFile.deletingFailedText);\n                    this._templating.showDeleteButton(id);\n                } else {\n                    this._removeFileItem(id);\n                }\n            },\n            _sendDeleteRequest: function(id, uuid, additionalMandatedParams) {\n                this._templating.hideDeleteButton(id);\n                this._templating.showSpinner(id);\n                this._templating.setStatusText(id, this._options.deleteFile.deletingStatusText);\n                this._deleteHandler.sendDelete.apply(this, arguments);\n            },\n            _showDeleteConfirm: function(id, uuid, mandatedParams) {\n                var fileName = this.getName(id), confirmMessage = this._options.deleteFile.confirmMessage.replace(/\\{filename\\}/g, fileName), uuid = this.getUuid(id), deleteRequestArgs = arguments, self = this, retVal;\n                retVal = this._options.showConfirm(confirmMessage);\n                if (qq.isGenericPromise(retVal)) {\n                    retVal.then(function() {\n                        self._sendDeleteRequest.apply(self, deleteRequestArgs);\n                    });\n                } else if (retVal !== false) {\n                    self._sendDeleteRequest.apply(self, deleteRequestArgs);\n                }\n            },\n            _addToList: function(id, name, canned) {\n                var prependData, prependIndex = 0, dontDisplay = this._handler.isProxied(id) && this._options.scaling.hideScaled, record;\n                if (this._options.display.prependFiles) {\n                    if (this._totalFilesInBatch > 1 && this._filesInBatchAddedToUi > 0) {\n                        prependIndex = this._filesInBatchAddedToUi - 1;\n                    }\n                    prependData = {\n                        index: prependIndex\n                    };\n                }\n                if (!canned) {\n                    if (this._options.disableCancelForFormUploads && !qq.supportedFeatures.ajaxUploading) {\n                        this._templating.disableCancel();\n                    }\n                    if (!this._options.multiple) {\n                        record = this.getUploads({\n                            id: id\n                        });\n                        this._handledProxyGroup = this._handledProxyGroup || record.proxyGroupId;\n                        if (record.proxyGroupId !== this._handledProxyGroup || !record.proxyGroupId) {\n                            this._handler.cancelAll();\n                            this._clearList();\n                            this._handledProxyGroup = null;\n                        }\n                    }\n                }\n                if (canned) {\n                    this._templating.addFileToCache(id, this._options.formatFileName(name), prependData, dontDisplay);\n                    this._templating.updateThumbnail(id, this._thumbnailUrls[id], true, this._options.thumbnails.customResizer);\n                } else {\n                    this._templating.addFile(id, this._options.formatFileName(name), prependData, dontDisplay);\n                    this._templating.generatePreview(id, this.getFile(id), this._options.thumbnails.customResizer);\n                }\n                this._filesInBatchAddedToUi += 1;\n                if (canned || this._options.display.fileSizeOnSubmit && qq.supportedFeatures.ajaxUploading) {\n                    this._displayFileSize(id);\n                }\n            },\n            _clearList: function() {\n                this._templating.clearFiles();\n                this.clearStoredFiles();\n            },\n            _displayFileSize: function(id, loadedSize, totalSize) {\n                var size = this.getSize(id), sizeForDisplay = this._formatSize(size);\n                if (size >= 0) {\n                    if (loadedSize !== undefined && totalSize !== undefined) {\n                        sizeForDisplay = this._formatProgress(loadedSize, totalSize);\n                    }\n                    this._templating.updateSize(id, sizeForDisplay);\n                }\n            },\n            _formatProgress: function(uploadedSize, totalSize) {\n                var message = this._options.text.formatProgress;\n                function r(name, replacement) {\n                    message = message.replace(name, replacement);\n                }\n                r(\"{percent}\", Math.round(uploadedSize / totalSize * 100));\n                r(\"{total_size}\", this._formatSize(totalSize));\n                return message;\n            },\n            _controlFailureTextDisplay: function(id, response) {\n                var mode, responseProperty, failureReason;\n                mode = this._options.failedUploadTextDisplay.mode;\n                responseProperty = this._options.failedUploadTextDisplay.responseProperty;\n                if (mode === \"custom\") {\n                    failureReason = response[responseProperty];\n                    if (!failureReason) {\n                        failureReason = this._options.text.failUpload;\n                    }\n                    this._templating.setStatusText(id, failureReason);\n                    if (this._options.failedUploadTextDisplay.enableTooltip) {\n                        this._showTooltip(id, failureReason);\n                    }\n                } else if (mode === \"default\") {\n                    this._templating.setStatusText(id, this._options.text.failUpload);\n                } else if (mode !== \"none\") {\n                    this.log(\"failedUploadTextDisplay.mode value of '\" + mode + \"' is not valid\", \"warn\");\n                }\n            },\n            _showTooltip: function(id, text) {\n                this._templating.getFileContainer(id).title = text;\n            },\n            _showCancelLink: function(id) {\n                if (!this._options.disableCancelForFormUploads || qq.supportedFeatures.ajaxUploading) {\n                    this._templating.showCancel(id);\n                }\n            },\n            _itemError: function(code, name, item) {\n                var message = this._parent.prototype._itemError.apply(this, arguments);\n                this._options.showMessage(message);\n            },\n            _batchError: function(message) {\n                this._parent.prototype._batchError.apply(this, arguments);\n                this._options.showMessage(message);\n            },\n            _setupPastePrompt: function() {\n                var self = this;\n                this._options.callbacks.onPasteReceived = function() {\n                    var message = self._options.paste.namePromptMessage, defaultVal = self._options.paste.defaultName;\n                    return self._options.showPrompt(message, defaultVal);\n                };\n            },\n            _fileOrBlobRejected: function(id, name) {\n                this._totalFilesInBatch -= 1;\n                this._parent.prototype._fileOrBlobRejected.apply(this, arguments);\n            },\n            _prepareItemsForUpload: function(items, params, endpoint) {\n                this._totalFilesInBatch = items.length;\n                this._filesInBatchAddedToUi = 0;\n                this._parent.prototype._prepareItemsForUpload.apply(this, arguments);\n            },\n            _maybeUpdateThumbnail: function(fileId) {\n                var thumbnailUrl = this._thumbnailUrls[fileId], fileStatus = this.getUploads({\n                    id: fileId\n                }).status;\n                if (fileStatus !== qq.status.DELETED && (thumbnailUrl || this._options.thumbnails.placeholders.waitUntilResponse || !qq.supportedFeatures.imagePreviews)) {\n                    this._templating.updateThumbnail(fileId, thumbnailUrl, this._options.thumbnails.customResizer);\n                }\n            },\n            _addCannedFile: function(sessionData) {\n                var id = this._parent.prototype._addCannedFile.apply(this, arguments);\n                this._addToList(id, this.getName(id), true);\n                this._templating.hideSpinner(id);\n                this._templating.hideCancel(id);\n                this._markFileAsSuccessful(id);\n                return id;\n            },\n            _setSize: function(id, newSize) {\n                this._parent.prototype._setSize.apply(this, arguments);\n                this._templating.updateSize(id, this._formatSize(newSize));\n            },\n            _sessionRequestComplete: function() {\n                this._templating.addCacheToDom();\n                this._parent.prototype._sessionRequestComplete.apply(this, arguments);\n            }\n        };\n    })();\n    qq.FineUploader = function(o, namespace) {\n        \"use strict\";\n        var self = this;\n        this._parent = namespace ? qq[namespace].FineUploaderBasic : qq.FineUploaderBasic;\n        this._parent.apply(this, arguments);\n        qq.extend(this._options, {\n            element: null,\n            button: null,\n            listElement: null,\n            dragAndDrop: {\n                extraDropzones: [],\n                reportDirectoryPaths: false\n            },\n            text: {\n                formatProgress: \"{percent}% of {total_size}\",\n                failUpload: \"Upload failed\",\n                waitingForResponse: \"Processing...\",\n                paused: \"Paused\"\n            },\n            template: \"qq-template\",\n            classes: {\n                retrying: \"qq-upload-retrying\",\n                retryable: \"qq-upload-retryable\",\n                success: \"qq-upload-success\",\n                fail: \"qq-upload-fail\",\n                editable: \"qq-editable\",\n                hide: \"qq-hide\",\n                dropActive: \"qq-upload-drop-area-active\"\n            },\n            failedUploadTextDisplay: {\n                mode: \"default\",\n                responseProperty: \"error\",\n                enableTooltip: true\n            },\n            messages: {\n                tooManyFilesError: \"You may only drop one file\",\n                unsupportedBrowser: \"Unrecoverable error - this browser does not permit file uploading of any kind.\"\n            },\n            retry: {\n                showAutoRetryNote: true,\n                autoRetryNote: \"Retrying {retryNum}/{maxAuto}...\"\n            },\n            deleteFile: {\n                forceConfirm: false,\n                confirmMessage: \"Are you sure you want to delete {filename}?\",\n                deletingStatusText: \"Deleting...\",\n                deletingFailedText: \"Delete failed\"\n            },\n            display: {\n                fileSizeOnSubmit: false,\n                prependFiles: false\n            },\n            paste: {\n                promptForName: false,\n                namePromptMessage: \"Please name this image\"\n            },\n            thumbnails: {\n                customResizer: null,\n                maxCount: 0,\n                placeholders: {\n                    waitUntilResponse: false,\n                    notAvailablePath: null,\n                    waitingPath: null\n                },\n                timeBetweenThumbs: 750\n            },\n            scaling: {\n                hideScaled: false\n            },\n            showMessage: function(message) {\n                if (self._templating.hasDialog(\"alert\")) {\n                    return self._templating.showDialog(\"alert\", message);\n                } else {\n                    setTimeout(function() {\n                        window.alert(message);\n                    }, 0);\n                }\n            },\n            showConfirm: function(message) {\n                if (self._templating.hasDialog(\"confirm\")) {\n                    return self._templating.showDialog(\"confirm\", message);\n                } else {\n                    return window.confirm(message);\n                }\n            },\n            showPrompt: function(message, defaultValue) {\n                if (self._templating.hasDialog(\"prompt\")) {\n                    return self._templating.showDialog(\"prompt\", message, defaultValue);\n                } else {\n                    return window.prompt(message, defaultValue);\n                }\n            }\n        }, true);\n        qq.extend(this._options, o, true);\n        this._templating = new qq.Templating({\n            log: qq.bind(this.log, this),\n            templateIdOrEl: this._options.template,\n            containerEl: this._options.element,\n            fileContainerEl: this._options.listElement,\n            button: this._options.button,\n            imageGenerator: this._imageGenerator,\n            classes: {\n                hide: this._options.classes.hide,\n                editable: this._options.classes.editable\n            },\n            limits: {\n                maxThumbs: this._options.thumbnails.maxCount,\n                timeBetweenThumbs: this._options.thumbnails.timeBetweenThumbs\n            },\n            placeholders: {\n                waitUntilUpdate: this._options.thumbnails.placeholders.waitUntilResponse,\n                thumbnailNotAvailable: this._options.thumbnails.placeholders.notAvailablePath,\n                waitingForThumbnail: this._options.thumbnails.placeholders.waitingPath\n            },\n            text: this._options.text\n        });\n        if (this._options.workarounds.ios8SafariUploads && qq.ios800() && qq.iosSafari()) {\n            this._templating.renderFailure(this._options.messages.unsupportedBrowserIos8Safari);\n        } else if (!qq.supportedFeatures.uploading || this._options.cors.expected && !qq.supportedFeatures.uploadCors) {\n            this._templating.renderFailure(this._options.messages.unsupportedBrowser);\n        } else {\n            this._wrapCallbacks();\n            this._templating.render();\n            this._classes = this._options.classes;\n            if (!this._options.button && this._templating.getButton()) {\n                this._defaultButtonId = this._createUploadButton({\n                    element: this._templating.getButton(),\n                    title: this._options.text.fileInputTitle\n                }).getButtonId();\n            }\n            this._setupClickAndEditEventHandlers();\n            if (qq.DragAndDrop && qq.supportedFeatures.fileDrop) {\n                this._dnd = this._setupDragAndDrop();\n            }\n            if (this._options.paste.targetElement && this._options.paste.promptForName) {\n                if (qq.PasteSupport) {\n                    this._setupPastePrompt();\n                } else {\n                    this.log(\"Paste support module not found.\", \"error\");\n                }\n            }\n            this._totalFilesInBatch = 0;\n            this._filesInBatchAddedToUi = 0;\n        }\n    };\n    qq.extend(qq.FineUploader.prototype, qq.basePublicApi);\n    qq.extend(qq.FineUploader.prototype, qq.basePrivateApi);\n    qq.extend(qq.FineUploader.prototype, qq.uiPublicApi);\n    qq.extend(qq.FineUploader.prototype, qq.uiPrivateApi);\n    qq.Templating = function(spec) {\n        \"use strict\";\n        var FILE_ID_ATTR = \"qq-file-id\", FILE_CLASS_PREFIX = \"qq-file-id-\", THUMBNAIL_MAX_SIZE_ATTR = \"qq-max-size\", THUMBNAIL_SERVER_SCALE_ATTR = \"qq-server-scale\", HIDE_DROPZONE_ATTR = \"qq-hide-dropzone\", DROPZPONE_TEXT_ATTR = \"qq-drop-area-text\", IN_PROGRESS_CLASS = \"qq-in-progress\", HIDDEN_FOREVER_CLASS = \"qq-hidden-forever\", fileBatch = {\n            content: document.createDocumentFragment(),\n            map: {}\n        }, isCancelDisabled = false, generatedThumbnails = 0, thumbnailQueueMonitorRunning = false, thumbGenerationQueue = [], thumbnailMaxSize = -1, options = {\n            log: null,\n            limits: {\n                maxThumbs: 0,\n                timeBetweenThumbs: 750\n            },\n            templateIdOrEl: \"qq-template\",\n            containerEl: null,\n            fileContainerEl: null,\n            button: null,\n            imageGenerator: null,\n            classes: {\n                hide: \"qq-hide\",\n                editable: \"qq-editable\"\n            },\n            placeholders: {\n                waitUntilUpdate: false,\n                thumbnailNotAvailable: null,\n                waitingForThumbnail: null\n            },\n            text: {\n                paused: \"Paused\"\n            }\n        }, selectorClasses = {\n            button: \"qq-upload-button-selector\",\n            alertDialog: \"qq-alert-dialog-selector\",\n            dialogCancelButton: \"qq-cancel-button-selector\",\n            confirmDialog: \"qq-confirm-dialog-selector\",\n            dialogMessage: \"qq-dialog-message-selector\",\n            dialogOkButton: \"qq-ok-button-selector\",\n            promptDialog: \"qq-prompt-dialog-selector\",\n            uploader: \"qq-uploader-selector\",\n            drop: \"qq-upload-drop-area-selector\",\n            list: \"qq-upload-list-selector\",\n            progressBarContainer: \"qq-progress-bar-container-selector\",\n            progressBar: \"qq-progress-bar-selector\",\n            totalProgressBarContainer: \"qq-total-progress-bar-container-selector\",\n            totalProgressBar: \"qq-total-progress-bar-selector\",\n            file: \"qq-upload-file-selector\",\n            spinner: \"qq-upload-spinner-selector\",\n            size: \"qq-upload-size-selector\",\n            cancel: \"qq-upload-cancel-selector\",\n            pause: \"qq-upload-pause-selector\",\n            continueButton: \"qq-upload-continue-selector\",\n            deleteButton: \"qq-upload-delete-selector\",\n            retry: \"qq-upload-retry-selector\",\n            statusText: \"qq-upload-status-text-selector\",\n            editFilenameInput: \"qq-edit-filename-selector\",\n            editNameIcon: \"qq-edit-filename-icon-selector\",\n            dropText: \"qq-upload-drop-area-text-selector\",\n            dropProcessing: \"qq-drop-processing-selector\",\n            dropProcessingSpinner: \"qq-drop-processing-spinner-selector\",\n            thumbnail: \"qq-thumbnail-selector\"\n        }, previewGeneration = {}, cachedThumbnailNotAvailableImg = new qq.Promise(), cachedWaitingForThumbnailImg = new qq.Promise(), log, isEditElementsExist, isRetryElementExist, templateDom, container, fileList, showThumbnails, serverScale, cacheThumbnailPlaceholders = function() {\n            var notAvailableUrl = options.placeholders.thumbnailNotAvailable, waitingUrl = options.placeholders.waitingForThumbnail, spec = {\n                maxSize: thumbnailMaxSize,\n                scale: serverScale\n            };\n            if (showThumbnails) {\n                if (notAvailableUrl) {\n                    options.imageGenerator.generate(notAvailableUrl, new Image(), spec).then(function(updatedImg) {\n                        cachedThumbnailNotAvailableImg.success(updatedImg);\n                    }, function() {\n                        cachedThumbnailNotAvailableImg.failure();\n                        log(\"Problem loading 'not available' placeholder image at \" + notAvailableUrl, \"error\");\n                    });\n                } else {\n                    cachedThumbnailNotAvailableImg.failure();\n                }\n                if (waitingUrl) {\n                    options.imageGenerator.generate(waitingUrl, new Image(), spec).then(function(updatedImg) {\n                        cachedWaitingForThumbnailImg.success(updatedImg);\n                    }, function() {\n                        cachedWaitingForThumbnailImg.failure();\n                        log(\"Problem loading 'waiting for thumbnail' placeholder image at \" + waitingUrl, \"error\");\n                    });\n                } else {\n                    cachedWaitingForThumbnailImg.failure();\n                }\n            }\n        }, displayWaitingImg = function(thumbnail) {\n            var waitingImgPlacement = new qq.Promise();\n            cachedWaitingForThumbnailImg.then(function(img) {\n                maybeScalePlaceholderViaCss(img, thumbnail);\n                if (!thumbnail.src) {\n                    thumbnail.src = img.src;\n                    thumbnail.onload = function() {\n                        thumbnail.onload = null;\n                        show(thumbnail);\n                        waitingImgPlacement.success();\n                    };\n                } else {\n                    waitingImgPlacement.success();\n                }\n            }, function() {\n                hide(thumbnail);\n                waitingImgPlacement.success();\n            });\n            return waitingImgPlacement;\n        }, generateNewPreview = function(id, blob, spec) {\n            var thumbnail = getThumbnail(id);\n            log(\"Generating new thumbnail for \" + id);\n            blob.qqThumbnailId = id;\n            return options.imageGenerator.generate(blob, thumbnail, spec).then(function() {\n                generatedThumbnails++;\n                show(thumbnail);\n                previewGeneration[id].success();\n            }, function() {\n                previewGeneration[id].failure();\n                if (!options.placeholders.waitUntilUpdate) {\n                    maybeSetDisplayNotAvailableImg(id, thumbnail);\n                }\n            });\n        }, generateNextQueuedPreview = function() {\n            if (thumbGenerationQueue.length) {\n                thumbnailQueueMonitorRunning = true;\n                var queuedThumbRequest = thumbGenerationQueue.shift();\n                if (queuedThumbRequest.update) {\n                    processUpdateQueuedPreviewRequest(queuedThumbRequest);\n                } else {\n                    processNewQueuedPreviewRequest(queuedThumbRequest);\n                }\n            } else {\n                thumbnailQueueMonitorRunning = false;\n            }\n        }, getCancel = function(id) {\n            return getTemplateEl(getFile(id), selectorClasses.cancel);\n        }, getContinue = function(id) {\n            return getTemplateEl(getFile(id), selectorClasses.continueButton);\n        }, getDialog = function(type) {\n            return getTemplateEl(container, selectorClasses[type + \"Dialog\"]);\n        }, getDelete = function(id) {\n            return getTemplateEl(getFile(id), selectorClasses.deleteButton);\n        }, getDropProcessing = function() {\n            return getTemplateEl(container, selectorClasses.dropProcessing);\n        }, getEditIcon = function(id) {\n            return getTemplateEl(getFile(id), selectorClasses.editNameIcon);\n        }, getFile = function(id) {\n            return fileBatch.map[id] || qq(fileList).getFirstByClass(FILE_CLASS_PREFIX + id);\n        }, getFilename = function(id) {\n            return getTemplateEl(getFile(id), selectorClasses.file);\n        }, getPause = function(id) {\n            return getTemplateEl(getFile(id), selectorClasses.pause);\n        }, getProgress = function(id) {\n            if (id == null) {\n                return getTemplateEl(container, selectorClasses.totalProgressBarContainer) || getTemplateEl(container, selectorClasses.totalProgressBar);\n            }\n            return getTemplateEl(getFile(id), selectorClasses.progressBarContainer) || getTemplateEl(getFile(id), selectorClasses.progressBar);\n        }, getRetry = function(id) {\n            return getTemplateEl(getFile(id), selectorClasses.retry);\n        }, getSize = function(id) {\n            return getTemplateEl(getFile(id), selectorClasses.size);\n        }, getSpinner = function(id) {\n            return getTemplateEl(getFile(id), selectorClasses.spinner);\n        }, getTemplateEl = function(context, cssClass) {\n            return context && qq(context).getFirstByClass(cssClass);\n        }, getThumbnail = function(id) {\n            return showThumbnails && getTemplateEl(getFile(id), selectorClasses.thumbnail);\n        }, hide = function(el) {\n            el && qq(el).addClass(options.classes.hide);\n        }, maybeScalePlaceholderViaCss = function(placeholder, thumbnail) {\n            var maxWidth = placeholder.style.maxWidth, maxHeight = placeholder.style.maxHeight;\n            if (maxHeight && maxWidth && !thumbnail.style.maxWidth && !thumbnail.style.maxHeight) {\n                qq(thumbnail).css({\n                    maxWidth: maxWidth,\n                    maxHeight: maxHeight\n                });\n            }\n        }, maybeSetDisplayNotAvailableImg = function(id, thumbnail) {\n            var previewing = previewGeneration[id] || new qq.Promise().failure(), notAvailableImgPlacement = new qq.Promise();\n            cachedThumbnailNotAvailableImg.then(function(img) {\n                previewing.then(function() {\n                    notAvailableImgPlacement.success();\n                }, function() {\n                    maybeScalePlaceholderViaCss(img, thumbnail);\n                    thumbnail.onload = function() {\n                        thumbnail.onload = null;\n                        notAvailableImgPlacement.success();\n                    };\n                    thumbnail.src = img.src;\n                    show(thumbnail);\n                });\n            });\n            return notAvailableImgPlacement;\n        }, parseAndGetTemplate = function() {\n            var scriptEl, scriptHtml, fileListNode, tempTemplateEl, fileListEl, defaultButton, dropArea, thumbnail, dropProcessing, dropTextEl, uploaderEl;\n            log(\"Parsing template\");\n            if (options.templateIdOrEl == null) {\n                throw new Error(\"You MUST specify either a template element or ID!\");\n            }\n            if (qq.isString(options.templateIdOrEl)) {\n                scriptEl = document.getElementById(options.templateIdOrEl);\n                if (scriptEl === null) {\n                    throw new Error(qq.format(\"Cannot find template script at ID '{}'!\", options.templateIdOrEl));\n                }\n                scriptHtml = scriptEl.innerHTML;\n            } else {\n                if (options.templateIdOrEl.innerHTML === undefined) {\n                    throw new Error(\"You have specified an invalid value for the template option!  \" + \"It must be an ID or an Element.\");\n                }\n                scriptHtml = options.templateIdOrEl.innerHTML;\n            }\n            scriptHtml = qq.trimStr(scriptHtml);\n            tempTemplateEl = document.createElement(\"div\");\n            tempTemplateEl.appendChild(qq.toElement(scriptHtml));\n            uploaderEl = qq(tempTemplateEl).getFirstByClass(selectorClasses.uploader);\n            if (options.button) {\n                defaultButton = qq(tempTemplateEl).getFirstByClass(selectorClasses.button);\n                if (defaultButton) {\n                    qq(defaultButton).remove();\n                }\n            }\n            if (!qq.DragAndDrop || !qq.supportedFeatures.fileDrop) {\n                dropProcessing = qq(tempTemplateEl).getFirstByClass(selectorClasses.dropProcessing);\n                if (dropProcessing) {\n                    qq(dropProcessing).remove();\n                }\n            }\n            dropArea = qq(tempTemplateEl).getFirstByClass(selectorClasses.drop);\n            if (dropArea && !qq.DragAndDrop) {\n                log(\"DnD module unavailable.\", \"info\");\n                qq(dropArea).remove();\n            }\n            if (!qq.supportedFeatures.fileDrop) {\n                uploaderEl.removeAttribute(DROPZPONE_TEXT_ATTR);\n                if (dropArea && qq(dropArea).hasAttribute(HIDE_DROPZONE_ATTR)) {\n                    qq(dropArea).css({\n                        display: \"none\"\n                    });\n                }\n            } else if (qq(uploaderEl).hasAttribute(DROPZPONE_TEXT_ATTR) && dropArea) {\n                dropTextEl = qq(dropArea).getFirstByClass(selectorClasses.dropText);\n                dropTextEl && qq(dropTextEl).remove();\n            }\n            thumbnail = qq(tempTemplateEl).getFirstByClass(selectorClasses.thumbnail);\n            if (!showThumbnails) {\n                thumbnail && qq(thumbnail).remove();\n            } else if (thumbnail) {\n                thumbnailMaxSize = parseInt(thumbnail.getAttribute(THUMBNAIL_MAX_SIZE_ATTR));\n                thumbnailMaxSize = thumbnailMaxSize > 0 ? thumbnailMaxSize : null;\n                serverScale = qq(thumbnail).hasAttribute(THUMBNAIL_SERVER_SCALE_ATTR);\n            }\n            showThumbnails = showThumbnails && thumbnail;\n            isEditElementsExist = qq(tempTemplateEl).getByClass(selectorClasses.editFilenameInput).length > 0;\n            isRetryElementExist = qq(tempTemplateEl).getByClass(selectorClasses.retry).length > 0;\n            fileListNode = qq(tempTemplateEl).getFirstByClass(selectorClasses.list);\n            if (fileListNode == null) {\n                throw new Error(\"Could not find the file list container in the template!\");\n            }\n            fileListEl = fileListNode.children[0].cloneNode(true);\n            fileListNode.innerHTML = \"\";\n            if (tempTemplateEl.getElementsByTagName(\"DIALOG\").length) {\n                document.createElement(\"dialog\");\n            }\n            log(\"Template parsing complete\");\n            return {\n                template: tempTemplateEl,\n                fileTemplate: fileListEl\n            };\n        }, prependFile = function(el, index, fileList) {\n            var parentEl = fileList, beforeEl = parentEl.firstChild;\n            if (index > 0) {\n                beforeEl = qq(parentEl).children()[index].nextSibling;\n            }\n            parentEl.insertBefore(el, beforeEl);\n        }, processNewQueuedPreviewRequest = function(queuedThumbRequest) {\n            var id = queuedThumbRequest.id, optFileOrBlob = queuedThumbRequest.optFileOrBlob, relatedThumbnailId = optFileOrBlob && optFileOrBlob.qqThumbnailId, thumbnail = getThumbnail(id), spec = {\n                customResizeFunction: queuedThumbRequest.customResizeFunction,\n                maxSize: thumbnailMaxSize,\n                orient: true,\n                scale: true\n            };\n            if (qq.supportedFeatures.imagePreviews) {\n                if (thumbnail) {\n                    if (options.limits.maxThumbs && options.limits.maxThumbs <= generatedThumbnails) {\n                        maybeSetDisplayNotAvailableImg(id, thumbnail);\n                        generateNextQueuedPreview();\n                    } else {\n                        displayWaitingImg(thumbnail).done(function() {\n                            previewGeneration[id] = new qq.Promise();\n                            previewGeneration[id].done(function() {\n                                setTimeout(generateNextQueuedPreview, options.limits.timeBetweenThumbs);\n                            });\n                            if (relatedThumbnailId != null) {\n                                useCachedPreview(id, relatedThumbnailId);\n                            } else {\n                                generateNewPreview(id, optFileOrBlob, spec);\n                            }\n                        });\n                    }\n                } else {\n                    generateNextQueuedPreview();\n                }\n            } else if (thumbnail) {\n                displayWaitingImg(thumbnail);\n                generateNextQueuedPreview();\n            }\n        }, processUpdateQueuedPreviewRequest = function(queuedThumbRequest) {\n            var id = queuedThumbRequest.id, thumbnailUrl = queuedThumbRequest.thumbnailUrl, showWaitingImg = queuedThumbRequest.showWaitingImg, thumbnail = getThumbnail(id), spec = {\n                customResizeFunction: queuedThumbRequest.customResizeFunction,\n                scale: serverScale,\n                maxSize: thumbnailMaxSize\n            };\n            if (thumbnail) {\n                if (thumbnailUrl) {\n                    if (options.limits.maxThumbs && options.limits.maxThumbs <= generatedThumbnails) {\n                        maybeSetDisplayNotAvailableImg(id, thumbnail);\n                        generateNextQueuedPreview();\n                    } else {\n                        if (showWaitingImg) {\n                            displayWaitingImg(thumbnail);\n                        }\n                        return options.imageGenerator.generate(thumbnailUrl, thumbnail, spec).then(function() {\n                            show(thumbnail);\n                            generatedThumbnails++;\n                            setTimeout(generateNextQueuedPreview, options.limits.timeBetweenThumbs);\n                        }, function() {\n                            maybeSetDisplayNotAvailableImg(id, thumbnail);\n                            setTimeout(generateNextQueuedPreview, options.limits.timeBetweenThumbs);\n                        });\n                    }\n                } else {\n                    maybeSetDisplayNotAvailableImg(id, thumbnail);\n                    generateNextQueuedPreview();\n                }\n            }\n        }, setProgressBarWidth = function(id, percent) {\n            var bar = getProgress(id), progressBarSelector = id == null ? selectorClasses.totalProgressBar : selectorClasses.progressBar;\n            if (bar && !qq(bar).hasClass(progressBarSelector)) {\n                bar = qq(bar).getFirstByClass(progressBarSelector);\n            }\n            if (bar) {\n                qq(bar).css({\n                    width: percent + \"%\"\n                });\n                bar.setAttribute(\"aria-valuenow\", percent);\n            }\n        }, show = function(el) {\n            el && qq(el).removeClass(options.classes.hide);\n        }, useCachedPreview = function(targetThumbnailId, cachedThumbnailId) {\n            var targetThumbnail = getThumbnail(targetThumbnailId), cachedThumbnail = getThumbnail(cachedThumbnailId);\n            log(qq.format(\"ID {} is the same file as ID {}.  Will use generated thumbnail from ID {} instead.\", targetThumbnailId, cachedThumbnailId, cachedThumbnailId));\n            previewGeneration[cachedThumbnailId].then(function() {\n                generatedThumbnails++;\n                previewGeneration[targetThumbnailId].success();\n                log(qq.format(\"Now using previously generated thumbnail created for ID {} on ID {}.\", cachedThumbnailId, targetThumbnailId));\n                targetThumbnail.src = cachedThumbnail.src;\n                show(targetThumbnail);\n            }, function() {\n                previewGeneration[targetThumbnailId].failure();\n                if (!options.placeholders.waitUntilUpdate) {\n                    maybeSetDisplayNotAvailableImg(targetThumbnailId, targetThumbnail);\n                }\n            });\n        };\n        qq.extend(options, spec);\n        log = options.log;\n        if (!qq.supportedFeatures.imagePreviews) {\n            options.limits.timeBetweenThumbs = 0;\n            options.limits.maxThumbs = 0;\n        }\n        container = options.containerEl;\n        showThumbnails = options.imageGenerator !== undefined;\n        templateDom = parseAndGetTemplate();\n        cacheThumbnailPlaceholders();\n        qq.extend(this, {\n            render: function() {\n                log(\"Rendering template in DOM.\");\n                generatedThumbnails = 0;\n                container.appendChild(templateDom.template.cloneNode(true));\n                hide(getDropProcessing());\n                this.hideTotalProgress();\n                fileList = options.fileContainerEl || getTemplateEl(container, selectorClasses.list);\n                log(\"Template rendering complete\");\n            },\n            renderFailure: function(message) {\n                var cantRenderEl = qq.toElement(message);\n                container.innerHTML = \"\";\n                container.appendChild(cantRenderEl);\n            },\n            reset: function() {\n                container.innerHTML = \"\";\n                this.render();\n            },\n            clearFiles: function() {\n                fileList.innerHTML = \"\";\n            },\n            disableCancel: function() {\n                isCancelDisabled = true;\n            },\n            addFile: function(id, name, prependInfo, hideForever, batch) {\n                var fileEl = templateDom.fileTemplate.cloneNode(true), fileNameEl = getTemplateEl(fileEl, selectorClasses.file), uploaderEl = getTemplateEl(container, selectorClasses.uploader), fileContainer = batch ? fileBatch.content : fileList, thumb;\n                if (batch) {\n                    fileBatch.map[id] = fileEl;\n                }\n                qq(fileEl).addClass(FILE_CLASS_PREFIX + id);\n                uploaderEl.removeAttribute(DROPZPONE_TEXT_ATTR);\n                if (fileNameEl) {\n                    qq(fileNameEl).setText(name);\n                    fileNameEl.setAttribute(\"title\", name);\n                }\n                fileEl.setAttribute(FILE_ID_ATTR, id);\n                if (prependInfo) {\n                    prependFile(fileEl, prependInfo.index, fileContainer);\n                } else {\n                    fileContainer.appendChild(fileEl);\n                }\n                if (hideForever) {\n                    fileEl.style.display = \"none\";\n                    qq(fileEl).addClass(HIDDEN_FOREVER_CLASS);\n                } else {\n                    hide(getProgress(id));\n                    hide(getSize(id));\n                    hide(getDelete(id));\n                    hide(getRetry(id));\n                    hide(getPause(id));\n                    hide(getContinue(id));\n                    if (isCancelDisabled) {\n                        this.hideCancel(id);\n                    }\n                    thumb = getThumbnail(id);\n                    if (thumb && !thumb.src) {\n                        cachedWaitingForThumbnailImg.then(function(waitingImg) {\n                            thumb.src = waitingImg.src;\n                            if (waitingImg.style.maxHeight && waitingImg.style.maxWidth) {\n                                qq(thumb).css({\n                                    maxHeight: waitingImg.style.maxHeight,\n                                    maxWidth: waitingImg.style.maxWidth\n                                });\n                            }\n                            show(thumb);\n                        });\n                    }\n                }\n            },\n            addFileToCache: function(id, name, prependInfo, hideForever) {\n                this.addFile(id, name, prependInfo, hideForever, true);\n            },\n            addCacheToDom: function() {\n                fileList.appendChild(fileBatch.content);\n                fileBatch.content = document.createDocumentFragment();\n                fileBatch.map = {};\n            },\n            removeFile: function(id) {\n                qq(getFile(id)).remove();\n            },\n            getFileId: function(el) {\n                var currentNode = el;\n                if (currentNode) {\n                    while (currentNode.getAttribute(FILE_ID_ATTR) == null) {\n                        currentNode = currentNode.parentNode;\n                    }\n                    return parseInt(currentNode.getAttribute(FILE_ID_ATTR));\n                }\n            },\n            getFileList: function() {\n                return fileList;\n            },\n            markFilenameEditable: function(id) {\n                var filename = getFilename(id);\n                filename && qq(filename).addClass(options.classes.editable);\n            },\n            updateFilename: function(id, name) {\n                var filenameEl = getFilename(id);\n                if (filenameEl) {\n                    qq(filenameEl).setText(name);\n                    filenameEl.setAttribute(\"title\", name);\n                }\n            },\n            hideFilename: function(id) {\n                hide(getFilename(id));\n            },\n            showFilename: function(id) {\n                show(getFilename(id));\n            },\n            isFileName: function(el) {\n                return qq(el).hasClass(selectorClasses.file);\n            },\n            getButton: function() {\n                return options.button || getTemplateEl(container, selectorClasses.button);\n            },\n            hideDropProcessing: function() {\n                hide(getDropProcessing());\n            },\n            showDropProcessing: function() {\n                show(getDropProcessing());\n            },\n            getDropZone: function() {\n                return getTemplateEl(container, selectorClasses.drop);\n            },\n            isEditFilenamePossible: function() {\n                return isEditElementsExist;\n            },\n            hideRetry: function(id) {\n                hide(getRetry(id));\n            },\n            isRetryPossible: function() {\n                return isRetryElementExist;\n            },\n            showRetry: function(id) {\n                show(getRetry(id));\n            },\n            getFileContainer: function(id) {\n                return getFile(id);\n            },\n            showEditIcon: function(id) {\n                var icon = getEditIcon(id);\n                icon && qq(icon).addClass(options.classes.editable);\n            },\n            isHiddenForever: function(id) {\n                return qq(getFile(id)).hasClass(HIDDEN_FOREVER_CLASS);\n            },\n            hideEditIcon: function(id) {\n                var icon = getEditIcon(id);\n                icon && qq(icon).removeClass(options.classes.editable);\n            },\n            isEditIcon: function(el) {\n                return qq(el).hasClass(selectorClasses.editNameIcon, true);\n            },\n            getEditInput: function(id) {\n                return getTemplateEl(getFile(id), selectorClasses.editFilenameInput);\n            },\n            isEditInput: function(el) {\n                return qq(el).hasClass(selectorClasses.editFilenameInput, true);\n            },\n            updateProgress: function(id, loaded, total) {\n                var bar = getProgress(id), percent;\n                if (bar && total > 0) {\n                    percent = Math.round(loaded / total * 100);\n                    if (percent === 100) {\n                        hide(bar);\n                    } else {\n                        show(bar);\n                    }\n                    setProgressBarWidth(id, percent);\n                }\n            },\n            updateTotalProgress: function(loaded, total) {\n                this.updateProgress(null, loaded, total);\n            },\n            hideProgress: function(id) {\n                var bar = getProgress(id);\n                bar && hide(bar);\n            },\n            hideTotalProgress: function() {\n                this.hideProgress();\n            },\n            resetProgress: function(id) {\n                setProgressBarWidth(id, 0);\n                this.hideTotalProgress(id);\n            },\n            resetTotalProgress: function() {\n                this.resetProgress();\n            },\n            showCancel: function(id) {\n                if (!isCancelDisabled) {\n                    var cancel = getCancel(id);\n                    cancel && qq(cancel).removeClass(options.classes.hide);\n                }\n            },\n            hideCancel: function(id) {\n                hide(getCancel(id));\n            },\n            isCancel: function(el) {\n                return qq(el).hasClass(selectorClasses.cancel, true);\n            },\n            allowPause: function(id) {\n                show(getPause(id));\n                hide(getContinue(id));\n            },\n            uploadPaused: function(id) {\n                this.setStatusText(id, options.text.paused);\n                this.allowContinueButton(id);\n                hide(getSpinner(id));\n            },\n            hidePause: function(id) {\n                hide(getPause(id));\n            },\n            isPause: function(el) {\n                return qq(el).hasClass(selectorClasses.pause, true);\n            },\n            isContinueButton: function(el) {\n                return qq(el).hasClass(selectorClasses.continueButton, true);\n            },\n            allowContinueButton: function(id) {\n                show(getContinue(id));\n                hide(getPause(id));\n            },\n            uploadContinued: function(id) {\n                this.setStatusText(id, \"\");\n                this.allowPause(id);\n                show(getSpinner(id));\n            },\n            showDeleteButton: function(id) {\n                show(getDelete(id));\n            },\n            hideDeleteButton: function(id) {\n                hide(getDelete(id));\n            },\n            isDeleteButton: function(el) {\n                return qq(el).hasClass(selectorClasses.deleteButton, true);\n            },\n            isRetry: function(el) {\n                return qq(el).hasClass(selectorClasses.retry, true);\n            },\n            updateSize: function(id, text) {\n                var size = getSize(id);\n                if (size) {\n                    show(size);\n                    qq(size).setText(text);\n                }\n            },\n            setStatusText: function(id, text) {\n                var textEl = getTemplateEl(getFile(id), selectorClasses.statusText);\n                if (textEl) {\n                    if (text == null) {\n                        qq(textEl).clearText();\n                    } else {\n                        qq(textEl).setText(text);\n                    }\n                }\n            },\n            hideSpinner: function(id) {\n                qq(getFile(id)).removeClass(IN_PROGRESS_CLASS);\n                hide(getSpinner(id));\n            },\n            showSpinner: function(id) {\n                qq(getFile(id)).addClass(IN_PROGRESS_CLASS);\n                show(getSpinner(id));\n            },\n            generatePreview: function(id, optFileOrBlob, customResizeFunction) {\n                if (!this.isHiddenForever(id)) {\n                    thumbGenerationQueue.push({\n                        id: id,\n                        customResizeFunction: customResizeFunction,\n                        optFileOrBlob: optFileOrBlob\n                    });\n                    !thumbnailQueueMonitorRunning && generateNextQueuedPreview();\n                }\n            },\n            updateThumbnail: function(id, thumbnailUrl, showWaitingImg, customResizeFunction) {\n                if (!this.isHiddenForever(id)) {\n                    thumbGenerationQueue.push({\n                        customResizeFunction: customResizeFunction,\n                        update: true,\n                        id: id,\n                        thumbnailUrl: thumbnailUrl,\n                        showWaitingImg: showWaitingImg\n                    });\n                    !thumbnailQueueMonitorRunning && generateNextQueuedPreview();\n                }\n            },\n            hasDialog: function(type) {\n                return qq.supportedFeatures.dialogElement && !!getDialog(type);\n            },\n            showDialog: function(type, message, defaultValue) {\n                var dialog = getDialog(type), messageEl = getTemplateEl(dialog, selectorClasses.dialogMessage), inputEl = dialog.getElementsByTagName(\"INPUT\")[0], cancelBtn = getTemplateEl(dialog, selectorClasses.dialogCancelButton), okBtn = getTemplateEl(dialog, selectorClasses.dialogOkButton), promise = new qq.Promise(), closeHandler = function() {\n                    cancelBtn.removeEventListener(\"click\", cancelClickHandler);\n                    okBtn && okBtn.removeEventListener(\"click\", okClickHandler);\n                    promise.failure();\n                }, cancelClickHandler = function() {\n                    cancelBtn.removeEventListener(\"click\", cancelClickHandler);\n                    dialog.close();\n                }, okClickHandler = function() {\n                    dialog.removeEventListener(\"close\", closeHandler);\n                    okBtn.removeEventListener(\"click\", okClickHandler);\n                    dialog.close();\n                    promise.success(inputEl && inputEl.value);\n                };\n                dialog.addEventListener(\"close\", closeHandler);\n                cancelBtn.addEventListener(\"click\", cancelClickHandler);\n                okBtn && okBtn.addEventListener(\"click\", okClickHandler);\n                if (inputEl) {\n                    inputEl.value = defaultValue;\n                }\n                messageEl.textContent = message;\n                dialog.showModal();\n                return promise;\n            }\n        });\n    };\n    qq.UiEventHandler = function(s, protectedApi) {\n        \"use strict\";\n        var disposer = new qq.DisposeSupport(), spec = {\n            eventType: \"click\",\n            attachTo: null,\n            onHandled: function(target, event) {}\n        };\n        qq.extend(this, {\n            addHandler: function(element) {\n                addHandler(element);\n            },\n            dispose: function() {\n                disposer.dispose();\n            }\n        });\n        function addHandler(element) {\n            disposer.attach(element, spec.eventType, function(event) {\n                event = event || window.event;\n                var target = event.target || event.srcElement;\n                spec.onHandled(target, event);\n            });\n        }\n        qq.extend(protectedApi, {\n            getFileIdFromItem: function(item) {\n                return item.qqFileId;\n            },\n            getDisposeSupport: function() {\n                return disposer;\n            }\n        });\n        qq.extend(spec, s);\n        if (spec.attachTo) {\n            addHandler(spec.attachTo);\n        }\n    };\n    qq.FileButtonsClickHandler = function(s) {\n        \"use strict\";\n        var inheritedInternalApi = {}, spec = {\n            templating: null,\n            log: function(message, lvl) {},\n            onDeleteFile: function(fileId) {},\n            onCancel: function(fileId) {},\n            onRetry: function(fileId) {},\n            onPause: function(fileId) {},\n            onContinue: function(fileId) {},\n            onGetName: function(fileId) {}\n        }, buttonHandlers = {\n            cancel: function(id) {\n                spec.onCancel(id);\n            },\n            retry: function(id) {\n                spec.onRetry(id);\n            },\n            deleteButton: function(id) {\n                spec.onDeleteFile(id);\n            },\n            pause: function(id) {\n                spec.onPause(id);\n            },\n            continueButton: function(id) {\n                spec.onContinue(id);\n            }\n        };\n        function examineEvent(target, event) {\n            qq.each(buttonHandlers, function(buttonType, handler) {\n                var firstLetterCapButtonType = buttonType.charAt(0).toUpperCase() + buttonType.slice(1), fileId;\n                if (spec.templating[\"is\" + firstLetterCapButtonType](target)) {\n                    fileId = spec.templating.getFileId(target);\n                    qq.preventDefault(event);\n                    spec.log(qq.format(\"Detected valid file button click event on file '{}', ID: {}.\", spec.onGetName(fileId), fileId));\n                    handler(fileId);\n                    return false;\n                }\n            });\n        }\n        qq.extend(spec, s);\n        spec.eventType = \"click\";\n        spec.onHandled = examineEvent;\n        spec.attachTo = spec.templating.getFileList();\n        qq.extend(this, new qq.UiEventHandler(spec, inheritedInternalApi));\n    };\n    qq.FilenameClickHandler = function(s) {\n        \"use strict\";\n        var inheritedInternalApi = {}, spec = {\n            templating: null,\n            log: function(message, lvl) {},\n            classes: {\n                file: \"qq-upload-file\",\n                editNameIcon: \"qq-edit-filename-icon\"\n            },\n            onGetUploadStatus: function(fileId) {},\n            onGetName: function(fileId) {}\n        };\n        qq.extend(spec, s);\n        function examineEvent(target, event) {\n            if (spec.templating.isFileName(target) || spec.templating.isEditIcon(target)) {\n                var fileId = spec.templating.getFileId(target), status = spec.onGetUploadStatus(fileId);\n                if (status === qq.status.SUBMITTED) {\n                    spec.log(qq.format(\"Detected valid filename click event on file '{}', ID: {}.\", spec.onGetName(fileId), fileId));\n                    qq.preventDefault(event);\n                    inheritedInternalApi.handleFilenameEdit(fileId, target, true);\n                }\n            }\n        }\n        spec.eventType = \"click\";\n        spec.onHandled = examineEvent;\n        qq.extend(this, new qq.FilenameEditHandler(spec, inheritedInternalApi));\n    };\n    qq.FilenameInputFocusInHandler = function(s, inheritedInternalApi) {\n        \"use strict\";\n        var spec = {\n            templating: null,\n            onGetUploadStatus: function(fileId) {},\n            log: function(message, lvl) {}\n        };\n        if (!inheritedInternalApi) {\n            inheritedInternalApi = {};\n        }\n        function handleInputFocus(target, event) {\n            if (spec.templating.isEditInput(target)) {\n                var fileId = spec.templating.getFileId(target), status = spec.onGetUploadStatus(fileId);\n                if (status === qq.status.SUBMITTED) {\n                    spec.log(qq.format(\"Detected valid filename input focus event on file '{}', ID: {}.\", spec.onGetName(fileId), fileId));\n                    inheritedInternalApi.handleFilenameEdit(fileId, target);\n                }\n            }\n        }\n        spec.eventType = \"focusin\";\n        spec.onHandled = handleInputFocus;\n        qq.extend(spec, s);\n        qq.extend(this, new qq.FilenameEditHandler(spec, inheritedInternalApi));\n    };\n    qq.FilenameInputFocusHandler = function(spec) {\n        \"use strict\";\n        spec.eventType = \"focus\";\n        spec.attachTo = null;\n        qq.extend(this, new qq.FilenameInputFocusInHandler(spec, {}));\n    };\n    qq.FilenameEditHandler = function(s, inheritedInternalApi) {\n        \"use strict\";\n        var spec = {\n            templating: null,\n            log: function(message, lvl) {},\n            onGetUploadStatus: function(fileId) {},\n            onGetName: function(fileId) {},\n            onSetName: function(fileId, newName) {},\n            onEditingStatusChange: function(fileId, isEditing) {}\n        };\n        function getFilenameSansExtension(fileId) {\n            var filenameSansExt = spec.onGetName(fileId), extIdx = filenameSansExt.lastIndexOf(\".\");\n            if (extIdx > 0) {\n                filenameSansExt = filenameSansExt.substr(0, extIdx);\n            }\n            return filenameSansExt;\n        }\n        function getOriginalExtension(fileId) {\n            var origName = spec.onGetName(fileId);\n            return qq.getExtension(origName);\n        }\n        function handleNameUpdate(newFilenameInputEl, fileId) {\n            var newName = newFilenameInputEl.value, origExtension;\n            if (newName !== undefined && qq.trimStr(newName).length > 0) {\n                origExtension = getOriginalExtension(fileId);\n                if (origExtension !== undefined) {\n                    newName = newName + \".\" + origExtension;\n                }\n                spec.onSetName(fileId, newName);\n            }\n            spec.onEditingStatusChange(fileId, false);\n        }\n        function registerInputBlurHandler(inputEl, fileId) {\n            inheritedInternalApi.getDisposeSupport().attach(inputEl, \"blur\", function() {\n                handleNameUpdate(inputEl, fileId);\n            });\n        }\n        function registerInputEnterKeyHandler(inputEl, fileId) {\n            inheritedInternalApi.getDisposeSupport().attach(inputEl, \"keyup\", function(event) {\n                var code = event.keyCode || event.which;\n                if (code === 13) {\n                    handleNameUpdate(inputEl, fileId);\n                }\n            });\n        }\n        qq.extend(spec, s);\n        spec.attachTo = spec.templating.getFileList();\n        qq.extend(this, new qq.UiEventHandler(spec, inheritedInternalApi));\n        qq.extend(inheritedInternalApi, {\n            handleFilenameEdit: function(id, target, focusInput) {\n                var newFilenameInputEl = spec.templating.getEditInput(id);\n                spec.onEditingStatusChange(id, true);\n                newFilenameInputEl.value = getFilenameSansExtension(id);\n                if (focusInput) {\n                    newFilenameInputEl.focus();\n                }\n                registerInputBlurHandler(newFilenameInputEl, id);\n                registerInputEnterKeyHandler(newFilenameInputEl, id);\n            }\n        });\n    };\n})(window);\n//# sourceMappingURL=fine-uploader.js.map","var map = {\n\t\"./7z.svg\": 7,\n\t\"./ai.svg\": 8,\n\t\"./audio.svg\": 9,\n\t\"./avi.svg\": 10,\n\t\"./csv.svg\": 11,\n\t\"./doc.svg\": 12,\n\t\"./flac.svg\": 13,\n\t\"./json.svg\": 14,\n\t\"./mp3.svg\": 15,\n\t\"./mp4.svg\": 16,\n\t\"./pdf.svg\": 17,\n\t\"./ppt.svg\": 18,\n\t\"./psd.svg\": 19,\n\t\"./rar.svg\": 20,\n\t\"./rtf.svg\": 21,\n\t\"./svg.svg\": 22,\n\t\"./tar.svg\": 23,\n\t\"./txt.svg\": 24,\n\t\"./unknown.svg\": 25,\n\t\"./video.svg\": 26,\n\t\"./wav.svg\": 27,\n\t\"./wma.svg\": 28,\n\t\"./xls.svg\": 29,\n\t\"./xml.svg\": 30,\n\t\"./zip.svg\": 31\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 6;","module.exports = __webpack_public_path__ + \"image/7z.svg\";","module.exports = __webpack_public_path__ + \"image/ai.svg\";","module.exports = __webpack_public_path__ + \"image/audio.svg\";","module.exports = __webpack_public_path__ + \"image/avi.svg\";","module.exports = __webpack_public_path__ + \"image/csv.svg\";","module.exports = __webpack_public_path__ + \"image/doc.svg\";","module.exports = __webpack_public_path__ + \"image/flac.svg\";","module.exports = __webpack_public_path__ + \"image/json.svg\";","module.exports = __webpack_public_path__ + \"image/mp3.svg\";","module.exports = __webpack_public_path__ + \"image/mp4.svg\";","module.exports = __webpack_public_path__ + \"image/pdf.svg\";","module.exports = __webpack_public_path__ + \"image/ppt.svg\";","module.exports = __webpack_public_path__ + \"image/psd.svg\";","module.exports = __webpack_public_path__ + \"image/rar.svg\";","module.exports = __webpack_public_path__ + \"image/rtf.svg\";","module.exports = __webpack_public_path__ + \"image/svg.svg\";","module.exports = __webpack_public_path__ + \"image/tar.svg\";","module.exports = __webpack_public_path__ + \"image/txt.svg\";","module.exports = __webpack_public_path__ + \"image/unknown.svg\";","module.exports = __webpack_public_path__ + \"image/video.svg\";","module.exports = __webpack_public_path__ + \"image/wav.svg\";","module.exports = __webpack_public_path__ + \"image/wma.svg\";","module.exports = __webpack_public_path__ + \"image/xls.svg\";","module.exports = __webpack_public_path__ + \"image/xml.svg\";","module.exports = __webpack_public_path__ + \"image/zip.svg\";","import {FineUploaderBasic, DragAndDrop} from \"fine-uploader\";\n\n// PaperAdmin API\nconst EventEmitter = window.paperAdmin.EventEmitter;\n\n\nfunction Uploader(element, options) {\n    this._opts = Object.assign({\n        url: '',\n        multiple: false,\n        button: null,\n        dropzones: null,\n        extraData: null,\n        acceptFiles: null,\n        filters: []\n    }, options);\n\n    this.element = element;\n    this.uploader = this._makeUploader();\n}\n\nUploader.prototype = Object.create(EventEmitter.prototype);\n\nUploader.prototype.getParams = function() {\n    if (typeof this._opts.extraData === 'function') {\n        return Object.assign(getPaperParams(this.element), this._opts.extraData.call(this));\n    } else if (typeof this._opts.extraData === 'object') {\n        return Object.assign(getPaperParams(this.element), this._opts.extraData);\n    } else {\n        return getPaperParams(this.element);\n    }\n};\n\nUploader.prototype._makeUploader = function() {\n    const _this = this;\n\n    // ,     multiple=false\n    let is_loading = false;\n\n    let uploader = new FineUploaderBasic({\n        button: this._opts.button,\n        multiple: this._opts.multiple,\n        maxConnections: 1,\n        request: {\n            endpoint: this._opts.url,\n            params: this.getParams()\n        },\n        chunking: {\n            enabled: true,\n            partSize: 1024 * 1024\n        },\n        text: {\n            fileInputTitle: 'Select file'\n        },\n        validation: {\n            acceptFiles: this._opts.acceptFiles,\n        },\n        callbacks: {\n            onSubmit: function(id) {\n                if (!_this._opts.multiple) {\n                    if (is_loading) {\n                        return false;\n                    }\n                    is_loading = true;\n                }\n\n                //     \n                if (_this._opts.filters && _this._opts.filters.length) {\n                    const uploader = this;\n                    const file = this.getFile(id);\n                    for (let index=0; index<_this._opts.filters.length; index++) {\n                        const filter = _this._opts.filters[index];\n                        try {\n                            filter.call(uploader, id, file);\n                        } catch (error) {\n                            _this.trigger('reject', [id, file, error.message]);\n                            return false;\n                        }\n                    }\n                }\n            },\n            onSubmitted: function(id) {\n                _this.trigger('submit', [id]);\n            },\n            onUpload: function(id) {\n                _this.trigger('upload', [id]);\n            },\n            onProgress: function(id, name, uploadedBytes, totalBytes) {\n                const percentage = Math.ceil(100 * (uploadedBytes / totalBytes));\n                _this.trigger('progress', [id, percentage]);\n            },\n            onCancel: function(id) {\n                _this.trigger('cancel', [id]);\n            },\n            onComplete: function(id, name, response) {\n                if (response.success) {\n                    _this.trigger('complete', [id, response]);\n                }\n            },\n            onAllComplete: function(succeeded, failed) {\n                if (!_this._opts.multiple) {\n                    is_loading = false;\n                }\n                _this.trigger('all_complete', [succeeded, failed]);\n            },\n            onError: function(id, name, reason) {\n                _this.trigger('error', [id, reason]);\n            }\n        }\n    });\n\n    if (this._opts.dropzones && this._opts.dropzones.length) {\n        new DragAndDrop({\n            dropZoneElements: this._opts.dropzones,\n            allowMultipleItems: this._opts.multiple,\n            classes: {\n                dropActive: 'dropzone-highlighted'\n            },\n            callbacks: {\n                processingDroppedFilesComplete: function(files) {\n                    uploader.addFiles(files);\n                }\n            }\n        });\n    }\n\n    return uploader;\n};\n\n\nfunction getPaperParams(element) {\n    const params = {};\n    const dataset = element.dataset;\n    Object.keys(dataset).forEach(function(name) {\n        if (/^paper(?:[^a-z0-9]|$)/.test(name)) {\n            params[name] = dataset[name];\n        }\n    });\n    return params;\n}\n\n\nexport {Uploader, getPaperParams};\n","/* global gettext */\n\nimport deepmerge from \"deepmerge\";\nimport {Uploader, getPaperParams} from \"./_uploader\";\n\n// PaperAdmin API\nconst EventEmitter = window.paperAdmin.EventEmitter;\nconst whenDomReady = window.paperAdmin.whenDomReady;\nconst bootbox = window.paperAdmin.bootbox;\nconst emitters = window.paperAdmin.emitters;\nconst preloader = window.paperAdmin.preloader;\nconst formUtils = window.paperAdmin.formUtils;\n\n// CSS\nimport \"../css/widget_file.scss\";\n\n\n/**\n * @fires upload:submit\n * @fires upload:upload\n * @fires upload:created\n * @fires upload:deleted\n * @fires upload:complete\n * @fires upload:error\n * @param element\n * @param options\n * @constructor\n */\nfunction FileWidget(element, options) {\n    /**\n     * @type object\n     */\n    this._opts = deepmerge({\n        input: '.file-uploader__input',\n        uploadButton: '.file-uploader__upload-button',\n        changeButton: '.file-uploader__change-button',\n        deleteButton: '.file-uploader__delete-button',\n\n        link: '.file-uploader__link',\n\n        urls: {\n            upload: '',\n            change: '',\n            delete: ''\n        }\n    }, options || {});\n\n    this.element = element;\n\n    this.input = this.element.querySelector(this._opts.input);\n    if (!this.input) {\n        throw new Error(`Not found element \"${this._opts.input}\"`);\n    }\n\n    this.uploadButton = this.element.querySelector(this._opts.uploadButton);\n    if (!this.uploadButton) {\n        throw new Error(`Not found element \"${this._opts.uploadButton}\"`);\n    }\n\n    this.changeButton = this.element.querySelector(this._opts.changeButton);\n    if (!this.changeButton) {\n        throw new Error(`Not found element \"${this._opts.changeButton}\"`);\n    }\n\n    this.deleteButton = this.element.querySelector(this._opts.deleteButton);\n    if (!this.deleteButton) {\n        throw new Error(`Not found element \"${this._opts.deleteButton}\"`);\n    }\n\n    // \n    this.loading = false;\n    this.empty = isNaN(this.instanceId);\n\n    this.uploader = this.initUploader();\n    this.addListeners();\n}\n\nFileWidget.prototype = Object.create(EventEmitter.prototype);\n\nObject.defineProperty(FileWidget.prototype, 'instanceId', {\n    get: function() {\n        return parseInt(this.input.value);\n    },\n    set: function(value) {\n        this.input.value = parseInt(value) || '';\n    }\n});\n\nObject.defineProperty(FileWidget.prototype, 'empty', {\n    get: function() {\n        return Boolean(this._empty);\n    },\n    set: function(value) {\n        const newValue = Boolean(value);\n        if (newValue === Boolean(this._empty)) {\n            return\n        }\n        if (newValue) {\n            this.element.classList.add('empty');\n        } else {\n            this.element.classList.remove('empty');\n        }\n        this._empty = newValue;\n    }\n});\n\nObject.defineProperty(FileWidget.prototype, 'loading', {\n    get: function() {\n        return Boolean(this._loading);\n    },\n    set: function(value) {\n        const newValue = Boolean(value);\n        if (newValue === Boolean(this._loading)) {\n            return\n        }\n        if (newValue) {\n            this.element.classList.add('loading');\n        } else {\n            this.element.classList.remove('loading');\n        }\n        this._loading = newValue;\n    }\n});\n\n/**\n *   .\n */\nFileWidget.prototype.initUploader = function() {\n    const _this = this;\n    return new Uploader(this.element, {\n        url: this._opts.urls.upload,\n        button: this.uploadButton,\n        dropzones: this.element.querySelectorAll('.dropzone-overlay'),\n    }).on('submit', function(id) {\n        _this.trigger('upload:submit', [id]);\n    }).on('upload', function(id) {\n        _this.loading = true;\n\n        const progressBar = _this.element.querySelector('.progress-bar');\n        progressBar && (progressBar.style.width = '');\n        _this.trigger('upload:upload', [id]);\n    }).on('progress', function(id, percentage) {\n        const progressBar = _this.element.querySelector('.progress-bar');\n        progressBar && (progressBar.style.width = percentage + '%');\n    }).on('complete', function(id, response) {\n        _this.empty = false;\n        _this.instanceId = response.instance_id;\n        _this.trigger('upload:created');\n\n        _this.element.classList.remove('loading');\n\n        const fileName = _this.element.querySelector('.file-name');\n        fileName && (fileName.textContent = response.name);\n\n        const fileInfo = _this.element.querySelector('.file-info');\n        fileInfo && (fileInfo.textContent = response.file_info);\n\n        const previewLink = _this.element.querySelector(_this._opts.link);\n        previewLink && (previewLink.href = response.url);\n\n        _this.trigger('upload:complete');\n    }).on('cancel', function(id) {\n        _this.trigger('upload:cancel', [id]);\n    }).on('error', function(id, reason) {\n        _this.trigger('upload:error', [reason]);\n    }).on('all_complete', function() {\n        _this.loading = false;\n    });\n};\n\n/**\n *    .\n * @param $dialog\n * @private\n */\nFileWidget.prototype._change = function($dialog) {\n    if (isNaN(this.instanceId)) {\n        return\n    }\n\n    const _this = this;\n    const $form = $dialog.find('form');\n    Promise.all([\n        preloader.show(),\n        fetch($form.prop('action'), {\n            method: 'POST',\n            credentials: 'same-origin',\n            body: new FormData($form.get(0))\n        })\n    ]).then(function(values) {\n        const response = values[1];\n        if (!response.ok) {\n            const error = new Error(`${response.status} ${response.statusText}`);\n            error.response = response;\n            throw error;\n        }\n\n        return response.json();\n    }).then(function(response) {\n        if (response.error) {\n            const error = new Error(response.error);\n            error.response = response;\n            throw error\n        }\n\n        preloader.hide();\n        formUtils.cleanFormErrors($form.get(0));\n        if (response.form_errors) {\n            formUtils.addFormErrorsFromJSON($form.get(0), response.form_errors);\n        } else {\n            $dialog.modal('hide');\n\n            const fileName = _this.element.querySelector('.file-name');\n            fileName && (fileName.textContent = response.name);\n\n            const fileInfo = _this.element.querySelector('.file-info');\n            fileInfo && (fileInfo.textContent = response.file_info);\n\n            const previewLink = _this.element.querySelector(_this._opts.link);\n            previewLink && (previewLink.href = response.url);\n        }\n    }).catch(function(error) {\n        preloader.hide();\n        _this.trigger('upload:error', [null, error]);\n    });\n};\n\n/**\n *  .\n * @private\n */\nFileWidget.prototype._delete = function() {\n    if (isNaN(this.instanceId)) {\n        return\n    }\n\n    const data = new FormData();\n    const params = getPaperParams(this.element);\n    Object.keys(params).forEach(function(name) {\n        data.append(name, params[name]);\n    });\n    data.append('instance_id', this.instanceId.toString());\n\n    const _this = this;\n    fetch(this._opts.urls.delete, {\n        method: 'POST',\n        credentials: 'same-origin',\n        body: data\n    }).then(function(response) {\n        if (!response.ok) {\n            const error = new Error(`${response.status} ${response.statusText}`);\n            error.response = response;\n            throw error;\n        }\n        return response.json();\n    }).then(function(response) {\n        if (response.error) {\n            const error = new Error(response.error);\n            error.response = response;\n            throw error\n        }\n\n        _this.empty = true;\n        _this.instanceId = '';\n\n        const fileName = _this.element.querySelector('.file-name');\n        fileName && (fileName.textContent = '');\n\n        const fileInfo = _this.element.querySelector('.file-info');\n        fileInfo && (fileInfo.textContent = '');\n\n        _this.trigger('upload:deleted');\n    }).catch(function(error) {\n        _this.trigger('upload:error', [null, error]);\n    });\n};\n\nFileWidget.prototype.addListeners = function() {\n    const _this = this;\n\n    //  \n    this.deleteButton.addEventListener('click', function(event) {\n        event.preventDefault();\n\n        bootbox.dialog({\n            size: 'small',\n            title: gettext('Confirmation'),\n            message: gettext('Are you sure you want to <b>DELETE</b> this file?'),\n            onEscape: true,\n            buttons: {\n                cancel: {\n                    label: gettext('Cancel'),\n                    className: 'btn-outline-info'\n                },\n                confirm: {\n                    label: gettext('Delete'),\n                    className: 'btn-danger',\n                    callback: function() {\n                        _this._delete();\n                    }\n                }\n            }\n        });\n    });\n\n    //  \n    this.changeButton.addEventListener('click', function(event) {\n        event.preventDefault();\n\n        const data = new FormData();\n        const params = getPaperParams(_this.element);\n        Object.keys(params).forEach(function(name) {\n            data.append(name, params[name]);\n        });\n        data.append('instance_id', _this.instanceId.toString());\n        const queryString = new URLSearchParams(data).toString();\n\n        Promise.all([\n            preloader.show(),\n            fetch(`${_this._opts.urls.change}?${queryString}`, {\n                credentials: 'same-origin',\n            })\n        ]).then(function(values) {\n            const response = values[1];\n            if (!response.ok) {\n                const error = new Error(`${response.status} ${response.statusText}`);\n                error.response = response;\n                throw error;\n            }\n\n            return response.json();\n        }).then(function(response) {\n            if (response.error) {\n                const error = new Error(response.error);\n                error.response = response;\n                throw error\n            }\n\n            preloader.hide();\n            const $dialog = bootbox.dialog({\n                title: gettext('Edit file'),\n                message: response.form,\n                onEscape: true,\n                buttons: {\n                    cancel: {\n                        label: gettext('Cancel'),\n                        className: 'btn-outline-info'\n                    },\n                    ok: {\n                        label: gettext('Save'),\n                        className: 'btn-success',\n                        callback: function() {\n                            _this._change(this);\n                            return false;\n                        }\n                    }\n                }\n            });\n\n            const $form = $dialog.find('form');\n            $form.on('submit', function() {\n                _this._change($dialog);\n                return false;\n            });\n        }).catch(function(error) {\n            preloader.hide();\n            _this.trigger('upload:error', [error]);\n        });\n    });\n};\n\n// ======================================\n\n\nfunction initWidget(element) {\n    if (element.closest('.empty-form')) {\n        return\n    }\n\n    new FileWidget(element, {\n        urls: {\n            upload: element.dataset.uploadUrl,\n            change: element.dataset.changeUrl,\n            delete: element.dataset.deleteUrl,\n        }\n    }).on('upload:error', function(reason) {\n        bootbox.alert({\n            message: reason,\n            size: 'small'\n        });\n    });\n}\n\n\nfunction initWidgets(root = document.body) {\n    let file_selector = '.file-uploader';\n    root.matches(file_selector) && initWidget(root);\n    root.querySelectorAll(file_selector).forEach(initWidget);\n}\n\n\nwhenDomReady(initWidgets);\nemitters.dom.on('mutate', initWidgets);\n","/* global gettext */\n\nimport deepmerge from \"deepmerge\";\nimport {Uploader, getPaperParams} from \"./_uploader\";\n\n// PaperAdmin API\nconst EventEmitter = window.paperAdmin.EventEmitter;\nconst whenDomReady = window.paperAdmin.whenDomReady;\nconst bootbox = window.paperAdmin.bootbox;\nconst emitters = window.paperAdmin.emitters;\nconst preloader = window.paperAdmin.preloader;\nconst formUtils = window.paperAdmin.formUtils;\n\n// CSS\nimport \"../css/widget_image.scss\";\n\n\n/**\n * @fires upload:submit\n * @fires upload:upload\n * @fires upload:created\n * @fires upload:deleted\n * @fires upload:complete\n * @fires upload:error\n * @param element\n * @param options\n * @constructor\n */\nfunction ImageWidget(element, options) {\n    /**\n     * @type object\n     */\n    this._opts = deepmerge({\n        input: '.image-uploader__input',\n        uploadButton: '.image-uploader__upload-button',\n        changeButton: '.image-uploader__change-button',\n        deleteButton: '.image-uploader__delete-button',\n\n        link: '.image-uploader__link',\n\n        urls: {\n            upload: '',\n            change: '',\n            delete: ''\n        }\n    }, options || {});\n\n    this.element = element;\n\n    this.input = this.element.querySelector(this._opts.input);\n    if (!this.input) {\n        throw new Error(`Not found element \"${this._opts.input}\"`);\n    }\n\n    this.uploadButton = this.element.querySelector(this._opts.uploadButton);\n    if (!this.uploadButton) {\n        throw new Error(`Not found element \"${this._opts.uploadButton}\"`);\n    }\n\n    this.changeButton = this.element.querySelector(this._opts.changeButton);\n    if (!this.changeButton) {\n        throw new Error(`Not found element \"${this._opts.changeButton}\"`);\n    }\n\n    this.deleteButton = this.element.querySelector(this._opts.deleteButton);\n    if (!this.deleteButton) {\n        throw new Error(`Not found element \"${this._opts.deleteButton}\"`);\n    }\n\n    // \n    this.loading = false;\n    this.empty = isNaN(this.instanceId);\n\n    this.uploader = this.initUploader();\n    this.addListeners();\n}\n\nImageWidget.prototype = Object.create(EventEmitter.prototype);\n\nObject.defineProperty(ImageWidget.prototype, 'instanceId', {\n    get: function() {\n        return parseInt(this.input.value);\n    },\n    set: function(value) {\n        this.input.value = parseInt(value) || '';\n    }\n});\n\nObject.defineProperty(ImageWidget.prototype, 'empty', {\n    get: function() {\n        return Boolean(this._empty);\n    },\n    set: function(value) {\n        const newValue = Boolean(value);\n        if (newValue === Boolean(this._empty)) {\n            return\n        }\n        if (newValue) {\n            this.element.classList.add('empty');\n        } else {\n            this.element.classList.remove('empty');\n        }\n        this._empty = newValue;\n    }\n});\n\nObject.defineProperty(ImageWidget.prototype, 'loading', {\n    get: function() {\n        return Boolean(this._loading);\n    },\n    set: function(value) {\n        const newValue = Boolean(value);\n        if (newValue === Boolean(this._loading)) {\n            return\n        }\n        if (newValue) {\n            this.element.classList.add('loading');\n        } else {\n            this.element.classList.remove('loading');\n        }\n        this._loading = newValue;\n    }\n});\n\n/**\n *   .\n */\nImageWidget.prototype.initUploader = function() {\n    const _this = this;\n    const uploader = new Uploader(this.element, {\n        url: this._opts.urls.upload,\n        button: this.uploadButton,\n        acceptFiles: 'image/*',\n        dropzones: this.element.querySelectorAll('.dropzone-overlay'),\n    }).on('submit', function(id) {\n        _this.trigger('upload:submit', [id]);\n    }).on('upload', function(id) {\n        _this.loading = true;\n\n        const progressBar = _this.element.querySelector('.progress-bar');\n        progressBar && (progressBar.style.width = '');\n        _this.trigger('upload:upload', [id]);\n    }).on('progress', function(id, percentage) {\n        const progressBar = _this.element.querySelector('.progress-bar');\n        progressBar && (progressBar.style.width = percentage + '%');\n    }).on('complete', function(id, response) {\n        _this.empty = false;\n        _this.instanceId = response.instance_id;\n        _this.trigger('upload:created');\n\n        _this.element.classList.remove('loading');\n\n        const fileName = _this.element.querySelector('.file-name');\n        fileName && (fileName.textContent = response.name);\n\n        const fileInfo = _this.element.querySelector('.file-info');\n        fileInfo && (fileInfo.textContent = response.file_info);\n\n        const previewLink = _this.element.querySelector(_this._opts.link);\n        previewLink && (previewLink.href = response.url);\n\n        _this.trigger('upload:complete');\n    }).on('cancel', function(id) {\n        _this.trigger('upload:cancel', [id]);\n    }).on('error', function(id, reason) {\n        _this.trigger('upload:error', [reason]);\n    }).on('all_complete', function() {\n        _this.loading = false;\n    });\n\n    return uploader;\n};\n\n/**\n *    .\n * @param $dialog\n * @private\n */\nImageWidget.prototype._change = function($dialog) {\n    if (isNaN(this.instanceId)) {\n        return\n    }\n\n    const _this = this;\n    const $form = $dialog.find('form');\n    Promise.all([\n        preloader.show(),\n        fetch($form.prop('action'), {\n            method: 'POST',\n            credentials: 'same-origin',\n            body: new FormData($form.get(0))\n        })\n    ]).then(function(values) {\n        const response = values[1];\n        if (!response.ok) {\n            const error = new Error(`${response.status} ${response.statusText}`);\n            error.response = response;\n            throw error;\n        }\n\n        return response.json();\n    }).then(function(response) {\n        if (response.error) {\n            const error = new Error(response.error);\n            error.response = response;\n            throw error\n        }\n\n        preloader.hide();\n        formUtils.cleanFormErrors($form.get(0));\n        if (response.form_errors) {\n            formUtils.addFormErrorsFromJSON($form.get(0), response.form_errors);\n        } else {\n            $dialog.modal('hide');\n\n            const fileName = _this.element.querySelector('.file-name');\n            fileName && (fileName.textContent = response.name);\n\n            const fileInfo = _this.element.querySelector('.file-info');\n            fileInfo && (fileInfo.textContent = response.file_info);\n\n            const previewLink = _this.element.querySelector(_this._opts.link);\n            previewLink && (previewLink.href = response.url);\n        }\n    }).catch(function(error) {\n        preloader.hide();\n        _this.trigger('upload:error', [null, error]);\n    });\n};\n\n/**\n *  .\n * @private\n */\nImageWidget.prototype._delete = function() {\n    if (isNaN(this.instanceId)) {\n        return\n    }\n\n    const data = new FormData();\n    const params = getPaperParams(this.element);\n    Object.keys(params).forEach(function(name) {\n        data.append(name, params[name]);\n    });\n    data.append('instance_id', this.instanceId.toString());\n\n    const _this = this;\n    fetch(this._opts.urls.delete, {\n        method: 'POST',\n        credentials: 'same-origin',\n        body: data\n    }).then(function(response) {\n        if (!response.ok) {\n            const error = new Error(`${response.status} ${response.statusText}`);\n            error.response = response;\n            throw error;\n        }\n        return response.json();\n    }).then(function(response) {\n        if (response.error) {\n            const error = new Error(response.error);\n            error.response = response;\n            throw error\n        }\n\n        _this.empty = true;\n        _this.instanceId = '';\n\n        const fileName = _this.element.querySelector('.file-name');\n        fileName && (fileName.textContent = '');\n\n        const fileInfo = _this.element.querySelector('.file-info');\n        fileInfo && (fileInfo.textContent = '');\n\n        _this.trigger('upload:deleted');\n    }).catch(function(error) {\n        _this.trigger('upload:error', [null, error]);\n    });\n};\n\nImageWidget.prototype.addListeners = function() {\n    const _this = this;\n\n    //  \n    this.deleteButton.addEventListener('click', function(event) {\n        event.preventDefault();\n\n        bootbox.dialog({\n            size: 'small',\n            title: gettext('Confirmation'),\n            message: gettext('Are you sure you want to <b>DELETE</b> this file?'),\n            onEscape: true,\n            buttons: {\n                cancel: {\n                    label: gettext('Cancel'),\n                    className: 'btn-outline-info'\n                },\n                confirm: {\n                    label: gettext('Delete'),\n                    className: 'btn-danger',\n                    callback: function() {\n                        _this._delete();\n                    }\n                }\n            }\n        });\n    });\n\n    //  \n    this.changeButton.addEventListener('click', function(event) {\n        event.preventDefault();\n\n        const data = new FormData();\n        const params = getPaperParams(_this.element);\n        Object.keys(params).forEach(function(name) {\n            data.append(name, params[name]);\n        });\n        data.append('instance_id', _this.instanceId.toString());\n        const queryString = new URLSearchParams(data).toString();\n\n        Promise.all([\n            preloader.show(),\n            fetch(`${_this._opts.urls.change}?${queryString}`, {\n                credentials: 'same-origin',\n            })\n        ]).then(function(values) {\n            const response = values[1];\n            if (!response.ok) {\n                const error = new Error(`${response.status} ${response.statusText}`);\n                error.response = response;\n                throw error;\n            }\n\n            return response.json();\n        }).then(function(response) {\n            if (response.error) {\n                const error = new Error(response.error);\n                error.response = response;\n                throw error\n            }\n\n            preloader.hide();\n            const $dialog = bootbox.dialog({\n                title: gettext('Edit file'),\n                message: response.form,\n                onEscape: true,\n                buttons: {\n                    cancel: {\n                        label: gettext('Cancel'),\n                        className: 'btn-outline-info'\n                    },\n                    ok: {\n                        label: gettext('Save'),\n                        className: 'btn-success',\n                        callback: function() {\n                            _this._change(this);\n                            return false;\n                        }\n                    }\n                }\n            });\n\n            const $form = $dialog.find('form');\n            $form.on('submit', function() {\n                _this._change($dialog);\n                return false;\n            });\n        }).catch(function(error) {\n            preloader.hide();\n            _this.trigger('upload:error', [error]);\n        });\n    });\n};\n\n// ======================================\n\n\nfunction initWidget(element) {\n    if (element.closest('.empty-form')) {\n        return\n    }\n\n    new ImageWidget(element, {\n        urls: {\n            upload: element.dataset.uploadUrl,\n            change: element.dataset.changeUrl,\n            delete: element.dataset.deleteUrl,\n        }\n    }).on('upload:error', function(reason) {\n        bootbox.alert({\n            message: reason,\n            size: 'small'\n        });\n    });\n}\n\n\nfunction initWidgets(root = document.body) {\n    let file_selector = '.image-uploader';\n    root.matches(file_selector) && initWidget(root);\n    root.querySelectorAll(file_selector).forEach(initWidget);\n}\n\n\nwhenDomReady(initWidgets);\nemitters.dom.on('mutate', initWidgets);\n\n","/* global gettext */\n\nimport deepmerge from \"deepmerge\";\nimport {Uploader, getPaperParams} from \"./_uploader\";\n\n// PaperAdmin API\nconst EventEmitter = window.paperAdmin.EventEmitter;\nconst whenDomReady = window.paperAdmin.whenDomReady;\nconst Sortable = window.paperAdmin.Sortable;\nconst bootbox = window.paperAdmin.bootbox;\nconst emitters = window.paperAdmin.emitters;\nconst preloader = window.paperAdmin.preloader;\nconst formUtils = window.paperAdmin.formUtils;\n\n// CSS\nimport \"../css/widget_gallery.scss\";\n\n\n/**\n * @param element\n * @param options\n * @fires gallery:created\n * @fires gallery:deleted\n * @fires gallery:error\n * @fires gallery:submit_item\n * @fires gallery:upload_item\n * @fires gallery:cancel_item\n * @fires gallery:complete_item\n * @constructor\n */\nfunction Gallery(element, options) {\n    /**\n     * @type Object\n     */\n    this._opts = deepmerge({\n        input: '.gallery__input',\n        itemContainer: '.gallery__items',\n        item: '.gallery__item',\n        uploadButton: '.gallery__upload-button',\n        deleteButton: '.gallery__delete-button',\n        preloaderItem: '.gallery__item--preloader',\n        preloaderTemplate: '.gallery__item-preloader',\n\n        itemPreview: '.gallery__item-preview',\n        itemLink: '.gallery__item-link',\n        itemCheckbox: '.gallery__item-checkbox',\n        itemName: '.gallery__item-name',\n        changeItemButton: '.gallery__item-change-button',\n        deleteItemButton: '.gallery__item-delete-button',\n        itemSelectorTemplate: '.gallery__{}-item-template',\n        itemCoverClass: 'gallery__item--cover',\n\n        urls: {\n            deleteGallery: '',\n            uploadItem: '',\n            changeItem: '',\n            deleteItem: '',\n            sortItems: ''\n        }\n    }, options || {});\n\n    this.element = element;\n\n    this.input = this.element.querySelector(this._opts.input);\n    if (!this.input) {\n        throw new Error(`Not found element \"${this._opts.input}\"`);\n    }\n\n    this.itemContainer = this.element.querySelector(this._opts.itemContainer);\n    if (!this.itemContainer) {\n        throw new Error(`Not found element \"${this._opts.itemContainer}\"`);\n    }\n\n    this.uploadButton = this.element.querySelector(this._opts.uploadButton);\n    if (!this.uploadButton) {\n        throw new Error(`Not found element \"${this._opts.uploadButton}\"`);\n    }\n\n    this.deleteButton = this.element.querySelector(this._opts.deleteButton);\n    if (!this.deleteButton) {\n        throw new Error(`Not found element \"${this._opts.deleteButton}\"`);\n    }\n\n    this.init();\n}\n\nGallery.prototype = Object.create(EventEmitter.prototype);\n\nObject.defineProperty(Gallery.prototype, 'galleryId', {\n    get: function() {\n        return parseInt(this.input.value);\n    },\n    set: function(value) {\n        this.input.value = parseInt(value) || '';\n    }\n});\n\nObject.defineProperty(Gallery.prototype, 'empty', {\n    get: function() {\n        return Boolean(this._empty);\n    },\n    set: function(value) {\n        const newValue = Boolean(value);\n        if (newValue === Boolean(this._empty)) {\n            return\n        }\n        if (newValue) {\n            this.element.classList.add('empty');\n            this.deleteButton.disabled = true;\n        } else {\n            this.element.classList.remove('empty');\n            this.deleteButton.disabled = false;\n        }\n        this._empty = newValue;\n    }\n});\n\n/**\n *  \n */\nGallery.prototype.init = function() {\n    this.allowedMimeTypes = JSON.parse(this.element.dataset.allowedMimetypes);\n    this.empty = isNaN(this.galleryId);\n    this.uploader = this.initUploader();\n    this.sortable = this.initSortable();\n    this.addListeners();\n};\n\n/**\n *   .\n */\nGallery.prototype.initUploader = function() {\n    const _this = this;\n    return new Uploader(this.element, {\n        url: this._opts.urls.uploadItem,\n        multiple: true,\n        button: this.uploadButton,\n        dropzones: this.element.querySelectorAll('.dropzone-overlay'),\n        extraData: {\n            gallery_id: function() {\n                return _this.galleryId;\n            }\n        },\n        filters: [\n            function(id, file) {\n                if (_this.allowedMimeTypes && _this.allowedMimeTypes.length) {\n                    if (_this.allowedMimeTypes.indexOf(file.type) < 0) {\n                        throw new Error(`Unsupported MIME type: ${file.type}`);\n                    }\n                }\n            }\n        ]\n    }).on('submit', function(id) {\n        const template = _this.element.querySelector(_this._opts.preloaderTemplate);\n        const clone = document.importNode(template.content, true);\n\n        const preloader = clone.querySelector(_this._opts.item);\n        preloader.dataset.queueId = id;\n        preloader.classList.add(`item-preloader-${id}`);\n\n        const file = this.uploader.getFile(id);\n        const fileName = preloader.querySelector(_this._opts.itemName);\n        if (fileName) {\n            fileName.title = file.name;\n            fileName.textContent = file.name;\n        }\n\n        _this.itemContainer.append(clone);\n\n        _this.trigger('gallery:submit_item', [preloader, id]);\n    }).on('upload', function(id) {\n        const preloader = _this.itemContainer.querySelector(`.item-preloader-${id}`);\n        _this.trigger('gallery:upload_item', [preloader, id]);\n    }).on('progress', function(id, percentage) {\n        const preloader = _this.itemContainer.querySelector(`.item-preloader-${id}`);\n        const progressBar = preloader.querySelector('.progress-bar');\n        progressBar && (progressBar.style.height = percentage + '%');\n\n        if (percentage >= 100) {\n            preloader.classList.add('processing');\n        }\n    }).on('complete', function(id, response) {\n        if (_this.empty) {\n            _this.empty = false;\n            _this.galleryId = response.gallery_id;\n            _this.trigger('gallery:created');\n        }\n\n        const preloader = _this.itemContainer.querySelector(`.item-preloader-${id}`);\n        _this.trigger('gallery:complete_item', [preloader, id]);\n\n        const itemType = response.item_type;\n        const templateSelector = _this._opts.itemSelectorTemplate.replace('{}', itemType);\n        const template = _this.element.querySelector(templateSelector);\n        if (!template) {\n            _this.trigger('gallery:error', [preloader, `Invalid item_type: ${itemType}`]);\n        } else {\n            const clone = document.importNode(template.content, true);\n            const item = clone.querySelector(_this._opts.item);\n            item.setAttribute('data-pk', response.id);\n            item.setAttribute('data-item-type', itemType);\n\n            const preview = clone.querySelector(_this._opts.itemPreview);\n            preview && (preview.innerHTML = response.preview);\n\n            const previewLink = clone.querySelector(_this._opts.itemLink);\n            previewLink && (previewLink.href = response.url);\n\n            const fileName = clone.querySelector(_this._opts.itemName);\n            if (fileName) {\n                fileName.title = response.name;\n                fileName.textContent = response.name;\n            }\n\n            preloader.before(clone);\n        }\n\n        preloader.remove();\n\n        // set cover class\n        const currentCover = _this.itemContainer.querySelector(`.${_this._opts.itemCoverClass}`);\n        if (response.cover) {\n            const newCover = _this.itemContainer.querySelector(`${_this._opts.item}[data-pk=\"${response.cover}\"]`);\n            if (newCover !== currentCover) {\n                currentCover && currentCover.classList.remove(_this._opts.itemCoverClass);\n                newCover && newCover.classList.add(_this._opts.itemCoverClass);\n            }\n        }\n    }).on('cancel', function(id) {\n        const preloader = _this.itemContainer.querySelector(`.item-preloader-${id}`);\n        _this.trigger('gallery:cancel_item', [preloader, id]);\n        preloader.remove();\n    }).on('error', function(id, reason) {\n        const preloader = _this.itemContainer.querySelector(`.item-preloader-${id}`);\n        _this.trigger('gallery:error', [preloader, reason]);\n        preloader.remove();\n    }).on('reject', function(id, file, reason) {\n        _this.trigger('gallery:reject', [id, file, reason]);\n    });\n};\n\nGallery.prototype.initSortable = function() {\n    const _this = this;\n    return Sortable.create(this.itemContainer, {\n        animation: 0,\n        draggable: this._opts.item,\n        filter: this._opts.preloaderItem,\n        handle: '.sortable-handler',\n        ghostClass: 'sortable-ghost',\n        onEnd: function() {\n            const items = Array.from(_this.itemContainer.querySelectorAll(_this._opts.item));\n            const order = items.map(function(item) {\n                if (!item.matches(_this._opts.preloaderItem)) {\n                    return item.dataset.pk;\n                }\n            }).filter(Boolean);\n\n            const data = new FormData();\n            const params = getPaperParams(_this.element);\n            Object.keys(params).forEach(function(name) {\n                data.append(name, params[name]);\n            });\n            data.append('gallery_id', _this.galleryId.toString());\n            data.append('order', order.join(','));\n\n            fetch(_this._opts.urls.sortItems, {\n                method: 'POST',\n                credentials: 'same-origin',\n                body: data\n            }).then(function(response) {\n                if (!response.ok) {\n                    const error = new Error(`${response.status} ${response.statusText}`);\n                    error.response = response;\n                    throw error;\n                }\n\n                return response.json();\n            }).then(function(response) {\n                if (response.error) {\n                    const error = new Error(response.error);\n                    error.response = response;\n                    throw error\n                }\n            }).catch(function(error) {\n                _this.trigger('gallery:error', [null, error]);\n            })\n        },\n    });\n};\n\n/**\n *      .\n */\nGallery.prototype.cleanItems = function() {\n    while (this.itemContainer.firstChild) {\n        this.itemContainer.removeChild(this.itemContainer.firstChild);\n    }\n};\n\nGallery.prototype._deleteItem = function(item) {\n    if (item.matches(this._opts.preloaderItem)) {\n        //      -  \n        if (!item.classList.contains('processing')) {\n            const queueId = parseInt(item.dataset.queueId);\n            this.uploader.uploader.cancel(queueId);\n        }\n        return\n    }\n\n    if (isNaN(this.galleryId)) {\n        return\n    }\n\n    const instance_id = parseInt(item && item.dataset.pk);\n    if (isNaN(instance_id)) {\n        return\n    }\n\n    const data = new FormData();\n    const params = getPaperParams(this.element);\n    Object.keys(params).forEach(function(name) {\n        data.append(name, params[name]);\n    });\n    data.append('gallery_id', this.galleryId.toString());\n    data.append('instance_id', instance_id.toString());\n    data.append('item_type', item.dataset.itemType);\n\n    const _this = this;\n    Promise.all([\n        preloader.show(),\n        fetch(this._opts.urls.deleteItem, {\n            method: 'POST',\n            credentials: 'same-origin',\n            body: data\n        })\n    ]).then(function(values) {\n        const response = values[1];\n        if (!response.ok) {\n            const error = new Error(`${response.status} ${response.statusText}`);\n            error.response = response;\n            throw error;\n        }\n\n        return response.json();\n    }).then(function(response) {\n        if (response.error) {\n            const error = new Error(response.error);\n            error.response = response;\n            throw error\n        }\n\n        // set cover class\n        const currentCover = _this.itemContainer.querySelector(`.${_this._opts.itemCoverClass}`);\n        if (response.cover) {\n            const newCover = _this.itemContainer.querySelector(`${_this._opts.item}[data-pk=\"${response.cover}\"]`);\n            if (newCover !== currentCover) {\n                currentCover && currentCover.classList.remove(_this._opts.itemCoverClass);\n                newCover && newCover.classList.add(_this._opts.itemCoverClass);\n            }\n        }\n\n        preloader.hide();\n        item.remove();\n    }).catch(function(error) {\n        preloader.hide();\n        _this.trigger('gallery:error', [item, error]);\n    });\n};\n\n/**\n *    .\n * @param item\n * @param $dialog\n * @private\n */\nGallery.prototype._changeItem = function(item, $dialog) {\n    if (isNaN(this.galleryId)) {\n        return\n    }\n\n    const instance_id = parseInt(item && item.dataset.pk);\n    if (isNaN(instance_id)) {\n        return\n    }\n\n    const _this = this;\n    const $form = $dialog.find('form');\n    Promise.all([\n        preloader.show(),\n        fetch($form.prop('action'), {\n            method: 'POST',\n            credentials: 'same-origin',\n            body: new FormData($form.get(0))\n        })\n    ]).then(function(values) {\n        const response = values[1];\n        if (!response.ok) {\n            const error = new Error(`${response.status} ${response.statusText}`);\n            error.response = response;\n            throw error;\n        }\n\n        return response.json();\n    }).then(function(response) {\n        if (response.error) {\n            const error = new Error(response.error);\n            error.response = response;\n            throw error\n        }\n\n        preloader.hide();\n        formUtils.cleanFormErrors($form.get(0));\n        if (response.form_errors) {\n            formUtils.addFormErrorsFromJSON($form.get(0), response.form_errors);\n        } else {\n            $dialog.modal('hide');\n\n            const preview = item.querySelector(_this._opts.itemPreview);\n            preview && (preview.innerHTML = response.preview);\n\n            const previewLink = item.querySelector(_this._opts.itemLink);\n            previewLink && (previewLink.href = response.url);\n\n            const fileName = item.querySelector(_this._opts.itemName);\n            if (fileName) {\n                fileName.title = response.name;\n                fileName.textContent = response.name;\n            }\n        }\n    }).catch(function(error) {\n        preloader.hide();\n        _this.trigger('gallery:error', [null, error]);\n    });\n};\n\n/**\n *  .\n * @private\n */\nGallery.prototype._deleteGallery = function() {\n    if (isNaN(this.galleryId)) {\n        return\n    }\n\n    const data = new FormData();\n    const params = getPaperParams(this.element);\n    Object.keys(params).forEach(function(name) {\n        data.append(name, params[name]);\n    });\n    data.append('gallery_id', this.galleryId.toString());\n\n    const _this = this;\n    fetch(this._opts.urls.deleteGallery, {\n        method: 'POST',\n        credentials: 'same-origin',\n        body: data\n    }).then(function(response) {\n        if (!response.ok) {\n            const error = new Error(`${response.status} ${response.statusText}`);\n            error.response = response;\n            throw error;\n        }\n        return response.json();\n    }).then(function(response) {\n        if (response.error) {\n            const error = new Error(response.error);\n            error.response = response;\n            throw error\n        }\n\n        _this.cleanItems();\n        _this.empty = true;\n        _this.galleryId = '';\n        _this.trigger('gallery:deleted');\n    }).catch(function(error) {\n        _this.trigger('gallery:error', [null, error]);\n    });\n};\n\n/**\n *   .\n * @param {HTMLElement} item\n * @param {Boolean} state\n * @private\n */\nGallery.prototype._checkItem = function(item, state=true) {\n    item.classList.toggle('gallery__item--checked', state);\n    const checkbox = item.querySelector(this._opts.itemCheckbox);\n    checkbox.checked = state;\n};\n\nGallery.prototype.addListeners = function() {\n    const _this = this;\n\n    //  \n    this.element.addEventListener('click', function(event) {\n        if (!event.target.closest(_this._opts.deleteButton)) {\n            return\n        }\n\n        event.preventDefault();\n\n        bootbox.dialog({\n            size: 'small',\n            title: gettext('Confirmation'),\n            message: gettext('Are you sure you want to <b>DELETE</b> this gallery?'),\n            onEscape: true,\n            buttons: {\n                cancel: {\n                    label: gettext('Cancel'),\n                    className: 'btn-outline-info'\n                },\n                confirm: {\n                    label: gettext('Delete'),\n                    className: 'btn-danger',\n                    callback: function() {\n                        _this._deleteGallery();\n                    }\n                }\n            }\n        });\n    });\n\n    //  \n    this.element.addEventListener('click', function(event) {\n        if (!event.target.closest(_this._opts.changeItemButton)) {\n            return\n        }\n\n        event.preventDefault();\n\n        const item = event.target.closest(_this._opts.item);\n        const instance_id = parseInt(item && item.dataset.pk);\n        if (isNaN(instance_id)) {\n            return\n        }\n\n        const data = new FormData();\n        const params = getPaperParams(_this.element);\n        Object.keys(params).forEach(function(name) {\n            data.append(name, params[name]);\n        });\n        data.append('gallery_id', _this.galleryId.toString());\n        data.append('instance_id', instance_id.toString());\n        data.append('item_type', item.dataset.itemType);\n        const queryString = new URLSearchParams(data).toString();\n\n        Promise.all([\n            preloader.show(),\n            fetch(`${_this._opts.urls.changeItem}?${queryString}`, {\n                credentials: 'same-origin',\n            })\n        ]).then(function(values) {\n            const response = values[1];\n            if (!response.ok) {\n                const error = new Error(`${response.status} ${response.statusText}`);\n                error.response = response;\n                throw error;\n            }\n\n            return response.json();\n        }).then(function(response) {\n            if (response.error) {\n                const error = new Error(response.error);\n                error.response = response;\n                throw error\n            }\n\n            preloader.hide();\n            const $dialog = bootbox.dialog({\n                title: gettext('Edit file'),\n                message: response.form,\n                onEscape: true,\n                buttons: {\n                    cancel: {\n                        label: gettext('Cancel'),\n                        className: 'btn-outline-info'\n                    },\n                    ok: {\n                        label: gettext('Save'),\n                        className: 'btn-success',\n                        callback: function() {\n                            _this._changeItem(item, this);\n                            return false;\n                        }\n                    }\n                }\n            });\n\n            const $form = $dialog.find('form');\n            $form.on('submit', function() {\n                _this._changeItem(item, $dialog);\n                return false;\n            });\n        }).catch(function(error) {\n            preloader.hide();\n            _this.trigger('gallery:error', [null, error]);\n        });\n    });\n\n    //   /  \n    this.element.addEventListener('click', function(event) {\n        if (!event.target.closest(_this._opts.deleteItemButton)) {\n            return\n        }\n\n        event.preventDefault();\n\n        bootbox.dialog({\n            size: 'small',\n            title: gettext('Confirmation'),\n            message: gettext('Are you sure you want to <b>DELETE</b> this file?'),\n            onEscape: true,\n            buttons: {\n                cancel: {\n                    label: gettext('Cancel'),\n                    className: 'btn-outline-info'\n                },\n                confirm: {\n                    label: gettext('Delete'),\n                    className: 'btn-danger',\n                    callback: function() {\n                        const item = event.target.closest(_this._opts.item);\n                        _this._deleteItem(item);\n                    }\n                }\n            }\n        });\n    });\n\n    //   \n    let lastChecked = null;\n    this.element.addEventListener('click', function(event) {\n        const item = event.target.closest(_this._opts.item);\n        if (!item) {\n            return\n        }\n\n        let target_state;\n        let checkbox = event.target.closest(_this._opts.itemCheckbox);\n        if (!checkbox) {\n            //     ,      ,\n            //     Ctrl ( Shift   )\n            if (!event.ctrlKey && !event.shiftKey) {\n                return\n            }\n\n            checkbox = item.querySelector(_this._opts.itemCheckbox);\n            if (!checkbox) {\n                return\n            }\n            target_state = !checkbox.checked;\n        } else {\n            //        \n            target_state = checkbox.checked;\n        }\n\n        if (lastChecked && event.shiftKey && (lastChecked !== item)) {\n            const items = Array.from(_this.itemContainer.querySelectorAll(_this._opts.item));\n            const lastIndex = items.indexOf(lastChecked);\n            const targetIndex = items.indexOf(item);\n            const startIndex = Math.min(lastIndex, targetIndex);\n            const endIndex = Math.max(lastIndex, targetIndex);\n            const item_slice = items.slice(startIndex, endIndex + 1);\n            item_slice.forEach(function(item) {\n                _this._checkItem(item, target_state)\n            });\n        } else {\n            _this._checkItem(item, target_state);\n        }\n\n        lastChecked = item;\n    });\n\n    //      Delete\n    this.element.addEventListener('keyup', function(event) {\n        if (event.code === 'Delete') {\n            const items = Array.from(_this.itemContainer.querySelectorAll(_this._opts.item));\n            const checkedItems = items.filter(function(item) {\n                const checkbox = item.querySelector(_this._opts.itemCheckbox);\n                return checkbox.checked;\n            });\n\n            if (checkedItems.length) {\n                bootbox.dialog({\n                    size: 'small',\n                    title: gettext('Confirmation'),\n                    message: gettext(`Are you sure you want to <b>DELETE</b> the selected <b>${checkedItems.length}</b> file(s)?`),\n                    onEscape: true,\n                    buttons: {\n                        cancel: {\n                            label: gettext('Cancel'),\n                            className: 'btn-outline-info'\n                        },\n                        confirm: {\n                            label: gettext('Delete'),\n                            className: 'btn-danger',\n                            callback: function() {\n                                checkedItems.forEach(function(item) {\n                                    _this._deleteItem(item);\n                                });\n                            }\n                        }\n                    }\n                });\n            }\n        }\n    });\n};\n\n// ======================================\n\nlet _errors = [];\nlet _errorTimer = null;\nfunction alertMessage(text) {\n    _errors.push(text);\n    if (_errorTimer) {\n        clearTimeout(_errorTimer);\n    }\n\n    _errorTimer = setTimeout(function() {\n        let message = ['<ul class=\"px-4 mb-0\">'];\n        for (let i=0, l=_errors.length; i<l; i++) {\n            message.push(`<li>${_errors[i]}</li>`);\n        }\n        message.push(`</ul>`);\n\n        bootbox.alert({\n            message: message.join('')\n        });\n\n        _errors = [];\n        _errorTimer = null;\n    }, 500);\n}\n\nfunction initWidget(element) {\n    if (element.closest('.empty-form')) {\n        return\n    }\n\n    new Gallery(element, {\n        urls: {\n            deleteGallery: element.dataset.deleteGalleryUrl,\n            uploadItem: element.dataset.uploadItemUrl,\n            changeItem: element.dataset.changeItemUrl,\n            deleteItem: element.dataset.deleteItemUrl,\n            sortItems: element.dataset.sortItemsUrl\n        }\n    }).on('gallery:error', function(item, reason) {\n        alertMessage(reason);\n    }).on('gallery:reject', function(id, file, reason) {\n        alertMessage(`File \"${file.name}\" <b>rejected</b>:<br>${reason}`);\n    });\n}\n\n\nfunction initWidgets(root = document.body) {\n    let file_selector = '.gallery';\n    root.matches(file_selector) && initWidget(root);\n    root.querySelectorAll(file_selector).forEach(initWidget);\n}\n\n\nwhenDomReady(initWidgets);\nemitters.dom.on('mutate', initWidgets);\n","import \"./_uploader\";\nimport \"./file_widget\";\nimport \"./image_widget\";\nimport \"./gallery_widget\";\n\n// Images\nfunction importAll(r) {\n    return r.keys().map(r);\n}\nimportAll(require.context('../img/files/', false, /\\.svg$/));\n"],"sourceRoot":""}